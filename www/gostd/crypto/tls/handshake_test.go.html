<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html" class="current">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8163317">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8163372">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8163426">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8163477">package</span>&nbsp;<span class="ident" id="8163485">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8163490">import</span>&nbsp;<span class="op" id="8163497">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8163500">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8163509">&#34;encoding/hex&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8163525">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8163535">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8163543">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8163550">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8163556">&#34;io/ioutil&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8163569">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8163576">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8163587">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8163598">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="8163605">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="8163608">//&nbsp;TLS&nbsp;reference&nbsp;tests&nbsp;run&nbsp;a&nbsp;connection&nbsp;against&nbsp;a&nbsp;reference&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="8163683">//&nbsp;(OpenSSL)&nbsp;of&nbsp;TLS&nbsp;and&nbsp;record&nbsp;the&nbsp;bytes&nbsp;of&nbsp;the&nbsp;resulting&nbsp;connection.&nbsp;The&nbsp;Go</span><br>
<span class="lineno"></span><span class="comment" id="8163760">//&nbsp;code,&nbsp;during&nbsp;a&nbsp;test,&nbsp;is&nbsp;configured&nbsp;with&nbsp;deterministic&nbsp;randomness&nbsp;and&nbsp;so&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="8163839">//&nbsp;reference&nbsp;test&nbsp;can&nbsp;be&nbsp;reproduced&nbsp;exactly&nbsp;in&nbsp;the&nbsp;future.</span><br>
<span class="lineno">25</span><span class="comment" id="8163898">//</span><br>
<span class="lineno"></span><span class="comment" id="8163901">//&nbsp;In&nbsp;order&nbsp;to&nbsp;save&nbsp;everyone&nbsp;who&nbsp;wishes&nbsp;to&nbsp;run&nbsp;the&nbsp;tests&nbsp;from&nbsp;needing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="8163975">//&nbsp;reference&nbsp;implementation&nbsp;installed,&nbsp;the&nbsp;reference&nbsp;connections&nbsp;are&nbsp;saved&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="8164053">//&nbsp;files&nbsp;in&nbsp;the&nbsp;testdata&nbsp;directory.&nbsp;Thus&nbsp;running&nbsp;the&nbsp;tests&nbsp;involves&nbsp;nothing</span><br>
<span class="lineno"></span><span class="comment" id="8164129">//&nbsp;external,&nbsp;but&nbsp;creating&nbsp;and&nbsp;updating&nbsp;them&nbsp;requires&nbsp;the&nbsp;reference</span><br>
<span class="lineno">30</span><span class="comment" id="8164196">//&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="comment" id="8164215">//</span><br>
<span class="lineno"></span><span class="comment" id="8164218">//&nbsp;Tests&nbsp;can&nbsp;be&nbsp;updated&nbsp;by&nbsp;running&nbsp;them&nbsp;with&nbsp;the&nbsp;-update&nbsp;flag.&nbsp;This&nbsp;will&nbsp;cause</span><br>
<span class="lineno"></span><span class="comment" id="8164297">//&nbsp;the&nbsp;test&nbsp;files.&nbsp;Generally&nbsp;one&nbsp;should&nbsp;combine&nbsp;the&nbsp;-update&nbsp;flag&nbsp;with&nbsp;-test.run</span><br>
<span class="lineno"></span><span class="comment" id="8164377">//&nbsp;to&nbsp;updated&nbsp;a&nbsp;specific&nbsp;test.&nbsp;Since&nbsp;the&nbsp;reference&nbsp;implementation&nbsp;will&nbsp;always</span><br>
<span class="lineno">35</span><span class="comment" id="8164455">//&nbsp;generate&nbsp;fresh&nbsp;random&nbsp;numbers,&nbsp;large&nbsp;parts&nbsp;of&nbsp;the&nbsp;reference&nbsp;connection&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="8164534">//&nbsp;always&nbsp;change.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8164553">var</span>&nbsp;<span class="ident" id="8164557">update</span>&nbsp;<span class="op" id="8164564">=</span>&nbsp;<span class="ident" id="8164566"><a href="/gostd/crypto/tls/handshake_test.go.html#8163535">flag</a></span><span class="op" id="8164570">.</span><span class="ident" id="8164571"><a href="/gostd/flag/flag.go.html#3948389">Bool</a></span><span class="op" id="8164575">(</span><span class="string" id="8164576">&#34;update&#34;</span><span class="op" id="8164584">,</span>&nbsp;<span class="builtintype" id="8164586">false</span><span class="op" id="8164591">,</span>&nbsp;<span class="string" id="8164593">&#34;update&nbsp;golden&nbsp;files&nbsp;on&nbsp;disk&#34;</span><span class="op" id="8164622">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="8164625">//&nbsp;recordingConn&nbsp;is&nbsp;a&nbsp;net.Conn&nbsp;that&nbsp;records&nbsp;the&nbsp;traffic&nbsp;that&nbsp;passes&nbsp;through&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="8164705">//&nbsp;WriteTo&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;produce&nbsp;output&nbsp;that&nbsp;can&nbsp;be&nbsp;later&nbsp;be&nbsp;loaded&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="8164779">//&nbsp;ParseTestData.</span><br>
<span class="lineno"></span><span class="keyword" id="8164797">type</span>&nbsp;<span class="ident" id="8164802">recordingConn</span>&nbsp;<span class="keyword" id="8164816">struct</span>&nbsp;<span class="op" id="8164823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8164826"><a href="/gostd/crypto/tls/handshake_test.go.html#8163569">net</a></span><span class="op" id="8164829">.</span><span class="ident" id="8164830"><a href="/gostd/net/net.go.html#3334417">Conn</a></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8164836"><a href="/gostd/crypto/tls/handshake_test.go.html#8163598">sync</a></span><span class="op" id="8164840">.</span><span class="ident" id="8164841"><a href="/gostd/sync/mutex.go.html#1443974">Mutex</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8164848">flows</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8164856">[</span><span class="op" id="8164857">]</span><span class="op" id="8164858">[</span><span class="op" id="8164859">]</span><span class="builtintype" id="8164860">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8164866">reading</span>&nbsp;<span class="builtintype" id="8164874">bool</span><br>
<span class="lineno"></span><span class="op" id="8164879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="8164882">func</span>&nbsp;<span class="op" id="8164887">(</span><span class="ident" id="8164888">r</span>&nbsp;<span class="op" id="8164890">*</span><span class="ident" id="8164891"><a href="/gostd/crypto/tls/handshake_test.go.html#8164802">recordingConn</a></span><span class="op" id="8164904">)</span>&nbsp;<span class="ident" id="8164906">Read</span><span class="op" id="8164910">(</span><span class="ident" id="8164911">b</span>&nbsp;<span class="op" id="8164913">[</span><span class="op" id="8164914">]</span><span class="builtintype" id="8164915">byte</span><span class="op" id="8164919">)</span>&nbsp;<span class="op" id="8164921">(</span><span class="ident" id="8164922">n</span>&nbsp;<span class="builtintype" id="8164924">int</span><span class="op" id="8164927">,</span>&nbsp;<span class="ident" id="8164929">err</span>&nbsp;<span class="builtintype" id="8164933">error</span><span class="op" id="8164938">)</span>&nbsp;<span class="op" id="8164940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8164943">if</span>&nbsp;<span class="ident" id="8164946"><a href="/gostd/crypto/tls/handshake_test.go.html#8164922">n</a></span><span class="op" id="8164947">,</span>&nbsp;<span class="ident" id="8164949"><a href="/gostd/crypto/tls/handshake_test.go.html#8164929">err</a></span>&nbsp;<span class="op" id="8164953">=</span>&nbsp;<span class="ident" id="8164955"><a href="/gostd/crypto/tls/handshake_test.go.html#8164888">r</a></span><span class="op" id="8164956">.</span><span class="ident" id="8164957"><a href="/gostd/crypto/tls/handshake_test.go.html#8164826">Conn</a></span><span class="op" id="8164961">.</span><span class="ident" id="8164962"><a href="/gostd/net/net.go.html#3334618">Read</a></span><span class="op" id="8164966">(</span><span class="ident" id="8164967"><a href="/gostd/crypto/tls/handshake_test.go.html#8164911">b</a></span><span class="op" id="8164968">)</span><span class="op" id="8164969">;</span>&nbsp;<span class="ident" id="8164971"><a href="/gostd/crypto/tls/handshake_test.go.html#8164922">n</a></span>&nbsp;<span class="op" id="8164973">==</span>&nbsp;<span class="num" id="8164976">0</span>&nbsp;<span class="op" id="8164978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8164982">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8164990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8164993"><a href="/gostd/crypto/tls/handshake_test.go.html#8164911">b</a></span>&nbsp;<span class="op" id="8164995">=</span>&nbsp;<span class="ident" id="8164997"><a href="/gostd/crypto/tls/handshake_test.go.html#8164911">b</a></span><span class="op" id="8164998">[</span><span class="op" id="8164999">:</span><span class="ident" id="8165000"><a href="/gostd/crypto/tls/handshake_test.go.html#8164922">n</a></span><span class="op" id="8165001">]</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8165005"><a href="/gostd/crypto/tls/handshake_test.go.html#8164888">r</a></span><span class="op" id="8165006">.</span><span class="ident" id="8165007"><a href="/gostd/sync/mutex.go.html#1444351">Lock</a></span><span class="op" id="8165011">(</span><span class="op" id="8165012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8165015">defer</span>&nbsp;<span class="ident" id="8165021"><a href="/gostd/crypto/tls/handshake_test.go.html#8164888">r</a></span><span class="op" id="8165022">.</span><span class="ident" id="8165023"><a href="/gostd/sync/mutex.go.html#1445283">Unlock</a></span><span class="op" id="8165029">(</span><span class="op" id="8165030">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8165034">if</span>&nbsp;<span class="ident" id="8165037">l</span>&nbsp;<span class="op" id="8165039">:=</span>&nbsp;<span class="builtinfunc" id="8165042">len</span><span class="op" id="8165045">(</span><span class="ident" id="8165046"><a href="/gostd/crypto/tls/handshake_test.go.html#8164888">r</a></span><span class="op" id="8165047">.</span><span class="ident" id="8165048"><a href="/gostd/crypto/tls/handshake_test.go.html#8164848">flows</a></span><span class="op" id="8165053">)</span><span class="op" id="8165054">;</span>&nbsp;<span class="ident" id="8165056"><a href="/gostd/crypto/tls/handshake_test.go.html#8165037">l</a></span>&nbsp;<span class="op" id="8165058">==</span>&nbsp;<span class="num" id="8165061">0</span>&nbsp;<span class="op" id="8165063">||</span>&nbsp;<span class="op" id="8165066">!</span><span class="ident" id="8165067"><a href="/gostd/crypto/tls/handshake_test.go.html#8164888">r</a></span><span class="op" id="8165068">.</span><span class="ident" id="8165069"><a href="/gostd/crypto/tls/handshake_test.go.html#8164866">reading</a></span>&nbsp;<span class="op" id="8165077">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8165081">buf</span>&nbsp;<span class="op" id="8165085">:=</span>&nbsp;<span class="builtinfunc" id="8165088">make</span><span class="op" id="8165092">(</span><span class="op" id="8165093">[</span><span class="op" id="8165094">]</span><span class="builtintype" id="8165095">byte</span><span class="op" id="8165099">,</span>&nbsp;<span class="builtinfunc" id="8165101">len</span><span class="op" id="8165104">(</span><span class="ident" id="8165105"><a href="/gostd/crypto/tls/handshake_test.go.html#8164911">b</a></span><span class="op" id="8165106">)</span><span class="op" id="8165107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8165111">copy</span><span class="op" id="8165115">(</span><span class="ident" id="8165116"><a href="/gostd/crypto/tls/handshake_test.go.html#8165081">buf</a></span><span class="op" id="8165119">,</span>&nbsp;<span class="ident" id="8165121"><a href="/gostd/crypto/tls/handshake_test.go.html#8164911">b</a></span><span class="op" id="8165122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8165126"><a href="/gostd/crypto/tls/handshake_test.go.html#8164888">r</a></span><span class="op" id="8165127">.</span><span class="ident" id="8165128"><a href="/gostd/crypto/tls/handshake_test.go.html#8164848">flows</a></span>&nbsp;<span class="op" id="8165134">=</span>&nbsp;<span class="builtinfunc" id="8165136">append</span><span class="op" id="8165142">(</span><span class="ident" id="8165143"><a href="/gostd/crypto/tls/handshake_test.go.html#8164888">r</a></span><span class="op" id="8165144">.</span><span class="ident" id="8165145"><a href="/gostd/crypto/tls/handshake_test.go.html#8164848">flows</a></span><span class="op" id="8165150">,</span>&nbsp;<span class="ident" id="8165152"><a href="/gostd/crypto/tls/handshake_test.go.html#8165081">buf</a></span><span class="op" id="8165155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8165158">}</span>&nbsp;<span class="keyword" id="8165160">else</span>&nbsp;<span class="op" id="8165165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8165169"><a href="/gostd/crypto/tls/handshake_test.go.html#8164888">r</a></span><span class="op" id="8165170">.</span><span class="ident" id="8165171"><a href="/gostd/crypto/tls/handshake_test.go.html#8164848">flows</a></span><span class="op" id="8165176">[</span><span class="ident" id="8165177"><a href="/gostd/crypto/tls/handshake_test.go.html#8165037">l</a></span><span class="op" id="8165178">-</span><span class="num" id="8165179">1</span><span class="op" id="8165180">]</span>&nbsp;<span class="op" id="8165182">=</span>&nbsp;<span class="builtinfunc" id="8165184">append</span><span class="op" id="8165190">(</span><span class="ident" id="8165191"><a href="/gostd/crypto/tls/handshake_test.go.html#8164888">r</a></span><span class="op" id="8165192">.</span><span class="ident" id="8165193"><a href="/gostd/crypto/tls/handshake_test.go.html#8164848">flows</a></span><span class="op" id="8165198">[</span><span class="ident" id="8165199"><a href="/gostd/crypto/tls/handshake_test.go.html#8165037">l</a></span><span class="op" id="8165200">-</span><span class="num" id="8165201">1</span><span class="op" id="8165202">]</span><span class="op" id="8165203">,</span>&nbsp;<span class="ident" id="8165205"><a href="/gostd/crypto/tls/handshake_test.go.html#8164911">b</a></span><span class="op" id="8165206">[</span><span class="op" id="8165207">:</span><span class="ident" id="8165208"><a href="/gostd/crypto/tls/handshake_test.go.html#8164922">n</a></span><span class="op" id="8165209">]</span><span class="op" id="8165210">...</span><span class="op" id="8165213">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8165216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8165219"><a href="/gostd/crypto/tls/handshake_test.go.html#8164888">r</a></span><span class="op" id="8165220">.</span><span class="ident" id="8165221"><a href="/gostd/crypto/tls/handshake_test.go.html#8164866">reading</a></span>&nbsp;<span class="op" id="8165229">=</span>&nbsp;<span class="builtintype" id="8165231">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8165237">return</span><br>
<span class="lineno"></span><span class="op" id="8165244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="8165247">func</span>&nbsp;<span class="op" id="8165252">(</span><span class="ident" id="8165253">r</span>&nbsp;<span class="op" id="8165255">*</span><span class="ident" id="8165256"><a href="/gostd/crypto/tls/handshake_test.go.html#8164802">recordingConn</a></span><span class="op" id="8165269">)</span>&nbsp;<span class="ident" id="8165271">Write</span><span class="op" id="8165276">(</span><span class="ident" id="8165277">b</span>&nbsp;<span class="op" id="8165279">[</span><span class="op" id="8165280">]</span><span class="builtintype" id="8165281">byte</span><span class="op" id="8165285">)</span>&nbsp;<span class="op" id="8165287">(</span><span class="ident" id="8165288">n</span>&nbsp;<span class="builtintype" id="8165290">int</span><span class="op" id="8165293">,</span>&nbsp;<span class="ident" id="8165295">err</span>&nbsp;<span class="builtintype" id="8165299">error</span><span class="op" id="8165304">)</span>&nbsp;<span class="op" id="8165306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8165309">if</span>&nbsp;<span class="ident" id="8165312"><a href="/gostd/crypto/tls/handshake_test.go.html#8165288">n</a></span><span class="op" id="8165313">,</span>&nbsp;<span class="ident" id="8165315"><a href="/gostd/crypto/tls/handshake_test.go.html#8165295">err</a></span>&nbsp;<span class="op" id="8165319">=</span>&nbsp;<span class="ident" id="8165321"><a href="/gostd/crypto/tls/handshake_test.go.html#8165253">r</a></span><span class="op" id="8165322">.</span><span class="ident" id="8165323"><a href="/gostd/crypto/tls/handshake_test.go.html#8164826">Conn</a></span><span class="op" id="8165327">.</span><span class="ident" id="8165328"><a href="/gostd/net/net.go.html#3334839">Write</a></span><span class="op" id="8165333">(</span><span class="ident" id="8165334"><a href="/gostd/crypto/tls/handshake_test.go.html#8165277">b</a></span><span class="op" id="8165335">)</span><span class="op" id="8165336">;</span>&nbsp;<span class="ident" id="8165338"><a href="/gostd/crypto/tls/handshake_test.go.html#8165288">n</a></span>&nbsp;<span class="op" id="8165340">==</span>&nbsp;<span class="num" id="8165343">0</span>&nbsp;<span class="op" id="8165345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8165349">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8165357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8165360"><a href="/gostd/crypto/tls/handshake_test.go.html#8165277">b</a></span>&nbsp;<span class="op" id="8165362">=</span>&nbsp;<span class="ident" id="8165364"><a href="/gostd/crypto/tls/handshake_test.go.html#8165277">b</a></span><span class="op" id="8165365">[</span><span class="op" id="8165366">:</span><span class="ident" id="8165367"><a href="/gostd/crypto/tls/handshake_test.go.html#8165288">n</a></span><span class="op" id="8165368">]</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8165372"><a href="/gostd/crypto/tls/handshake_test.go.html#8165253">r</a></span><span class="op" id="8165373">.</span><span class="ident" id="8165374"><a href="/gostd/sync/mutex.go.html#1444351">Lock</a></span><span class="op" id="8165378">(</span><span class="op" id="8165379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8165382">defer</span>&nbsp;<span class="ident" id="8165388"><a href="/gostd/crypto/tls/handshake_test.go.html#8165253">r</a></span><span class="op" id="8165389">.</span><span class="ident" id="8165390"><a href="/gostd/sync/mutex.go.html#1445283">Unlock</a></span><span class="op" id="8165396">(</span><span class="op" id="8165397">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8165401">if</span>&nbsp;<span class="ident" id="8165404">l</span>&nbsp;<span class="op" id="8165406">:=</span>&nbsp;<span class="builtinfunc" id="8165409">len</span><span class="op" id="8165412">(</span><span class="ident" id="8165413"><a href="/gostd/crypto/tls/handshake_test.go.html#8165253">r</a></span><span class="op" id="8165414">.</span><span class="ident" id="8165415"><a href="/gostd/crypto/tls/handshake_test.go.html#8164848">flows</a></span><span class="op" id="8165420">)</span><span class="op" id="8165421">;</span>&nbsp;<span class="ident" id="8165423"><a href="/gostd/crypto/tls/handshake_test.go.html#8165404">l</a></span>&nbsp;<span class="op" id="8165425">==</span>&nbsp;<span class="num" id="8165428">0</span>&nbsp;<span class="op" id="8165430">||</span>&nbsp;<span class="ident" id="8165433"><a href="/gostd/crypto/tls/handshake_test.go.html#8165253">r</a></span><span class="op" id="8165434">.</span><span class="ident" id="8165435"><a href="/gostd/crypto/tls/handshake_test.go.html#8164866">reading</a></span>&nbsp;<span class="op" id="8165443">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8165447">buf</span>&nbsp;<span class="op" id="8165451">:=</span>&nbsp;<span class="builtinfunc" id="8165454">make</span><span class="op" id="8165458">(</span><span class="op" id="8165459">[</span><span class="op" id="8165460">]</span><span class="builtintype" id="8165461">byte</span><span class="op" id="8165465">,</span>&nbsp;<span class="builtinfunc" id="8165467">len</span><span class="op" id="8165470">(</span><span class="ident" id="8165471"><a href="/gostd/crypto/tls/handshake_test.go.html#8165277">b</a></span><span class="op" id="8165472">)</span><span class="op" id="8165473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8165477">copy</span><span class="op" id="8165481">(</span><span class="ident" id="8165482"><a href="/gostd/crypto/tls/handshake_test.go.html#8165447">buf</a></span><span class="op" id="8165485">,</span>&nbsp;<span class="ident" id="8165487"><a href="/gostd/crypto/tls/handshake_test.go.html#8165277">b</a></span><span class="op" id="8165488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8165492"><a href="/gostd/crypto/tls/handshake_test.go.html#8165253">r</a></span><span class="op" id="8165493">.</span><span class="ident" id="8165494"><a href="/gostd/crypto/tls/handshake_test.go.html#8164848">flows</a></span>&nbsp;<span class="op" id="8165500">=</span>&nbsp;<span class="builtinfunc" id="8165502">append</span><span class="op" id="8165508">(</span><span class="ident" id="8165509"><a href="/gostd/crypto/tls/handshake_test.go.html#8165253">r</a></span><span class="op" id="8165510">.</span><span class="ident" id="8165511"><a href="/gostd/crypto/tls/handshake_test.go.html#8164848">flows</a></span><span class="op" id="8165516">,</span>&nbsp;<span class="ident" id="8165518"><a href="/gostd/crypto/tls/handshake_test.go.html#8165447">buf</a></span><span class="op" id="8165521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8165524">}</span>&nbsp;<span class="keyword" id="8165526">else</span>&nbsp;<span class="op" id="8165531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8165535"><a href="/gostd/crypto/tls/handshake_test.go.html#8165253">r</a></span><span class="op" id="8165536">.</span><span class="ident" id="8165537"><a href="/gostd/crypto/tls/handshake_test.go.html#8164848">flows</a></span><span class="op" id="8165542">[</span><span class="ident" id="8165543"><a href="/gostd/crypto/tls/handshake_test.go.html#8165404">l</a></span><span class="op" id="8165544">-</span><span class="num" id="8165545">1</span><span class="op" id="8165546">]</span>&nbsp;<span class="op" id="8165548">=</span>&nbsp;<span class="builtinfunc" id="8165550">append</span><span class="op" id="8165556">(</span><span class="ident" id="8165557"><a href="/gostd/crypto/tls/handshake_test.go.html#8165253">r</a></span><span class="op" id="8165558">.</span><span class="ident" id="8165559"><a href="/gostd/crypto/tls/handshake_test.go.html#8164848">flows</a></span><span class="op" id="8165564">[</span><span class="ident" id="8165565"><a href="/gostd/crypto/tls/handshake_test.go.html#8165404">l</a></span><span class="op" id="8165566">-</span><span class="num" id="8165567">1</span><span class="op" id="8165568">]</span><span class="op" id="8165569">,</span>&nbsp;<span class="ident" id="8165571"><a href="/gostd/crypto/tls/handshake_test.go.html#8165277">b</a></span><span class="op" id="8165572">[</span><span class="op" id="8165573">:</span><span class="ident" id="8165574"><a href="/gostd/crypto/tls/handshake_test.go.html#8165288">n</a></span><span class="op" id="8165575">]</span><span class="op" id="8165576">...</span><span class="op" id="8165579">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8165582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8165585"><a href="/gostd/crypto/tls/handshake_test.go.html#8165253">r</a></span><span class="op" id="8165586">.</span><span class="ident" id="8165587"><a href="/gostd/crypto/tls/handshake_test.go.html#8164866">reading</a></span>&nbsp;<span class="op" id="8165595">=</span>&nbsp;<span class="builtintype" id="8165597">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8165604">return</span><br>
<span class="lineno"></span><span class="op" id="8165611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="comment" id="8165614">//&nbsp;WriteTo&nbsp;writes&nbsp;Go&nbsp;source&nbsp;code&nbsp;to&nbsp;w&nbsp;that&nbsp;contains&nbsp;the&nbsp;recorded&nbsp;traffic.</span><br>
<span class="lineno"></span><span class="keyword" id="8165688">func</span>&nbsp;<span class="op" id="8165693">(</span><span class="ident" id="8165694">r</span>&nbsp;<span class="op" id="8165696">*</span><span class="ident" id="8165697"><a href="/gostd/crypto/tls/handshake_test.go.html#8164802">recordingConn</a></span><span class="op" id="8165710">)</span>&nbsp;<span class="ident" id="8165712">WriteTo</span><span class="op" id="8165719">(</span><span class="ident" id="8165720">w</span>&nbsp;<span class="ident" id="8165722"><a href="/gostd/crypto/tls/handshake_test.go.html#8163550">io</a></span><span class="op" id="8165724">.</span><span class="ident" id="8165725"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="8165731">)</span>&nbsp;<span class="op" id="8165733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8165736">//&nbsp;TLS&nbsp;always&nbsp;starts&nbsp;with&nbsp;a&nbsp;client&nbsp;to&nbsp;server&nbsp;flow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8165788">clientToServer</span>&nbsp;<span class="op" id="8165803">:=</span>&nbsp;<span class="builtintype" id="8165806">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8165813">for</span>&nbsp;<span class="ident" id="8165817">i</span><span class="op" id="8165818">,</span>&nbsp;<span class="ident" id="8165820">flow</span>&nbsp;<span class="op" id="8165825">:=</span>&nbsp;<span class="keyword" id="8165828">range</span>&nbsp;<span class="ident" id="8165834"><a href="/gostd/crypto/tls/handshake_test.go.html#8165694">r</a></span><span class="op" id="8165835">.</span><span class="ident" id="8165836"><a href="/gostd/crypto/tls/handshake_test.go.html#8164848">flows</a></span>&nbsp;<span class="op" id="8165842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8165846">source</span><span class="op" id="8165852">,</span>&nbsp;<span class="ident" id="8165854">dest</span>&nbsp;<span class="op" id="8165859">:=</span>&nbsp;<span class="string" id="8165862">&#34;client&#34;</span><span class="op" id="8165870">,</span>&nbsp;<span class="string" id="8165872">&#34;server&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8165883">if</span>&nbsp;<span class="op" id="8165886">!</span><span class="ident" id="8165887"><a href="/gostd/crypto/tls/handshake_test.go.html#8165788">clientToServer</a></span>&nbsp;<span class="op" id="8165902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8165907"><a href="/gostd/crypto/tls/handshake_test.go.html#8165846">source</a></span><span class="op" id="8165913">,</span>&nbsp;<span class="ident" id="8165915"><a href="/gostd/crypto/tls/handshake_test.go.html#8165854">dest</a></span>&nbsp;<span class="op" id="8165920">=</span>&nbsp;<span class="ident" id="8165922"><a href="/gostd/crypto/tls/handshake_test.go.html#8165854">dest</a></span><span class="op" id="8165926">,</span>&nbsp;<span class="ident" id="8165928"><a href="/gostd/crypto/tls/handshake_test.go.html#8165846">source</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8165937">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8165941"><a href="/gostd/crypto/tls/handshake_test.go.html#8163543">fmt</a></span><span class="op" id="8165944">.</span><span class="ident" id="8165945"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="8165952">(</span><span class="ident" id="8165953"><a href="/gostd/crypto/tls/handshake_test.go.html#8165720">w</a></span><span class="op" id="8165954">,</span>&nbsp;<span class="string" id="8165956">&#34;&gt;&gt;&gt;&nbsp;Flow&nbsp;%d&nbsp;(%s&nbsp;to&nbsp;%s)\n&#34;</span><span class="op" id="8165982">,</span>&nbsp;<span class="ident" id="8165984"><a href="/gostd/crypto/tls/handshake_test.go.html#8165817">i</a></span><span class="op" id="8165985">+</span><span class="num" id="8165986">1</span><span class="op" id="8165987">,</span>&nbsp;<span class="ident" id="8165989"><a href="/gostd/crypto/tls/handshake_test.go.html#8165846">source</a></span><span class="op" id="8165995">,</span>&nbsp;<span class="ident" id="8165997"><a href="/gostd/crypto/tls/handshake_test.go.html#8165854">dest</a></span><span class="op" id="8166001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8166005">dumper</span>&nbsp;<span class="op" id="8166012">:=</span>&nbsp;<span class="ident" id="8166015"><a href="/gostd/crypto/tls/handshake_test.go.html#8163509">hex</a></span><span class="op" id="8166018">.</span><span class="ident" id="8166019"><a href="/gostd/encoding/hex/hex.go.html#4722222">Dumper</a></span><span class="op" id="8166025">(</span><span class="ident" id="8166026"><a href="/gostd/crypto/tls/handshake_test.go.html#8165720">w</a></span><span class="op" id="8166027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8166031"><a href="/gostd/crypto/tls/handshake_test.go.html#8166005">dumper</a></span><span class="op" id="8166037">.</span><span class="ident" id="8166038"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="8166043">(</span><span class="ident" id="8166044"><a href="/gostd/crypto/tls/handshake_test.go.html#8165820">flow</a></span><span class="op" id="8166048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8166052"><a href="/gostd/crypto/tls/handshake_test.go.html#8166005">dumper</a></span><span class="op" id="8166058">.</span><span class="ident" id="8166059"><a href="/gostd/io/io.go.html#1422583">Close</a></span><span class="op" id="8166064">(</span><span class="op" id="8166065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8166069"><a href="/gostd/crypto/tls/handshake_test.go.html#8165788">clientToServer</a></span>&nbsp;<span class="op" id="8166084">=</span>&nbsp;<span class="op" id="8166086">!</span><span class="ident" id="8166087"><a href="/gostd/crypto/tls/handshake_test.go.html#8165788">clientToServer</a></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8166103">}</span><br>
<span class="lineno"></span><span class="op" id="8166105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8166108">func</span>&nbsp;<span class="ident" id="8166113">parseTestData</span><span class="op" id="8166126">(</span><span class="ident" id="8166127">r</span>&nbsp;<span class="ident" id="8166129"><a href="/gostd/crypto/tls/handshake_test.go.html#8163550">io</a></span><span class="op" id="8166131">.</span><span class="ident" id="8166132"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="8166138">)</span>&nbsp;<span class="op" id="8166140">(</span><span class="ident" id="8166141">flows</span>&nbsp;<span class="op" id="8166147">[</span><span class="op" id="8166148">]</span><span class="op" id="8166149">[</span><span class="op" id="8166150">]</span><span class="builtintype" id="8166151">byte</span><span class="op" id="8166155">,</span>&nbsp;<span class="ident" id="8166157">err</span>&nbsp;<span class="builtintype" id="8166161">error</span><span class="op" id="8166166">)</span>&nbsp;<span class="op" id="8166168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8166171">var</span>&nbsp;<span class="ident" id="8166175">currentFlow</span>&nbsp;<span class="op" id="8166187">[</span><span class="op" id="8166188">]</span><span class="builtintype" id="8166189">byte</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8166196">scanner</span>&nbsp;<span class="op" id="8166204">:=</span>&nbsp;<span class="ident" id="8166207"><a href="/gostd/crypto/tls/handshake_test.go.html#8163500">bufio</a></span><span class="op" id="8166212">.</span><span class="ident" id="8166213"><a href="/gostd/bufio/scan.go.html#1374479">NewScanner</a></span><span class="op" id="8166223">(</span><span class="ident" id="8166224"><a href="/gostd/crypto/tls/handshake_test.go.html#8166127">r</a></span><span class="op" id="8166225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8166228">for</span>&nbsp;<span class="ident" id="8166232"><a href="/gostd/crypto/tls/handshake_test.go.html#8166196">scanner</a></span><span class="op" id="8166239">.</span><span class="ident" id="8166240"><a href="/gostd/bufio/scan.go.html#1375802">Scan</a></span><span class="op" id="8166244">(</span><span class="op" id="8166245">)</span>&nbsp;<span class="op" id="8166247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8166251">line</span>&nbsp;<span class="op" id="8166256">:=</span>&nbsp;<span class="ident" id="8166259"><a href="/gostd/crypto/tls/handshake_test.go.html#8166196">scanner</a></span><span class="op" id="8166266">.</span><span class="ident" id="8166267"><a href="/gostd/bufio/scan.go.html#1375242">Text</a></span><span class="op" id="8166271">(</span><span class="op" id="8166272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8166276">//&nbsp;If&nbsp;the&nbsp;line&nbsp;starts&nbsp;with&nbsp;&#34;&gt;&gt;&gt;&nbsp;&#34;&nbsp;then&nbsp;it&nbsp;marks&nbsp;the&nbsp;beginning</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8166340">//&nbsp;of&nbsp;a&nbsp;new&nbsp;flow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8166360">if</span>&nbsp;<span class="ident" id="8166363"><a href="/gostd/crypto/tls/handshake_test.go.html#8163587">strings</a></span><span class="op" id="8166370">.</span><span class="ident" id="8166371"><a href="/gostd/strings/strings.go.html#2975366">HasPrefix</a></span><span class="op" id="8166380">(</span><span class="ident" id="8166381"><a href="/gostd/crypto/tls/handshake_test.go.html#8166251">line</a></span><span class="op" id="8166385">,</span>&nbsp;<span class="string" id="8166387">&#34;&gt;&gt;&gt;&nbsp;&#34;</span><span class="op" id="8166393">)</span>&nbsp;<span class="op" id="8166395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8166400">if</span>&nbsp;<span class="builtinfunc" id="8166403">len</span><span class="op" id="8166406">(</span><span class="ident" id="8166407"><a href="/gostd/crypto/tls/handshake_test.go.html#8166175">currentFlow</a></span><span class="op" id="8166418">)</span>&nbsp;<span class="op" id="8166420">&gt;</span>&nbsp;<span class="num" id="8166422">0</span>&nbsp;<span class="op" id="8166424">||</span>&nbsp;<span class="builtinfunc" id="8166427">len</span><span class="op" id="8166430">(</span><span class="ident" id="8166431"><a href="/gostd/crypto/tls/handshake_test.go.html#8166141">flows</a></span><span class="op" id="8166436">)</span>&nbsp;<span class="op" id="8166438">&gt;</span>&nbsp;<span class="num" id="8166440">0</span>&nbsp;<span class="op" id="8166442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8166448"><a href="/gostd/crypto/tls/handshake_test.go.html#8166141">flows</a></span>&nbsp;<span class="op" id="8166454">=</span>&nbsp;<span class="builtinfunc" id="8166456">append</span><span class="op" id="8166462">(</span><span class="ident" id="8166463"><a href="/gostd/crypto/tls/handshake_test.go.html#8166141">flows</a></span><span class="op" id="8166468">,</span>&nbsp;<span class="ident" id="8166470"><a href="/gostd/crypto/tls/handshake_test.go.html#8166175">currentFlow</a></span><span class="op" id="8166481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8166487"><a href="/gostd/crypto/tls/handshake_test.go.html#8166175">currentFlow</a></span>&nbsp;<span class="op" id="8166499">=</span>&nbsp;<span class="builtintype" id="8166501">nil</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8166508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8166513">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8166524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8166529">//&nbsp;Otherwise&nbsp;the&nbsp;line&nbsp;is&nbsp;a&nbsp;line&nbsp;of&nbsp;hex&nbsp;dump&nbsp;that&nbsp;looks&nbsp;like:</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8166592">//&nbsp;00000170&nbsp;&nbsp;fc&nbsp;f5&nbsp;06&nbsp;bf&nbsp;(...)&nbsp;&nbsp;|.....X{&amp;?......!|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8166645">//&nbsp;(Some&nbsp;bytes&nbsp;have&nbsp;been&nbsp;omitted&nbsp;from&nbsp;the&nbsp;middle&nbsp;section.)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8166707">if</span>&nbsp;<span class="ident" id="8166710">i</span>&nbsp;<span class="op" id="8166712">:=</span>&nbsp;<span class="ident" id="8166715"><a href="/gostd/crypto/tls/handshake_test.go.html#8163587">strings</a></span><span class="op" id="8166722">.</span><span class="ident" id="8166723"><a href="/gostd/strings/strings_decl.go.html#2985554">IndexByte</a></span><span class="op" id="8166732">(</span><span class="ident" id="8166733"><a href="/gostd/crypto/tls/handshake_test.go.html#8166251">line</a></span><span class="op" id="8166737">,</span>&nbsp;<span class="string" id="8166739">&#39;&nbsp;&#39;</span><span class="op" id="8166742">)</span><span class="op" id="8166743">;</span>&nbsp;<span class="ident" id="8166745"><a href="/gostd/crypto/tls/handshake_test.go.html#8166710">i</a></span>&nbsp;<span class="op" id="8166747">&gt;=</span>&nbsp;<span class="num" id="8166750">0</span>&nbsp;<span class="op" id="8166752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8166757"><a href="/gostd/crypto/tls/handshake_test.go.html#8166251">line</a></span>&nbsp;<span class="op" id="8166762">=</span>&nbsp;<span class="ident" id="8166764"><a href="/gostd/crypto/tls/handshake_test.go.html#8166251">line</a></span><span class="op" id="8166768">[</span><span class="ident" id="8166769"><a href="/gostd/crypto/tls/handshake_test.go.html#8166710">i</a></span><span class="op" id="8166770">:</span><span class="op" id="8166771">]</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8166775">}</span>&nbsp;<span class="keyword" id="8166777">else</span>&nbsp;<span class="op" id="8166782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8166787">return</span>&nbsp;<span class="builtintype" id="8166794">nil</span><span class="op" id="8166797">,</span>&nbsp;<span class="ident" id="8166799"><a href="/gostd/crypto/tls/handshake_test.go.html#8163525">errors</a></span><span class="op" id="8166805">.</span><span class="ident" id="8166806"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="8166809">(</span><span class="string" id="8166810">&#34;invalid&nbsp;test&nbsp;data&#34;</span><span class="op" id="8166829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8166833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8166838">if</span>&nbsp;<span class="ident" id="8166841">i</span>&nbsp;<span class="op" id="8166843">:=</span>&nbsp;<span class="ident" id="8166846"><a href="/gostd/crypto/tls/handshake_test.go.html#8163587">strings</a></span><span class="op" id="8166853">.</span><span class="ident" id="8166854"><a href="/gostd/strings/strings_decl.go.html#2985554">IndexByte</a></span><span class="op" id="8166863">(</span><span class="ident" id="8166864"><a href="/gostd/crypto/tls/handshake_test.go.html#8166251">line</a></span><span class="op" id="8166868">,</span>&nbsp;<span class="string" id="8166870">&#39;|&#39;</span><span class="op" id="8166873">)</span><span class="op" id="8166874">;</span>&nbsp;<span class="ident" id="8166876"><a href="/gostd/crypto/tls/handshake_test.go.html#8166841">i</a></span>&nbsp;<span class="op" id="8166878">&gt;=</span>&nbsp;<span class="num" id="8166881">0</span>&nbsp;<span class="op" id="8166883">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8166888"><a href="/gostd/crypto/tls/handshake_test.go.html#8166251">line</a></span>&nbsp;<span class="op" id="8166893">=</span>&nbsp;<span class="ident" id="8166895"><a href="/gostd/crypto/tls/handshake_test.go.html#8166251">line</a></span><span class="op" id="8166899">[</span><span class="op" id="8166900">:</span><span class="ident" id="8166901"><a href="/gostd/crypto/tls/handshake_test.go.html#8166841">i</a></span><span class="op" id="8166902">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8166906">}</span>&nbsp;<span class="keyword" id="8166908">else</span>&nbsp;<span class="op" id="8166913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8166918">return</span>&nbsp;<span class="builtintype" id="8166925">nil</span><span class="op" id="8166928">,</span>&nbsp;<span class="ident" id="8166930"><a href="/gostd/crypto/tls/handshake_test.go.html#8163525">errors</a></span><span class="op" id="8166936">.</span><span class="ident" id="8166937"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="8166940">(</span><span class="string" id="8166941">&#34;invalid&nbsp;test&nbsp;data&#34;</span><span class="op" id="8166960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8166964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8166969">hexBytes</span>&nbsp;<span class="op" id="8166978">:=</span>&nbsp;<span class="ident" id="8166981"><a href="/gostd/crypto/tls/handshake_test.go.html#8163587">strings</a></span><span class="op" id="8166988">.</span><span class="ident" id="8166989"><a href="/gostd/strings/strings.go.html#2973751">Fields</a></span><span class="op" id="8166995">(</span><span class="ident" id="8166996"><a href="/gostd/crypto/tls/handshake_test.go.html#8166251">line</a></span><span class="op" id="8167000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8167004">for</span>&nbsp;<span class="ident" id="8167008">_</span><span class="op" id="8167009">,</span>&nbsp;<span class="ident" id="8167011">hexByte</span>&nbsp;<span class="op" id="8167019">:=</span>&nbsp;<span class="keyword" id="8167022">range</span>&nbsp;<span class="ident" id="8167028"><a href="/gostd/crypto/tls/handshake_test.go.html#8166969">hexBytes</a></span>&nbsp;<span class="op" id="8167037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8167042">val</span><span class="op" id="8167045">,</span>&nbsp;<span class="ident" id="8167047">err</span>&nbsp;<span class="op" id="8167051">:=</span>&nbsp;<span class="ident" id="8167054"><a href="/gostd/crypto/tls/handshake_test.go.html#8163576">strconv</a></span><span class="op" id="8167061">.</span><span class="ident" id="8167062"><a href="/gostd/strconv/atoi.go.html#2353976">ParseUint</a></span><span class="op" id="8167071">(</span><span class="ident" id="8167072"><a href="/gostd/crypto/tls/handshake_test.go.html#8167011">hexByte</a></span><span class="op" id="8167079">,</span>&nbsp;<span class="num" id="8167081">16</span><span class="op" id="8167083">,</span>&nbsp;<span class="num" id="8167085">8</span><span class="op" id="8167086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8167091">if</span>&nbsp;<span class="ident" id="8167094"><a href="/gostd/crypto/tls/handshake_test.go.html#8167047">err</a></span>&nbsp;<span class="op" id="8167098">!=</span>&nbsp;<span class="builtintype" id="8167101">nil</span>&nbsp;<span class="op" id="8167105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8167111">return</span>&nbsp;<span class="builtintype" id="8167118">nil</span><span class="op" id="8167121">,</span>&nbsp;<span class="ident" id="8167123"><a href="/gostd/crypto/tls/handshake_test.go.html#8163525">errors</a></span><span class="op" id="8167129">.</span><span class="ident" id="8167130"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="8167133">(</span><span class="string" id="8167134">&#34;invalid&nbsp;hex&nbsp;byte&nbsp;in&nbsp;test&nbsp;data:&nbsp;&#34;</span>&nbsp;<span class="op" id="8167168">+</span>&nbsp;<span class="ident" id="8167170"><a href="/gostd/crypto/tls/handshake_test.go.html#8167047">err</a></span><span class="op" id="8167173">.</span><span class="ident" id="8167174">Error</span><span class="op" id="8167179">(</span><span class="op" id="8167180">)</span><span class="op" id="8167181">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8167186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8167191"><a href="/gostd/crypto/tls/handshake_test.go.html#8166175">currentFlow</a></span>&nbsp;<span class="op" id="8167203">=</span>&nbsp;<span class="builtinfunc" id="8167205">append</span><span class="op" id="8167211">(</span><span class="ident" id="8167212"><a href="/gostd/crypto/tls/handshake_test.go.html#8166175">currentFlow</a></span><span class="op" id="8167223">,</span>&nbsp;<span class="builtintype" id="8167225">byte</span><span class="op" id="8167229">(</span><span class="ident" id="8167230"><a href="/gostd/crypto/tls/handshake_test.go.html#8167042">val</a></span><span class="op" id="8167233">)</span><span class="op" id="8167234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8167238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8167241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8167245">if</span>&nbsp;<span class="builtinfunc" id="8167248">len</span><span class="op" id="8167251">(</span><span class="ident" id="8167252"><a href="/gostd/crypto/tls/handshake_test.go.html#8166175">currentFlow</a></span><span class="op" id="8167263">)</span>&nbsp;<span class="op" id="8167265">&gt;</span>&nbsp;<span class="num" id="8167267">0</span>&nbsp;<span class="op" id="8167269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8167273"><a href="/gostd/crypto/tls/handshake_test.go.html#8166141">flows</a></span>&nbsp;<span class="op" id="8167279">=</span>&nbsp;<span class="builtinfunc" id="8167281">append</span><span class="op" id="8167287">(</span><span class="ident" id="8167288"><a href="/gostd/crypto/tls/handshake_test.go.html#8166141">flows</a></span><span class="op" id="8167293">,</span>&nbsp;<span class="ident" id="8167295"><a href="/gostd/crypto/tls/handshake_test.go.html#8166175">currentFlow</a></span><span class="op" id="8167306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8167309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8167313">return</span>&nbsp;<span class="ident" id="8167320"><a href="/gostd/crypto/tls/handshake_test.go.html#8166141">flows</a></span><span class="op" id="8167325">,</span>&nbsp;<span class="builtintype" id="8167327">nil</span><br>
<span class="lineno">155</span><span class="op" id="8167331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8167334">//&nbsp;tempFile&nbsp;creates&nbsp;a&nbsp;temp&nbsp;file&nbsp;containing&nbsp;contents&nbsp;and&nbsp;returns&nbsp;its&nbsp;path.</span><br>
<span class="lineno"></span><span class="keyword" id="8167408">func</span>&nbsp;<span class="ident" id="8167413">tempFile</span><span class="op" id="8167421">(</span><span class="ident" id="8167422">contents</span>&nbsp;<span class="builtintype" id="8167431">string</span><span class="op" id="8167437">)</span>&nbsp;<span class="builtintype" id="8167439">string</span>&nbsp;<span class="op" id="8167446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8167449">file</span><span class="op" id="8167453">,</span>&nbsp;<span class="ident" id="8167455">err</span>&nbsp;<span class="op" id="8167459">:=</span>&nbsp;<span class="ident" id="8167462"><a href="/gostd/crypto/tls/handshake_test.go.html#8163556">ioutil</a></span><span class="op" id="8167468">.</span><span class="ident" id="8167469"><a href="/gostd/io/ioutil/tempfile.go.html#3769783">TempFile</a></span><span class="op" id="8167477">(</span><span class="string" id="8167478">&#34;&#34;</span><span class="op" id="8167480">,</span>&nbsp;<span class="string" id="8167482">&#34;go-tls-test&#34;</span><span class="op" id="8167495">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8167498">if</span>&nbsp;<span class="ident" id="8167501"><a href="/gostd/crypto/tls/handshake_test.go.html#8167455">err</a></span>&nbsp;<span class="op" id="8167505">!=</span>&nbsp;<span class="builtintype" id="8167508">nil</span>&nbsp;<span class="op" id="8167512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8167516">panic</span><span class="op" id="8167521">(</span><span class="string" id="8167522">&#34;failed&nbsp;to&nbsp;create&nbsp;temp&nbsp;file:&nbsp;&#34;</span>&nbsp;<span class="op" id="8167553">+</span>&nbsp;<span class="ident" id="8167555"><a href="/gostd/crypto/tls/handshake_test.go.html#8167455">err</a></span><span class="op" id="8167558">.</span><span class="ident" id="8167559">Error</span><span class="op" id="8167564">(</span><span class="op" id="8167565">)</span><span class="op" id="8167566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8167569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8167572">path</span>&nbsp;<span class="op" id="8167577">:=</span>&nbsp;<span class="ident" id="8167580"><a href="/gostd/crypto/tls/handshake_test.go.html#8167449">file</a></span><span class="op" id="8167584">.</span><span class="ident" id="8167585"><a href="/gostd/os/file.go.html#2441585">Name</a></span><span class="op" id="8167589">(</span><span class="op" id="8167590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8167593"><a href="/gostd/crypto/tls/handshake_test.go.html#8167449">file</a></span><span class="op" id="8167597">.</span><span class="ident" id="8167598"><a href="/gostd/os/file.go.html#2445653">WriteString</a></span><span class="op" id="8167609">(</span><span class="ident" id="8167610"><a href="/gostd/crypto/tls/handshake_test.go.html#8167422">contents</a></span><span class="op" id="8167618">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8167621"><a href="/gostd/crypto/tls/handshake_test.go.html#8167449">file</a></span><span class="op" id="8167625">.</span><span class="ident" id="8167626"><a href="/gostd/os/file_unix.go.html#2454611">Close</a></span><span class="op" id="8167631">(</span><span class="op" id="8167632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8167635">return</span>&nbsp;<span class="ident" id="8167642"><a href="/gostd/crypto/tls/handshake_test.go.html#8167572">path</a></span><br>
<span class="lineno"></span><span class="op" id="8167647">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
