<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html</h2>
<ul>
<li><a href="/gostd/html/entity.go.html">entity.go</a></li>
<li><a href="/gostd/html/entity_test.go.html">entity_test.go</a></li>
<li><a href="/gostd/html/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/escape_test.go.html">escape_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7038655">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7038710">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7038764">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7038815">package</span>&nbsp;<span class="ident" id="7038823">html</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7038829">import</span>&nbsp;<span class="op" id="7038836">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7038839">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7038850">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">10</span><span class="op" id="7038865">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7038868">func</span>&nbsp;<span class="ident" id="7038873">TestEntityLength</span><span class="op" id="7038889">(</span><span class="ident" id="7038890">t</span>&nbsp;<span class="op" id="7038892">*</span><span class="ident" id="7038893">testing</span><span class="op" id="7038900">.</span><span class="ident" id="7038901">T</span><span class="op" id="7038902">)</span>&nbsp;<span class="op" id="7038904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7038907">//&nbsp;We&nbsp;verify&nbsp;that&nbsp;the&nbsp;length&nbsp;of&nbsp;UTF-8&nbsp;encoding&nbsp;of&nbsp;each&nbsp;value&nbsp;is&nbsp;&lt;=&nbsp;1&nbsp;+&nbsp;len(key).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7038989">//&nbsp;The&nbsp;+1&nbsp;comes&nbsp;from&nbsp;the&nbsp;leading&nbsp;&#34;&amp;&#34;.&nbsp;This&nbsp;property&nbsp;implies&nbsp;that&nbsp;the&nbsp;length&nbsp;of</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7039069">//&nbsp;unescaped&nbsp;text&nbsp;is&nbsp;&lt;=&nbsp;the&nbsp;length&nbsp;of&nbsp;escaped&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7039122">for</span>&nbsp;<span class="ident" id="7039126">k</span><span class="op" id="7039127">,</span>&nbsp;<span class="ident" id="7039129">v</span>&nbsp;<span class="op" id="7039131">:=</span>&nbsp;<span class="keyword" id="7039134">range</span>&nbsp;<span class="ident" id="7039140">entity</span>&nbsp;<span class="op" id="7039147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7039151">if</span>&nbsp;<span class="num" id="7039154">1</span><span class="op" id="7039155">+</span><span class="builtinfunc" id="7039156">len</span><span class="op" id="7039159">(</span><span class="ident" id="7039160">k</span><span class="op" id="7039161">)</span>&nbsp;<span class="op" id="7039163">&lt;</span>&nbsp;<span class="ident" id="7039165">utf8</span><span class="op" id="7039169">.</span><span class="ident" id="7039170">RuneLen</span><span class="op" id="7039177">(</span><span class="ident" id="7039178">v</span><span class="op" id="7039179">)</span>&nbsp;<span class="op" id="7039181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7039186">t</span><span class="op" id="7039187">.</span><span class="ident" id="7039188">Error</span><span class="op" id="7039193">(</span><span class="string" id="7039194">&#34;escaped&nbsp;entity&nbsp;&amp;&#34;</span>&nbsp;<span class="op" id="7039213">+</span>&nbsp;<span class="ident" id="7039215">k</span>&nbsp;<span class="op" id="7039217">+</span>&nbsp;<span class="string" id="7039219">&#34;&nbsp;is&nbsp;shorter&nbsp;than&nbsp;its&nbsp;UTF-8&nbsp;encoding&nbsp;&#34;</span>&nbsp;<span class="op" id="7039258">+</span>&nbsp;<span class="builtintype" id="7039260">string</span><span class="op" id="7039266">(</span><span class="ident" id="7039267">v</span><span class="op" id="7039268">)</span><span class="op" id="7039269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7039273">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7039277">if</span>&nbsp;<span class="builtinfunc" id="7039280">len</span><span class="op" id="7039283">(</span><span class="ident" id="7039284">k</span><span class="op" id="7039285">)</span>&nbsp;<span class="op" id="7039287">&gt;</span>&nbsp;<span class="ident" id="7039289">longestEntityWithoutSemicolon</span>&nbsp;<span class="op" id="7039319">&amp;&amp;</span>&nbsp;<span class="ident" id="7039322">k</span><span class="op" id="7039323">[</span><span class="builtinfunc" id="7039324">len</span><span class="op" id="7039327">(</span><span class="ident" id="7039328">k</span><span class="op" id="7039329">)</span><span class="op" id="7039330">-</span><span class="num" id="7039331">1</span><span class="op" id="7039332">]</span>&nbsp;<span class="op" id="7039334">!=</span>&nbsp;<span class="string" id="7039337">&#39;;&#39;</span>&nbsp;<span class="op" id="7039341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7039346">t</span><span class="op" id="7039347">.</span><span class="ident" id="7039348">Errorf</span><span class="op" id="7039354">(</span><span class="string" id="7039355">&#34;entity&nbsp;name&nbsp;%s&nbsp;is&nbsp;%d&nbsp;characters,&nbsp;but&nbsp;longestEntityWithoutSemicolon=%d&#34;</span><span class="op" id="7039426">,</span>&nbsp;<span class="ident" id="7039428">k</span><span class="op" id="7039429">,</span>&nbsp;<span class="builtinfunc" id="7039431">len</span><span class="op" id="7039434">(</span><span class="ident" id="7039435">k</span><span class="op" id="7039436">)</span><span class="op" id="7039437">,</span>&nbsp;<span class="ident" id="7039439">longestEntityWithoutSemicolon</span><span class="op" id="7039468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7039472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7039475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7039478">for</span>&nbsp;<span class="ident" id="7039482">k</span><span class="op" id="7039483">,</span>&nbsp;<span class="ident" id="7039485">v</span>&nbsp;<span class="op" id="7039487">:=</span>&nbsp;<span class="keyword" id="7039490">range</span>&nbsp;<span class="ident" id="7039496">entity2</span>&nbsp;<span class="op" id="7039504">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7039508">if</span>&nbsp;<span class="num" id="7039511">1</span><span class="op" id="7039512">+</span><span class="builtinfunc" id="7039513">len</span><span class="op" id="7039516">(</span><span class="ident" id="7039517">k</span><span class="op" id="7039518">)</span>&nbsp;<span class="op" id="7039520">&lt;</span>&nbsp;<span class="ident" id="7039522">utf8</span><span class="op" id="7039526">.</span><span class="ident" id="7039527">RuneLen</span><span class="op" id="7039534">(</span><span class="ident" id="7039535">v</span><span class="op" id="7039536">[</span><span class="num" id="7039537">0</span><span class="op" id="7039538">]</span><span class="op" id="7039539">)</span><span class="op" id="7039540">+</span><span class="ident" id="7039541">utf8</span><span class="op" id="7039545">.</span><span class="ident" id="7039546">RuneLen</span><span class="op" id="7039553">(</span><span class="ident" id="7039554">v</span><span class="op" id="7039555">[</span><span class="num" id="7039556">1</span><span class="op" id="7039557">]</span><span class="op" id="7039558">)</span>&nbsp;<span class="op" id="7039560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7039565">t</span><span class="op" id="7039566">.</span><span class="ident" id="7039567">Error</span><span class="op" id="7039572">(</span><span class="string" id="7039573">&#34;escaped&nbsp;entity&nbsp;&amp;&#34;</span>&nbsp;<span class="op" id="7039592">+</span>&nbsp;<span class="ident" id="7039594">k</span>&nbsp;<span class="op" id="7039596">+</span>&nbsp;<span class="string" id="7039598">&#34;&nbsp;is&nbsp;shorter&nbsp;than&nbsp;its&nbsp;UTF-8&nbsp;encoding&nbsp;&#34;</span>&nbsp;<span class="op" id="7039637">+</span>&nbsp;<span class="builtintype" id="7039639">string</span><span class="op" id="7039645">(</span><span class="ident" id="7039646">v</span><span class="op" id="7039647">[</span><span class="num" id="7039648">0</span><span class="op" id="7039649">]</span><span class="op" id="7039650">)</span>&nbsp;<span class="op" id="7039652">+</span>&nbsp;<span class="builtintype" id="7039654">string</span><span class="op" id="7039660">(</span><span class="ident" id="7039661">v</span><span class="op" id="7039662">[</span><span class="num" id="7039663">1</span><span class="op" id="7039664">]</span><span class="op" id="7039665">)</span><span class="op" id="7039666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7039670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7039673">}</span><br>
<span class="lineno"></span><span class="op" id="7039675">}</span>
</div>
</body>
</html>
