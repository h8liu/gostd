<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>lonnie.io/e8vm/lex8</h2>
<ul>
<li><a href="/gostd/lonnie.io/e8vm/lex8/error.go.html">error.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/lex8/error_list.go.html">error_list.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/lex8/lex_scanner.go.html">lex_scanner.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/lex8/lexer.go.html">lexer.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/lex8/pos.go.html">pos.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/lex8/rune_scanner.go.html">rune_scanner.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/lex8/token.go.html">token.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="keyword" id="3667530">package</span>&nbsp;<span class="ident" id="3667538">lex8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3667544">import</span>&nbsp;<span class="op" id="3667551">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3667554">&#34;bytes&#34;</span><br>
<span class="lineno">5</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3667563">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="3667568">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3667571">//&nbsp;LexScanner&nbsp;parses&nbsp;a&nbsp;file&nbsp;input&nbsp;stream&nbsp;into&nbsp;tokens.</span><br>
<span class="lineno"></span><span class="keyword" id="3667625">type</span>&nbsp;<span class="ident" id="3667630">LexScanner</span>&nbsp;<span class="keyword" id="3667641">struct</span>&nbsp;<span class="op" id="3667648">{</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667651">s</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3667657">*</span><span class="ident" id="3667658">RuneScanner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667671">errs</span>&nbsp;&nbsp;<span class="op" id="3667677">*</span><span class="ident" id="3667678">ErrorList</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667689">valid</span>&nbsp;<span class="builtintype" id="3667695">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667702">pos</span>&nbsp;<span class="op" id="3667706">*</span><span class="ident" id="3667707">Pos</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667712">buf</span>&nbsp;<span class="op" id="3667716">*</span><span class="ident" id="3667717">bytes</span><span class="op" id="3667722">.</span><span class="ident" id="3667723">Buffer</span><br>
<span class="lineno"></span><span class="op" id="3667730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3667733">//&nbsp;NewLexScanner&nbsp;creates&nbsp;a&nbsp;new&nbsp;lexer.</span><br>
<span class="lineno"></span><span class="keyword" id="3667771">func</span>&nbsp;<span class="ident" id="3667776">NewLexScanner</span><span class="op" id="3667789">(</span><span class="ident" id="3667790">file</span>&nbsp;<span class="builtintype" id="3667795">string</span><span class="op" id="3667801">,</span>&nbsp;<span class="ident" id="3667803">rc</span>&nbsp;<span class="ident" id="3667806">io</span><span class="op" id="3667808">.</span><span class="ident" id="3667809">ReadCloser</span><span class="op" id="3667819">)</span>&nbsp;<span class="op" id="3667821">*</span><span class="ident" id="3667822">LexScanner</span>&nbsp;<span class="op" id="3667833">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667836">ret</span>&nbsp;<span class="op" id="3667840">:=</span>&nbsp;<span class="builtinfunc" id="3667843">new</span><span class="op" id="3667846">(</span><span class="ident" id="3667847">LexScanner</span><span class="op" id="3667857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667860">ret</span><span class="op" id="3667863">.</span><span class="ident" id="3667864">s</span>&nbsp;<span class="op" id="3667866">=</span>&nbsp;<span class="ident" id="3667868">NewRuneScanner</span><span class="op" id="3667882">(</span><span class="ident" id="3667883">file</span><span class="op" id="3667887">,</span>&nbsp;<span class="ident" id="3667889">rc</span><span class="op" id="3667891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667894">ret</span><span class="op" id="3667897">.</span><span class="ident" id="3667898">errs</span>&nbsp;<span class="op" id="3667903">=</span>&nbsp;<span class="ident" id="3667905">NewErrList</span><span class="op" id="3667915">(</span><span class="op" id="3667916">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667920">ret</span><span class="op" id="3667923">.</span><span class="ident" id="3667924">buf</span>&nbsp;<span class="op" id="3667928">=</span>&nbsp;<span class="builtinfunc" id="3667930">new</span><span class="op" id="3667933">(</span><span class="ident" id="3667934">bytes</span><span class="op" id="3667939">.</span><span class="ident" id="3667940">Buffer</span><span class="op" id="3667946">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667949">ret</span><span class="op" id="3667952">.</span><span class="ident" id="3667953">pos</span>&nbsp;<span class="op" id="3667957">=</span>&nbsp;<span class="ident" id="3667959">ret</span><span class="op" id="3667962">.</span><span class="ident" id="3667963">s</span><span class="op" id="3667964">.</span><span class="ident" id="3667965">Pos</span><span class="op" id="3667968">(</span><span class="op" id="3667969">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3667973">return</span>&nbsp;<span class="ident" id="3667980">ret</span><br>
<span class="lineno"></span><span class="op" id="3667984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="3667987">//&nbsp;Next&nbsp;pushes&nbsp;the&nbsp;current&nbsp;rune&nbsp;(if&nbsp;valid)&nbsp;into&nbsp;the&nbsp;buffer,</span><br>
<span class="lineno"></span><span class="comment" id="3668047">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;rune&nbsp;or&nbsp;error&nbsp;from&nbsp;scanning&nbsp;the&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="3668109">//&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="3668120">func</span>&nbsp;<span class="op" id="3668125">(</span><span class="ident" id="3668126">s</span>&nbsp;<span class="op" id="3668128">*</span><span class="ident" id="3668129">LexScanner</span><span class="op" id="3668139">)</span>&nbsp;<span class="ident" id="3668141">Next</span><span class="op" id="3668145">(</span><span class="op" id="3668146">)</span>&nbsp;<span class="op" id="3668148">(</span><span class="builtintype" id="3668149">rune</span><span class="op" id="3668153">,</span>&nbsp;<span class="builtintype" id="3668155">error</span><span class="op" id="3668160">)</span>&nbsp;<span class="op" id="3668162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3668165">if</span>&nbsp;<span class="ident" id="3668168">s</span><span class="op" id="3668169">.</span><span class="ident" id="3668170">valid</span>&nbsp;<span class="op" id="3668176">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3668180">s</span><span class="op" id="3668181">.</span><span class="ident" id="3668182">buf</span><span class="op" id="3668185">.</span><span class="ident" id="3668186">WriteRune</span><span class="op" id="3668195">(</span><span class="ident" id="3668196">s</span><span class="op" id="3668197">.</span><span class="ident" id="3668198">s</span><span class="op" id="3668199">.</span><span class="ident" id="3668200">Rune</span><span class="op" id="3668204">)</span>&nbsp;<span class="comment" id="3668206">//&nbsp;push&nbsp;into&nbsp;the&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3668232">s</span><span class="op" id="3668233">.</span><span class="ident" id="3668234">valid</span>&nbsp;<span class="op" id="3668240">=</span>&nbsp;<span class="builtintype" id="3668242">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3668249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3668253">if</span>&nbsp;<span class="op" id="3668256">!</span><span class="ident" id="3668257">s</span><span class="op" id="3668258">.</span><span class="ident" id="3668259">s</span><span class="op" id="3668260">.</span><span class="ident" id="3668261">Scan</span><span class="op" id="3668265">(</span><span class="op" id="3668266">)</span>&nbsp;<span class="op" id="3668268">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3668272">if</span>&nbsp;<span class="ident" id="3668275">s</span><span class="op" id="3668276">.</span><span class="ident" id="3668277">s</span><span class="op" id="3668278">.</span><span class="ident" id="3668279">Err</span>&nbsp;<span class="op" id="3668283">!=</span>&nbsp;<span class="ident" id="3668286">nil</span>&nbsp;<span class="op" id="3668290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3668295">return</span>&nbsp;<span class="num" id="3668302">0</span><span class="op" id="3668303">,</span>&nbsp;<span class="ident" id="3668305">s</span><span class="op" id="3668306">.</span><span class="ident" id="3668307">s</span><span class="op" id="3668308">.</span><span class="ident" id="3668309">Err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3668315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3668320">return</span>&nbsp;<span class="num" id="3668327">0</span><span class="op" id="3668328">,</span>&nbsp;<span class="ident" id="3668330">io</span><span class="op" id="3668332">.</span><span class="ident" id="3668333">EOF</span>&nbsp;<span class="comment" id="3668337">//&nbsp;signal&nbsp;end&nbsp;of&nbsp;file</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3668360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3668364">s</span><span class="op" id="3668365">.</span><span class="ident" id="3668366">valid</span>&nbsp;<span class="op" id="3668372">=</span>&nbsp;<span class="builtintype" id="3668374">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3668380">return</span>&nbsp;<span class="ident" id="3668387">s</span><span class="op" id="3668388">.</span><span class="ident" id="3668389">s</span><span class="op" id="3668390">.</span><span class="ident" id="3668391">Rune</span><span class="op" id="3668395">,</span>&nbsp;<span class="ident" id="3668397">nil</span><br>
<span class="lineno"></span><span class="op" id="3668401">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="3668404">//&nbsp;Accept&nbsp;returns&nbsp;the&nbsp;string&nbsp;buffered,&nbsp;and&nbsp;the&nbsp;starting&nbsp;position</span><br>
<span class="lineno"></span><span class="comment" id="3668469">//&nbsp;of&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3668487">func</span>&nbsp;<span class="op" id="3668492">(</span><span class="ident" id="3668493">s</span>&nbsp;<span class="op" id="3668495">*</span><span class="ident" id="3668496">LexScanner</span><span class="op" id="3668506">)</span>&nbsp;<span class="ident" id="3668508">Accept</span><span class="op" id="3668514">(</span><span class="op" id="3668515">)</span>&nbsp;<span class="op" id="3668517">(</span><span class="builtintype" id="3668518">string</span><span class="op" id="3668524">,</span>&nbsp;<span class="op" id="3668526">*</span><span class="ident" id="3668527">Pos</span><span class="op" id="3668530">)</span>&nbsp;<span class="op" id="3668532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3668535">ret</span>&nbsp;<span class="op" id="3668539">:=</span>&nbsp;<span class="ident" id="3668542">s</span><span class="op" id="3668543">.</span><span class="ident" id="3668544">buf</span><span class="op" id="3668547">.</span><span class="ident" id="3668548">String</span><span class="op" id="3668554">(</span><span class="op" id="3668555">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3668558">s</span><span class="op" id="3668559">.</span><span class="ident" id="3668560">buf</span><span class="op" id="3668563">.</span><span class="ident" id="3668564">Reset</span><span class="op" id="3668569">(</span><span class="op" id="3668570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3668573">pos</span>&nbsp;<span class="op" id="3668577">:=</span>&nbsp;<span class="ident" id="3668580">s</span><span class="op" id="3668581">.</span><span class="ident" id="3668582">pos</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3668588">s</span><span class="op" id="3668589">.</span><span class="ident" id="3668590">pos</span>&nbsp;<span class="op" id="3668594">=</span>&nbsp;<span class="ident" id="3668596">s</span><span class="op" id="3668597">.</span><span class="ident" id="3668598">s</span><span class="op" id="3668599">.</span><span class="ident" id="3668600">Pos</span><span class="op" id="3668603">(</span><span class="op" id="3668604">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3668608">return</span>&nbsp;<span class="ident" id="3668615">ret</span><span class="op" id="3668618">,</span>&nbsp;<span class="ident" id="3668620">pos</span><br>
<span class="lineno"></span><span class="op" id="3668624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3668627">//&nbsp;Pos&nbsp;returns&nbsp;the&nbsp;position&nbsp;of&nbsp;the&nbsp;buffer&nbsp;start.</span><br>
<span class="lineno"></span><span class="keyword" id="3668676">func</span>&nbsp;<span class="op" id="3668681">(</span><span class="ident" id="3668682">s</span>&nbsp;<span class="op" id="3668684">*</span><span class="ident" id="3668685">LexScanner</span><span class="op" id="3668695">)</span>&nbsp;<span class="ident" id="3668697">Pos</span><span class="op" id="3668700">(</span><span class="op" id="3668701">)</span>&nbsp;<span class="op" id="3668703">*</span><span class="ident" id="3668704">Pos</span>&nbsp;<span class="op" id="3668708">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3668711">return</span>&nbsp;<span class="ident" id="3668718">s</span><span class="op" id="3668719">.</span><span class="ident" id="3668720">pos</span><br>
<span class="lineno"></span><span class="op" id="3668724">}</span>
</div>
</body>
</html>
