<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html" class="current">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8207965">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8208021">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8208075">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8208126">package</span>&nbsp;<span class="ident" id="8208134">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8208140">import</span>&nbsp;<span class="op" id="8208147">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8208150">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8208159">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8208169">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8208176">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8208182">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8208195">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8208206">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8208217">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8208227">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8208230">type</span>&nbsp;<span class="ident" id="8208235">reqWriteTest</span>&nbsp;<span class="keyword" id="8208248">struct</span>&nbsp;<span class="op" id="8208255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208258">Req</span>&nbsp;&nbsp;<span class="ident" id="8208263">Request</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208272">Body</span>&nbsp;<span class="keyword" id="8208277">interface</span><span class="op" id="8208286">{</span><span class="op" id="8208287">}</span>&nbsp;<span class="comment" id="8208289">//&nbsp;optional&nbsp;[]byte&nbsp;or&nbsp;func()&nbsp;io.ReadCloser&nbsp;to&nbsp;populate&nbsp;Req.Body</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8208355">//&nbsp;Any&nbsp;of&nbsp;these&nbsp;three&nbsp;may&nbsp;be&nbsp;empty&nbsp;to&nbsp;skip&nbsp;that&nbsp;test.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208410">WantWrite</span>&nbsp;<span class="builtintype" id="8208420">string</span>&nbsp;<span class="comment" id="8208427">//&nbsp;Request.Write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208445">WantProxy</span>&nbsp;<span class="builtintype" id="8208455">string</span>&nbsp;<span class="comment" id="8208462">//&nbsp;Request.WriteProxy</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208486">WantError</span>&nbsp;<span class="builtintype" id="8208496">error</span>&nbsp;<span class="comment" id="8208502">//&nbsp;wanted&nbsp;error&nbsp;from&nbsp;Request.Write</span><br>
<span class="lineno"></span><span class="op" id="8208537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8208540">var</span>&nbsp;<span class="ident" id="8208544">reqWriteTests</span>&nbsp;<span class="op" id="8208558">=</span>&nbsp;<span class="op" id="8208560">[</span><span class="op" id="8208561">]</span><span class="ident" id="8208562">reqWriteTest</span><span class="op" id="8208574">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8208577">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;no&nbsp;body;&nbsp;no&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8208629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208633">Req</span><span class="op" id="8208636">:</span>&nbsp;<span class="ident" id="8208638">Request</span><span class="op" id="8208645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208650">Method</span><span class="op" id="8208656">:</span>&nbsp;<span class="string" id="8208658">&#34;GET&#34;</span><span class="op" id="8208663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208668">URL</span><span class="op" id="8208671">:</span>&nbsp;<span class="op" id="8208673">&amp;</span><span class="ident" id="8208674">url</span><span class="op" id="8208677">.</span><span class="ident" id="8208678">URL</span><span class="op" id="8208681">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208687">Scheme</span><span class="op" id="8208693">:</span>&nbsp;<span class="string" id="8208695">&#34;http&#34;</span><span class="op" id="8208701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208707">Host</span><span class="op" id="8208711">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8208715">&#34;www.techcrunch.com&#34;</span><span class="op" id="8208735">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208741">Path</span><span class="op" id="8208745">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8208749">&#34;/&#34;</span><span class="op" id="8208752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8208757">}</span><span class="op" id="8208758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208763">Proto</span><span class="op" id="8208768">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8208775">&#34;HTTP/1.1&#34;</span><span class="op" id="8208785">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208790">ProtoMajor</span><span class="op" id="8208800">:</span>&nbsp;<span class="num" id="8208802">1</span><span class="op" id="8208803">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208808">ProtoMinor</span><span class="op" id="8208818">:</span>&nbsp;<span class="num" id="8208820">1</span><span class="op" id="8208821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208826">Header</span><span class="op" id="8208832">:</span>&nbsp;<span class="ident" id="8208834">Header</span><span class="op" id="8208840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8208846">&#34;Accept&#34;</span><span class="op" id="8208854">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8208866">{</span><span class="string" id="8208867">&#34;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#34;</span><span class="op" id="8208932">}</span><span class="op" id="8208933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8208939">&#34;Accept-Charset&#34;</span><span class="op" id="8208955">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8208959">{</span><span class="string" id="8208960">&#34;ISO-8859-1,utf-8;q=0.7,*;q=0.7&#34;</span><span class="op" id="8208992">}</span><span class="op" id="8208993">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8208999">&#34;Accept-Encoding&#34;</span><span class="op" id="8209016">:</span>&nbsp;&nbsp;<span class="op" id="8209019">{</span><span class="string" id="8209020">&#34;gzip,deflate&#34;</span><span class="op" id="8209034">}</span><span class="op" id="8209035">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8209041">&#34;Accept-Language&#34;</span><span class="op" id="8209058">:</span>&nbsp;&nbsp;<span class="op" id="8209061">{</span><span class="string" id="8209062">&#34;en-us,en;q=0.5&#34;</span><span class="op" id="8209078">}</span><span class="op" id="8209079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8209085">&#34;Keep-Alive&#34;</span><span class="op" id="8209097">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8209105">{</span><span class="string" id="8209106">&#34;300&#34;</span><span class="op" id="8209111">}</span><span class="op" id="8209112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8209118">&#34;Proxy-Connection&#34;</span><span class="op" id="8209136">:</span>&nbsp;<span class="op" id="8209138">{</span><span class="string" id="8209139">&#34;keep-alive&#34;</span><span class="op" id="8209151">}</span><span class="op" id="8209152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8209158">&#34;User-Agent&#34;</span><span class="op" id="8209170">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8209178">{</span><span class="string" id="8209179">&#34;Fake&#34;</span><span class="op" id="8209185">}</span><span class="op" id="8209186">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8209191">}</span><span class="op" id="8209192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209197">Body</span><span class="op" id="8209201">:</span>&nbsp;&nbsp;<span class="ident" id="8209204">nil</span><span class="op" id="8209207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209212">Close</span><span class="op" id="8209217">:</span>&nbsp;<span class="builtintype" id="8209219">false</span><span class="op" id="8209224">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209229">Host</span><span class="op" id="8209233">:</span>&nbsp;&nbsp;<span class="string" id="8209236">&#34;www.techcrunch.com&#34;</span><span class="op" id="8209256">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209261">Form</span><span class="op" id="8209265">:</span>&nbsp;&nbsp;<span class="keyword" id="8209268">map</span><span class="op" id="8209271">[</span><span class="builtintype" id="8209272">string</span><span class="op" id="8209278">]</span><span class="op" id="8209279">[</span><span class="op" id="8209280">]</span><span class="builtintype" id="8209281">string</span><span class="op" id="8209287">{</span><span class="op" id="8209288">}</span><span class="op" id="8209289">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8209293">}</span><span class="op" id="8209294">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209299">WantWrite</span><span class="op" id="8209308">:</span>&nbsp;<span class="string" id="8209310">&#34;GET&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8209331">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8209336">&#34;Host:&nbsp;www.techcrunch.com\r\n&#34;</span>&nbsp;<span class="op" id="8209367">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8209372">&#34;User-Agent:&nbsp;Fake\r\n&#34;</span>&nbsp;<span class="op" id="8209395">+</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8209400">&#34;Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&#34;</span>&nbsp;<span class="op" id="8209478">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8209483">&#34;Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n&#34;</span>&nbsp;<span class="op" id="8209536">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8209541">&#34;Accept-Encoding:&nbsp;gzip,deflate\r\n&#34;</span>&nbsp;<span class="op" id="8209577">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8209582">&#34;Accept-Language:&nbsp;en-us,en;q=0.5\r\n&#34;</span>&nbsp;<span class="op" id="8209620">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8209625">&#34;Keep-Alive:&nbsp;300\r\n&#34;</span>&nbsp;<span class="op" id="8209647">+</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8209652">&#34;Proxy-Connection:&nbsp;keep-alive\r\n\r\n&#34;</span><span class="op" id="8209690">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209695">WantProxy</span><span class="op" id="8209704">:</span>&nbsp;<span class="string" id="8209706">&#34;GET&nbsp;http://www.techcrunch.com/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8209752">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8209757">&#34;Host:&nbsp;www.techcrunch.com\r\n&#34;</span>&nbsp;<span class="op" id="8209788">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8209793">&#34;User-Agent:&nbsp;Fake\r\n&#34;</span>&nbsp;<span class="op" id="8209816">+</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8209821">&#34;Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&#34;</span>&nbsp;<span class="op" id="8209899">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8209904">&#34;Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n&#34;</span>&nbsp;<span class="op" id="8209957">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8209962">&#34;Accept-Encoding:&nbsp;gzip,deflate\r\n&#34;</span>&nbsp;<span class="op" id="8209998">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8210003">&#34;Accept-Language:&nbsp;en-us,en;q=0.5\r\n&#34;</span>&nbsp;<span class="op" id="8210041">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8210046">&#34;Keep-Alive:&nbsp;300\r\n&#34;</span>&nbsp;<span class="op" id="8210068">+</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8210073">&#34;Proxy-Connection:&nbsp;keep-alive\r\n\r\n&#34;</span><span class="op" id="8210111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210114">}</span><span class="op" id="8210115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8210118">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210174">Req</span><span class="op" id="8210177">:</span>&nbsp;<span class="ident" id="8210179">Request</span><span class="op" id="8210186">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210191">Method</span><span class="op" id="8210197">:</span>&nbsp;<span class="string" id="8210199">&#34;GET&#34;</span><span class="op" id="8210204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210209">URL</span><span class="op" id="8210212">:</span>&nbsp;<span class="op" id="8210214">&amp;</span><span class="ident" id="8210215">url</span><span class="op" id="8210218">.</span><span class="ident" id="8210219">URL</span><span class="op" id="8210222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210228">Scheme</span><span class="op" id="8210234">:</span>&nbsp;<span class="string" id="8210236">&#34;http&#34;</span><span class="op" id="8210242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210248">Host</span><span class="op" id="8210252">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8210256">&#34;www.google.com&#34;</span><span class="op" id="8210272">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210278">Path</span><span class="op" id="8210282">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8210286">&#34;/search&#34;</span><span class="op" id="8210295">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210300">}</span><span class="op" id="8210301">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210306">ProtoMajor</span><span class="op" id="8210316">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8210324">1</span><span class="op" id="8210325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210330">ProtoMinor</span><span class="op" id="8210340">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8210348">1</span><span class="op" id="8210349">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210354">Header</span><span class="op" id="8210360">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8210372">Header</span><span class="op" id="8210378">{</span><span class="op" id="8210379">}</span><span class="op" id="8210380">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210385">TransferEncoding</span><span class="op" id="8210401">:</span>&nbsp;<span class="op" id="8210403">[</span><span class="op" id="8210404">]</span><span class="builtintype" id="8210405">string</span><span class="op" id="8210411">{</span><span class="string" id="8210412">&#34;chunked&#34;</span><span class="op" id="8210421">}</span><span class="op" id="8210422">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210426">}</span><span class="op" id="8210427">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210432">Body</span><span class="op" id="8210436">:</span>&nbsp;<span class="op" id="8210438">[</span><span class="op" id="8210439">]</span><span class="builtintype" id="8210440">byte</span><span class="op" id="8210444">(</span><span class="string" id="8210445">&#34;abcdef&#34;</span><span class="op" id="8210453">)</span><span class="op" id="8210454">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210459">WantWrite</span><span class="op" id="8210468">:</span>&nbsp;<span class="string" id="8210470">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8210497">+</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8210502">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8210529">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8210534">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8210572">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8210577">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8210614">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210619">chunk</span><span class="op" id="8210624">(</span><span class="string" id="8210625">&#34;abcdef&#34;</span><span class="op" id="8210633">)</span>&nbsp;<span class="op" id="8210635">+</span>&nbsp;<span class="ident" id="8210637">chunk</span><span class="op" id="8210642">(</span><span class="string" id="8210643">&#34;&#34;</span><span class="op" id="8210645">)</span><span class="op" id="8210646">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210651">WantProxy</span><span class="op" id="8210660">:</span>&nbsp;<span class="string" id="8210662">&#34;GET&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8210710">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8210715">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8210742">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8210747">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8210785">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8210790">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8210827">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210832">chunk</span><span class="op" id="8210837">(</span><span class="string" id="8210838">&#34;abcdef&#34;</span><span class="op" id="8210846">)</span>&nbsp;<span class="op" id="8210848">+</span>&nbsp;<span class="ident" id="8210850">chunk</span><span class="op" id="8210855">(</span><span class="string" id="8210856">&#34;&#34;</span><span class="op" id="8210858">)</span><span class="op" id="8210859">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210862">}</span><span class="op" id="8210863">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8210866">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8210923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210927">Req</span><span class="op" id="8210930">:</span>&nbsp;<span class="ident" id="8210932">Request</span><span class="op" id="8210939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210944">Method</span><span class="op" id="8210950">:</span>&nbsp;<span class="string" id="8210952">&#34;POST&#34;</span><span class="op" id="8210958">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210963">URL</span><span class="op" id="8210966">:</span>&nbsp;<span class="op" id="8210968">&amp;</span><span class="ident" id="8210969">url</span><span class="op" id="8210972">.</span><span class="ident" id="8210973">URL</span><span class="op" id="8210976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8210982">Scheme</span><span class="op" id="8210988">:</span>&nbsp;<span class="string" id="8210990">&#34;http&#34;</span><span class="op" id="8210996">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211002">Host</span><span class="op" id="8211006">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8211010">&#34;www.google.com&#34;</span><span class="op" id="8211026">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211032">Path</span><span class="op" id="8211036">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8211040">&#34;/search&#34;</span><span class="op" id="8211049">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8211054">}</span><span class="op" id="8211055">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211060">ProtoMajor</span><span class="op" id="8211070">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8211078">1</span><span class="op" id="8211079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211084">ProtoMinor</span><span class="op" id="8211094">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8211102">1</span><span class="op" id="8211103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211108">Header</span><span class="op" id="8211114">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8211126">Header</span><span class="op" id="8211132">{</span><span class="op" id="8211133">}</span><span class="op" id="8211134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211139">Close</span><span class="op" id="8211144">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8211157">true</span><span class="op" id="8211161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211166">TransferEncoding</span><span class="op" id="8211182">:</span>&nbsp;<span class="op" id="8211184">[</span><span class="op" id="8211185">]</span><span class="builtintype" id="8211186">string</span><span class="op" id="8211192">{</span><span class="string" id="8211193">&#34;chunked&#34;</span><span class="op" id="8211202">}</span><span class="op" id="8211203">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8211207">}</span><span class="op" id="8211208">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211213">Body</span><span class="op" id="8211217">:</span>&nbsp;<span class="op" id="8211219">[</span><span class="op" id="8211220">]</span><span class="builtintype" id="8211221">byte</span><span class="op" id="8211225">(</span><span class="string" id="8211226">&#34;abcdef&#34;</span><span class="op" id="8211234">)</span><span class="op" id="8211235">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211240">WantWrite</span><span class="op" id="8211249">:</span>&nbsp;<span class="string" id="8211251">&#34;POST&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8211279">+</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8211284">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8211311">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8211316">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8211354">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8211359">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8211383">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8211388">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8211425">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211430">chunk</span><span class="op" id="8211435">(</span><span class="string" id="8211436">&#34;abcdef&#34;</span><span class="op" id="8211444">)</span>&nbsp;<span class="op" id="8211446">+</span>&nbsp;<span class="ident" id="8211448">chunk</span><span class="op" id="8211453">(</span><span class="string" id="8211454">&#34;&#34;</span><span class="op" id="8211456">)</span><span class="op" id="8211457">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211462">WantProxy</span><span class="op" id="8211471">:</span>&nbsp;<span class="string" id="8211473">&#34;POST&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8211522">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8211527">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8211554">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8211559">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8211597">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8211602">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8211626">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8211631">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8211668">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211673">chunk</span><span class="op" id="8211678">(</span><span class="string" id="8211679">&#34;abcdef&#34;</span><span class="op" id="8211687">)</span>&nbsp;<span class="op" id="8211689">+</span>&nbsp;<span class="ident" id="8211691">chunk</span><span class="op" id="8211696">(</span><span class="string" id="8211697">&#34;&#34;</span><span class="op" id="8211699">)</span><span class="op" id="8211700">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8211703">}</span><span class="op" id="8211704">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8211708">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;with&nbsp;Content-Length,&nbsp;no&nbsp;chunking</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8211759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211763">Req</span><span class="op" id="8211766">:</span>&nbsp;<span class="ident" id="8211768">Request</span><span class="op" id="8211775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211780">Method</span><span class="op" id="8211786">:</span>&nbsp;<span class="string" id="8211788">&#34;POST&#34;</span><span class="op" id="8211794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211799">URL</span><span class="op" id="8211802">:</span>&nbsp;<span class="op" id="8211804">&amp;</span><span class="ident" id="8211805">url</span><span class="op" id="8211808">.</span><span class="ident" id="8211809">URL</span><span class="op" id="8211812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211818">Scheme</span><span class="op" id="8211824">:</span>&nbsp;<span class="string" id="8211826">&#34;http&#34;</span><span class="op" id="8211832">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211838">Host</span><span class="op" id="8211842">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8211846">&#34;www.google.com&#34;</span><span class="op" id="8211862">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211868">Path</span><span class="op" id="8211872">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8211876">&#34;/search&#34;</span><span class="op" id="8211885">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8211890">}</span><span class="op" id="8211891">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211896">ProtoMajor</span><span class="op" id="8211906">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8211911">1</span><span class="op" id="8211912">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211917">ProtoMinor</span><span class="op" id="8211927">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8211932">1</span><span class="op" id="8211933">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211938">Header</span><span class="op" id="8211944">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8211953">Header</span><span class="op" id="8211959">{</span><span class="op" id="8211960">}</span><span class="op" id="8211961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211966">Close</span><span class="op" id="8211971">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8211981">true</span><span class="op" id="8211985">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8211990">ContentLength</span><span class="op" id="8212003">:</span>&nbsp;<span class="num" id="8212005">6</span><span class="op" id="8212006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212010">}</span><span class="op" id="8212011">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212016">Body</span><span class="op" id="8212020">:</span>&nbsp;<span class="op" id="8212022">[</span><span class="op" id="8212023">]</span><span class="builtintype" id="8212024">byte</span><span class="op" id="8212028">(</span><span class="string" id="8212029">&#34;abcdef&#34;</span><span class="op" id="8212037">)</span><span class="op" id="8212038">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212043">WantWrite</span><span class="op" id="8212052">:</span>&nbsp;<span class="string" id="8212054">&#34;POST&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8212082">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8212087">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8212114">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8212119">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8212157">+</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8212162">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8212186">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8212191">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="8212215">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8212220">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8212227">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8212232">&#34;abcdef&#34;</span><span class="op" id="8212240">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212245">WantProxy</span><span class="op" id="8212254">:</span>&nbsp;<span class="string" id="8212256">&#34;POST&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8212305">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8212310">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8212337">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8212342">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8212380">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8212385">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8212409">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8212414">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="8212438">+</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8212443">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8212450">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8212455">&#34;abcdef&#34;</span><span class="op" id="8212463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212466">}</span><span class="op" id="8212467">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8212471">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;with&nbsp;Content-Length&nbsp;in&nbsp;headers</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212524">Req</span><span class="op" id="8212527">:</span>&nbsp;<span class="ident" id="8212529">Request</span><span class="op" id="8212536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212541">Method</span><span class="op" id="8212547">:</span>&nbsp;<span class="string" id="8212549">&#34;POST&#34;</span><span class="op" id="8212555">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212560">URL</span><span class="op" id="8212563">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8212568">mustParseURL</span><span class="op" id="8212580">(</span><span class="string" id="8212581">&#34;http://example.com/&#34;</span><span class="op" id="8212602">)</span><span class="op" id="8212603">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212608">Host</span><span class="op" id="8212612">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8212616">&#34;example.com&#34;</span><span class="op" id="8212629">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212634">Header</span><span class="op" id="8212640">:</span>&nbsp;<span class="ident" id="8212642">Header</span><span class="op" id="8212648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8212654">&#34;Content-Length&#34;</span><span class="op" id="8212670">:</span>&nbsp;<span class="op" id="8212672">[</span><span class="op" id="8212673">]</span><span class="builtintype" id="8212674">string</span><span class="op" id="8212680">{</span><span class="string" id="8212681">&#34;10&#34;</span><span class="op" id="8212685">}</span><span class="op" id="8212686">,</span>&nbsp;<span class="comment" id="8212688">//&nbsp;ignored</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212702">}</span><span class="op" id="8212703">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212708">ContentLength</span><span class="op" id="8212721">:</span>&nbsp;<span class="num" id="8212723">6</span><span class="op" id="8212724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8212728">}</span><span class="op" id="8212729">,</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212734">Body</span><span class="op" id="8212738">:</span>&nbsp;<span class="op" id="8212740">[</span><span class="op" id="8212741">]</span><span class="builtintype" id="8212742">byte</span><span class="op" id="8212746">(</span><span class="string" id="8212747">&#34;abcdef&#34;</span><span class="op" id="8212755">)</span><span class="op" id="8212756">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212761">WantWrite</span><span class="op" id="8212770">:</span>&nbsp;<span class="string" id="8212772">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8212794">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8212799">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8212823">+</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8212828">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8212866">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8212871">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="8212895">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8212900">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8212907">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8212912">&#34;abcdef&#34;</span><span class="op" id="8212920">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8212925">WantProxy</span><span class="op" id="8212934">:</span>&nbsp;<span class="string" id="8212936">&#34;POST&nbsp;http://example.com/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8212976">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8212981">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8213005">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8213010">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8213048">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8213053">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="8213077">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8213082">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8213089">+</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8213094">&#34;abcdef&#34;</span><span class="op" id="8213102">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213105">}</span><span class="op" id="8213106">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8213110">//&nbsp;default&nbsp;to&nbsp;HTTP/1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213134">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213138">Req</span><span class="op" id="8213141">:</span>&nbsp;<span class="ident" id="8213143">Request</span><span class="op" id="8213150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213155">Method</span><span class="op" id="8213161">:</span>&nbsp;<span class="string" id="8213163">&#34;GET&#34;</span><span class="op" id="8213168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213173">URL</span><span class="op" id="8213176">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8213181">mustParseURL</span><span class="op" id="8213193">(</span><span class="string" id="8213194">&#34;/search&#34;</span><span class="op" id="8213203">)</span><span class="op" id="8213204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213209">Host</span><span class="op" id="8213213">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8213217">&#34;www.google.com&#34;</span><span class="op" id="8213233">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213237">}</span><span class="op" id="8213238">,</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213243">WantWrite</span><span class="op" id="8213252">:</span>&nbsp;<span class="string" id="8213254">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8213281">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8213286">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8213313">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8213318">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8213356">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8213361">&#34;\r\n&#34;</span><span class="op" id="8213367">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213370">}</span><span class="op" id="8213371">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8213375">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;0&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213433">Req</span><span class="op" id="8213436">:</span>&nbsp;<span class="ident" id="8213438">Request</span><span class="op" id="8213445">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213450">Method</span><span class="op" id="8213456">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8213465">&#34;POST&#34;</span><span class="op" id="8213471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213476">URL</span><span class="op" id="8213479">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8213491">mustParseURL</span><span class="op" id="8213503">(</span><span class="string" id="8213504">&#34;/&#34;</span><span class="op" id="8213507">)</span><span class="op" id="8213508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213513">Host</span><span class="op" id="8213517">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8213528">&#34;example.com&#34;</span><span class="op" id="8213541">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213546">ProtoMajor</span><span class="op" id="8213556">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8213561">1</span><span class="op" id="8213562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213567">ProtoMinor</span><span class="op" id="8213577">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8213582">1</span><span class="op" id="8213583">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213588">ContentLength</span><span class="op" id="8213601">:</span>&nbsp;<span class="num" id="8213603">0</span><span class="op" id="8213604">,</span>&nbsp;<span class="comment" id="8213606">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8213631">}</span><span class="op" id="8213632">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213637">Body</span><span class="op" id="8213641">:</span>&nbsp;<span class="keyword" id="8213643">func</span><span class="op" id="8213647">(</span><span class="op" id="8213648">)</span>&nbsp;<span class="ident" id="8213650">io</span><span class="op" id="8213652">.</span><span class="ident" id="8213653">ReadCloser</span>&nbsp;<span class="op" id="8213664">{</span>&nbsp;<span class="keyword" id="8213666">return</span>&nbsp;<span class="ident" id="8213673">ioutil</span><span class="op" id="8213679">.</span><span class="ident" id="8213680">NopCloser</span><span class="op" id="8213689">(</span><span class="ident" id="8213690">io</span><span class="op" id="8213692">.</span><span class="ident" id="8213693">LimitReader</span><span class="op" id="8213704">(</span><span class="ident" id="8213705">strings</span><span class="op" id="8213712">.</span><span class="ident" id="8213713">NewReader</span><span class="op" id="8213722">(</span><span class="string" id="8213723">&#34;xx&#34;</span><span class="op" id="8213727">)</span><span class="op" id="8213728">,</span>&nbsp;<span class="num" id="8213730">0</span><span class="op" id="8213731">)</span><span class="op" id="8213732">)</span>&nbsp;<span class="op" id="8213734">}</span><span class="op" id="8213735">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8213740">//&nbsp;RFC&nbsp;2616&nbsp;Section&nbsp;14.13&nbsp;says&nbsp;Content-Length&nbsp;should&nbsp;be&nbsp;specified</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8213808">//&nbsp;unless&nbsp;body&nbsp;is&nbsp;prohibited&nbsp;by&nbsp;the&nbsp;request&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8213862">//&nbsp;Also,&nbsp;nginx&nbsp;expects&nbsp;it&nbsp;for&nbsp;POST&nbsp;and&nbsp;PUT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8213908">WantWrite</span><span class="op" id="8213917">:</span>&nbsp;<span class="string" id="8213919">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8213941">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8213946">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8213970">+</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8213975">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8214013">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8214018">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="8214042">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8214047">&#34;\r\n&#34;</span><span class="op" id="8214053">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8214058">WantProxy</span><span class="op" id="8214067">:</span>&nbsp;<span class="string" id="8214069">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8214091">+</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8214096">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8214120">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8214125">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8214163">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8214168">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="8214192">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8214197">&#34;\r\n&#34;</span><span class="op" id="8214203">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8214206">}</span><span class="op" id="8214207">,</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8214211">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;1&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8214265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8214269">Req</span><span class="op" id="8214272">:</span>&nbsp;<span class="ident" id="8214274">Request</span><span class="op" id="8214281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8214286">Method</span><span class="op" id="8214292">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8214301">&#34;POST&#34;</span><span class="op" id="8214307">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8214312">URL</span><span class="op" id="8214315">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8214327">mustParseURL</span><span class="op" id="8214339">(</span><span class="string" id="8214340">&#34;/&#34;</span><span class="op" id="8214343">)</span><span class="op" id="8214344">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8214349">Host</span><span class="op" id="8214353">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8214364">&#34;example.com&#34;</span><span class="op" id="8214377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8214382">ProtoMajor</span><span class="op" id="8214392">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8214397">1</span><span class="op" id="8214398">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8214403">ProtoMinor</span><span class="op" id="8214413">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8214418">1</span><span class="op" id="8214419">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8214424">ContentLength</span><span class="op" id="8214437">:</span>&nbsp;<span class="num" id="8214439">0</span><span class="op" id="8214440">,</span>&nbsp;<span class="comment" id="8214442">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8214467">}</span><span class="op" id="8214468">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8214473">Body</span><span class="op" id="8214477">:</span>&nbsp;<span class="keyword" id="8214479">func</span><span class="op" id="8214483">(</span><span class="op" id="8214484">)</span>&nbsp;<span class="ident" id="8214486">io</span><span class="op" id="8214488">.</span><span class="ident" id="8214489">ReadCloser</span>&nbsp;<span class="op" id="8214500">{</span>&nbsp;<span class="keyword" id="8214502">return</span>&nbsp;<span class="ident" id="8214509">ioutil</span><span class="op" id="8214515">.</span><span class="ident" id="8214516">NopCloser</span><span class="op" id="8214525">(</span><span class="ident" id="8214526">io</span><span class="op" id="8214528">.</span><span class="ident" id="8214529">LimitReader</span><span class="op" id="8214540">(</span><span class="ident" id="8214541">strings</span><span class="op" id="8214548">.</span><span class="ident" id="8214549">NewReader</span><span class="op" id="8214558">(</span><span class="string" id="8214559">&#34;xx&#34;</span><span class="op" id="8214563">)</span><span class="op" id="8214564">,</span>&nbsp;<span class="num" id="8214566">1</span><span class="op" id="8214567">)</span><span class="op" id="8214568">)</span>&nbsp;<span class="op" id="8214570">}</span><span class="op" id="8214571">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8214576">WantWrite</span><span class="op" id="8214585">:</span>&nbsp;<span class="string" id="8214587">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8214609">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8214614">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8214638">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8214643">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8214681">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8214686">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8214723">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8214728">chunk</span><span class="op" id="8214733">(</span><span class="string" id="8214734">&#34;x&#34;</span><span class="op" id="8214737">)</span>&nbsp;<span class="op" id="8214739">+</span>&nbsp;<span class="ident" id="8214741">chunk</span><span class="op" id="8214746">(</span><span class="string" id="8214747">&#34;&#34;</span><span class="op" id="8214749">)</span><span class="op" id="8214750">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8214755">WantProxy</span><span class="op" id="8214764">:</span>&nbsp;<span class="string" id="8214766">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8214788">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8214793">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8214817">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8214822">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8214860">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8214865">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8214902">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8214907">chunk</span><span class="op" id="8214912">(</span><span class="string" id="8214913">&#34;x&#34;</span><span class="op" id="8214916">)</span>&nbsp;<span class="op" id="8214918">+</span>&nbsp;<span class="ident" id="8214920">chunk</span><span class="op" id="8214925">(</span><span class="string" id="8214926">&#34;&#34;</span><span class="op" id="8214928">)</span><span class="op" id="8214929">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8214932">}</span><span class="op" id="8214933">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8214937">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;ContentLength&nbsp;of&nbsp;10&nbsp;but&nbsp;a&nbsp;5&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8214995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8214999">Req</span><span class="op" id="8215002">:</span>&nbsp;<span class="ident" id="8215004">Request</span><span class="op" id="8215011">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215016">Method</span><span class="op" id="8215022">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8215031">&#34;POST&#34;</span><span class="op" id="8215037">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215042">URL</span><span class="op" id="8215045">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8215057">mustParseURL</span><span class="op" id="8215069">(</span><span class="string" id="8215070">&#34;/&#34;</span><span class="op" id="8215073">)</span><span class="op" id="8215074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215079">Host</span><span class="op" id="8215083">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8215094">&#34;example.com&#34;</span><span class="op" id="8215107">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215112">ProtoMajor</span><span class="op" id="8215122">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8215127">1</span><span class="op" id="8215128">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215133">ProtoMinor</span><span class="op" id="8215143">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8215148">1</span><span class="op" id="8215149">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215154">ContentLength</span><span class="op" id="8215167">:</span>&nbsp;<span class="num" id="8215169">10</span><span class="op" id="8215171">,</span>&nbsp;<span class="comment" id="8215173">//&nbsp;but&nbsp;we&#39;re&nbsp;going&nbsp;to&nbsp;send&nbsp;only&nbsp;5&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8215215">}</span><span class="op" id="8215216">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215220">Body</span><span class="op" id="8215224">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8215231">[</span><span class="op" id="8215232">]</span><span class="builtintype" id="8215233">byte</span><span class="op" id="8215237">(</span><span class="string" id="8215238">&#34;12345&#34;</span><span class="op" id="8215245">)</span><span class="op" id="8215246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215250">WantError</span><span class="op" id="8215259">:</span>&nbsp;<span class="ident" id="8215261">errors</span><span class="op" id="8215267">.</span><span class="ident" id="8215268">New</span><span class="op" id="8215271">(</span><span class="string" id="8215272">&#34;http:&nbsp;ContentLength=10&nbsp;with&nbsp;Body&nbsp;length&nbsp;5&#34;</span><span class="op" id="8215315">)</span><span class="op" id="8215316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8215319">}</span><span class="op" id="8215320">,</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8215324">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;ContentLength&nbsp;of&nbsp;4&nbsp;but&nbsp;an&nbsp;8&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8215382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215386">Req</span><span class="op" id="8215389">:</span>&nbsp;<span class="ident" id="8215391">Request</span><span class="op" id="8215398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215403">Method</span><span class="op" id="8215409">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8215418">&#34;POST&#34;</span><span class="op" id="8215424">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215429">URL</span><span class="op" id="8215432">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8215444">mustParseURL</span><span class="op" id="8215456">(</span><span class="string" id="8215457">&#34;/&#34;</span><span class="op" id="8215460">)</span><span class="op" id="8215461">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215466">Host</span><span class="op" id="8215470">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8215481">&#34;example.com&#34;</span><span class="op" id="8215494">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215499">ProtoMajor</span><span class="op" id="8215509">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8215514">1</span><span class="op" id="8215515">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215520">ProtoMinor</span><span class="op" id="8215530">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8215535">1</span><span class="op" id="8215536">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215541">ContentLength</span><span class="op" id="8215554">:</span>&nbsp;<span class="num" id="8215556">4</span><span class="op" id="8215557">,</span>&nbsp;<span class="comment" id="8215559">//&nbsp;but&nbsp;we&#39;re&nbsp;going&nbsp;to&nbsp;try&nbsp;to&nbsp;send&nbsp;8&nbsp;bytes</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8215603">}</span><span class="op" id="8215604">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215608">Body</span><span class="op" id="8215612">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8215619">[</span><span class="op" id="8215620">]</span><span class="builtintype" id="8215621">byte</span><span class="op" id="8215625">(</span><span class="string" id="8215626">&#34;12345678&#34;</span><span class="op" id="8215636">)</span><span class="op" id="8215637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215641">WantError</span><span class="op" id="8215650">:</span>&nbsp;<span class="ident" id="8215652">errors</span><span class="op" id="8215658">.</span><span class="ident" id="8215659">New</span><span class="op" id="8215662">(</span><span class="string" id="8215663">&#34;http:&nbsp;ContentLength=4&nbsp;with&nbsp;Body&nbsp;length&nbsp;8&#34;</span><span class="op" id="8215705">)</span><span class="op" id="8215706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8215709">}</span><span class="op" id="8215710">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8215714">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;5&nbsp;ContentLength&nbsp;and&nbsp;nil&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8215763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215767">Req</span><span class="op" id="8215770">:</span>&nbsp;<span class="ident" id="8215772">Request</span><span class="op" id="8215779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215784">Method</span><span class="op" id="8215790">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8215799">&#34;POST&#34;</span><span class="op" id="8215805">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215810">URL</span><span class="op" id="8215813">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8215825">mustParseURL</span><span class="op" id="8215837">(</span><span class="string" id="8215838">&#34;/&#34;</span><span class="op" id="8215841">)</span><span class="op" id="8215842">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215847">Host</span><span class="op" id="8215851">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8215862">&#34;example.com&#34;</span><span class="op" id="8215875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215880">ProtoMajor</span><span class="op" id="8215890">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8215895">1</span><span class="op" id="8215896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215901">ProtoMinor</span><span class="op" id="8215911">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8215916">1</span><span class="op" id="8215917">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215922">ContentLength</span><span class="op" id="8215935">:</span>&nbsp;<span class="num" id="8215937">5</span><span class="op" id="8215938">,</span>&nbsp;<span class="comment" id="8215940">//&nbsp;but&nbsp;we&#39;ll&nbsp;omit&nbsp;the&nbsp;body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8215969">}</span><span class="op" id="8215970">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215974">WantError</span><span class="op" id="8215983">:</span>&nbsp;<span class="ident" id="8215985">errors</span><span class="op" id="8215991">.</span><span class="ident" id="8215992">New</span><span class="op" id="8215995">(</span><span class="string" id="8215996">&#34;http:&nbsp;Request.ContentLength=5&nbsp;with&nbsp;nil&nbsp;Body&#34;</span><span class="op" id="8216041">)</span><span class="op" id="8216042">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8216045">}</span><span class="op" id="8216046">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8216050">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;body&nbsp;with&nbsp;1&nbsp;byte&nbsp;content&nbsp;and&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8216130">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216134">Req</span><span class="op" id="8216137">:</span>&nbsp;<span class="ident" id="8216139">Request</span><span class="op" id="8216146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216151">Method</span><span class="op" id="8216157">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8216166">&#34;POST&#34;</span><span class="op" id="8216172">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216177">URL</span><span class="op" id="8216180">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8216192">mustParseURL</span><span class="op" id="8216204">(</span><span class="string" id="8216205">&#34;/&#34;</span><span class="op" id="8216208">)</span><span class="op" id="8216209">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216214">Host</span><span class="op" id="8216218">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8216229">&#34;example.com&#34;</span><span class="op" id="8216242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216247">ProtoMajor</span><span class="op" id="8216257">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8216262">1</span><span class="op" id="8216263">,</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216268">ProtoMinor</span><span class="op" id="8216278">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8216283">1</span><span class="op" id="8216284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216289">ContentLength</span><span class="op" id="8216302">:</span>&nbsp;<span class="num" id="8216304">0</span><span class="op" id="8216305">,</span>&nbsp;<span class="comment" id="8216307">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8216332">}</span><span class="op" id="8216333">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216338">Body</span><span class="op" id="8216342">:</span>&nbsp;<span class="keyword" id="8216344">func</span><span class="op" id="8216348">(</span><span class="op" id="8216349">)</span>&nbsp;<span class="ident" id="8216351">io</span><span class="op" id="8216353">.</span><span class="ident" id="8216354">ReadCloser</span>&nbsp;<span class="op" id="8216365">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216370">err</span>&nbsp;<span class="op" id="8216374">:=</span>&nbsp;<span class="ident" id="8216377">errors</span><span class="op" id="8216383">.</span><span class="ident" id="8216384">New</span><span class="op" id="8216387">(</span><span class="string" id="8216388">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="8216409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216414">errReader</span>&nbsp;<span class="op" id="8216424">:=</span>&nbsp;<span class="op" id="8216427">&amp;</span><span class="ident" id="8216428">errorReader</span><span class="op" id="8216439">{</span><span class="ident" id="8216440">err</span><span class="op" id="8216443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8216448">return</span>&nbsp;<span class="ident" id="8216455">ioutil</span><span class="op" id="8216461">.</span><span class="ident" id="8216462">NopCloser</span><span class="op" id="8216471">(</span><span class="ident" id="8216472">io</span><span class="op" id="8216474">.</span><span class="ident" id="8216475">MultiReader</span><span class="op" id="8216486">(</span><span class="ident" id="8216487">strings</span><span class="op" id="8216494">.</span><span class="ident" id="8216495">NewReader</span><span class="op" id="8216504">(</span><span class="string" id="8216505">&#34;x&#34;</span><span class="op" id="8216508">)</span><span class="op" id="8216509">,</span>&nbsp;<span class="ident" id="8216511">errReader</span><span class="op" id="8216520">)</span><span class="op" id="8216521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8216525">}</span><span class="op" id="8216526">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216531">WantError</span><span class="op" id="8216540">:</span>&nbsp;<span class="ident" id="8216542">errors</span><span class="op" id="8216548">.</span><span class="ident" id="8216549">New</span><span class="op" id="8216552">(</span><span class="string" id="8216553">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="8216574">)</span><span class="op" id="8216575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8216578">}</span><span class="op" id="8216579">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8216583">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;body&nbsp;without&nbsp;content&nbsp;and&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8216659">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216663">Req</span><span class="op" id="8216666">:</span>&nbsp;<span class="ident" id="8216668">Request</span><span class="op" id="8216675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216680">Method</span><span class="op" id="8216686">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8216695">&#34;POST&#34;</span><span class="op" id="8216701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216706">URL</span><span class="op" id="8216709">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8216721">mustParseURL</span><span class="op" id="8216733">(</span><span class="string" id="8216734">&#34;/&#34;</span><span class="op" id="8216737">)</span><span class="op" id="8216738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216743">Host</span><span class="op" id="8216747">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8216758">&#34;example.com&#34;</span><span class="op" id="8216771">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216776">ProtoMajor</span><span class="op" id="8216786">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8216791">1</span><span class="op" id="8216792">,</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216797">ProtoMinor</span><span class="op" id="8216807">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8216812">1</span><span class="op" id="8216813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216818">ContentLength</span><span class="op" id="8216831">:</span>&nbsp;<span class="num" id="8216833">0</span><span class="op" id="8216834">,</span>&nbsp;<span class="comment" id="8216836">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8216861">}</span><span class="op" id="8216862">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216867">Body</span><span class="op" id="8216871">:</span>&nbsp;<span class="keyword" id="8216873">func</span><span class="op" id="8216877">(</span><span class="op" id="8216878">)</span>&nbsp;<span class="ident" id="8216880">io</span><span class="op" id="8216882">.</span><span class="ident" id="8216883">ReadCloser</span>&nbsp;<span class="op" id="8216894">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216899">err</span>&nbsp;<span class="op" id="8216903">:=</span>&nbsp;<span class="ident" id="8216906">errors</span><span class="op" id="8216912">.</span><span class="ident" id="8216913">New</span><span class="op" id="8216916">(</span><span class="string" id="8216917">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="8216938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216943">errReader</span>&nbsp;<span class="op" id="8216953">:=</span>&nbsp;<span class="op" id="8216956">&amp;</span><span class="ident" id="8216957">errorReader</span><span class="op" id="8216968">{</span><span class="ident" id="8216969">err</span><span class="op" id="8216972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8216977">return</span>&nbsp;<span class="ident" id="8216984">ioutil</span><span class="op" id="8216990">.</span><span class="ident" id="8216991">NopCloser</span><span class="op" id="8217000">(</span><span class="ident" id="8217001">errReader</span><span class="op" id="8217010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8217014">}</span><span class="op" id="8217015">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217020">WantError</span><span class="op" id="8217029">:</span>&nbsp;<span class="ident" id="8217031">errors</span><span class="op" id="8217037">.</span><span class="ident" id="8217038">New</span><span class="op" id="8217041">(</span><span class="string" id="8217042">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="8217063">)</span><span class="op" id="8217064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8217067">}</span><span class="op" id="8217068">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8217072">//&nbsp;Verify&nbsp;that&nbsp;DumpRequest&nbsp;preserves&nbsp;the&nbsp;HTTP&nbsp;version&nbsp;number,&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;Host,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8217155">//&nbsp;and&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;User-Agent.</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8217189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217193">Req</span><span class="op" id="8217196">:</span>&nbsp;<span class="ident" id="8217198">Request</span><span class="op" id="8217205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217210">Method</span><span class="op" id="8217216">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8217222">&#34;GET&#34;</span><span class="op" id="8217227">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217232">URL</span><span class="op" id="8217235">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8217244">mustParseURL</span><span class="op" id="8217256">(</span><span class="string" id="8217257">&#34;/foo&#34;</span><span class="op" id="8217263">)</span><span class="op" id="8217264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217269">ProtoMajor</span><span class="op" id="8217279">:</span>&nbsp;<span class="num" id="8217281">1</span><span class="op" id="8217282">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217287">ProtoMinor</span><span class="op" id="8217297">:</span>&nbsp;<span class="num" id="8217299">0</span><span class="op" id="8217300">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217305">Header</span><span class="op" id="8217311">:</span>&nbsp;<span class="ident" id="8217313">Header</span><span class="op" id="8217319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8217325">&#34;X-Foo&#34;</span><span class="op" id="8217332">:</span>&nbsp;<span class="op" id="8217334">[</span><span class="op" id="8217335">]</span><span class="builtintype" id="8217336">string</span><span class="op" id="8217342">{</span><span class="string" id="8217343">&#34;X-Bar&#34;</span><span class="op" id="8217350">}</span><span class="op" id="8217351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8217356">}</span><span class="op" id="8217357">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8217361">}</span><span class="op" id="8217362">,</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217367">WantWrite</span><span class="op" id="8217376">:</span>&nbsp;<span class="string" id="8217378">&#34;GET&nbsp;/foo&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8217402">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8217407">&#34;Host:&nbsp;\r\n&#34;</span>&nbsp;<span class="op" id="8217420">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8217425">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8217463">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8217468">&#34;X-Foo:&nbsp;X-Bar\r\n\r\n&#34;</span><span class="op" id="8217490">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8217493">}</span><span class="op" id="8217494">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8217498">//&nbsp;If&nbsp;no&nbsp;Request.Host&nbsp;and&nbsp;no&nbsp;Request.URL.Host,&nbsp;we&nbsp;send</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8217554">//&nbsp;an&nbsp;empty&nbsp;Host&nbsp;header,&nbsp;and&nbsp;don&#39;t&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8217594">//&nbsp;Request.Header[&#34;Host&#34;].&nbsp;This&nbsp;is&nbsp;just&nbsp;testing&nbsp;that</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8217648">//&nbsp;we&nbsp;don&#39;t&nbsp;change&nbsp;Go&nbsp;1.0&nbsp;behavior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8217685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217689">Req</span><span class="op" id="8217692">:</span>&nbsp;<span class="ident" id="8217694">Request</span><span class="op" id="8217701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217706">Method</span><span class="op" id="8217712">:</span>&nbsp;<span class="string" id="8217714">&#34;GET&#34;</span><span class="op" id="8217719">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217724">Host</span><span class="op" id="8217728">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8217732">&#34;&#34;</span><span class="op" id="8217734">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217739">URL</span><span class="op" id="8217742">:</span>&nbsp;<span class="op" id="8217744">&amp;</span><span class="ident" id="8217745">url</span><span class="op" id="8217748">.</span><span class="ident" id="8217749">URL</span><span class="op" id="8217752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217758">Scheme</span><span class="op" id="8217764">:</span>&nbsp;<span class="string" id="8217766">&#34;http&#34;</span><span class="op" id="8217772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217778">Host</span><span class="op" id="8217782">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8217786">&#34;&#34;</span><span class="op" id="8217788">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217794">Path</span><span class="op" id="8217798">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8217802">&#34;/search&#34;</span><span class="op" id="8217811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8217816">}</span><span class="op" id="8217817">,</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217822">ProtoMajor</span><span class="op" id="8217832">:</span>&nbsp;<span class="num" id="8217834">1</span><span class="op" id="8217835">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217840">ProtoMinor</span><span class="op" id="8217850">:</span>&nbsp;<span class="num" id="8217852">1</span><span class="op" id="8217853">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217858">Header</span><span class="op" id="8217864">:</span>&nbsp;<span class="ident" id="8217866">Header</span><span class="op" id="8217872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8217878">&#34;Host&#34;</span><span class="op" id="8217884">:</span>&nbsp;<span class="op" id="8217886">[</span><span class="op" id="8217887">]</span><span class="builtintype" id="8217888">string</span><span class="op" id="8217894">{</span><span class="string" id="8217895">&#34;bad.example.com&#34;</span><span class="op" id="8217912">}</span><span class="op" id="8217913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8217918">}</span><span class="op" id="8217919">,</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8217923">}</span><span class="op" id="8217924">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217929">WantWrite</span><span class="op" id="8217938">:</span>&nbsp;<span class="string" id="8217940">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8217967">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8217972">&#34;Host:&nbsp;\r\n&#34;</span>&nbsp;<span class="op" id="8217985">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8217990">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="8218031">,</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218034">}</span><span class="op" id="8218035">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8218039">//&nbsp;Opaque&nbsp;test&nbsp;#1&nbsp;from&nbsp;golang.org/issue/4860</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218089">Req</span><span class="op" id="8218092">:</span>&nbsp;<span class="ident" id="8218094">Request</span><span class="op" id="8218101">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218106">Method</span><span class="op" id="8218112">:</span>&nbsp;<span class="string" id="8218114">&#34;GET&#34;</span><span class="op" id="8218119">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218124">URL</span><span class="op" id="8218127">:</span>&nbsp;<span class="op" id="8218129">&amp;</span><span class="ident" id="8218130">url</span><span class="op" id="8218133">.</span><span class="ident" id="8218134">URL</span><span class="op" id="8218137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218143">Scheme</span><span class="op" id="8218149">:</span>&nbsp;<span class="string" id="8218151">&#34;http&#34;</span><span class="op" id="8218157">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218163">Host</span><span class="op" id="8218167">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8218171">&#34;www.google.com&#34;</span><span class="op" id="8218187">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218193">Opaque</span><span class="op" id="8218199">:</span>&nbsp;<span class="string" id="8218201">&#34;/%2F/%2F/&#34;</span><span class="op" id="8218212">,</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218217">}</span><span class="op" id="8218218">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218223">ProtoMajor</span><span class="op" id="8218233">:</span>&nbsp;<span class="num" id="8218235">1</span><span class="op" id="8218236">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218241">ProtoMinor</span><span class="op" id="8218251">:</span>&nbsp;<span class="num" id="8218253">1</span><span class="op" id="8218254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218259">Header</span><span class="op" id="8218265">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8218271">Header</span><span class="op" id="8218277">{</span><span class="op" id="8218278">}</span><span class="op" id="8218279">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218283">}</span><span class="op" id="8218284">,</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218289">WantWrite</span><span class="op" id="8218298">:</span>&nbsp;<span class="string" id="8218300">&#34;GET&nbsp;/%2F/%2F/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8218329">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218334">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8218361">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218366">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="8218407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218410">}</span><span class="op" id="8218411">,</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8218415">//&nbsp;Opaque&nbsp;test&nbsp;#2&nbsp;from&nbsp;golang.org/issue/4860</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218465">Req</span><span class="op" id="8218468">:</span>&nbsp;<span class="ident" id="8218470">Request</span><span class="op" id="8218477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218482">Method</span><span class="op" id="8218488">:</span>&nbsp;<span class="string" id="8218490">&#34;GET&#34;</span><span class="op" id="8218495">,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218500">URL</span><span class="op" id="8218503">:</span>&nbsp;<span class="op" id="8218505">&amp;</span><span class="ident" id="8218506">url</span><span class="op" id="8218509">.</span><span class="ident" id="8218510">URL</span><span class="op" id="8218513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218519">Scheme</span><span class="op" id="8218525">:</span>&nbsp;<span class="string" id="8218527">&#34;http&#34;</span><span class="op" id="8218533">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218539">Host</span><span class="op" id="8218543">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8218547">&#34;x.google.com&#34;</span><span class="op" id="8218561">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218567">Opaque</span><span class="op" id="8218573">:</span>&nbsp;<span class="string" id="8218575">&#34;//y.google.com/%2F/%2F/&#34;</span><span class="op" id="8218600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218605">}</span><span class="op" id="8218606">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218611">ProtoMajor</span><span class="op" id="8218621">:</span>&nbsp;<span class="num" id="8218623">1</span><span class="op" id="8218624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218629">ProtoMinor</span><span class="op" id="8218639">:</span>&nbsp;<span class="num" id="8218641">1</span><span class="op" id="8218642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218647">Header</span><span class="op" id="8218653">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8218659">Header</span><span class="op" id="8218665">{</span><span class="op" id="8218666">}</span><span class="op" id="8218667">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218671">}</span><span class="op" id="8218672">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218677">WantWrite</span><span class="op" id="8218686">:</span>&nbsp;<span class="string" id="8218688">&#34;GET&nbsp;http://y.google.com/%2F/%2F/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8218736">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218741">&#34;Host:&nbsp;x.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8218766">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218771">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="8218812">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218815">}</span><span class="op" id="8218816">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8218820">//&nbsp;Testing&nbsp;custom&nbsp;case&nbsp;in&nbsp;header&nbsp;keys.&nbsp;Issue&nbsp;5022.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218876">Req</span><span class="op" id="8218879">:</span>&nbsp;<span class="ident" id="8218881">Request</span><span class="op" id="8218888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218893">Method</span><span class="op" id="8218899">:</span>&nbsp;<span class="string" id="8218901">&#34;GET&#34;</span><span class="op" id="8218906">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218911">URL</span><span class="op" id="8218914">:</span>&nbsp;<span class="op" id="8218916">&amp;</span><span class="ident" id="8218917">url</span><span class="op" id="8218920">.</span><span class="ident" id="8218921">URL</span><span class="op" id="8218924">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218930">Scheme</span><span class="op" id="8218936">:</span>&nbsp;<span class="string" id="8218938">&#34;http&#34;</span><span class="op" id="8218944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218950">Host</span><span class="op" id="8218954">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8218958">&#34;www.google.com&#34;</span><span class="op" id="8218974">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218980">Path</span><span class="op" id="8218984">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8218988">&#34;/&#34;</span><span class="op" id="8218991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218996">}</span><span class="op" id="8218997">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8219002">Proto</span><span class="op" id="8219007">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8219014">&#34;HTTP/1.1&#34;</span><span class="op" id="8219024">,</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8219029">ProtoMajor</span><span class="op" id="8219039">:</span>&nbsp;<span class="num" id="8219041">1</span><span class="op" id="8219042">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8219047">ProtoMinor</span><span class="op" id="8219057">:</span>&nbsp;<span class="num" id="8219059">1</span><span class="op" id="8219060">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8219065">Header</span><span class="op" id="8219071">:</span>&nbsp;<span class="ident" id="8219073">Header</span><span class="op" id="8219079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8219085">&#34;ALL-CAPS&#34;</span><span class="op" id="8219095">:</span>&nbsp;<span class="op" id="8219097">{</span><span class="string" id="8219098">&#34;x&#34;</span><span class="op" id="8219101">}</span><span class="op" id="8219102">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8219107">}</span><span class="op" id="8219108">,</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8219112">}</span><span class="op" id="8219113">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8219118">WantWrite</span><span class="op" id="8219127">:</span>&nbsp;<span class="string" id="8219129">&#34;GET&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8219150">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8219155">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8219182">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8219187">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8219225">+</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8219230">&#34;ALL-CAPS:&nbsp;x\r\n&#34;</span>&nbsp;<span class="op" id="8219248">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8219253">&#34;\r\n&#34;</span><span class="op" id="8219259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8219262">}</span><span class="op" id="8219263">,</span><br>
<span class="lineno"></span><span class="op" id="8219265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="keyword" id="8219268">func</span>&nbsp;<span class="ident" id="8219273">TestRequestWrite</span><span class="op" id="8219289">(</span><span class="ident" id="8219290">t</span>&nbsp;<span class="op" id="8219292">*</span><span class="ident" id="8219293">testing</span><span class="op" id="8219300">.</span><span class="ident" id="8219301">T</span><span class="op" id="8219302">)</span>&nbsp;<span class="op" id="8219304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8219307">for</span>&nbsp;<span class="ident" id="8219311">i</span>&nbsp;<span class="op" id="8219313">:=</span>&nbsp;<span class="keyword" id="8219316">range</span>&nbsp;<span class="ident" id="8219322">reqWriteTests</span>&nbsp;<span class="op" id="8219336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8219340">tt</span>&nbsp;<span class="op" id="8219343">:=</span>&nbsp;<span class="op" id="8219346">&amp;</span><span class="ident" id="8219347">reqWriteTests</span><span class="op" id="8219360">[</span><span class="ident" id="8219361">i</span><span class="op" id="8219362">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8219367">setBody</span>&nbsp;<span class="op" id="8219375">:=</span>&nbsp;<span class="keyword" id="8219378">func</span><span class="op" id="8219382">(</span><span class="op" id="8219383">)</span>&nbsp;<span class="op" id="8219385">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8219390">if</span>&nbsp;<span class="ident" id="8219393">tt</span><span class="op" id="8219395">.</span><span class="ident" id="8219396">Body</span>&nbsp;<span class="op" id="8219401">==</span>&nbsp;<span class="ident" id="8219404">nil</span>&nbsp;<span class="op" id="8219408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8219414">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8219424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8219429">switch</span>&nbsp;<span class="ident" id="8219436">b</span>&nbsp;<span class="op" id="8219438">:=</span>&nbsp;<span class="ident" id="8219441">tt</span><span class="op" id="8219443">.</span><span class="ident" id="8219444">Body</span><span class="op" id="8219448">.</span><span class="op" id="8219449">(</span><span class="keyword" id="8219450">type</span><span class="op" id="8219454">)</span>&nbsp;<span class="op" id="8219456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8219461">case</span>&nbsp;<span class="op" id="8219466">[</span><span class="op" id="8219467">]</span><span class="builtintype" id="8219468">byte</span><span class="op" id="8219472">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8219478">tt</span><span class="op" id="8219480">.</span><span class="ident" id="8219481">Req</span><span class="op" id="8219484">.</span><span class="ident" id="8219485">Body</span>&nbsp;<span class="op" id="8219490">=</span>&nbsp;<span class="ident" id="8219492">ioutil</span><span class="op" id="8219498">.</span><span class="ident" id="8219499">NopCloser</span><span class="op" id="8219508">(</span><span class="ident" id="8219509">bytes</span><span class="op" id="8219514">.</span><span class="ident" id="8219515">NewReader</span><span class="op" id="8219524">(</span><span class="ident" id="8219525">b</span><span class="op" id="8219526">)</span><span class="op" id="8219527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8219532">case</span>&nbsp;<span class="keyword" id="8219537">func</span><span class="op" id="8219541">(</span><span class="op" id="8219542">)</span>&nbsp;<span class="ident" id="8219544">io</span><span class="op" id="8219546">.</span><span class="ident" id="8219547">ReadCloser</span><span class="op" id="8219557">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8219563">tt</span><span class="op" id="8219565">.</span><span class="ident" id="8219566">Req</span><span class="op" id="8219569">.</span><span class="ident" id="8219570">Body</span>&nbsp;<span class="op" id="8219575">=</span>&nbsp;<span class="ident" id="8219577">b</span><span class="op" id="8219578">(</span><span class="op" id="8219579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8219584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8219588">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8219592">setBody</span><span class="op" id="8219599">(</span><span class="op" id="8219600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8219604">if</span>&nbsp;<span class="ident" id="8219607">tt</span><span class="op" id="8219609">.</span><span class="ident" id="8219610">Req</span><span class="op" id="8219613">.</span><span class="ident" id="8219614">Header</span>&nbsp;<span class="op" id="8219621">==</span>&nbsp;<span class="ident" id="8219624">nil</span>&nbsp;<span class="op" id="8219628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8219633">tt</span><span class="op" id="8219635">.</span><span class="ident" id="8219636">Req</span><span class="op" id="8219639">.</span><span class="ident" id="8219640">Header</span>&nbsp;<span class="op" id="8219647">=</span>&nbsp;<span class="builtinfunc" id="8219649">make</span><span class="op" id="8219653">(</span><span class="ident" id="8219654">Header</span><span class="op" id="8219660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8219664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8219669">var</span>&nbsp;<span class="ident" id="8219673">braw</span>&nbsp;<span class="ident" id="8219678">bytes</span><span class="op" id="8219683">.</span><span class="ident" id="8219684">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8219693">err</span>&nbsp;<span class="op" id="8219697">:=</span>&nbsp;<span class="ident" id="8219700">tt</span><span class="op" id="8219702">.</span><span class="ident" id="8219703">Req</span><span class="op" id="8219706">.</span><span class="ident" id="8219707">Write</span><span class="op" id="8219712">(</span><span class="op" id="8219713">&amp;</span><span class="ident" id="8219714">braw</span><span class="op" id="8219718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8219722">if</span>&nbsp;<span class="ident" id="8219725">g</span><span class="op" id="8219726">,</span>&nbsp;<span class="ident" id="8219728">e</span>&nbsp;<span class="op" id="8219730">:=</span>&nbsp;<span class="ident" id="8219733">fmt</span><span class="op" id="8219736">.</span><span class="ident" id="8219737">Sprintf</span><span class="op" id="8219744">(</span><span class="string" id="8219745">&#34;%v&#34;</span><span class="op" id="8219749">,</span>&nbsp;<span class="ident" id="8219751">err</span><span class="op" id="8219754">)</span><span class="op" id="8219755">,</span>&nbsp;<span class="ident" id="8219757">fmt</span><span class="op" id="8219760">.</span><span class="ident" id="8219761">Sprintf</span><span class="op" id="8219768">(</span><span class="string" id="8219769">&#34;%v&#34;</span><span class="op" id="8219773">,</span>&nbsp;<span class="ident" id="8219775">tt</span><span class="op" id="8219777">.</span><span class="ident" id="8219778">WantError</span><span class="op" id="8219787">)</span><span class="op" id="8219788">;</span>&nbsp;<span class="ident" id="8219790">g</span>&nbsp;<span class="op" id="8219792">!=</span>&nbsp;<span class="ident" id="8219795">e</span>&nbsp;<span class="op" id="8219797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8219802">t</span><span class="op" id="8219803">.</span><span class="ident" id="8219804">Errorf</span><span class="op" id="8219810">(</span><span class="string" id="8219811">&#34;writing&nbsp;#%d,&nbsp;err&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8219843">,</span>&nbsp;<span class="ident" id="8219845">i</span><span class="op" id="8219846">,</span>&nbsp;<span class="ident" id="8219848">g</span><span class="op" id="8219849">,</span>&nbsp;<span class="ident" id="8219851">e</span><span class="op" id="8219852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8219857">continue</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8219868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8219872">if</span>&nbsp;<span class="ident" id="8219875">err</span>&nbsp;<span class="op" id="8219879">!=</span>&nbsp;<span class="ident" id="8219882">nil</span>&nbsp;<span class="op" id="8219886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8219891">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8219902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8219907">if</span>&nbsp;<span class="ident" id="8219910">tt</span><span class="op" id="8219912">.</span><span class="ident" id="8219913">WantWrite</span>&nbsp;<span class="op" id="8219923">!=</span>&nbsp;<span class="string" id="8219926">&#34;&#34;</span>&nbsp;<span class="op" id="8219929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8219934">sraw</span>&nbsp;<span class="op" id="8219939">:=</span>&nbsp;<span class="ident" id="8219942">braw</span><span class="op" id="8219946">.</span><span class="ident" id="8219947">String</span><span class="op" id="8219953">(</span><span class="op" id="8219954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8219959">if</span>&nbsp;<span class="ident" id="8219962">sraw</span>&nbsp;<span class="op" id="8219967">!=</span>&nbsp;<span class="ident" id="8219970">tt</span><span class="op" id="8219972">.</span><span class="ident" id="8219973">WantWrite</span>&nbsp;<span class="op" id="8219983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8219989">t</span><span class="op" id="8219990">.</span><span class="ident" id="8219991">Errorf</span><span class="op" id="8219997">(</span><span class="string" id="8219998">&#34;Test&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="8220035">,</span>&nbsp;<span class="ident" id="8220037">i</span><span class="op" id="8220038">,</span>&nbsp;<span class="ident" id="8220040">tt</span><span class="op" id="8220042">.</span><span class="ident" id="8220043">WantWrite</span><span class="op" id="8220052">,</span>&nbsp;<span class="ident" id="8220054">sraw</span><span class="op" id="8220058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8220064">continue</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8220076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8220080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8220085">if</span>&nbsp;<span class="ident" id="8220088">tt</span><span class="op" id="8220090">.</span><span class="ident" id="8220091">WantProxy</span>&nbsp;<span class="op" id="8220101">!=</span>&nbsp;<span class="string" id="8220104">&#34;&#34;</span>&nbsp;<span class="op" id="8220107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8220112">setBody</span><span class="op" id="8220119">(</span><span class="op" id="8220120">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8220125">var</span>&nbsp;<span class="ident" id="8220129">praw</span>&nbsp;<span class="ident" id="8220134">bytes</span><span class="op" id="8220139">.</span><span class="ident" id="8220140">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8220150">err</span>&nbsp;<span class="op" id="8220154">=</span>&nbsp;<span class="ident" id="8220156">tt</span><span class="op" id="8220158">.</span><span class="ident" id="8220159">Req</span><span class="op" id="8220162">.</span><span class="ident" id="8220163">WriteProxy</span><span class="op" id="8220173">(</span><span class="op" id="8220174">&amp;</span><span class="ident" id="8220175">praw</span><span class="op" id="8220179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8220184">if</span>&nbsp;<span class="ident" id="8220187">err</span>&nbsp;<span class="op" id="8220191">!=</span>&nbsp;<span class="ident" id="8220194">nil</span>&nbsp;<span class="op" id="8220198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8220204">t</span><span class="op" id="8220205">.</span><span class="ident" id="8220206">Errorf</span><span class="op" id="8220212">(</span><span class="string" id="8220213">&#34;WriteProxy&nbsp;#%d:&nbsp;%s&#34;</span><span class="op" id="8220233">,</span>&nbsp;<span class="ident" id="8220235">i</span><span class="op" id="8220236">,</span>&nbsp;<span class="ident" id="8220238">err</span><span class="op" id="8220241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8220247">continue</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8220259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8220264">sraw</span>&nbsp;<span class="op" id="8220269">:=</span>&nbsp;<span class="ident" id="8220272">praw</span><span class="op" id="8220276">.</span><span class="ident" id="8220277">String</span><span class="op" id="8220283">(</span><span class="op" id="8220284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8220289">if</span>&nbsp;<span class="ident" id="8220292">sraw</span>&nbsp;<span class="op" id="8220297">!=</span>&nbsp;<span class="ident" id="8220300">tt</span><span class="op" id="8220302">.</span><span class="ident" id="8220303">WantProxy</span>&nbsp;<span class="op" id="8220313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8220319">t</span><span class="op" id="8220320">.</span><span class="ident" id="8220321">Errorf</span><span class="op" id="8220327">(</span><span class="string" id="8220328">&#34;Test&nbsp;Proxy&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="8220371">,</span>&nbsp;<span class="ident" id="8220373">i</span><span class="op" id="8220374">,</span>&nbsp;<span class="ident" id="8220376">tt</span><span class="op" id="8220378">.</span><span class="ident" id="8220379">WantProxy</span><span class="op" id="8220388">,</span>&nbsp;<span class="ident" id="8220390">sraw</span><span class="op" id="8220394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8220400">continue</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8220412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8220416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8220419">}</span><br>
<span class="lineno"></span><span class="op" id="8220421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="8220424">type</span>&nbsp;<span class="ident" id="8220429">closeChecker</span>&nbsp;<span class="keyword" id="8220442">struct</span>&nbsp;<span class="op" id="8220449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8220452">io</span><span class="op" id="8220454">.</span><span class="ident" id="8220455">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8220463">closed</span>&nbsp;<span class="builtintype" id="8220470">bool</span><br>
<span class="lineno"></span><span class="op" id="8220475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span><span class="keyword" id="8220478">func</span>&nbsp;<span class="op" id="8220483">(</span><span class="ident" id="8220484">rc</span>&nbsp;<span class="op" id="8220487">*</span><span class="ident" id="8220488">closeChecker</span><span class="op" id="8220500">)</span>&nbsp;<span class="ident" id="8220502">Close</span><span class="op" id="8220507">(</span><span class="op" id="8220508">)</span>&nbsp;<span class="builtintype" id="8220510">error</span>&nbsp;<span class="op" id="8220516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8220519">rc</span><span class="op" id="8220521">.</span><span class="ident" id="8220522">closed</span>&nbsp;<span class="op" id="8220529">=</span>&nbsp;<span class="builtintype" id="8220531">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8220537">return</span>&nbsp;<span class="ident" id="8220544">nil</span><br>
<span class="lineno"></span><span class="op" id="8220548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="8220551">//&nbsp;TestRequestWriteClosesBody&nbsp;tests&nbsp;that&nbsp;Request.Write&nbsp;does&nbsp;close&nbsp;its&nbsp;request.Body.</span><br>
<span class="lineno"></span><span class="comment" id="8220635">//&nbsp;It&nbsp;also&nbsp;indirectly&nbsp;tests&nbsp;NewRequest&nbsp;and&nbsp;that&nbsp;it&nbsp;doesn&#39;t&nbsp;wrap&nbsp;an&nbsp;existing&nbsp;Closer</span><br>
<span class="lineno"></span><span class="comment" id="8220718">//&nbsp;inside&nbsp;a&nbsp;NopCloser,&nbsp;and&nbsp;that&nbsp;it&nbsp;serializes&nbsp;it&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="keyword" id="8220778">func</span>&nbsp;<span class="ident" id="8220783">TestRequestWriteClosesBody</span><span class="op" id="8220809">(</span><span class="ident" id="8220810">t</span>&nbsp;<span class="op" id="8220812">*</span><span class="ident" id="8220813">testing</span><span class="op" id="8220820">.</span><span class="ident" id="8220821">T</span><span class="op" id="8220822">)</span>&nbsp;<span class="op" id="8220824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8220827">rc</span>&nbsp;<span class="op" id="8220830">:=</span>&nbsp;<span class="op" id="8220833">&amp;</span><span class="ident" id="8220834">closeChecker</span><span class="op" id="8220846">{</span><span class="ident" id="8220847">Reader</span><span class="op" id="8220853">:</span>&nbsp;<span class="ident" id="8220855">strings</span><span class="op" id="8220862">.</span><span class="ident" id="8220863">NewReader</span><span class="op" id="8220872">(</span><span class="string" id="8220873">&#34;my&nbsp;body&#34;</span><span class="op" id="8220882">)</span><span class="op" id="8220883">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8220886">req</span><span class="op" id="8220889">,</span>&nbsp;<span class="ident" id="8220891">_</span>&nbsp;<span class="op" id="8220893">:=</span>&nbsp;<span class="ident" id="8220896">NewRequest</span><span class="op" id="8220906">(</span><span class="string" id="8220907">&#34;POST&#34;</span><span class="op" id="8220913">,</span>&nbsp;<span class="string" id="8220915">&#34;http://foo.com/&#34;</span><span class="op" id="8220932">,</span>&nbsp;<span class="ident" id="8220934">rc</span><span class="op" id="8220936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8220939">if</span>&nbsp;<span class="ident" id="8220942">req</span><span class="op" id="8220945">.</span><span class="ident" id="8220946">ContentLength</span>&nbsp;<span class="op" id="8220960">!=</span>&nbsp;<span class="num" id="8220963">0</span>&nbsp;<span class="op" id="8220965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8220969">t</span><span class="op" id="8220970">.</span><span class="ident" id="8220971">Errorf</span><span class="op" id="8220977">(</span><span class="string" id="8220978">&#34;got&nbsp;req.ContentLength&nbsp;%d,&nbsp;want&nbsp;0&#34;</span><span class="op" id="8221012">,</span>&nbsp;<span class="ident" id="8221014">req</span><span class="op" id="8221017">.</span><span class="ident" id="8221018">ContentLength</span><span class="op" id="8221031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8221034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8221037">buf</span>&nbsp;<span class="op" id="8221041">:=</span>&nbsp;<span class="builtinfunc" id="8221044">new</span><span class="op" id="8221047">(</span><span class="ident" id="8221048">bytes</span><span class="op" id="8221053">.</span><span class="ident" id="8221054">Buffer</span><span class="op" id="8221060">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8221063">req</span><span class="op" id="8221066">.</span><span class="ident" id="8221067">Write</span><span class="op" id="8221072">(</span><span class="ident" id="8221073">buf</span><span class="op" id="8221076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8221079">if</span>&nbsp;<span class="op" id="8221082">!</span><span class="ident" id="8221083">rc</span><span class="op" id="8221085">.</span><span class="ident" id="8221086">closed</span>&nbsp;<span class="op" id="8221093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8221097">t</span><span class="op" id="8221098">.</span><span class="ident" id="8221099">Error</span><span class="op" id="8221104">(</span><span class="string" id="8221105">&#34;body&nbsp;not&nbsp;closed&nbsp;after&nbsp;write&#34;</span><span class="op" id="8221134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8221137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8221140">expected</span>&nbsp;<span class="op" id="8221149">:=</span>&nbsp;<span class="string" id="8221152">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8221174">+</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8221178">&#34;Host:&nbsp;foo.com\r\n&#34;</span>&nbsp;<span class="op" id="8221198">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8221202">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8221240">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8221244">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8221281">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8221285">//&nbsp;TODO:&nbsp;currently&nbsp;we&nbsp;don&#39;t&nbsp;buffer&nbsp;before&nbsp;chunking,&nbsp;so&nbsp;we&nbsp;get&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8221351">//&nbsp;single&nbsp;&#34;m&#34;&nbsp;chunk&nbsp;before&nbsp;the&nbsp;other&nbsp;chunks,&nbsp;as&nbsp;this&nbsp;was&nbsp;the&nbsp;1-byte</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8221421">//&nbsp;read&nbsp;from&nbsp;our&nbsp;MultiReader&nbsp;where&nbsp;we&nbsp;stiched&nbsp;the&nbsp;Body&nbsp;back&nbsp;together</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8221492">//&nbsp;after&nbsp;sniffing&nbsp;whether&nbsp;the&nbsp;Body&nbsp;was&nbsp;0&nbsp;bytes&nbsp;or&nbsp;not.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8221549">chunk</span><span class="op" id="8221554">(</span><span class="string" id="8221555">&#34;m&#34;</span><span class="op" id="8221558">)</span>&nbsp;<span class="op" id="8221560">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8221564">chunk</span><span class="op" id="8221569">(</span><span class="string" id="8221570">&#34;y&nbsp;body&#34;</span><span class="op" id="8221578">)</span>&nbsp;<span class="op" id="8221580">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8221584">chunk</span><span class="op" id="8221589">(</span><span class="string" id="8221590">&#34;&#34;</span><span class="op" id="8221592">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8221595">if</span>&nbsp;<span class="ident" id="8221598">buf</span><span class="op" id="8221601">.</span><span class="ident" id="8221602">String</span><span class="op" id="8221608">(</span><span class="op" id="8221609">)</span>&nbsp;<span class="op" id="8221611">!=</span>&nbsp;<span class="ident" id="8221614">expected</span>&nbsp;<span class="op" id="8221623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8221627">t</span><span class="op" id="8221628">.</span><span class="ident" id="8221629">Errorf</span><span class="op" id="8221635">(</span><span class="string" id="8221636">&#34;write:\n&nbsp;got:&nbsp;%s\nwant:&nbsp;%s&#34;</span><span class="op" id="8221664">,</span>&nbsp;<span class="ident" id="8221666">buf</span><span class="op" id="8221669">.</span><span class="ident" id="8221670">String</span><span class="op" id="8221676">(</span><span class="op" id="8221677">)</span><span class="op" id="8221678">,</span>&nbsp;<span class="ident" id="8221680">expected</span><span class="op" id="8221688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8221691">}</span><br>
<span class="lineno"></span><span class="op" id="8221693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">555</span><span class="keyword" id="8221696">func</span>&nbsp;<span class="ident" id="8221701">chunk</span><span class="op" id="8221706">(</span><span class="ident" id="8221707">s</span>&nbsp;<span class="builtintype" id="8221709">string</span><span class="op" id="8221715">)</span>&nbsp;<span class="builtintype" id="8221717">string</span>&nbsp;<span class="op" id="8221724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8221727">return</span>&nbsp;<span class="ident" id="8221734">fmt</span><span class="op" id="8221737">.</span><span class="ident" id="8221738">Sprintf</span><span class="op" id="8221745">(</span><span class="string" id="8221746">&#34;%x\r\n%s\r\n&#34;</span><span class="op" id="8221760">,</span>&nbsp;<span class="builtinfunc" id="8221762">len</span><span class="op" id="8221765">(</span><span class="ident" id="8221766">s</span><span class="op" id="8221767">)</span><span class="op" id="8221768">,</span>&nbsp;<span class="ident" id="8221770">s</span><span class="op" id="8221771">)</span><br>
<span class="lineno"></span><span class="op" id="8221773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8221776">func</span>&nbsp;<span class="ident" id="8221781">mustParseURL</span><span class="op" id="8221793">(</span><span class="ident" id="8221794">s</span>&nbsp;<span class="builtintype" id="8221796">string</span><span class="op" id="8221802">)</span>&nbsp;<span class="op" id="8221804">*</span><span class="ident" id="8221805">url</span><span class="op" id="8221808">.</span><span class="ident" id="8221809">URL</span>&nbsp;<span class="op" id="8221813">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8221816">u</span><span class="op" id="8221817">,</span>&nbsp;<span class="ident" id="8221819">err</span>&nbsp;<span class="op" id="8221823">:=</span>&nbsp;<span class="ident" id="8221826">url</span><span class="op" id="8221829">.</span><span class="ident" id="8221830">Parse</span><span class="op" id="8221835">(</span><span class="ident" id="8221836">s</span><span class="op" id="8221837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8221840">if</span>&nbsp;<span class="ident" id="8221843">err</span>&nbsp;<span class="op" id="8221847">!=</span>&nbsp;<span class="ident" id="8221850">nil</span>&nbsp;<span class="op" id="8221854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8221858">panic</span><span class="op" id="8221863">(</span><span class="ident" id="8221864">fmt</span><span class="op" id="8221867">.</span><span class="ident" id="8221868">Sprintf</span><span class="op" id="8221875">(</span><span class="string" id="8221876">&#34;Error&nbsp;parsing&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="8221902">,</span>&nbsp;<span class="ident" id="8221904">s</span><span class="op" id="8221905">,</span>&nbsp;<span class="ident" id="8221907">err</span><span class="op" id="8221910">)</span><span class="op" id="8221911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8221914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8221917">return</span>&nbsp;<span class="ident" id="8221924">u</span><br>
<span class="lineno">565</span><span class="op" id="8221926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8221929">type</span>&nbsp;<span class="ident" id="8221934">writerFunc</span>&nbsp;<span class="keyword" id="8221945">func</span><span class="op" id="8221949">(</span><span class="op" id="8221950">[</span><span class="op" id="8221951">]</span><span class="builtintype" id="8221952">byte</span><span class="op" id="8221956">)</span>&nbsp;<span class="op" id="8221958">(</span><span class="builtintype" id="8221959">int</span><span class="op" id="8221962">,</span>&nbsp;<span class="builtintype" id="8221964">error</span><span class="op" id="8221969">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8221972">func</span>&nbsp;<span class="op" id="8221977">(</span><span class="ident" id="8221978">f</span>&nbsp;<span class="ident" id="8221980">writerFunc</span><span class="op" id="8221990">)</span>&nbsp;<span class="ident" id="8221992">Write</span><span class="op" id="8221997">(</span><span class="ident" id="8221998">p</span>&nbsp;<span class="op" id="8222000">[</span><span class="op" id="8222001">]</span><span class="builtintype" id="8222002">byte</span><span class="op" id="8222006">)</span>&nbsp;<span class="op" id="8222008">(</span><span class="builtintype" id="8222009">int</span><span class="op" id="8222012">,</span>&nbsp;<span class="builtintype" id="8222014">error</span><span class="op" id="8222019">)</span>&nbsp;<span class="op" id="8222021">{</span>&nbsp;<span class="keyword" id="8222023">return</span>&nbsp;<span class="ident" id="8222030">f</span><span class="op" id="8222031">(</span><span class="ident" id="8222032">p</span><span class="op" id="8222033">)</span>&nbsp;<span class="op" id="8222035">}</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span><span class="comment" id="8222038">//&nbsp;TestRequestWriteError&nbsp;tests&nbsp;the&nbsp;Write&nbsp;err&nbsp;!=&nbsp;nil&nbsp;checks&nbsp;in&nbsp;(*Request).write.</span><br>
<span class="lineno"></span><span class="keyword" id="8222118">func</span>&nbsp;<span class="ident" id="8222123">TestRequestWriteError</span><span class="op" id="8222144">(</span><span class="ident" id="8222145">t</span>&nbsp;<span class="op" id="8222147">*</span><span class="ident" id="8222148">testing</span><span class="op" id="8222155">.</span><span class="ident" id="8222156">T</span><span class="op" id="8222157">)</span>&nbsp;<span class="op" id="8222159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8222162">failAfter</span><span class="op" id="8222171">,</span>&nbsp;<span class="ident" id="8222173">writeCount</span>&nbsp;<span class="op" id="8222184">:=</span>&nbsp;<span class="num" id="8222187">0</span><span class="op" id="8222188">,</span>&nbsp;<span class="num" id="8222190">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8222193">errFail</span>&nbsp;<span class="op" id="8222201">:=</span>&nbsp;<span class="ident" id="8222204">errors</span><span class="op" id="8222210">.</span><span class="ident" id="8222211">New</span><span class="op" id="8222214">(</span><span class="string" id="8222215">&#34;fake&nbsp;write&nbsp;failure&#34;</span><span class="op" id="8222235">)</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8222239">//&nbsp;w&nbsp;is&nbsp;the&nbsp;buffered&nbsp;io.Writer&nbsp;to&nbsp;write&nbsp;the&nbsp;request&nbsp;to.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8222300">//&nbsp;fails&nbsp;exactly&nbsp;once&nbsp;on&nbsp;its&nbsp;Nth&nbsp;Write&nbsp;call,&nbsp;as&nbsp;controlled&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8222363">//&nbsp;failAfter.&nbsp;It&nbsp;also&nbsp;tracks&nbsp;the&nbsp;number&nbsp;of&nbsp;calls&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8222416">//&nbsp;writeCount.</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8222432">w</span>&nbsp;<span class="op" id="8222434">:=</span>&nbsp;<span class="keyword" id="8222437">struct</span>&nbsp;<span class="op" id="8222444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8222448">io</span><span class="op" id="8222450">.</span><span class="ident" id="8222451">ByteWriter</span>&nbsp;<span class="comment" id="8222462">//&nbsp;to&nbsp;avoid&nbsp;being&nbsp;wrapped&nbsp;by&nbsp;a&nbsp;bufio.Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8222508">io</span><span class="op" id="8222510">.</span><span class="ident" id="8222511">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8222519">}</span><span class="op" id="8222520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8222524">nil</span><span class="op" id="8222527">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8222531">writerFunc</span><span class="op" id="8222541">(</span><span class="keyword" id="8222542">func</span><span class="op" id="8222546">(</span><span class="ident" id="8222547">p</span>&nbsp;<span class="op" id="8222549">[</span><span class="op" id="8222550">]</span><span class="builtintype" id="8222551">byte</span><span class="op" id="8222555">)</span>&nbsp;<span class="op" id="8222557">(</span><span class="ident" id="8222558">n</span>&nbsp;<span class="builtintype" id="8222560">int</span><span class="op" id="8222563">,</span>&nbsp;<span class="ident" id="8222565">err</span>&nbsp;<span class="builtintype" id="8222569">error</span><span class="op" id="8222574">)</span>&nbsp;<span class="op" id="8222576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8222581">writeCount</span><span class="op" id="8222591">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8222597">if</span>&nbsp;<span class="ident" id="8222600">failAfter</span>&nbsp;<span class="op" id="8222610">==</span>&nbsp;<span class="num" id="8222613">0</span>&nbsp;<span class="op" id="8222615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8222621">err</span>&nbsp;<span class="op" id="8222625">=</span>&nbsp;<span class="ident" id="8222627">errFail</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8222638">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8222643">failAfter</span><span class="op" id="8222652">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8222658">return</span>&nbsp;<span class="builtinfunc" id="8222665">len</span><span class="op" id="8222668">(</span><span class="ident" id="8222669">p</span><span class="op" id="8222670">)</span><span class="op" id="8222671">,</span>&nbsp;<span class="ident" id="8222673">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8222679">}</span><span class="op" id="8222680">)</span><span class="op" id="8222681">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8222684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8222688">req</span><span class="op" id="8222691">,</span>&nbsp;<span class="ident" id="8222693">_</span>&nbsp;<span class="op" id="8222695">:=</span>&nbsp;<span class="ident" id="8222698">NewRequest</span><span class="op" id="8222708">(</span><span class="string" id="8222709">&#34;GET&#34;</span><span class="op" id="8222714">,</span>&nbsp;<span class="string" id="8222716">&#34;http://example.com/&#34;</span><span class="op" id="8222737">,</span>&nbsp;<span class="ident" id="8222739">nil</span><span class="op" id="8222742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8222745">const</span>&nbsp;<span class="ident" id="8222751">writeCalls</span>&nbsp;<span class="op" id="8222762">=</span>&nbsp;<span class="num" id="8222764">4</span>&nbsp;<span class="comment" id="8222766">//&nbsp;number&nbsp;of&nbsp;Write&nbsp;calls&nbsp;in&nbsp;current&nbsp;implementation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8222818">sawGood</span>&nbsp;<span class="op" id="8222826">:=</span>&nbsp;<span class="builtintype" id="8222829">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8222836">for</span>&nbsp;<span class="ident" id="8222840">n</span>&nbsp;<span class="op" id="8222842">:=</span>&nbsp;<span class="num" id="8222845">0</span><span class="op" id="8222846">;</span>&nbsp;<span class="ident" id="8222848">n</span>&nbsp;<span class="op" id="8222850">&lt;=</span>&nbsp;<span class="ident" id="8222853">writeCalls</span><span class="op" id="8222863">+</span><span class="num" id="8222864">2</span><span class="op" id="8222865">;</span>&nbsp;<span class="ident" id="8222867">n</span><span class="op" id="8222868">++</span>&nbsp;<span class="op" id="8222871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8222875">failAfter</span>&nbsp;<span class="op" id="8222885">=</span>&nbsp;<span class="ident" id="8222887">n</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8222891">writeCount</span>&nbsp;<span class="op" id="8222902">=</span>&nbsp;<span class="num" id="8222904">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8222908">err</span>&nbsp;<span class="op" id="8222912">:=</span>&nbsp;<span class="ident" id="8222915">req</span><span class="op" id="8222918">.</span><span class="ident" id="8222919">Write</span><span class="op" id="8222924">(</span><span class="ident" id="8222925">w</span><span class="op" id="8222926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8222930">var</span>&nbsp;<span class="ident" id="8222934">wantErr</span>&nbsp;<span class="builtintype" id="8222942">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8222950">if</span>&nbsp;<span class="ident" id="8222953">n</span>&nbsp;<span class="op" id="8222955">&lt;</span>&nbsp;<span class="ident" id="8222957">writeCalls</span>&nbsp;<span class="op" id="8222968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8222973">wantErr</span>&nbsp;<span class="op" id="8222981">=</span>&nbsp;<span class="ident" id="8222983">errFail</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8222993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8222997">if</span>&nbsp;<span class="ident" id="8223000">err</span>&nbsp;<span class="op" id="8223004">!=</span>&nbsp;<span class="ident" id="8223007">wantErr</span>&nbsp;<span class="op" id="8223015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8223020">t</span><span class="op" id="8223021">.</span><span class="ident" id="8223022">Errorf</span><span class="op" id="8223028">(</span><span class="string" id="8223029">&#34;for&nbsp;fail-after&nbsp;%d&nbsp;Writes,&nbsp;err&nbsp;=&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8223074">,</span>&nbsp;<span class="ident" id="8223076">n</span><span class="op" id="8223077">,</span>&nbsp;<span class="ident" id="8223079">err</span><span class="op" id="8223082">,</span>&nbsp;<span class="ident" id="8223084">wantErr</span><span class="op" id="8223091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8223096">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8223107">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8223111">if</span>&nbsp;<span class="ident" id="8223114">err</span>&nbsp;<span class="op" id="8223118">==</span>&nbsp;<span class="ident" id="8223121">nil</span>&nbsp;<span class="op" id="8223125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8223130">sawGood</span>&nbsp;<span class="op" id="8223138">=</span>&nbsp;<span class="builtintype" id="8223140">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8223148">if</span>&nbsp;<span class="ident" id="8223151">writeCount</span>&nbsp;<span class="op" id="8223162">!=</span>&nbsp;<span class="ident" id="8223165">writeCalls</span>&nbsp;<span class="op" id="8223176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8223182">t</span><span class="op" id="8223183">.</span><span class="ident" id="8223184">Fatalf</span><span class="op" id="8223190">(</span><span class="string" id="8223191">&#34;writeCalls&nbsp;constant&nbsp;is&nbsp;outdated&nbsp;in&nbsp;test&#34;</span><span class="op" id="8223232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8223237">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8223241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8223245">if</span>&nbsp;<span class="ident" id="8223248">writeCount</span>&nbsp;<span class="op" id="8223259">&gt;</span>&nbsp;<span class="ident" id="8223261">writeCalls</span>&nbsp;<span class="op" id="8223272">||</span>&nbsp;<span class="ident" id="8223275">writeCount</span>&nbsp;<span class="op" id="8223286">&gt;</span>&nbsp;<span class="ident" id="8223288">n</span><span class="op" id="8223289">+</span><span class="num" id="8223290">1</span>&nbsp;<span class="op" id="8223292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8223297">t</span><span class="op" id="8223298">.</span><span class="ident" id="8223299">Errorf</span><span class="op" id="8223305">(</span><span class="string" id="8223306">&#34;for&nbsp;fail-after&nbsp;%d,&nbsp;saw&nbsp;unexpectedly&nbsp;high&nbsp;(%d)&nbsp;write&nbsp;calls&#34;</span><span class="op" id="8223365">,</span>&nbsp;<span class="ident" id="8223367">n</span><span class="op" id="8223368">,</span>&nbsp;<span class="ident" id="8223370">writeCount</span><span class="op" id="8223380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8223384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8223387">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8223390">if</span>&nbsp;<span class="op" id="8223393">!</span><span class="ident" id="8223394">sawGood</span>&nbsp;<span class="op" id="8223402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8223406">t</span><span class="op" id="8223407">.</span><span class="ident" id="8223408">Fatalf</span><span class="op" id="8223414">(</span><span class="string" id="8223415">&#34;writeCalls&nbsp;constant&nbsp;is&nbsp;outdated&nbsp;in&nbsp;test&#34;</span><span class="op" id="8223456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8223459">}</span><br>
<span class="lineno"></span><span class="op" id="8223461">}</span>
</div>
</body>
</html>
