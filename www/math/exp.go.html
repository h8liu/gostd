<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1990998">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1991053">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1991107">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1991158">package</span>&nbsp;<span class="ident" id="1991166">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1991172">//&nbsp;Exp&nbsp;returns&nbsp;e**x,&nbsp;the&nbsp;base-e&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1991222">//</span><br>
<span class="lineno"></span><span class="comment" id="1991225">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">10</span><span class="comment" id="1991247">//&nbsp;&nbsp;&nbsp;&nbspExp(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="1991267">//&nbsp;&nbsp;&nbsp;&nbspExp(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="1991285">//&nbsp;Very&nbsp;large&nbsp;values&nbsp;overflow&nbsp;to&nbsp;0&nbsp;or&nbsp;+Inf.</span><br>
<span class="lineno"></span><span class="comment" id="1991329">//&nbsp;Very&nbsp;small&nbsp;values&nbsp;underflow&nbsp;to&nbsp;1.</span><br>
<span class="lineno"></span><span class="keyword" id="1991366">func</span>&nbsp;<span class="ident" id="1991371">Exp</span><span class="op" id="1991374">(</span><span class="ident" id="1991375">x</span>&nbsp;<span class="builtintype" id="1991377">float64</span><span class="op" id="1991384">)</span>&nbsp;<span class="builtintype" id="1991386">float64</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="1991395">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="1991455">//&nbsp;below&nbsp;are&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_exp.c</span><br>
<span class="lineno"></span><span class="comment" id="1991513">//&nbsp;and&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="1991572">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">20</span><span class="comment" id="1991602">//</span><br>
<span class="lineno"></span><span class="comment" id="1991605">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1991661">//&nbsp;Copyright&nbsp;(C)&nbsp;2004&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1991730">//</span><br>
<span class="lineno"></span><span class="comment" id="1991733">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno">25</span><span class="comment" id="1991789">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="1991846">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="1991863">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1991919">//</span><br>
<span class="lineno"></span><span class="comment" id="1991922">//</span><br>
<span class="lineno">30</span><span class="comment" id="1991925">//&nbsp;exp(x)</span><br>
<span class="lineno"></span><span class="comment" id="1991935">//&nbsp;Returns&nbsp;the&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1991968">//</span><br>
<span class="lineno"></span><span class="comment" id="1991971">//&nbsp;Method</span><br>
<span class="lineno"></span><span class="comment" id="1991981">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;reduction:</span><br>
<span class="lineno">35</span><span class="comment" id="1992009">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reduce&nbsp;x&nbsp;to&nbsp;an&nbsp;r&nbsp;so&nbsp;that&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2&nbsp;~&nbsp;0.34658.</span><br>
<span class="lineno"></span><span class="comment" id="1992068">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Given&nbsp;x,&nbsp;find&nbsp;r&nbsp;and&nbsp;integer&nbsp;k&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1992116">//</span><br>
<span class="lineno"></span><span class="comment" id="1992119">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;k*ln2&nbsp;+&nbsp;r,&nbsp;&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2.</span><br>
<span class="lineno"></span><span class="comment" id="1992168">//</span><br>
<span class="lineno">40</span><span class="comment" id="1992171">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;r&nbsp;will&nbsp;be&nbsp;represented&nbsp;as&nbsp;r&nbsp;=&nbsp;hi-lo&nbsp;for&nbsp;better</span><br>
<span class="lineno"></span><span class="comment" id="1992230">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accuracy.</span><br>
<span class="lineno"></span><span class="comment" id="1992248">//</span><br>
<span class="lineno"></span><span class="comment" id="1992251">//&nbsp;&nbsp;&nbsp;2.&nbsp;Approximation&nbsp;of&nbsp;exp(r)&nbsp;by&nbsp;a&nbsp;special&nbsp;rational&nbsp;function&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="1992317">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;interval&nbsp;[0,0.34658]:</span><br>
<span class="lineno">45</span><span class="comment" id="1992351">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write</span><br>
<span class="lineno"></span><span class="comment" id="1992365">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(r**2)&nbsp;=&nbsp;r*(exp(r)+1)/(exp(r)-1)&nbsp;=&nbsp;2&nbsp;+&nbsp;r*r/6&nbsp;-&nbsp;r**4/360&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="1992440">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;a&nbsp;special&nbsp;Remes&nbsp;algorithm&nbsp;on&nbsp;[0,0.34658]&nbsp;to&nbsp;generate</span><br>
<span class="lineno"></span><span class="comment" id="1992508">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;polynomial&nbsp;of&nbsp;degree&nbsp;5&nbsp;to&nbsp;approximate&nbsp;R.&nbsp;The&nbsp;maximum&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="1992577">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;this&nbsp;polynomial&nbsp;approximation&nbsp;is&nbsp;bounded&nbsp;by&nbsp;2**-59.&nbsp;In</span><br>
<span class="lineno">50</span><span class="comment" id="1992643">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other&nbsp;words,</span><br>
<span class="lineno"></span><span class="comment" id="1992664">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(z)&nbsp;~&nbsp;2.0&nbsp;+&nbsp;P1*z&nbsp;+&nbsp;P2*z**2&nbsp;+&nbsp;P3*z**3&nbsp;+&nbsp;P4*z**4&nbsp;+&nbsp;P5*z**5</span><br>
<span class="lineno"></span><span class="comment" id="1992734">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(where&nbsp;z=r*r,&nbsp;and&nbsp;the&nbsp;values&nbsp;of&nbsp;P1&nbsp;to&nbsp;P5&nbsp;are&nbsp;listed&nbsp;below)</span><br>
<span class="lineno"></span><span class="comment" id="1992801">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1992813">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-59</span><br>
<span class="lineno">55</span><span class="comment" id="1992865">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2.0+P1*z+...+P5*z&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;R(z)&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="1992914">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br>
<span class="lineno"></span><span class="comment" id="1992958">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;computation&nbsp;of&nbsp;exp(r)&nbsp;thus&nbsp;becomes</span><br>
<span class="lineno"></span><span class="comment" id="1993005">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2*r</span><br>
<span class="lineno"></span><span class="comment" id="1993040">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(r)&nbsp;=&nbsp;1&nbsp;+&nbsp;-------</span><br>
<span class="lineno">60</span><span class="comment" id="1993077">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;-&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="1993113">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r*R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="1993156">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;+&nbsp;r&nbsp;+&nbsp;-----------&nbsp;(for&nbsp;better&nbsp;accuracy)</span><br>
<span class="lineno"></span><span class="comment" id="1993223">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;-&nbsp;R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="1993267">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno">65</span><span class="comment" id="1993281">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10</span><br>
<span class="lineno"></span><span class="comment" id="1993339">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(r)&nbsp;=&nbsp;r&nbsp;-&nbsp;(P1*r&nbsp;&nbsp;+&nbsp;P2*r&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;P5*r&nbsp;&nbsp;&nbsp;).</span><br>
<span class="lineno"></span><span class="comment" id="1993400">//</span><br>
<span class="lineno"></span><span class="comment" id="1993403">//&nbsp;&nbsp;&nbsp;3.&nbsp;Scale&nbsp;back&nbsp;to&nbsp;obtain&nbsp;exp(x):</span><br>
<span class="lineno"></span><span class="comment" id="1993440">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From&nbsp;step&nbsp;1,&nbsp;we&nbsp;have</span><br>
<span class="lineno">70</span><span class="comment" id="1993469">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(x)&nbsp;=&nbsp;2**k&nbsp;*&nbsp;exp(r)</span><br>
<span class="lineno"></span><span class="comment" id="1993503">//</span><br>
<span class="lineno"></span><span class="comment" id="1993506">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="1993524">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(INF)&nbsp;is&nbsp;INF,&nbsp;exp(NaN)&nbsp;is&nbsp;NaN;</span><br>
<span class="lineno"></span><span class="comment" id="1993566">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-INF)&nbsp;is&nbsp;0,&nbsp;and</span><br>
<span class="lineno">75</span><span class="comment" id="1993594">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;finite&nbsp;argument,&nbsp;only&nbsp;exp(0)=1&nbsp;is&nbsp;exact.</span><br>
<span class="lineno"></span><span class="comment" id="1993647">//</span><br>
<span class="lineno"></span><span class="comment" id="1993650">//&nbsp;Accuracy:</span><br>
<span class="lineno"></span><span class="comment" id="1993663">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;according&nbsp;to&nbsp;an&nbsp;error&nbsp;analysis,&nbsp;the&nbsp;error&nbsp;is&nbsp;always&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="1993733">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;ulp&nbsp;(unit&nbsp;in&nbsp;the&nbsp;last&nbsp;place).</span><br>
<span class="lineno">80</span><span class="comment" id="1993773">//</span><br>
<span class="lineno"></span><span class="comment" id="1993776">//&nbsp;Misc.&nbsp;info.</span><br>
<span class="lineno"></span><span class="comment" id="1993791">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;IEEE&nbsp;double</span><br>
<span class="lineno"></span><span class="comment" id="1993815">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;&nbsp;7.09782712893383973096e+02&nbsp;then&nbsp;exp(x)&nbsp;overflow</span><br>
<span class="lineno"></span><span class="comment" id="1993883">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;-7.45133219101941108420e+02&nbsp;then&nbsp;exp(x)&nbsp;underflow</span><br>
<span class="lineno">85</span><span class="comment" id="1993952">//</span><br>
<span class="lineno"></span><span class="comment" id="1993955">//&nbsp;Constants:</span><br>
<span class="lineno"></span><span class="comment" id="1993969">//&nbsp;The&nbsp;hexadecimal&nbsp;values&nbsp;are&nbsp;the&nbsp;intended&nbsp;ones&nbsp;for&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="1994035">//&nbsp;constants.&nbsp;The&nbsp;decimal&nbsp;values&nbsp;may&nbsp;be&nbsp;used,&nbsp;provided&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1994099">//&nbsp;compiler&nbsp;will&nbsp;convert&nbsp;from&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;accurately&nbsp;enough</span><br>
<span class="lineno">90</span><span class="comment" id="1994165">//&nbsp;to&nbsp;produce&nbsp;the&nbsp;hexadecimal&nbsp;values&nbsp;shown.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1994210">func</span>&nbsp;<span class="ident" id="1994215">exp</span><span class="op" id="1994218">(</span><span class="ident" id="1994219">x</span>&nbsp;<span class="builtintype" id="1994221">float64</span><span class="op" id="1994228">)</span>&nbsp;<span class="builtintype" id="1994230">float64</span>&nbsp;<span class="op" id="1994238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994241">const</span>&nbsp;<span class="op" id="1994247">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994251">Ln2Hi</span>&nbsp;<span class="op" id="1994257">=</span>&nbsp;<span class="num" id="1994259">6.93147180369123816490e-01</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994288">Ln2Lo</span>&nbsp;<span class="op" id="1994294">=</span>&nbsp;<span class="num" id="1994296">1.90821492927058770002e-10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994325">Log2e</span>&nbsp;<span class="op" id="1994331">=</span>&nbsp;<span class="num" id="1994333">1.44269504088896338700e+00</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994363">Overflow</span>&nbsp;&nbsp;<span class="op" id="1994373">=</span>&nbsp;<span class="num" id="1994375">7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994404">Underflow</span>&nbsp;<span class="op" id="1994414">=</span>&nbsp;<span class="op" id="1994416">-</span><span class="num" id="1994417">7.45133219101941108420e+02</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994446">NearZero</span>&nbsp;&nbsp;<span class="op" id="1994456">=</span>&nbsp;<span class="num" id="1994458">1.0</span>&nbsp;<span class="op" id="1994462">/</span>&nbsp;<span class="op" id="1994464">(</span><span class="num" id="1994465">1</span>&nbsp;<span class="op" id="1994467">&lt;&lt;</span>&nbsp;<span class="num" id="1994470">28</span><span class="op" id="1994472">)</span>&nbsp;<span class="comment" id="1994474">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1994485">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1994489">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994507">switch</span>&nbsp;<span class="op" id="1994514">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994517">case</span>&nbsp;<span class="ident" id="1994522">IsNaN</span><span class="op" id="1994527">(</span><span class="ident" id="1994528">x</span><span class="op" id="1994529">)</span>&nbsp;<span class="op" id="1994531">||</span>&nbsp;<span class="ident" id="1994534">IsInf</span><span class="op" id="1994539">(</span><span class="ident" id="1994540">x</span><span class="op" id="1994541">,</span>&nbsp;<span class="num" id="1994543">1</span><span class="op" id="1994544">)</span><span class="op" id="1994545">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994549">return</span>&nbsp;<span class="ident" id="1994556">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994559">case</span>&nbsp;<span class="ident" id="1994564">IsInf</span><span class="op" id="1994569">(</span><span class="ident" id="1994570">x</span><span class="op" id="1994571">,</span>&nbsp;<span class="op" id="1994573">-</span><span class="num" id="1994574">1</span><span class="op" id="1994575">)</span><span class="op" id="1994576">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994580">return</span>&nbsp;<span class="num" id="1994587">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994590">case</span>&nbsp;<span class="ident" id="1994595">x</span>&nbsp;<span class="op" id="1994597">&gt;</span>&nbsp;<span class="ident" id="1994599">Overflow</span><span class="op" id="1994607">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994611">return</span>&nbsp;<span class="ident" id="1994618">Inf</span><span class="op" id="1994621">(</span><span class="num" id="1994622">1</span><span class="op" id="1994623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994626">case</span>&nbsp;<span class="ident" id="1994631">x</span>&nbsp;<span class="op" id="1994633">&lt;</span>&nbsp;<span class="ident" id="1994635">Underflow</span><span class="op" id="1994644">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994648">return</span>&nbsp;<span class="num" id="1994655">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994658">case</span>&nbsp;<span class="op" id="1994663">-</span><span class="ident" id="1994664">NearZero</span>&nbsp;<span class="op" id="1994673">&lt;</span>&nbsp;<span class="ident" id="1994675">x</span>&nbsp;<span class="op" id="1994677">&amp;&amp;</span>&nbsp;<span class="ident" id="1994680">x</span>&nbsp;<span class="op" id="1994682">&lt;</span>&nbsp;<span class="ident" id="1994684">NearZero</span><span class="op" id="1994692">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994696">return</span>&nbsp;<span class="num" id="1994703">1</span>&nbsp;<span class="op" id="1994705">+</span>&nbsp;<span class="ident" id="1994707">x</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1994710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1994714">//&nbsp;reduce;&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994771">var</span>&nbsp;<span class="ident" id="1994775">k</span>&nbsp;<span class="builtintype" id="1994777">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994782">switch</span>&nbsp;<span class="op" id="1994789">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994792">case</span>&nbsp;<span class="ident" id="1994797">x</span>&nbsp;<span class="op" id="1994799">&lt;</span>&nbsp;<span class="num" id="1994801">0</span><span class="op" id="1994802">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994806">k</span>&nbsp;<span class="op" id="1994808">=</span>&nbsp;<span class="builtintype" id="1994810">int</span><span class="op" id="1994813">(</span><span class="ident" id="1994814">Log2e</span><span class="op" id="1994819">*</span><span class="ident" id="1994820">x</span>&nbsp;<span class="op" id="1994822">-</span>&nbsp;<span class="num" id="1994824">0.5</span><span class="op" id="1994827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994830">case</span>&nbsp;<span class="ident" id="1994835">x</span>&nbsp;<span class="op" id="1994837">&gt;</span>&nbsp;<span class="num" id="1994839">0</span><span class="op" id="1994840">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994844">k</span>&nbsp;<span class="op" id="1994846">=</span>&nbsp;<span class="builtintype" id="1994848">int</span><span class="op" id="1994851">(</span><span class="ident" id="1994852">Log2e</span><span class="op" id="1994857">*</span><span class="ident" id="1994858">x</span>&nbsp;<span class="op" id="1994860">+</span>&nbsp;<span class="num" id="1994862">0.5</span><span class="op" id="1994865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1994868">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994871">hi</span>&nbsp;<span class="op" id="1994874">:=</span>&nbsp;<span class="ident" id="1994877">x</span>&nbsp;<span class="op" id="1994879">-</span>&nbsp;<span class="builtintype" id="1994881">float64</span><span class="op" id="1994888">(</span><span class="ident" id="1994889">k</span><span class="op" id="1994890">)</span><span class="op" id="1994891">*</span><span class="ident" id="1994892">Ln2Hi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1994899">lo</span>&nbsp;<span class="op" id="1994902">:=</span>&nbsp;<span class="builtintype" id="1994905">float64</span><span class="op" id="1994912">(</span><span class="ident" id="1994913">k</span><span class="op" id="1994914">)</span>&nbsp;<span class="op" id="1994916">*</span>&nbsp;<span class="ident" id="1994918">Ln2Lo</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1994926">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1994938">return</span>&nbsp;<span class="ident" id="1994945">expmulti</span><span class="op" id="1994953">(</span><span class="ident" id="1994954">hi</span><span class="op" id="1994956">,</span>&nbsp;<span class="ident" id="1994958">lo</span><span class="op" id="1994960">,</span>&nbsp;<span class="ident" id="1994962">k</span><span class="op" id="1994963">)</span><br>
<span class="lineno">130</span><span class="op" id="1994965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1994968">//&nbsp;Exp2&nbsp;returns&nbsp;2**x,&nbsp;the&nbsp;base-2&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1995019">//</span><br>
<span class="lineno"></span><span class="comment" id="1995022">//&nbsp;Special&nbsp;cases&nbsp;are&nbsp;the&nbsp;same&nbsp;as&nbsp;Exp.</span><br>
<span class="lineno">135</span><span class="keyword" id="1995060">func</span>&nbsp;<span class="ident" id="1995065">Exp2</span><span class="op" id="1995069">(</span><span class="ident" id="1995070">x</span>&nbsp;<span class="builtintype" id="1995072">float64</span><span class="op" id="1995079">)</span>&nbsp;<span class="builtintype" id="1995081">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1995090">func</span>&nbsp;<span class="ident" id="1995095">exp2</span><span class="op" id="1995099">(</span><span class="ident" id="1995100">x</span>&nbsp;<span class="builtintype" id="1995102">float64</span><span class="op" id="1995109">)</span>&nbsp;<span class="builtintype" id="1995111">float64</span>&nbsp;<span class="op" id="1995119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995122">const</span>&nbsp;<span class="op" id="1995128">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995132">Ln2Hi</span>&nbsp;<span class="op" id="1995138">=</span>&nbsp;<span class="num" id="1995140">6.93147180369123816490e-01</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995169">Ln2Lo</span>&nbsp;<span class="op" id="1995175">=</span>&nbsp;<span class="num" id="1995177">1.90821492927058770002e-10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995207">Overflow</span>&nbsp;&nbsp;<span class="op" id="1995217">=</span>&nbsp;<span class="num" id="1995219">1.0239999999999999e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995244">Underflow</span>&nbsp;<span class="op" id="1995254">=</span>&nbsp;<span class="op" id="1995256">-</span><span class="num" id="1995257">1.0740e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1995269">)</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1995273">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995291">switch</span>&nbsp;<span class="op" id="1995298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995301">case</span>&nbsp;<span class="ident" id="1995306">IsNaN</span><span class="op" id="1995311">(</span><span class="ident" id="1995312">x</span><span class="op" id="1995313">)</span>&nbsp;<span class="op" id="1995315">||</span>&nbsp;<span class="ident" id="1995318">IsInf</span><span class="op" id="1995323">(</span><span class="ident" id="1995324">x</span><span class="op" id="1995325">,</span>&nbsp;<span class="num" id="1995327">1</span><span class="op" id="1995328">)</span><span class="op" id="1995329">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995333">return</span>&nbsp;<span class="ident" id="1995340">x</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995343">case</span>&nbsp;<span class="ident" id="1995348">IsInf</span><span class="op" id="1995353">(</span><span class="ident" id="1995354">x</span><span class="op" id="1995355">,</span>&nbsp;<span class="op" id="1995357">-</span><span class="num" id="1995358">1</span><span class="op" id="1995359">)</span><span class="op" id="1995360">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995364">return</span>&nbsp;<span class="num" id="1995371">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995374">case</span>&nbsp;<span class="ident" id="1995379">x</span>&nbsp;<span class="op" id="1995381">&gt;</span>&nbsp;<span class="ident" id="1995383">Overflow</span><span class="op" id="1995391">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995395">return</span>&nbsp;<span class="ident" id="1995402">Inf</span><span class="op" id="1995405">(</span><span class="num" id="1995406">1</span><span class="op" id="1995407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995410">case</span>&nbsp;<span class="ident" id="1995415">x</span>&nbsp;<span class="op" id="1995417">&lt;</span>&nbsp;<span class="ident" id="1995419">Underflow</span><span class="op" id="1995428">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995432">return</span>&nbsp;<span class="num" id="1995439">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1995442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1995446">//&nbsp;argument&nbsp;reduction;&nbsp;x&nbsp;=&nbsp;r×lg(e)&nbsp;+&nbsp;k&nbsp;with&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1995509">//&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995558">var</span>&nbsp;<span class="ident" id="1995562">k</span>&nbsp;<span class="builtintype" id="1995564">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995569">switch</span>&nbsp;<span class="op" id="1995576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995579">case</span>&nbsp;<span class="ident" id="1995584">x</span>&nbsp;<span class="op" id="1995586">&gt;</span>&nbsp;<span class="num" id="1995588">0</span><span class="op" id="1995589">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995593">k</span>&nbsp;<span class="op" id="1995595">=</span>&nbsp;<span class="builtintype" id="1995597">int</span><span class="op" id="1995600">(</span><span class="ident" id="1995601">x</span>&nbsp;<span class="op" id="1995603">+</span>&nbsp;<span class="num" id="1995605">0.5</span><span class="op" id="1995608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995611">case</span>&nbsp;<span class="ident" id="1995616">x</span>&nbsp;<span class="op" id="1995618">&lt;</span>&nbsp;<span class="num" id="1995620">0</span><span class="op" id="1995621">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995625">k</span>&nbsp;<span class="op" id="1995627">=</span>&nbsp;<span class="builtintype" id="1995629">int</span><span class="op" id="1995632">(</span><span class="ident" id="1995633">x</span>&nbsp;<span class="op" id="1995635">-</span>&nbsp;<span class="num" id="1995637">0.5</span><span class="op" id="1995640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1995643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995646">t</span>&nbsp;<span class="op" id="1995648">:=</span>&nbsp;<span class="ident" id="1995651">x</span>&nbsp;<span class="op" id="1995653">-</span>&nbsp;<span class="builtintype" id="1995655">float64</span><span class="op" id="1995662">(</span><span class="ident" id="1995663">k</span><span class="op" id="1995664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995667">hi</span>&nbsp;<span class="op" id="1995670">:=</span>&nbsp;<span class="ident" id="1995673">t</span>&nbsp;<span class="op" id="1995675">*</span>&nbsp;<span class="ident" id="1995677">Ln2Hi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995684">lo</span>&nbsp;<span class="op" id="1995687">:=</span>&nbsp;<span class="op" id="1995690">-</span><span class="ident" id="1995691">t</span>&nbsp;<span class="op" id="1995693">*</span>&nbsp;<span class="ident" id="1995695">Ln2Lo</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1995703">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995715">return</span>&nbsp;<span class="ident" id="1995722">expmulti</span><span class="op" id="1995730">(</span><span class="ident" id="1995731">hi</span><span class="op" id="1995733">,</span>&nbsp;<span class="ident" id="1995735">lo</span><span class="op" id="1995737">,</span>&nbsp;<span class="ident" id="1995739">k</span><span class="op" id="1995740">)</span><br>
<span class="lineno"></span><span class="op" id="1995742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="1995745">//&nbsp;exp1&nbsp;returns&nbsp;e**r&nbsp;×&nbsp;2**k&nbsp;where&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;and&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span><span class="keyword" id="1995813">func</span>&nbsp;<span class="ident" id="1995818">expmulti</span><span class="op" id="1995826">(</span><span class="ident" id="1995827">hi</span><span class="op" id="1995829">,</span>&nbsp;<span class="ident" id="1995831">lo</span>&nbsp;<span class="builtintype" id="1995834">float64</span><span class="op" id="1995841">,</span>&nbsp;<span class="ident" id="1995843">k</span>&nbsp;<span class="builtintype" id="1995845">int</span><span class="op" id="1995848">)</span>&nbsp;<span class="builtintype" id="1995850">float64</span>&nbsp;<span class="op" id="1995858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1995861">const</span>&nbsp;<span class="op" id="1995867">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995871">P1</span>&nbsp;<span class="op" id="1995874">=</span>&nbsp;<span class="num" id="1995876">1.66666666666666019037e-01</span>&nbsp;&nbsp;<span class="comment" id="1995904">/*&nbsp;0x3FC55555;&nbsp;0x5555553E&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995935">P2</span>&nbsp;<span class="op" id="1995938">=</span>&nbsp;<span class="op" id="1995940">-</span><span class="num" id="1995941">2.77777777770155933842e-03</span>&nbsp;<span class="comment" id="1995968">/*&nbsp;0xBF66C16C;&nbsp;0x16BEBD93&nbsp;*/</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1995999">P3</span>&nbsp;<span class="op" id="1996002">=</span>&nbsp;<span class="num" id="1996004">6.61375632143793436117e-05</span>&nbsp;&nbsp;<span class="comment" id="1996032">/*&nbsp;0x3F11566A;&nbsp;0xAF25DE2C&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996063">P4</span>&nbsp;<span class="op" id="1996066">=</span>&nbsp;<span class="op" id="1996068">-</span><span class="num" id="1996069">1.65339022054652515390e-06</span>&nbsp;<span class="comment" id="1996096">/*&nbsp;0xBEBBBD41;&nbsp;0xC5D26BF1&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996127">P5</span>&nbsp;<span class="op" id="1996130">=</span>&nbsp;<span class="num" id="1996132">4.13813679705723846039e-08</span>&nbsp;&nbsp;<span class="comment" id="1996160">/*&nbsp;0x3E663769;&nbsp;0x72BEA4D0&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1996190">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996194">r</span>&nbsp;<span class="op" id="1996196">:=</span>&nbsp;<span class="ident" id="1996199">hi</span>&nbsp;<span class="op" id="1996202">-</span>&nbsp;<span class="ident" id="1996204">lo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996208">t</span>&nbsp;<span class="op" id="1996210">:=</span>&nbsp;<span class="ident" id="1996213">r</span>&nbsp;<span class="op" id="1996215">*</span>&nbsp;<span class="ident" id="1996217">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996220">c</span>&nbsp;<span class="op" id="1996222">:=</span>&nbsp;<span class="ident" id="1996225">r</span>&nbsp;<span class="op" id="1996227">-</span>&nbsp;<span class="ident" id="1996229">t</span><span class="op" id="1996230">*</span><span class="op" id="1996231">(</span><span class="ident" id="1996232">P1</span><span class="op" id="1996234">+</span><span class="ident" id="1996235">t</span><span class="op" id="1996236">*</span><span class="op" id="1996237">(</span><span class="ident" id="1996238">P2</span><span class="op" id="1996240">+</span><span class="ident" id="1996241">t</span><span class="op" id="1996242">*</span><span class="op" id="1996243">(</span><span class="ident" id="1996244">P3</span><span class="op" id="1996246">+</span><span class="ident" id="1996247">t</span><span class="op" id="1996248">*</span><span class="op" id="1996249">(</span><span class="ident" id="1996250">P4</span><span class="op" id="1996252">+</span><span class="ident" id="1996253">t</span><span class="op" id="1996254">*</span><span class="ident" id="1996255">P5</span><span class="op" id="1996257">)</span><span class="op" id="1996258">)</span><span class="op" id="1996259">)</span><span class="op" id="1996260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1996263">y</span>&nbsp;<span class="op" id="1996265">:=</span>&nbsp;<span class="num" id="1996268">1</span>&nbsp;<span class="op" id="1996270">-</span>&nbsp;<span class="op" id="1996272">(</span><span class="op" id="1996273">(</span><span class="ident" id="1996274">lo</span>&nbsp;<span class="op" id="1996277">-</span>&nbsp;<span class="op" id="1996279">(</span><span class="ident" id="1996280">r</span><span class="op" id="1996281">*</span><span class="ident" id="1996282">c</span><span class="op" id="1996283">)</span><span class="op" id="1996284">/</span><span class="op" id="1996285">(</span><span class="num" id="1996286">2</span><span class="op" id="1996287">-</span><span class="ident" id="1996288">c</span><span class="op" id="1996289">)</span><span class="op" id="1996290">)</span>&nbsp;<span class="op" id="1996292">-</span>&nbsp;<span class="ident" id="1996294">hi</span><span class="op" id="1996296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1996299">//&nbsp;TODO(rsc):&nbsp;make&nbsp;sure&nbsp;Ldexp&nbsp;can&nbsp;handle&nbsp;boundary&nbsp;k</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1996352">return</span>&nbsp;<span class="ident" id="1996359">Ldexp</span><span class="op" id="1996364">(</span><span class="ident" id="1996365">y</span><span class="op" id="1996366">,</span>&nbsp;<span class="ident" id="1996368">k</span><span class="op" id="1996369">)</span><br>
<span class="lineno"></span><span class="op" id="1996371">}</span>
</div>
</body>
</html>
