<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6950945">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6951001">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6951055">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6951106">//&nbsp;+build&nbsp;!plan9</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6951124">package</span>&nbsp;<span class="ident" id="6951132">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6951137">import</span>&nbsp;<span class="op" id="6951144">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6951147">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6951158">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6951169">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6951179">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="6951182">var</span>&nbsp;<span class="ident" id="6951186">listenerTests</span>&nbsp;<span class="op" id="6951200">=</span>&nbsp;<span class="op" id="6951202">[</span><span class="op" id="6951203">]</span><span class="keyword" id="6951204">struct</span>&nbsp;<span class="op" id="6951211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6951214">net</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6951223">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6951231">laddr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6951240">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6951248">ipv6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6951257">bool</span>&nbsp;<span class="comment" id="6951262">//&nbsp;test&nbsp;with&nbsp;underlying&nbsp;AF_INET6&nbsp;socket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6951303">wildcard</span>&nbsp;<span class="builtintype" id="6951312">bool</span>&nbsp;<span class="comment" id="6951317">//&nbsp;test&nbsp;with&nbsp;wildcard&nbsp;address</span><br>
<span class="lineno">20</span><span class="op" id="6951347">}</span><span class="op" id="6951348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6951351">{</span><span class="ident" id="6951352">net</span><span class="op" id="6951355">:</span>&nbsp;<span class="string" id="6951357">&#34;tcp&#34;</span><span class="op" id="6951362">,</span>&nbsp;<span class="ident" id="6951364">laddr</span><span class="op" id="6951369">:</span>&nbsp;<span class="string" id="6951371">&#34;&#34;</span><span class="op" id="6951373">,</span>&nbsp;<span class="ident" id="6951375">wildcard</span><span class="op" id="6951383">:</span>&nbsp;<span class="ident" id="6951385">true</span><span class="op" id="6951389">}</span><span class="op" id="6951390">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6951393">{</span><span class="ident" id="6951394">net</span><span class="op" id="6951397">:</span>&nbsp;<span class="string" id="6951399">&#34;tcp&#34;</span><span class="op" id="6951404">,</span>&nbsp;<span class="ident" id="6951406">laddr</span><span class="op" id="6951411">:</span>&nbsp;<span class="string" id="6951413">&#34;0.0.0.0&#34;</span><span class="op" id="6951422">,</span>&nbsp;<span class="ident" id="6951424">wildcard</span><span class="op" id="6951432">:</span>&nbsp;<span class="ident" id="6951434">true</span><span class="op" id="6951438">}</span><span class="op" id="6951439">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6951442">{</span><span class="ident" id="6951443">net</span><span class="op" id="6951446">:</span>&nbsp;<span class="string" id="6951448">&#34;tcp&#34;</span><span class="op" id="6951453">,</span>&nbsp;<span class="ident" id="6951455">laddr</span><span class="op" id="6951460">:</span>&nbsp;<span class="string" id="6951462">&#34;[::ffff:0.0.0.0]&#34;</span><span class="op" id="6951480">,</span>&nbsp;<span class="ident" id="6951482">wildcard</span><span class="op" id="6951490">:</span>&nbsp;<span class="ident" id="6951492">true</span><span class="op" id="6951496">}</span><span class="op" id="6951497">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6951500">{</span><span class="ident" id="6951501">net</span><span class="op" id="6951504">:</span>&nbsp;<span class="string" id="6951506">&#34;tcp&#34;</span><span class="op" id="6951511">,</span>&nbsp;<span class="ident" id="6951513">laddr</span><span class="op" id="6951518">:</span>&nbsp;<span class="string" id="6951520">&#34;[::]&#34;</span><span class="op" id="6951526">,</span>&nbsp;<span class="ident" id="6951528">ipv6</span><span class="op" id="6951532">:</span>&nbsp;<span class="ident" id="6951534">true</span><span class="op" id="6951538">,</span>&nbsp;<span class="ident" id="6951540">wildcard</span><span class="op" id="6951548">:</span>&nbsp;<span class="ident" id="6951550">true</span><span class="op" id="6951554">}</span><span class="op" id="6951555">,</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6951559">{</span><span class="ident" id="6951560">net</span><span class="op" id="6951563">:</span>&nbsp;<span class="string" id="6951565">&#34;tcp&#34;</span><span class="op" id="6951570">,</span>&nbsp;<span class="ident" id="6951572">laddr</span><span class="op" id="6951577">:</span>&nbsp;<span class="string" id="6951579">&#34;127.0.0.1&#34;</span><span class="op" id="6951590">}</span><span class="op" id="6951591">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6951594">{</span><span class="ident" id="6951595">net</span><span class="op" id="6951598">:</span>&nbsp;<span class="string" id="6951600">&#34;tcp&#34;</span><span class="op" id="6951605">,</span>&nbsp;<span class="ident" id="6951607">laddr</span><span class="op" id="6951612">:</span>&nbsp;<span class="string" id="6951614">&#34;[::ffff:127.0.0.1]&#34;</span><span class="op" id="6951634">}</span><span class="op" id="6951635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6951638">{</span><span class="ident" id="6951639">net</span><span class="op" id="6951642">:</span>&nbsp;<span class="string" id="6951644">&#34;tcp&#34;</span><span class="op" id="6951649">,</span>&nbsp;<span class="ident" id="6951651">laddr</span><span class="op" id="6951656">:</span>&nbsp;<span class="string" id="6951658">&#34;[::1]&#34;</span><span class="op" id="6951665">,</span>&nbsp;<span class="ident" id="6951667">ipv6</span><span class="op" id="6951671">:</span>&nbsp;<span class="ident" id="6951673">true</span><span class="op" id="6951677">}</span><span class="op" id="6951678">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6951682">{</span><span class="ident" id="6951683">net</span><span class="op" id="6951686">:</span>&nbsp;<span class="string" id="6951688">&#34;tcp4&#34;</span><span class="op" id="6951694">,</span>&nbsp;<span class="ident" id="6951696">laddr</span><span class="op" id="6951701">:</span>&nbsp;<span class="string" id="6951703">&#34;&#34;</span><span class="op" id="6951705">,</span>&nbsp;<span class="ident" id="6951707">wildcard</span><span class="op" id="6951715">:</span>&nbsp;<span class="ident" id="6951717">true</span><span class="op" id="6951721">}</span><span class="op" id="6951722">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6951725">{</span><span class="ident" id="6951726">net</span><span class="op" id="6951729">:</span>&nbsp;<span class="string" id="6951731">&#34;tcp4&#34;</span><span class="op" id="6951737">,</span>&nbsp;<span class="ident" id="6951739">laddr</span><span class="op" id="6951744">:</span>&nbsp;<span class="string" id="6951746">&#34;0.0.0.0&#34;</span><span class="op" id="6951755">,</span>&nbsp;<span class="ident" id="6951757">wildcard</span><span class="op" id="6951765">:</span>&nbsp;<span class="ident" id="6951767">true</span><span class="op" id="6951771">}</span><span class="op" id="6951772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6951775">{</span><span class="ident" id="6951776">net</span><span class="op" id="6951779">:</span>&nbsp;<span class="string" id="6951781">&#34;tcp4&#34;</span><span class="op" id="6951787">,</span>&nbsp;<span class="ident" id="6951789">laddr</span><span class="op" id="6951794">:</span>&nbsp;<span class="string" id="6951796">&#34;[::ffff:0.0.0.0]&#34;</span><span class="op" id="6951814">,</span>&nbsp;<span class="ident" id="6951816">wildcard</span><span class="op" id="6951824">:</span>&nbsp;<span class="ident" id="6951826">true</span><span class="op" id="6951830">}</span><span class="op" id="6951831">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6951835">{</span><span class="ident" id="6951836">net</span><span class="op" id="6951839">:</span>&nbsp;<span class="string" id="6951841">&#34;tcp4&#34;</span><span class="op" id="6951847">,</span>&nbsp;<span class="ident" id="6951849">laddr</span><span class="op" id="6951854">:</span>&nbsp;<span class="string" id="6951856">&#34;127.0.0.1&#34;</span><span class="op" id="6951867">}</span><span class="op" id="6951868">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6951871">{</span><span class="ident" id="6951872">net</span><span class="op" id="6951875">:</span>&nbsp;<span class="string" id="6951877">&#34;tcp4&#34;</span><span class="op" id="6951883">,</span>&nbsp;<span class="ident" id="6951885">laddr</span><span class="op" id="6951890">:</span>&nbsp;<span class="string" id="6951892">&#34;[::ffff:127.0.0.1]&#34;</span><span class="op" id="6951912">}</span><span class="op" id="6951913">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6951917">{</span><span class="ident" id="6951918">net</span><span class="op" id="6951921">:</span>&nbsp;<span class="string" id="6951923">&#34;tcp6&#34;</span><span class="op" id="6951929">,</span>&nbsp;<span class="ident" id="6951931">laddr</span><span class="op" id="6951936">:</span>&nbsp;<span class="string" id="6951938">&#34;&#34;</span><span class="op" id="6951940">,</span>&nbsp;<span class="ident" id="6951942">ipv6</span><span class="op" id="6951946">:</span>&nbsp;<span class="ident" id="6951948">true</span><span class="op" id="6951952">,</span>&nbsp;<span class="ident" id="6951954">wildcard</span><span class="op" id="6951962">:</span>&nbsp;<span class="ident" id="6951964">true</span><span class="op" id="6951968">}</span><span class="op" id="6951969">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6951972">{</span><span class="ident" id="6951973">net</span><span class="op" id="6951976">:</span>&nbsp;<span class="string" id="6951978">&#34;tcp6&#34;</span><span class="op" id="6951984">,</span>&nbsp;<span class="ident" id="6951986">laddr</span><span class="op" id="6951991">:</span>&nbsp;<span class="string" id="6951993">&#34;[::]&#34;</span><span class="op" id="6951999">,</span>&nbsp;<span class="ident" id="6952001">ipv6</span><span class="op" id="6952005">:</span>&nbsp;<span class="ident" id="6952007">true</span><span class="op" id="6952011">,</span>&nbsp;<span class="ident" id="6952013">wildcard</span><span class="op" id="6952021">:</span>&nbsp;<span class="ident" id="6952023">true</span><span class="op" id="6952027">}</span><span class="op" id="6952028">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6952032">{</span><span class="ident" id="6952033">net</span><span class="op" id="6952036">:</span>&nbsp;<span class="string" id="6952038">&#34;tcp6&#34;</span><span class="op" id="6952044">,</span>&nbsp;<span class="ident" id="6952046">laddr</span><span class="op" id="6952051">:</span>&nbsp;<span class="string" id="6952053">&#34;[::1]&#34;</span><span class="op" id="6952060">,</span>&nbsp;<span class="ident" id="6952062">ipv6</span><span class="op" id="6952066">:</span>&nbsp;<span class="ident" id="6952068">true</span><span class="op" id="6952072">}</span><span class="op" id="6952073">,</span><br>
<span class="lineno"></span><span class="op" id="6952075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6952078">//&nbsp;TestTCPListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen&nbsp;to&nbsp;a&nbsp;test</span><br>
<span class="lineno"></span><span class="comment" id="6952143">//&nbsp;listener&nbsp;with&nbsp;same&nbsp;address&nbsp;family,&nbsp;same&nbsp;listening&nbsp;address&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="6952208">//&nbsp;same&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="6952222">func</span>&nbsp;<span class="ident" id="6952227">TestTCPListener</span><span class="op" id="6952242">(</span><span class="ident" id="6952243">t</span>&nbsp;<span class="op" id="6952245">*</span><span class="ident" id="6952246"><a href="/net/unicast_posix_test.go.html#6951169">testing</a></span><span class="op" id="6952253">.</span><span class="ident" id="6952254">T</span><span class="op" id="6952255">)</span>&nbsp;<span class="op" id="6952257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6952260">switch</span>&nbsp;<span class="ident" id="6952267"><a href="/net/unicast_posix_test.go.html#6951147">runtime</a></span><span class="op" id="6952274">.</span><span class="ident" id="6952275">GOOS</span>&nbsp;<span class="op" id="6952280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6952283">case</span>&nbsp;<span class="string" id="6952288">&#34;plan9&#34;</span><span class="op" id="6952295">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6952299"><a href="/net/unicast_posix_test.go.html#6952243">t</a></span><span class="op" id="6952300">.</span><span class="ident" id="6952301">Skipf</span><span class="op" id="6952306">(</span><span class="string" id="6952307">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6952328">,</span>&nbsp;<span class="ident" id="6952330"><a href="/net/unicast_posix_test.go.html#6951147">runtime</a></span><span class="op" id="6952337">.</span><span class="ident" id="6952338">GOOS</span><span class="op" id="6952342">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6952345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6952349">for</span>&nbsp;<span class="ident" id="6952353">_</span><span class="op" id="6952354">,</span>&nbsp;<span class="ident" id="6952356">tt</span>&nbsp;<span class="op" id="6952359">:=</span>&nbsp;<span class="keyword" id="6952362">range</span>&nbsp;<span class="ident" id="6952368"><a href="/net/unicast_posix_test.go.html#6951186">listenerTests</a></span>&nbsp;<span class="op" id="6952382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6952386">if</span>&nbsp;<span class="ident" id="6952389"><a href="/net/unicast_posix_test.go.html#6952356">tt</a></span><span class="op" id="6952391">.</span><span class="ident" id="6952392">wildcard</span>&nbsp;<span class="op" id="6952401">&amp;&amp;</span>&nbsp;<span class="op" id="6952404">(</span><span class="ident" id="6952405"><a href="/net/unicast_posix_test.go.html#6951169">testing</a></span><span class="op" id="6952412">.</span><span class="ident" id="6952413">Short</span><span class="op" id="6952418">(</span><span class="op" id="6952419">)</span>&nbsp;<span class="op" id="6952421">||</span>&nbsp;<span class="op" id="6952424">!</span><span class="op" id="6952425">*</span><span class="ident" id="6952426"><a href="/net/lookup_test.go.html#6856134">testExternal</a></span><span class="op" id="6952438">)</span>&nbsp;<span class="op" id="6952440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6952445">continue</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6952456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6952460">if</span>&nbsp;<span class="ident" id="6952463"><a href="/net/unicast_posix_test.go.html#6952356">tt</a></span><span class="op" id="6952465">.</span><span class="ident" id="6952466">ipv6</span>&nbsp;<span class="op" id="6952471">&amp;&amp;</span>&nbsp;<span class="op" id="6952474">!</span><span class="ident" id="6952475"><a href="/net/ipsock.go.html#2627769">supportsIPv6</a></span>&nbsp;<span class="op" id="6952488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6952493">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6952504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6952508">l1</span><span class="op" id="6952510">,</span>&nbsp;<span class="ident" id="6952512">port</span>&nbsp;<span class="op" id="6952517">:=</span>&nbsp;<span class="ident" id="6952520"><a href="/net/unicast_posix_test.go.html#6960012">usableListenPort</a></span><span class="op" id="6952536">(</span><span class="ident" id="6952537"><a href="/net/unicast_posix_test.go.html#6952243">t</a></span><span class="op" id="6952538">,</span>&nbsp;<span class="ident" id="6952540"><a href="/net/unicast_posix_test.go.html#6952356">tt</a></span><span class="op" id="6952542">.</span><span class="ident" id="6952543">net</span><span class="op" id="6952546">,</span>&nbsp;<span class="ident" id="6952548"><a href="/net/unicast_posix_test.go.html#6952356">tt</a></span><span class="op" id="6952550">.</span><span class="ident" id="6952551">laddr</span><span class="op" id="6952556">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6952560"><a href="/net/unicast_posix_test.go.html#6961282">checkFirstListener</a></span><span class="op" id="6952578">(</span><span class="ident" id="6952579"><a href="/net/unicast_posix_test.go.html#6952243">t</a></span><span class="op" id="6952580">,</span>&nbsp;<span class="ident" id="6952582"><a href="/net/unicast_posix_test.go.html#6952356">tt</a></span><span class="op" id="6952584">.</span><span class="ident" id="6952585">net</span><span class="op" id="6952588">,</span>&nbsp;<span class="ident" id="6952590"><a href="/net/unicast_posix_test.go.html#6952356">tt</a></span><span class="op" id="6952592">.</span><span class="ident" id="6952593">laddr</span><span class="op" id="6952598">+</span><span class="string" id="6952599">&#34;:&#34;</span><span class="op" id="6952602">+</span><span class="ident" id="6952603"><a href="/net/unicast_posix_test.go.html#6952512">port</a></span><span class="op" id="6952607">,</span>&nbsp;<span class="ident" id="6952609"><a href="/net/unicast_posix_test.go.html#6952508">l1</a></span><span class="op" id="6952611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6952615">l2</span><span class="op" id="6952617">,</span>&nbsp;<span class="ident" id="6952619">err</span>&nbsp;<span class="op" id="6952623">:=</span>&nbsp;<span class="ident" id="6952626"><a href="/net/dial.go.html#2525176">Listen</a></span><span class="op" id="6952632">(</span><span class="ident" id="6952633"><a href="/net/unicast_posix_test.go.html#6952356">tt</a></span><span class="op" id="6952635">.</span><span class="ident" id="6952636">net</span><span class="op" id="6952639">,</span>&nbsp;<span class="ident" id="6952641"><a href="/net/unicast_posix_test.go.html#6952356">tt</a></span><span class="op" id="6952643">.</span><span class="ident" id="6952644">laddr</span><span class="op" id="6952649">+</span><span class="string" id="6952650">&#34;:&#34;</span><span class="op" id="6952653">+</span><span class="ident" id="6952654"><a href="/net/unicast_posix_test.go.html#6952512">port</a></span><span class="op" id="6952658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6952662"><a href="/net/unicast_posix_test.go.html#6962394">checkSecondListener</a></span><span class="op" id="6952681">(</span><span class="ident" id="6952682"><a href="/net/unicast_posix_test.go.html#6952243">t</a></span><span class="op" id="6952683">,</span>&nbsp;<span class="ident" id="6952685"><a href="/net/unicast_posix_test.go.html#6952356">tt</a></span><span class="op" id="6952687">.</span><span class="ident" id="6952688">net</span><span class="op" id="6952691">,</span>&nbsp;<span class="ident" id="6952693"><a href="/net/unicast_posix_test.go.html#6952356">tt</a></span><span class="op" id="6952695">.</span><span class="ident" id="6952696">laddr</span><span class="op" id="6952701">+</span><span class="string" id="6952702">&#34;:&#34;</span><span class="op" id="6952705">+</span><span class="ident" id="6952706"><a href="/net/unicast_posix_test.go.html#6952512">port</a></span><span class="op" id="6952710">,</span>&nbsp;<span class="ident" id="6952712"><a href="/net/unicast_posix_test.go.html#6952619">err</a></span><span class="op" id="6952715">,</span>&nbsp;<span class="ident" id="6952717"><a href="/net/unicast_posix_test.go.html#6952615">l2</a></span><span class="op" id="6952719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6952723"><a href="/net/unicast_posix_test.go.html#6952508">l1</a></span><span class="op" id="6952725">.</span><span class="ident" id="6952726">Close</span><span class="op" id="6952731">(</span><span class="op" id="6952732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6952735">}</span><br>
<span class="lineno">65</span><span class="op" id="6952737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6952740">//&nbsp;TestUDPListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen&nbsp;to&nbsp;a&nbsp;test</span><br>
<span class="lineno"></span><span class="comment" id="6952805">//&nbsp;listener&nbsp;with&nbsp;same&nbsp;address&nbsp;family,&nbsp;same&nbsp;listening&nbsp;address&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6952870">//&nbsp;same&nbsp;port.</span><br>
<span class="lineno">70</span><span class="keyword" id="6952884">func</span>&nbsp;<span class="ident" id="6952889">TestUDPListener</span><span class="op" id="6952904">(</span><span class="ident" id="6952905">t</span>&nbsp;<span class="op" id="6952907">*</span><span class="ident" id="6952908"><a href="/net/unicast_posix_test.go.html#6951169">testing</a></span><span class="op" id="6952915">.</span><span class="ident" id="6952916">T</span><span class="op" id="6952917">)</span>&nbsp;<span class="op" id="6952919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6952922">switch</span>&nbsp;<span class="ident" id="6952929"><a href="/net/unicast_posix_test.go.html#6951147">runtime</a></span><span class="op" id="6952936">.</span><span class="ident" id="6952937">GOOS</span>&nbsp;<span class="op" id="6952942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6952945">case</span>&nbsp;<span class="string" id="6952950">&#34;plan9&#34;</span><span class="op" id="6952957">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6952961"><a href="/net/unicast_posix_test.go.html#6952905">t</a></span><span class="op" id="6952962">.</span><span class="ident" id="6952963">Skipf</span><span class="op" id="6952968">(</span><span class="string" id="6952969">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6952990">,</span>&nbsp;<span class="ident" id="6952992"><a href="/net/unicast_posix_test.go.html#6951147">runtime</a></span><span class="op" id="6952999">.</span><span class="ident" id="6953000">GOOS</span><span class="op" id="6953004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6953007">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953011">toudpnet</span>&nbsp;<span class="op" id="6953020">:=</span>&nbsp;<span class="keyword" id="6953023">func</span><span class="op" id="6953027">(</span><span class="ident" id="6953028">net</span>&nbsp;<span class="builtintype" id="6953032">string</span><span class="op" id="6953038">)</span>&nbsp;<span class="builtintype" id="6953040">string</span>&nbsp;<span class="op" id="6953047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6953051">switch</span>&nbsp;<span class="ident" id="6953058"><a href="/net/unicast_posix_test.go.html#6953028">net</a></span>&nbsp;<span class="op" id="6953062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6953066">case</span>&nbsp;<span class="string" id="6953071">&#34;tcp&#34;</span><span class="op" id="6953076">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6953081">return</span>&nbsp;<span class="string" id="6953088">&#34;udp&#34;</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6953096">case</span>&nbsp;<span class="string" id="6953101">&#34;tcp4&#34;</span><span class="op" id="6953107">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6953112">return</span>&nbsp;<span class="string" id="6953119">&#34;udp4&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6953128">case</span>&nbsp;<span class="string" id="6953133">&#34;tcp6&#34;</span><span class="op" id="6953139">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6953144">return</span>&nbsp;<span class="string" id="6953151">&#34;udp6&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6953160">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6953164">return</span>&nbsp;<span class="string" id="6953171">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6953180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6953184">for</span>&nbsp;<span class="ident" id="6953188">_</span><span class="op" id="6953189">,</span>&nbsp;<span class="ident" id="6953191">tt</span>&nbsp;<span class="op" id="6953194">:=</span>&nbsp;<span class="keyword" id="6953197">range</span>&nbsp;<span class="ident" id="6953203"><a href="/net/unicast_posix_test.go.html#6951186">listenerTests</a></span>&nbsp;<span class="op" id="6953217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6953221">if</span>&nbsp;<span class="ident" id="6953224"><a href="/net/unicast_posix_test.go.html#6953191">tt</a></span><span class="op" id="6953226">.</span><span class="ident" id="6953227">wildcard</span>&nbsp;<span class="op" id="6953236">&amp;&amp;</span>&nbsp;<span class="op" id="6953239">(</span><span class="ident" id="6953240"><a href="/net/unicast_posix_test.go.html#6951169">testing</a></span><span class="op" id="6953247">.</span><span class="ident" id="6953248">Short</span><span class="op" id="6953253">(</span><span class="op" id="6953254">)</span>&nbsp;<span class="op" id="6953256">||</span>&nbsp;<span class="op" id="6953259">!</span><span class="op" id="6953260">*</span><span class="ident" id="6953261"><a href="/net/lookup_test.go.html#6856134">testExternal</a></span><span class="op" id="6953273">)</span>&nbsp;<span class="op" id="6953275">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6953280">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6953291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6953295">if</span>&nbsp;<span class="ident" id="6953298"><a href="/net/unicast_posix_test.go.html#6953191">tt</a></span><span class="op" id="6953300">.</span><span class="ident" id="6953301">ipv6</span>&nbsp;<span class="op" id="6953306">&amp;&amp;</span>&nbsp;<span class="op" id="6953309">!</span><span class="ident" id="6953310"><a href="/net/ipsock.go.html#2627769">supportsIPv6</a></span>&nbsp;<span class="op" id="6953323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6953328">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6953339">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953343"><a href="/net/unicast_posix_test.go.html#6953191">tt</a></span><span class="op" id="6953345">.</span><span class="ident" id="6953346">net</span>&nbsp;<span class="op" id="6953350">=</span>&nbsp;<span class="ident" id="6953352"><a href="/net/unicast_posix_test.go.html#6953011">toudpnet</a></span><span class="op" id="6953360">(</span><span class="ident" id="6953361"><a href="/net/unicast_posix_test.go.html#6953191">tt</a></span><span class="op" id="6953363">.</span><span class="ident" id="6953364">net</span><span class="op" id="6953367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953371">l1</span><span class="op" id="6953373">,</span>&nbsp;<span class="ident" id="6953375">port</span>&nbsp;<span class="op" id="6953380">:=</span>&nbsp;<span class="ident" id="6953383"><a href="/net/unicast_posix_test.go.html#6960510">usableListenPacketPort</a></span><span class="op" id="6953405">(</span><span class="ident" id="6953406"><a href="/net/unicast_posix_test.go.html#6952905">t</a></span><span class="op" id="6953407">,</span>&nbsp;<span class="ident" id="6953409"><a href="/net/unicast_posix_test.go.html#6953191">tt</a></span><span class="op" id="6953411">.</span><span class="ident" id="6953412">net</span><span class="op" id="6953415">,</span>&nbsp;<span class="ident" id="6953417"><a href="/net/unicast_posix_test.go.html#6953191">tt</a></span><span class="op" id="6953419">.</span><span class="ident" id="6953420">laddr</span><span class="op" id="6953425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953429"><a href="/net/unicast_posix_test.go.html#6961282">checkFirstListener</a></span><span class="op" id="6953447">(</span><span class="ident" id="6953448"><a href="/net/unicast_posix_test.go.html#6952905">t</a></span><span class="op" id="6953449">,</span>&nbsp;<span class="ident" id="6953451"><a href="/net/unicast_posix_test.go.html#6953191">tt</a></span><span class="op" id="6953453">.</span><span class="ident" id="6953454">net</span><span class="op" id="6953457">,</span>&nbsp;<span class="ident" id="6953459"><a href="/net/unicast_posix_test.go.html#6953191">tt</a></span><span class="op" id="6953461">.</span><span class="ident" id="6953462">laddr</span><span class="op" id="6953467">+</span><span class="string" id="6953468">&#34;:&#34;</span><span class="op" id="6953471">+</span><span class="ident" id="6953472"><a href="/net/unicast_posix_test.go.html#6953375">port</a></span><span class="op" id="6953476">,</span>&nbsp;<span class="ident" id="6953478"><a href="/net/unicast_posix_test.go.html#6953371">l1</a></span><span class="op" id="6953480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953484">l2</span><span class="op" id="6953486">,</span>&nbsp;<span class="ident" id="6953488">err</span>&nbsp;<span class="op" id="6953492">:=</span>&nbsp;<span class="ident" id="6953495"><a href="/net/dial.go.html#2525968">ListenPacket</a></span><span class="op" id="6953507">(</span><span class="ident" id="6953508"><a href="/net/unicast_posix_test.go.html#6953191">tt</a></span><span class="op" id="6953510">.</span><span class="ident" id="6953511">net</span><span class="op" id="6953514">,</span>&nbsp;<span class="ident" id="6953516"><a href="/net/unicast_posix_test.go.html#6953191">tt</a></span><span class="op" id="6953518">.</span><span class="ident" id="6953519">laddr</span><span class="op" id="6953524">+</span><span class="string" id="6953525">&#34;:&#34;</span><span class="op" id="6953528">+</span><span class="ident" id="6953529"><a href="/net/unicast_posix_test.go.html#6953375">port</a></span><span class="op" id="6953533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953537"><a href="/net/unicast_posix_test.go.html#6962394">checkSecondListener</a></span><span class="op" id="6953556">(</span><span class="ident" id="6953557"><a href="/net/unicast_posix_test.go.html#6952905">t</a></span><span class="op" id="6953558">,</span>&nbsp;<span class="ident" id="6953560"><a href="/net/unicast_posix_test.go.html#6953191">tt</a></span><span class="op" id="6953562">.</span><span class="ident" id="6953563">net</span><span class="op" id="6953566">,</span>&nbsp;<span class="ident" id="6953568"><a href="/net/unicast_posix_test.go.html#6953191">tt</a></span><span class="op" id="6953570">.</span><span class="ident" id="6953571">laddr</span><span class="op" id="6953576">+</span><span class="string" id="6953577">&#34;:&#34;</span><span class="op" id="6953580">+</span><span class="ident" id="6953581"><a href="/net/unicast_posix_test.go.html#6953375">port</a></span><span class="op" id="6953585">,</span>&nbsp;<span class="ident" id="6953587"><a href="/net/unicast_posix_test.go.html#6953488">err</a></span><span class="op" id="6953590">,</span>&nbsp;<span class="ident" id="6953592"><a href="/net/unicast_posix_test.go.html#6953484">l2</a></span><span class="op" id="6953594">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953598"><a href="/net/unicast_posix_test.go.html#6953371">l1</a></span><span class="op" id="6953600">.</span><span class="ident" id="6953601">Close</span><span class="op" id="6953606">(</span><span class="op" id="6953607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6953610">}</span><br>
<span class="lineno"></span><span class="op" id="6953612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6953615">var</span>&nbsp;<span class="ident" id="6953619">dualStackListenerTests</span>&nbsp;<span class="op" id="6953642">=</span>&nbsp;<span class="op" id="6953644">[</span><span class="op" id="6953645">]</span><span class="keyword" id="6953646">struct</span>&nbsp;<span class="op" id="6953653">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953656">net1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6953665">string</span>&nbsp;<span class="comment" id="6953672">//&nbsp;first&nbsp;listener</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953691">laddr1</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6953700">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953708">net2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6953717">string</span>&nbsp;<span class="comment" id="6953724">//&nbsp;second&nbsp;listener</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953744">laddr2</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6953753">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953761">wildcard</span>&nbsp;<span class="builtintype" id="6953770">bool</span>&nbsp;&nbsp;<span class="comment" id="6953776">//&nbsp;test&nbsp;with&nbsp;wildcard&nbsp;address</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6953807">xerr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6953816">error</span>&nbsp;<span class="comment" id="6953822">//&nbsp;expected&nbsp;error&nbsp;value,&nbsp;nil&nbsp;or&nbsp;other</span><br>
<span class="lineno"></span><span class="op" id="6953860">}</span><span class="op" id="6953861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6953864">//&nbsp;Test&nbsp;cases&nbsp;and&nbsp;expected&nbsp;results&nbsp;for&nbsp;the&nbsp;attemping&nbsp;2nd&nbsp;listen&nbsp;on&nbsp;the&nbsp;same&nbsp;port</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6953946">//&nbsp;1st&nbsp;listen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2nd&nbsp;listen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;darwin&nbsp;&nbsp;freebsd&nbsp;&nbsp;linux&nbsp;&nbsp;openbsd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6954035">//&nbsp;------------------------------------------------------------------------------------</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6954124">//&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6954210">//&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;0.0.0.0&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6954296">//&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;0.0.0.0&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6954382">//&nbsp;------------------------------------------------------------------------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6954471">//&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;[::]&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6954558">//&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;[::]&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6954645">//&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;0.0.0.0&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;[::]&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6954732">//&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;[::]&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;0.0.0.0&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6954819">//&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;[::ffff:0.0.0.0]&#34;&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;[::]&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6954906">//&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;[::]&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;[::ffff:0.0.0.0]&#34;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6954993">//&nbsp;------------------------------------------------------------------------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6955082">//&nbsp;&#34;tcp4&#34;&nbsp;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp6&#34;&nbsp;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6955169">//&nbsp;&#34;tcp6&#34;&nbsp;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp4&#34;&nbsp;&#34;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6955256">//&nbsp;&#34;tcp4&#34;&nbsp;&#34;0.0.0.0&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp6&#34;&nbsp;&#34;[::]&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6955343">//&nbsp;&#34;tcp6&#34;&nbsp;&#34;[::]&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp4&#34;&nbsp;&#34;0.0.0.0&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6955430">//&nbsp;------------------------------------------------------------------------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6955519">//&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;127.0.0.1&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;[::1]&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6955606">//&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;[::1]&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp&#34;&nbsp;&nbsp;&#34;127.0.0.1&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6955693">//&nbsp;&#34;tcp4&#34;&nbsp;&#34;127.0.0.1&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp6&#34;&nbsp;&#34;[::1]&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6955780">//&nbsp;&#34;tcp6&#34;&nbsp;&#34;[::1]&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;tcp4&#34;&nbsp;&#34;127.0.0.1&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6955867">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6955871">//&nbsp;Platform&nbsp;default&nbsp;configurations:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6955908">//&nbsp;darwin,&nbsp;kernel&nbsp;version&nbsp;11.3.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6955942">//&nbsp;&nbsp;&nbsp;&nbspnet.inet6.ip6.v6only=0&nbsp;(overridable&nbsp;by&nbsp;sysctl&nbsp;or&nbsp;IPV6_V6ONLY&nbsp;option)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6956015">//&nbsp;freebsd,&nbsp;kernel&nbsp;version&nbsp;8.2</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6956047">//&nbsp;&nbsp;&nbsp;&nbspnet.inet6.ip6.v6only=1&nbsp;(overridable&nbsp;by&nbsp;sysctl&nbsp;or&nbsp;IPV6_V6ONLY&nbsp;option)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6956120">//&nbsp;linux,&nbsp;kernel&nbsp;version&nbsp;3.0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6956152">//&nbsp;&nbsp;&nbsp;&nbspnet.ipv6.bindv6only=0&nbsp;(overridable&nbsp;by&nbsp;sysctl&nbsp;or&nbsp;IPV6_V6ONLY&nbsp;option)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6956224">//&nbsp;openbsd,&nbsp;kernel&nbsp;version&nbsp;5.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6956256">//&nbsp;&nbsp;&nbsp;&nbspnet.inet6.ip6.v6only=1&nbsp;(overriding&nbsp;is&nbsp;prohibited)</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6956311">{</span><span class="ident" id="6956312">net1</span><span class="op" id="6956316">:</span>&nbsp;<span class="string" id="6956318">&#34;tcp&#34;</span><span class="op" id="6956323">,</span>&nbsp;<span class="ident" id="6956325">laddr1</span><span class="op" id="6956331">:</span>&nbsp;<span class="string" id="6956333">&#34;&#34;</span><span class="op" id="6956335">,</span>&nbsp;<span class="ident" id="6956337">net2</span><span class="op" id="6956341">:</span>&nbsp;<span class="string" id="6956343">&#34;tcp&#34;</span><span class="op" id="6956348">,</span>&nbsp;<span class="ident" id="6956350">laddr2</span><span class="op" id="6956356">:</span>&nbsp;<span class="string" id="6956358">&#34;&#34;</span><span class="op" id="6956360">,</span>&nbsp;<span class="ident" id="6956362">wildcard</span><span class="op" id="6956370">:</span>&nbsp;<span class="ident" id="6956372">true</span><span class="op" id="6956376">,</span>&nbsp;<span class="ident" id="6956378">xerr</span><span class="op" id="6956382">:</span>&nbsp;<span class="ident" id="6956384"><a href="/net/unicast_posix_test.go.html#6951158">syscall</a></span><span class="op" id="6956391">.</span><span class="ident" id="6956392">EADDRINUSE</span><span class="op" id="6956402">}</span><span class="op" id="6956403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6956406">{</span><span class="ident" id="6956407">net1</span><span class="op" id="6956411">:</span>&nbsp;<span class="string" id="6956413">&#34;tcp&#34;</span><span class="op" id="6956418">,</span>&nbsp;<span class="ident" id="6956420">laddr1</span><span class="op" id="6956426">:</span>&nbsp;<span class="string" id="6956428">&#34;&#34;</span><span class="op" id="6956430">,</span>&nbsp;<span class="ident" id="6956432">net2</span><span class="op" id="6956436">:</span>&nbsp;<span class="string" id="6956438">&#34;tcp&#34;</span><span class="op" id="6956443">,</span>&nbsp;<span class="ident" id="6956445">laddr2</span><span class="op" id="6956451">:</span>&nbsp;<span class="string" id="6956453">&#34;0.0.0.0&#34;</span><span class="op" id="6956462">,</span>&nbsp;<span class="ident" id="6956464">wildcard</span><span class="op" id="6956472">:</span>&nbsp;<span class="ident" id="6956474">true</span><span class="op" id="6956478">,</span>&nbsp;<span class="ident" id="6956480">xerr</span><span class="op" id="6956484">:</span>&nbsp;<span class="ident" id="6956486"><a href="/net/unicast_posix_test.go.html#6951158">syscall</a></span><span class="op" id="6956493">.</span><span class="ident" id="6956494">EADDRINUSE</span><span class="op" id="6956504">}</span><span class="op" id="6956505">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6956508">{</span><span class="ident" id="6956509">net1</span><span class="op" id="6956513">:</span>&nbsp;<span class="string" id="6956515">&#34;tcp&#34;</span><span class="op" id="6956520">,</span>&nbsp;<span class="ident" id="6956522">laddr1</span><span class="op" id="6956528">:</span>&nbsp;<span class="string" id="6956530">&#34;0.0.0.0&#34;</span><span class="op" id="6956539">,</span>&nbsp;<span class="ident" id="6956541">net2</span><span class="op" id="6956545">:</span>&nbsp;<span class="string" id="6956547">&#34;tcp&#34;</span><span class="op" id="6956552">,</span>&nbsp;<span class="ident" id="6956554">laddr2</span><span class="op" id="6956560">:</span>&nbsp;<span class="string" id="6956562">&#34;&#34;</span><span class="op" id="6956564">,</span>&nbsp;<span class="ident" id="6956566">wildcard</span><span class="op" id="6956574">:</span>&nbsp;<span class="ident" id="6956576">true</span><span class="op" id="6956580">,</span>&nbsp;<span class="ident" id="6956582">xerr</span><span class="op" id="6956586">:</span>&nbsp;<span class="ident" id="6956588"><a href="/net/unicast_posix_test.go.html#6951158">syscall</a></span><span class="op" id="6956595">.</span><span class="ident" id="6956596">EADDRINUSE</span><span class="op" id="6956606">}</span><span class="op" id="6956607">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6956611">{</span><span class="ident" id="6956612">net1</span><span class="op" id="6956616">:</span>&nbsp;<span class="string" id="6956618">&#34;tcp&#34;</span><span class="op" id="6956623">,</span>&nbsp;<span class="ident" id="6956625">laddr1</span><span class="op" id="6956631">:</span>&nbsp;<span class="string" id="6956633">&#34;&#34;</span><span class="op" id="6956635">,</span>&nbsp;<span class="ident" id="6956637">net2</span><span class="op" id="6956641">:</span>&nbsp;<span class="string" id="6956643">&#34;tcp&#34;</span><span class="op" id="6956648">,</span>&nbsp;<span class="ident" id="6956650">laddr2</span><span class="op" id="6956656">:</span>&nbsp;<span class="string" id="6956658">&#34;[::]&#34;</span><span class="op" id="6956664">,</span>&nbsp;<span class="ident" id="6956666">wildcard</span><span class="op" id="6956674">:</span>&nbsp;<span class="ident" id="6956676">true</span><span class="op" id="6956680">,</span>&nbsp;<span class="ident" id="6956682">xerr</span><span class="op" id="6956686">:</span>&nbsp;<span class="ident" id="6956688"><a href="/net/unicast_posix_test.go.html#6951158">syscall</a></span><span class="op" id="6956695">.</span><span class="ident" id="6956696">EADDRINUSE</span><span class="op" id="6956706">}</span><span class="op" id="6956707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6956710">{</span><span class="ident" id="6956711">net1</span><span class="op" id="6956715">:</span>&nbsp;<span class="string" id="6956717">&#34;tcp&#34;</span><span class="op" id="6956722">,</span>&nbsp;<span class="ident" id="6956724">laddr1</span><span class="op" id="6956730">:</span>&nbsp;<span class="string" id="6956732">&#34;[::]&#34;</span><span class="op" id="6956738">,</span>&nbsp;<span class="ident" id="6956740">net2</span><span class="op" id="6956744">:</span>&nbsp;<span class="string" id="6956746">&#34;tcp&#34;</span><span class="op" id="6956751">,</span>&nbsp;<span class="ident" id="6956753">laddr2</span><span class="op" id="6956759">:</span>&nbsp;<span class="string" id="6956761">&#34;&#34;</span><span class="op" id="6956763">,</span>&nbsp;<span class="ident" id="6956765">wildcard</span><span class="op" id="6956773">:</span>&nbsp;<span class="ident" id="6956775">true</span><span class="op" id="6956779">,</span>&nbsp;<span class="ident" id="6956781">xerr</span><span class="op" id="6956785">:</span>&nbsp;<span class="ident" id="6956787"><a href="/net/unicast_posix_test.go.html#6951158">syscall</a></span><span class="op" id="6956794">.</span><span class="ident" id="6956795">EADDRINUSE</span><span class="op" id="6956805">}</span><span class="op" id="6956806">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6956809">{</span><span class="ident" id="6956810">net1</span><span class="op" id="6956814">:</span>&nbsp;<span class="string" id="6956816">&#34;tcp&#34;</span><span class="op" id="6956821">,</span>&nbsp;<span class="ident" id="6956823">laddr1</span><span class="op" id="6956829">:</span>&nbsp;<span class="string" id="6956831">&#34;0.0.0.0&#34;</span><span class="op" id="6956840">,</span>&nbsp;<span class="ident" id="6956842">net2</span><span class="op" id="6956846">:</span>&nbsp;<span class="string" id="6956848">&#34;tcp&#34;</span><span class="op" id="6956853">,</span>&nbsp;<span class="ident" id="6956855">laddr2</span><span class="op" id="6956861">:</span>&nbsp;<span class="string" id="6956863">&#34;[::]&#34;</span><span class="op" id="6956869">,</span>&nbsp;<span class="ident" id="6956871">wildcard</span><span class="op" id="6956879">:</span>&nbsp;<span class="ident" id="6956881">true</span><span class="op" id="6956885">,</span>&nbsp;<span class="ident" id="6956887">xerr</span><span class="op" id="6956891">:</span>&nbsp;<span class="ident" id="6956893"><a href="/net/unicast_posix_test.go.html#6951158">syscall</a></span><span class="op" id="6956900">.</span><span class="ident" id="6956901">EADDRINUSE</span><span class="op" id="6956911">}</span><span class="op" id="6956912">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6956915">{</span><span class="ident" id="6956916">net1</span><span class="op" id="6956920">:</span>&nbsp;<span class="string" id="6956922">&#34;tcp&#34;</span><span class="op" id="6956927">,</span>&nbsp;<span class="ident" id="6956929">laddr1</span><span class="op" id="6956935">:</span>&nbsp;<span class="string" id="6956937">&#34;[::]&#34;</span><span class="op" id="6956943">,</span>&nbsp;<span class="ident" id="6956945">net2</span><span class="op" id="6956949">:</span>&nbsp;<span class="string" id="6956951">&#34;tcp&#34;</span><span class="op" id="6956956">,</span>&nbsp;<span class="ident" id="6956958">laddr2</span><span class="op" id="6956964">:</span>&nbsp;<span class="string" id="6956966">&#34;0.0.0.0&#34;</span><span class="op" id="6956975">,</span>&nbsp;<span class="ident" id="6956977">wildcard</span><span class="op" id="6956985">:</span>&nbsp;<span class="ident" id="6956987">true</span><span class="op" id="6956991">,</span>&nbsp;<span class="ident" id="6956993">xerr</span><span class="op" id="6956997">:</span>&nbsp;<span class="ident" id="6956999"><a href="/net/unicast_posix_test.go.html#6951158">syscall</a></span><span class="op" id="6957006">.</span><span class="ident" id="6957007">EADDRINUSE</span><span class="op" id="6957017">}</span><span class="op" id="6957018">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6957021">{</span><span class="ident" id="6957022">net1</span><span class="op" id="6957026">:</span>&nbsp;<span class="string" id="6957028">&#34;tcp&#34;</span><span class="op" id="6957033">,</span>&nbsp;<span class="ident" id="6957035">laddr1</span><span class="op" id="6957041">:</span>&nbsp;<span class="string" id="6957043">&#34;[::ffff:0.0.0.0]&#34;</span><span class="op" id="6957061">,</span>&nbsp;<span class="ident" id="6957063">net2</span><span class="op" id="6957067">:</span>&nbsp;<span class="string" id="6957069">&#34;tcp&#34;</span><span class="op" id="6957074">,</span>&nbsp;<span class="ident" id="6957076">laddr2</span><span class="op" id="6957082">:</span>&nbsp;<span class="string" id="6957084">&#34;[::]&#34;</span><span class="op" id="6957090">,</span>&nbsp;<span class="ident" id="6957092">wildcard</span><span class="op" id="6957100">:</span>&nbsp;<span class="ident" id="6957102">true</span><span class="op" id="6957106">,</span>&nbsp;<span class="ident" id="6957108">xerr</span><span class="op" id="6957112">:</span>&nbsp;<span class="ident" id="6957114"><a href="/net/unicast_posix_test.go.html#6951158">syscall</a></span><span class="op" id="6957121">.</span><span class="ident" id="6957122">EADDRINUSE</span><span class="op" id="6957132">}</span><span class="op" id="6957133">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6957136">{</span><span class="ident" id="6957137">net1</span><span class="op" id="6957141">:</span>&nbsp;<span class="string" id="6957143">&#34;tcp&#34;</span><span class="op" id="6957148">,</span>&nbsp;<span class="ident" id="6957150">laddr1</span><span class="op" id="6957156">:</span>&nbsp;<span class="string" id="6957158">&#34;[::]&#34;</span><span class="op" id="6957164">,</span>&nbsp;<span class="ident" id="6957166">net2</span><span class="op" id="6957170">:</span>&nbsp;<span class="string" id="6957172">&#34;tcp&#34;</span><span class="op" id="6957177">,</span>&nbsp;<span class="ident" id="6957179">laddr2</span><span class="op" id="6957185">:</span>&nbsp;<span class="string" id="6957187">&#34;[::ffff:0.0.0.0]&#34;</span><span class="op" id="6957205">,</span>&nbsp;<span class="ident" id="6957207">wildcard</span><span class="op" id="6957215">:</span>&nbsp;<span class="ident" id="6957217">true</span><span class="op" id="6957221">,</span>&nbsp;<span class="ident" id="6957223">xerr</span><span class="op" id="6957227">:</span>&nbsp;<span class="ident" id="6957229"><a href="/net/unicast_posix_test.go.html#6951158">syscall</a></span><span class="op" id="6957236">.</span><span class="ident" id="6957237">EADDRINUSE</span><span class="op" id="6957247">}</span><span class="op" id="6957248">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6957252">{</span><span class="ident" id="6957253">net1</span><span class="op" id="6957257">:</span>&nbsp;<span class="string" id="6957259">&#34;tcp4&#34;</span><span class="op" id="6957265">,</span>&nbsp;<span class="ident" id="6957267">laddr1</span><span class="op" id="6957273">:</span>&nbsp;<span class="string" id="6957275">&#34;&#34;</span><span class="op" id="6957277">,</span>&nbsp;<span class="ident" id="6957279">net2</span><span class="op" id="6957283">:</span>&nbsp;<span class="string" id="6957285">&#34;tcp6&#34;</span><span class="op" id="6957291">,</span>&nbsp;<span class="ident" id="6957293">laddr2</span><span class="op" id="6957299">:</span>&nbsp;<span class="string" id="6957301">&#34;&#34;</span><span class="op" id="6957303">,</span>&nbsp;<span class="ident" id="6957305">wildcard</span><span class="op" id="6957313">:</span>&nbsp;<span class="ident" id="6957315">true</span><span class="op" id="6957319">}</span><span class="op" id="6957320">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6957323">{</span><span class="ident" id="6957324">net1</span><span class="op" id="6957328">:</span>&nbsp;<span class="string" id="6957330">&#34;tcp6&#34;</span><span class="op" id="6957336">,</span>&nbsp;<span class="ident" id="6957338">laddr1</span><span class="op" id="6957344">:</span>&nbsp;<span class="string" id="6957346">&#34;&#34;</span><span class="op" id="6957348">,</span>&nbsp;<span class="ident" id="6957350">net2</span><span class="op" id="6957354">:</span>&nbsp;<span class="string" id="6957356">&#34;tcp4&#34;</span><span class="op" id="6957362">,</span>&nbsp;<span class="ident" id="6957364">laddr2</span><span class="op" id="6957370">:</span>&nbsp;<span class="string" id="6957372">&#34;&#34;</span><span class="op" id="6957374">,</span>&nbsp;<span class="ident" id="6957376">wildcard</span><span class="op" id="6957384">:</span>&nbsp;<span class="ident" id="6957386">true</span><span class="op" id="6957390">}</span><span class="op" id="6957391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6957394">{</span><span class="ident" id="6957395">net1</span><span class="op" id="6957399">:</span>&nbsp;<span class="string" id="6957401">&#34;tcp4&#34;</span><span class="op" id="6957407">,</span>&nbsp;<span class="ident" id="6957409">laddr1</span><span class="op" id="6957415">:</span>&nbsp;<span class="string" id="6957417">&#34;0.0.0.0&#34;</span><span class="op" id="6957426">,</span>&nbsp;<span class="ident" id="6957428">net2</span><span class="op" id="6957432">:</span>&nbsp;<span class="string" id="6957434">&#34;tcp6&#34;</span><span class="op" id="6957440">,</span>&nbsp;<span class="ident" id="6957442">laddr2</span><span class="op" id="6957448">:</span>&nbsp;<span class="string" id="6957450">&#34;[::]&#34;</span><span class="op" id="6957456">,</span>&nbsp;<span class="ident" id="6957458">wildcard</span><span class="op" id="6957466">:</span>&nbsp;<span class="ident" id="6957468">true</span><span class="op" id="6957472">}</span><span class="op" id="6957473">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6957476">{</span><span class="ident" id="6957477">net1</span><span class="op" id="6957481">:</span>&nbsp;<span class="string" id="6957483">&#34;tcp6&#34;</span><span class="op" id="6957489">,</span>&nbsp;<span class="ident" id="6957491">laddr1</span><span class="op" id="6957497">:</span>&nbsp;<span class="string" id="6957499">&#34;[::]&#34;</span><span class="op" id="6957505">,</span>&nbsp;<span class="ident" id="6957507">net2</span><span class="op" id="6957511">:</span>&nbsp;<span class="string" id="6957513">&#34;tcp4&#34;</span><span class="op" id="6957519">,</span>&nbsp;<span class="ident" id="6957521">laddr2</span><span class="op" id="6957527">:</span>&nbsp;<span class="string" id="6957529">&#34;0.0.0.0&#34;</span><span class="op" id="6957538">,</span>&nbsp;<span class="ident" id="6957540">wildcard</span><span class="op" id="6957548">:</span>&nbsp;<span class="ident" id="6957550">true</span><span class="op" id="6957554">}</span><span class="op" id="6957555">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6957559">{</span><span class="ident" id="6957560">net1</span><span class="op" id="6957564">:</span>&nbsp;<span class="string" id="6957566">&#34;tcp&#34;</span><span class="op" id="6957571">,</span>&nbsp;<span class="ident" id="6957573">laddr1</span><span class="op" id="6957579">:</span>&nbsp;<span class="string" id="6957581">&#34;127.0.0.1&#34;</span><span class="op" id="6957592">,</span>&nbsp;<span class="ident" id="6957594">net2</span><span class="op" id="6957598">:</span>&nbsp;<span class="string" id="6957600">&#34;tcp&#34;</span><span class="op" id="6957605">,</span>&nbsp;<span class="ident" id="6957607">laddr2</span><span class="op" id="6957613">:</span>&nbsp;<span class="string" id="6957615">&#34;[::1]&#34;</span><span class="op" id="6957622">}</span><span class="op" id="6957623">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6957626">{</span><span class="ident" id="6957627">net1</span><span class="op" id="6957631">:</span>&nbsp;<span class="string" id="6957633">&#34;tcp&#34;</span><span class="op" id="6957638">,</span>&nbsp;<span class="ident" id="6957640">laddr1</span><span class="op" id="6957646">:</span>&nbsp;<span class="string" id="6957648">&#34;[::1]&#34;</span><span class="op" id="6957655">,</span>&nbsp;<span class="ident" id="6957657">net2</span><span class="op" id="6957661">:</span>&nbsp;<span class="string" id="6957663">&#34;tcp&#34;</span><span class="op" id="6957668">,</span>&nbsp;<span class="ident" id="6957670">laddr2</span><span class="op" id="6957676">:</span>&nbsp;<span class="string" id="6957678">&#34;127.0.0.1&#34;</span><span class="op" id="6957689">}</span><span class="op" id="6957690">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6957693">{</span><span class="ident" id="6957694">net1</span><span class="op" id="6957698">:</span>&nbsp;<span class="string" id="6957700">&#34;tcp4&#34;</span><span class="op" id="6957706">,</span>&nbsp;<span class="ident" id="6957708">laddr1</span><span class="op" id="6957714">:</span>&nbsp;<span class="string" id="6957716">&#34;127.0.0.1&#34;</span><span class="op" id="6957727">,</span>&nbsp;<span class="ident" id="6957729">net2</span><span class="op" id="6957733">:</span>&nbsp;<span class="string" id="6957735">&#34;tcp6&#34;</span><span class="op" id="6957741">,</span>&nbsp;<span class="ident" id="6957743">laddr2</span><span class="op" id="6957749">:</span>&nbsp;<span class="string" id="6957751">&#34;[::1]&#34;</span><span class="op" id="6957758">}</span><span class="op" id="6957759">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6957762">{</span><span class="ident" id="6957763">net1</span><span class="op" id="6957767">:</span>&nbsp;<span class="string" id="6957769">&#34;tcp6&#34;</span><span class="op" id="6957775">,</span>&nbsp;<span class="ident" id="6957777">laddr1</span><span class="op" id="6957783">:</span>&nbsp;<span class="string" id="6957785">&#34;[::1]&#34;</span><span class="op" id="6957792">,</span>&nbsp;<span class="ident" id="6957794">net2</span><span class="op" id="6957798">:</span>&nbsp;<span class="string" id="6957800">&#34;tcp4&#34;</span><span class="op" id="6957806">,</span>&nbsp;<span class="ident" id="6957808">laddr2</span><span class="op" id="6957814">:</span>&nbsp;<span class="string" id="6957816">&#34;127.0.0.1&#34;</span><span class="op" id="6957827">}</span><span class="op" id="6957828">,</span><br>
<span class="lineno"></span><span class="op" id="6957830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6957833">//&nbsp;TestDualStackTCPListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen</span><br>
<span class="lineno"></span><span class="comment" id="6957897">//&nbsp;to&nbsp;a&nbsp;test&nbsp;listener&nbsp;with&nbsp;various&nbsp;address&nbsp;families,&nbsp;different</span><br>
<span class="lineno">170</span><span class="comment" id="6957960">//&nbsp;listening&nbsp;address&nbsp;and&nbsp;same&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="6957996">func</span>&nbsp;<span class="ident" id="6958001">TestDualStackTCPListener</span><span class="op" id="6958025">(</span><span class="ident" id="6958026">t</span>&nbsp;<span class="op" id="6958028">*</span><span class="ident" id="6958029"><a href="/net/unicast_posix_test.go.html#6951169">testing</a></span><span class="op" id="6958036">.</span><span class="ident" id="6958037">T</span><span class="op" id="6958038">)</span>&nbsp;<span class="op" id="6958040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958043">if</span>&nbsp;<span class="ident" id="6958046"><a href="/net/unicast_posix_test.go.html#6951169">testing</a></span><span class="op" id="6958053">.</span><span class="ident" id="6958054">Short</span><span class="op" id="6958059">(</span><span class="op" id="6958060">)</span>&nbsp;<span class="op" id="6958062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6958066"><a href="/net/unicast_posix_test.go.html#6958026">t</a></span><span class="op" id="6958067">.</span><span class="ident" id="6958068">Skip</span><span class="op" id="6958072">(</span><span class="string" id="6958073">&#34;skipping&nbsp;in&nbsp;-short&nbsp;mode,&nbsp;see&nbsp;issue&nbsp;5001&#34;</span><span class="op" id="6958114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6958117">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958120">switch</span>&nbsp;<span class="ident" id="6958127"><a href="/net/unicast_posix_test.go.html#6951147">runtime</a></span><span class="op" id="6958134">.</span><span class="ident" id="6958135">GOOS</span>&nbsp;<span class="op" id="6958140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958143">case</span>&nbsp;<span class="string" id="6958148">&#34;plan9&#34;</span><span class="op" id="6958155">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6958159"><a href="/net/unicast_posix_test.go.html#6958026">t</a></span><span class="op" id="6958160">.</span><span class="ident" id="6958161">Skipf</span><span class="op" id="6958166">(</span><span class="string" id="6958167">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6958188">,</span>&nbsp;<span class="ident" id="6958190"><a href="/net/unicast_posix_test.go.html#6951147">runtime</a></span><span class="op" id="6958197">.</span><span class="ident" id="6958198">GOOS</span><span class="op" id="6958202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6958205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958208">if</span>&nbsp;<span class="op" id="6958211">!</span><span class="ident" id="6958212"><a href="/net/ipsock.go.html#2627769">supportsIPv6</a></span>&nbsp;<span class="op" id="6958225">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6958229"><a href="/net/unicast_posix_test.go.html#6958026">t</a></span><span class="op" id="6958230">.</span><span class="ident" id="6958231">Skip</span><span class="op" id="6958235">(</span><span class="string" id="6958236">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6958259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6958262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958266">for</span>&nbsp;<span class="ident" id="6958270">_</span><span class="op" id="6958271">,</span>&nbsp;<span class="ident" id="6958273">tt</span>&nbsp;<span class="op" id="6958276">:=</span>&nbsp;<span class="keyword" id="6958279">range</span>&nbsp;<span class="ident" id="6958285"><a href="/net/unicast_posix_test.go.html#6953619">dualStackListenerTests</a></span>&nbsp;<span class="op" id="6958308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958312">if</span>&nbsp;<span class="ident" id="6958315"><a href="/net/unicast_posix_test.go.html#6958273">tt</a></span><span class="op" id="6958317">.</span><span class="ident" id="6958318">wildcard</span>&nbsp;<span class="op" id="6958327">&amp;&amp;</span>&nbsp;<span class="op" id="6958330">!</span><span class="op" id="6958331">*</span><span class="ident" id="6958332"><a href="/net/lookup_test.go.html#6856134">testExternal</a></span>&nbsp;<span class="op" id="6958345">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958350">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6958361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958365">switch</span>&nbsp;<span class="ident" id="6958372"><a href="/net/unicast_posix_test.go.html#6951147">runtime</a></span><span class="op" id="6958379">.</span><span class="ident" id="6958380">GOOS</span>&nbsp;<span class="op" id="6958385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958389">case</span>&nbsp;<span class="string" id="6958394">&#34;openbsd&#34;</span><span class="op" id="6958403">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958408">if</span>&nbsp;<span class="ident" id="6958411"><a href="/net/unicast_posix_test.go.html#6958273">tt</a></span><span class="op" id="6958413">.</span><span class="ident" id="6958414">wildcard</span>&nbsp;<span class="op" id="6958423">&amp;&amp;</span>&nbsp;<span class="ident" id="6958426"><a href="/net/unicast_posix_test.go.html#6961035">differentWildcardAddr</a></span><span class="op" id="6958447">(</span><span class="ident" id="6958448"><a href="/net/unicast_posix_test.go.html#6958273">tt</a></span><span class="op" id="6958450">.</span><span class="ident" id="6958451">laddr1</span><span class="op" id="6958457">,</span>&nbsp;<span class="ident" id="6958459"><a href="/net/unicast_posix_test.go.html#6958273">tt</a></span><span class="op" id="6958461">.</span><span class="ident" id="6958462">laddr2</span><span class="op" id="6958468">)</span>&nbsp;<span class="op" id="6958470">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6958476"><a href="/net/unicast_posix_test.go.html#6958273">tt</a></span><span class="op" id="6958478">.</span><span class="ident" id="6958479">xerr</span>&nbsp;<span class="op" id="6958484">=</span>&nbsp;<span class="ident" id="6958486">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6958493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6958497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6958501">l1</span><span class="op" id="6958503">,</span>&nbsp;<span class="ident" id="6958505">port</span>&nbsp;<span class="op" id="6958510">:=</span>&nbsp;<span class="ident" id="6958513"><a href="/net/unicast_posix_test.go.html#6960012">usableListenPort</a></span><span class="op" id="6958529">(</span><span class="ident" id="6958530"><a href="/net/unicast_posix_test.go.html#6958026">t</a></span><span class="op" id="6958531">,</span>&nbsp;<span class="ident" id="6958533"><a href="/net/unicast_posix_test.go.html#6958273">tt</a></span><span class="op" id="6958535">.</span><span class="ident" id="6958536">net1</span><span class="op" id="6958540">,</span>&nbsp;<span class="ident" id="6958542"><a href="/net/unicast_posix_test.go.html#6958273">tt</a></span><span class="op" id="6958544">.</span><span class="ident" id="6958545">laddr1</span><span class="op" id="6958551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6958555">laddr</span>&nbsp;<span class="op" id="6958561">:=</span>&nbsp;<span class="ident" id="6958564"><a href="/net/unicast_posix_test.go.html#6958273">tt</a></span><span class="op" id="6958566">.</span><span class="ident" id="6958567">laddr1</span>&nbsp;<span class="op" id="6958574">+</span>&nbsp;<span class="string" id="6958576">&#34;:&#34;</span>&nbsp;<span class="op" id="6958580">+</span>&nbsp;<span class="ident" id="6958582"><a href="/net/unicast_posix_test.go.html#6958505">port</a></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6958589"><a href="/net/unicast_posix_test.go.html#6961282">checkFirstListener</a></span><span class="op" id="6958607">(</span><span class="ident" id="6958608"><a href="/net/unicast_posix_test.go.html#6958026">t</a></span><span class="op" id="6958609">,</span>&nbsp;<span class="ident" id="6958611"><a href="/net/unicast_posix_test.go.html#6958273">tt</a></span><span class="op" id="6958613">.</span><span class="ident" id="6958614">net1</span><span class="op" id="6958618">,</span>&nbsp;<span class="ident" id="6958620"><a href="/net/unicast_posix_test.go.html#6958555">laddr</a></span><span class="op" id="6958625">,</span>&nbsp;<span class="ident" id="6958627"><a href="/net/unicast_posix_test.go.html#6958501">l1</a></span><span class="op" id="6958629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6958633"><a href="/net/unicast_posix_test.go.html#6958555">laddr</a></span>&nbsp;<span class="op" id="6958639">=</span>&nbsp;<span class="ident" id="6958641"><a href="/net/unicast_posix_test.go.html#6958273">tt</a></span><span class="op" id="6958643">.</span><span class="ident" id="6958644">laddr2</span>&nbsp;<span class="op" id="6958651">+</span>&nbsp;<span class="string" id="6958653">&#34;:&#34;</span>&nbsp;<span class="op" id="6958657">+</span>&nbsp;<span class="ident" id="6958659"><a href="/net/unicast_posix_test.go.html#6958505">port</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6958666">l2</span><span class="op" id="6958668">,</span>&nbsp;<span class="ident" id="6958670">err</span>&nbsp;<span class="op" id="6958674">:=</span>&nbsp;<span class="ident" id="6958677"><a href="/net/dial.go.html#2525176">Listen</a></span><span class="op" id="6958683">(</span><span class="ident" id="6958684"><a href="/net/unicast_posix_test.go.html#6958273">tt</a></span><span class="op" id="6958686">.</span><span class="ident" id="6958687">net2</span><span class="op" id="6958691">,</span>&nbsp;<span class="ident" id="6958693"><a href="/net/unicast_posix_test.go.html#6958555">laddr</a></span><span class="op" id="6958698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6958702"><a href="/net/unicast_posix_test.go.html#6962834">checkDualStackSecondListener</a></span><span class="op" id="6958730">(</span><span class="ident" id="6958731"><a href="/net/unicast_posix_test.go.html#6958026">t</a></span><span class="op" id="6958732">,</span>&nbsp;<span class="ident" id="6958734"><a href="/net/unicast_posix_test.go.html#6958273">tt</a></span><span class="op" id="6958736">.</span><span class="ident" id="6958737">net2</span><span class="op" id="6958741">,</span>&nbsp;<span class="ident" id="6958743"><a href="/net/unicast_posix_test.go.html#6958555">laddr</a></span><span class="op" id="6958748">,</span>&nbsp;<span class="ident" id="6958750"><a href="/net/unicast_posix_test.go.html#6958273">tt</a></span><span class="op" id="6958752">.</span><span class="ident" id="6958753">xerr</span><span class="op" id="6958757">,</span>&nbsp;<span class="ident" id="6958759"><a href="/net/unicast_posix_test.go.html#6958670">err</a></span><span class="op" id="6958762">,</span>&nbsp;<span class="ident" id="6958764"><a href="/net/unicast_posix_test.go.html#6958666">l2</a></span><span class="op" id="6958766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6958770"><a href="/net/unicast_posix_test.go.html#6958501">l1</a></span><span class="op" id="6958772">.</span><span class="ident" id="6958773">Close</span><span class="op" id="6958778">(</span><span class="op" id="6958779">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6958782">}</span><br>
<span class="lineno"></span><span class="op" id="6958784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6958787">//&nbsp;TestDualStackUDPListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen</span><br>
<span class="lineno"></span><span class="comment" id="6958851">//&nbsp;to&nbsp;a&nbsp;test&nbsp;listener&nbsp;with&nbsp;various&nbsp;address&nbsp;families,&nbsp;differnet</span><br>
<span class="lineno">205</span><span class="comment" id="6958914">//&nbsp;listening&nbsp;address&nbsp;and&nbsp;same&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="6958950">func</span>&nbsp;<span class="ident" id="6958955">TestDualStackUDPListener</span><span class="op" id="6958979">(</span><span class="ident" id="6958980">t</span>&nbsp;<span class="op" id="6958982">*</span><span class="ident" id="6958983"><a href="/net/unicast_posix_test.go.html#6951169">testing</a></span><span class="op" id="6958990">.</span><span class="ident" id="6958991">T</span><span class="op" id="6958992">)</span>&nbsp;<span class="op" id="6958994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6958997">if</span>&nbsp;<span class="ident" id="6959000"><a href="/net/unicast_posix_test.go.html#6951169">testing</a></span><span class="op" id="6959007">.</span><span class="ident" id="6959008">Short</span><span class="op" id="6959013">(</span><span class="op" id="6959014">)</span>&nbsp;<span class="op" id="6959016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959020"><a href="/net/unicast_posix_test.go.html#6958980">t</a></span><span class="op" id="6959021">.</span><span class="ident" id="6959022">Skip</span><span class="op" id="6959026">(</span><span class="string" id="6959027">&#34;skipping&nbsp;in&nbsp;-short&nbsp;mode,&nbsp;see&nbsp;issue&nbsp;5001&#34;</span><span class="op" id="6959068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6959071">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959074">switch</span>&nbsp;<span class="ident" id="6959081"><a href="/net/unicast_posix_test.go.html#6951147">runtime</a></span><span class="op" id="6959088">.</span><span class="ident" id="6959089">GOOS</span>&nbsp;<span class="op" id="6959094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959097">case</span>&nbsp;<span class="string" id="6959102">&#34;plan9&#34;</span><span class="op" id="6959109">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959113"><a href="/net/unicast_posix_test.go.html#6958980">t</a></span><span class="op" id="6959114">.</span><span class="ident" id="6959115">Skipf</span><span class="op" id="6959120">(</span><span class="string" id="6959121">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6959142">,</span>&nbsp;<span class="ident" id="6959144"><a href="/net/unicast_posix_test.go.html#6951147">runtime</a></span><span class="op" id="6959151">.</span><span class="ident" id="6959152">GOOS</span><span class="op" id="6959156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6959159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959162">if</span>&nbsp;<span class="op" id="6959165">!</span><span class="ident" id="6959166"><a href="/net/ipsock.go.html#2627769">supportsIPv6</a></span>&nbsp;<span class="op" id="6959179">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959183"><a href="/net/unicast_posix_test.go.html#6958980">t</a></span><span class="op" id="6959184">.</span><span class="ident" id="6959185">Skip</span><span class="op" id="6959189">(</span><span class="string" id="6959190">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6959213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6959216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959220">toudpnet</span>&nbsp;<span class="op" id="6959229">:=</span>&nbsp;<span class="keyword" id="6959232">func</span><span class="op" id="6959236">(</span><span class="ident" id="6959237">net</span>&nbsp;<span class="builtintype" id="6959241">string</span><span class="op" id="6959247">)</span>&nbsp;<span class="builtintype" id="6959249">string</span>&nbsp;<span class="op" id="6959256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959260">switch</span>&nbsp;<span class="ident" id="6959267"><a href="/net/unicast_posix_test.go.html#6959237">net</a></span>&nbsp;<span class="op" id="6959271">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959275">case</span>&nbsp;<span class="string" id="6959280">&#34;tcp&#34;</span><span class="op" id="6959285">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959290">return</span>&nbsp;<span class="string" id="6959297">&#34;udp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959305">case</span>&nbsp;<span class="string" id="6959310">&#34;tcp4&#34;</span><span class="op" id="6959316">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959321">return</span>&nbsp;<span class="string" id="6959328">&#34;udp4&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959337">case</span>&nbsp;<span class="string" id="6959342">&#34;tcp6&#34;</span><span class="op" id="6959348">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959353">return</span>&nbsp;<span class="string" id="6959360">&#34;udp6&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6959369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959373">return</span>&nbsp;<span class="string" id="6959380">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6959389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959393">for</span>&nbsp;<span class="ident" id="6959397">_</span><span class="op" id="6959398">,</span>&nbsp;<span class="ident" id="6959400">tt</span>&nbsp;<span class="op" id="6959403">:=</span>&nbsp;<span class="keyword" id="6959406">range</span>&nbsp;<span class="ident" id="6959412"><a href="/net/unicast_posix_test.go.html#6953619">dualStackListenerTests</a></span>&nbsp;<span class="op" id="6959435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959439">if</span>&nbsp;<span class="ident" id="6959442"><a href="/net/unicast_posix_test.go.html#6959400">tt</a></span><span class="op" id="6959444">.</span><span class="ident" id="6959445">wildcard</span>&nbsp;<span class="op" id="6959454">&amp;&amp;</span>&nbsp;<span class="op" id="6959457">(</span><span class="ident" id="6959458"><a href="/net/unicast_posix_test.go.html#6951169">testing</a></span><span class="op" id="6959465">.</span><span class="ident" id="6959466">Short</span><span class="op" id="6959471">(</span><span class="op" id="6959472">)</span>&nbsp;<span class="op" id="6959474">||</span>&nbsp;<span class="op" id="6959477">!</span><span class="op" id="6959478">*</span><span class="ident" id="6959479"><a href="/net/lookup_test.go.html#6856134">testExternal</a></span><span class="op" id="6959491">)</span>&nbsp;<span class="op" id="6959493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959498">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6959509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959513"><a href="/net/unicast_posix_test.go.html#6959400">tt</a></span><span class="op" id="6959515">.</span><span class="ident" id="6959516">net1</span>&nbsp;<span class="op" id="6959521">=</span>&nbsp;<span class="ident" id="6959523"><a href="/net/unicast_posix_test.go.html#6959220">toudpnet</a></span><span class="op" id="6959531">(</span><span class="ident" id="6959532"><a href="/net/unicast_posix_test.go.html#6959400">tt</a></span><span class="op" id="6959534">.</span><span class="ident" id="6959535">net1</span><span class="op" id="6959539">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959543"><a href="/net/unicast_posix_test.go.html#6959400">tt</a></span><span class="op" id="6959545">.</span><span class="ident" id="6959546">net2</span>&nbsp;<span class="op" id="6959551">=</span>&nbsp;<span class="ident" id="6959553"><a href="/net/unicast_posix_test.go.html#6959220">toudpnet</a></span><span class="op" id="6959561">(</span><span class="ident" id="6959562"><a href="/net/unicast_posix_test.go.html#6959400">tt</a></span><span class="op" id="6959564">.</span><span class="ident" id="6959565">net2</span><span class="op" id="6959569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959573">switch</span>&nbsp;<span class="ident" id="6959580"><a href="/net/unicast_posix_test.go.html#6951147">runtime</a></span><span class="op" id="6959587">.</span><span class="ident" id="6959588">GOOS</span>&nbsp;<span class="op" id="6959593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959597">case</span>&nbsp;<span class="string" id="6959602">&#34;openbsd&#34;</span><span class="op" id="6959611">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6959616">if</span>&nbsp;<span class="ident" id="6959619"><a href="/net/unicast_posix_test.go.html#6959400">tt</a></span><span class="op" id="6959621">.</span><span class="ident" id="6959622">wildcard</span>&nbsp;<span class="op" id="6959631">&amp;&amp;</span>&nbsp;<span class="ident" id="6959634"><a href="/net/unicast_posix_test.go.html#6961035">differentWildcardAddr</a></span><span class="op" id="6959655">(</span><span class="ident" id="6959656"><a href="/net/unicast_posix_test.go.html#6959400">tt</a></span><span class="op" id="6959658">.</span><span class="ident" id="6959659">laddr1</span><span class="op" id="6959665">,</span>&nbsp;<span class="ident" id="6959667"><a href="/net/unicast_posix_test.go.html#6959400">tt</a></span><span class="op" id="6959669">.</span><span class="ident" id="6959670">laddr2</span><span class="op" id="6959676">)</span>&nbsp;<span class="op" id="6959678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959684"><a href="/net/unicast_posix_test.go.html#6959400">tt</a></span><span class="op" id="6959686">.</span><span class="ident" id="6959687">xerr</span>&nbsp;<span class="op" id="6959692">=</span>&nbsp;<span class="ident" id="6959694">nil</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6959701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6959705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959709">l1</span><span class="op" id="6959711">,</span>&nbsp;<span class="ident" id="6959713">port</span>&nbsp;<span class="op" id="6959718">:=</span>&nbsp;<span class="ident" id="6959721"><a href="/net/unicast_posix_test.go.html#6960510">usableListenPacketPort</a></span><span class="op" id="6959743">(</span><span class="ident" id="6959744"><a href="/net/unicast_posix_test.go.html#6958980">t</a></span><span class="op" id="6959745">,</span>&nbsp;<span class="ident" id="6959747"><a href="/net/unicast_posix_test.go.html#6959400">tt</a></span><span class="op" id="6959749">.</span><span class="ident" id="6959750">net1</span><span class="op" id="6959754">,</span>&nbsp;<span class="ident" id="6959756"><a href="/net/unicast_posix_test.go.html#6959400">tt</a></span><span class="op" id="6959758">.</span><span class="ident" id="6959759">laddr1</span><span class="op" id="6959765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959769">laddr</span>&nbsp;<span class="op" id="6959775">:=</span>&nbsp;<span class="ident" id="6959778"><a href="/net/unicast_posix_test.go.html#6959400">tt</a></span><span class="op" id="6959780">.</span><span class="ident" id="6959781">laddr1</span>&nbsp;<span class="op" id="6959788">+</span>&nbsp;<span class="string" id="6959790">&#34;:&#34;</span>&nbsp;<span class="op" id="6959794">+</span>&nbsp;<span class="ident" id="6959796"><a href="/net/unicast_posix_test.go.html#6959713">port</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959803"><a href="/net/unicast_posix_test.go.html#6961282">checkFirstListener</a></span><span class="op" id="6959821">(</span><span class="ident" id="6959822"><a href="/net/unicast_posix_test.go.html#6958980">t</a></span><span class="op" id="6959823">,</span>&nbsp;<span class="ident" id="6959825"><a href="/net/unicast_posix_test.go.html#6959400">tt</a></span><span class="op" id="6959827">.</span><span class="ident" id="6959828">net1</span><span class="op" id="6959832">,</span>&nbsp;<span class="ident" id="6959834"><a href="/net/unicast_posix_test.go.html#6959769">laddr</a></span><span class="op" id="6959839">,</span>&nbsp;<span class="ident" id="6959841"><a href="/net/unicast_posix_test.go.html#6959709">l1</a></span><span class="op" id="6959843">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959847"><a href="/net/unicast_posix_test.go.html#6959769">laddr</a></span>&nbsp;<span class="op" id="6959853">=</span>&nbsp;<span class="ident" id="6959855"><a href="/net/unicast_posix_test.go.html#6959400">tt</a></span><span class="op" id="6959857">.</span><span class="ident" id="6959858">laddr2</span>&nbsp;<span class="op" id="6959865">+</span>&nbsp;<span class="string" id="6959867">&#34;:&#34;</span>&nbsp;<span class="op" id="6959871">+</span>&nbsp;<span class="ident" id="6959873"><a href="/net/unicast_posix_test.go.html#6959713">port</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959880">l2</span><span class="op" id="6959882">,</span>&nbsp;<span class="ident" id="6959884">err</span>&nbsp;<span class="op" id="6959888">:=</span>&nbsp;<span class="ident" id="6959891"><a href="/net/dial.go.html#2525968">ListenPacket</a></span><span class="op" id="6959903">(</span><span class="ident" id="6959904"><a href="/net/unicast_posix_test.go.html#6959400">tt</a></span><span class="op" id="6959906">.</span><span class="ident" id="6959907">net2</span><span class="op" id="6959911">,</span>&nbsp;<span class="ident" id="6959913"><a href="/net/unicast_posix_test.go.html#6959769">laddr</a></span><span class="op" id="6959918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959922"><a href="/net/unicast_posix_test.go.html#6962834">checkDualStackSecondListener</a></span><span class="op" id="6959950">(</span><span class="ident" id="6959951"><a href="/net/unicast_posix_test.go.html#6958980">t</a></span><span class="op" id="6959952">,</span>&nbsp;<span class="ident" id="6959954"><a href="/net/unicast_posix_test.go.html#6959400">tt</a></span><span class="op" id="6959956">.</span><span class="ident" id="6959957">net2</span><span class="op" id="6959961">,</span>&nbsp;<span class="ident" id="6959963"><a href="/net/unicast_posix_test.go.html#6959769">laddr</a></span><span class="op" id="6959968">,</span>&nbsp;<span class="ident" id="6959970"><a href="/net/unicast_posix_test.go.html#6959400">tt</a></span><span class="op" id="6959972">.</span><span class="ident" id="6959973">xerr</span><span class="op" id="6959977">,</span>&nbsp;<span class="ident" id="6959979"><a href="/net/unicast_posix_test.go.html#6959884">err</a></span><span class="op" id="6959982">,</span>&nbsp;<span class="ident" id="6959984"><a href="/net/unicast_posix_test.go.html#6959880">l2</a></span><span class="op" id="6959986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6959990"><a href="/net/unicast_posix_test.go.html#6959709">l1</a></span><span class="op" id="6959992">.</span><span class="ident" id="6959993">Close</span><span class="op" id="6959998">(</span><span class="op" id="6959999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6960002">}</span><br>
<span class="lineno">250</span><span class="op" id="6960004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6960007">func</span>&nbsp;<span class="ident" id="6960012">usableListenPort</span><span class="op" id="6960028">(</span><span class="ident" id="6960029">t</span>&nbsp;<span class="op" id="6960031">*</span><span class="ident" id="6960032"><a href="/net/unicast_posix_test.go.html#6951169">testing</a></span><span class="op" id="6960039">.</span><span class="ident" id="6960040">T</span><span class="op" id="6960041">,</span>&nbsp;<span class="ident" id="6960043">net</span><span class="op" id="6960046">,</span>&nbsp;<span class="ident" id="6960048">laddr</span>&nbsp;<span class="builtintype" id="6960054">string</span><span class="op" id="6960060">)</span>&nbsp;<span class="op" id="6960062">(</span><span class="ident" id="6960063">l</span>&nbsp;<span class="ident" id="6960065"><a href="/net/net.go.html#2658762">Listener</a></span><span class="op" id="6960073">,</span>&nbsp;<span class="ident" id="6960075">port</span>&nbsp;<span class="builtintype" id="6960080">string</span><span class="op" id="6960086">)</span>&nbsp;<span class="op" id="6960088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6960091">var</span>&nbsp;<span class="ident" id="6960095">nladdr</span>&nbsp;<span class="builtintype" id="6960102">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6960110">var</span>&nbsp;<span class="ident" id="6960114">err</span>&nbsp;<span class="builtintype" id="6960118">error</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6960125">switch</span>&nbsp;<span class="ident" id="6960132"><a href="/net/unicast_posix_test.go.html#6960043">net</a></span>&nbsp;<span class="op" id="6960136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6960139">default</span><span class="op" id="6960146">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6960150">panic</span><span class="op" id="6960155">(</span><span class="string" id="6960156">&#34;usableListenPort&nbsp;net=&#34;</span>&nbsp;<span class="op" id="6960180">+</span>&nbsp;<span class="ident" id="6960182"><a href="/net/unicast_posix_test.go.html#6960043">net</a></span><span class="op" id="6960185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6960188">case</span>&nbsp;<span class="string" id="6960193">&#34;tcp&#34;</span><span class="op" id="6960198">,</span>&nbsp;<span class="string" id="6960200">&#34;tcp4&#34;</span><span class="op" id="6960206">,</span>&nbsp;<span class="string" id="6960208">&#34;tcp6&#34;</span><span class="op" id="6960214">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6960218"><a href="/net/unicast_posix_test.go.html#6960063">l</a></span><span class="op" id="6960219">,</span>&nbsp;<span class="ident" id="6960221"><a href="/net/unicast_posix_test.go.html#6960114">err</a></span>&nbsp;<span class="op" id="6960225">=</span>&nbsp;<span class="ident" id="6960227"><a href="/net/dial.go.html#2525176">Listen</a></span><span class="op" id="6960233">(</span><span class="ident" id="6960234"><a href="/net/unicast_posix_test.go.html#6960043">net</a></span><span class="op" id="6960237">,</span>&nbsp;<span class="ident" id="6960239"><a href="/net/unicast_posix_test.go.html#6960048">laddr</a></span><span class="op" id="6960244">+</span><span class="string" id="6960245">&#34;:0&#34;</span><span class="op" id="6960249">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6960253">if</span>&nbsp;<span class="ident" id="6960256"><a href="/net/unicast_posix_test.go.html#6960114">err</a></span>&nbsp;<span class="op" id="6960260">!=</span>&nbsp;<span class="ident" id="6960263">nil</span>&nbsp;<span class="op" id="6960267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6960272"><a href="/net/unicast_posix_test.go.html#6960029">t</a></span><span class="op" id="6960273">.</span><span class="ident" id="6960274">Fatalf</span><span class="op" id="6960280">(</span><span class="string" id="6960281">&#34;Probe&nbsp;Listen(%q,&nbsp;%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6960314">,</span>&nbsp;<span class="ident" id="6960316"><a href="/net/unicast_posix_test.go.html#6960043">net</a></span><span class="op" id="6960319">,</span>&nbsp;<span class="ident" id="6960321"><a href="/net/unicast_posix_test.go.html#6960048">laddr</a></span><span class="op" id="6960326">,</span>&nbsp;<span class="ident" id="6960328"><a href="/net/unicast_posix_test.go.html#6960114">err</a></span><span class="op" id="6960331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6960335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6960339"><a href="/net/unicast_posix_test.go.html#6960095">nladdr</a></span>&nbsp;<span class="op" id="6960346">=</span>&nbsp;<span class="ident" id="6960348"><a href="/net/unicast_posix_test.go.html#6960063">l</a></span><span class="op" id="6960349">.</span><span class="op" id="6960350">(</span><span class="op" id="6960351">*</span><span class="ident" id="6960352"><a href="/net/tcpsock_posix.go.html#2699965">TCPListener</a></span><span class="op" id="6960363">)</span><span class="op" id="6960364">.</span><span class="ident" id="6960365">Addr</span><span class="op" id="6960369">(</span><span class="op" id="6960370">)</span><span class="op" id="6960371">.</span><span class="ident" id="6960372">String</span><span class="op" id="6960378">(</span><span class="op" id="6960379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6960382">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6960385">_</span><span class="op" id="6960386">,</span>&nbsp;<span class="ident" id="6960388"><a href="/net/unicast_posix_test.go.html#6960075">port</a></span><span class="op" id="6960392">,</span>&nbsp;<span class="ident" id="6960394"><a href="/net/unicast_posix_test.go.html#6960114">err</a></span>&nbsp;<span class="op" id="6960398">=</span>&nbsp;<span class="ident" id="6960400"><a href="/net/ipsock.go.html#2631267">SplitHostPort</a></span><span class="op" id="6960413">(</span><span class="ident" id="6960414"><a href="/net/unicast_posix_test.go.html#6960095">nladdr</a></span><span class="op" id="6960420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6960423">if</span>&nbsp;<span class="ident" id="6960426"><a href="/net/unicast_posix_test.go.html#6960114">err</a></span>&nbsp;<span class="op" id="6960430">!=</span>&nbsp;<span class="ident" id="6960433">nil</span>&nbsp;<span class="op" id="6960437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6960441"><a href="/net/unicast_posix_test.go.html#6960029">t</a></span><span class="op" id="6960442">.</span><span class="ident" id="6960443">Fatalf</span><span class="op" id="6960449">(</span><span class="string" id="6960450">&#34;SplitHostPort&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6960476">,</span>&nbsp;<span class="ident" id="6960478"><a href="/net/unicast_posix_test.go.html#6960114">err</a></span><span class="op" id="6960481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6960484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6960487">return</span>&nbsp;<span class="ident" id="6960494"><a href="/net/unicast_posix_test.go.html#6960063">l</a></span><span class="op" id="6960495">,</span>&nbsp;<span class="ident" id="6960497"><a href="/net/unicast_posix_test.go.html#6960075">port</a></span><br>
<span class="lineno">270</span><span class="op" id="6960502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6960505">func</span>&nbsp;<span class="ident" id="6960510">usableListenPacketPort</span><span class="op" id="6960532">(</span><span class="ident" id="6960533">t</span>&nbsp;<span class="op" id="6960535">*</span><span class="ident" id="6960536"><a href="/net/unicast_posix_test.go.html#6951169">testing</a></span><span class="op" id="6960543">.</span><span class="ident" id="6960544">T</span><span class="op" id="6960545">,</span>&nbsp;<span class="ident" id="6960547">net</span><span class="op" id="6960550">,</span>&nbsp;<span class="ident" id="6960552">laddr</span>&nbsp;<span class="builtintype" id="6960558">string</span><span class="op" id="6960564">)</span>&nbsp;<span class="op" id="6960566">(</span><span class="ident" id="6960567">l</span>&nbsp;<span class="ident" id="6960569"><a href="/net/net.go.html#2656892">PacketConn</a></span><span class="op" id="6960579">,</span>&nbsp;<span class="ident" id="6960581">port</span>&nbsp;<span class="builtintype" id="6960586">string</span><span class="op" id="6960592">)</span>&nbsp;<span class="op" id="6960594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6960597">var</span>&nbsp;<span class="ident" id="6960601">nladdr</span>&nbsp;<span class="builtintype" id="6960608">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6960616">var</span>&nbsp;<span class="ident" id="6960620">err</span>&nbsp;<span class="builtintype" id="6960624">error</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6960631">switch</span>&nbsp;<span class="ident" id="6960638"><a href="/net/unicast_posix_test.go.html#6960547">net</a></span>&nbsp;<span class="op" id="6960642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6960645">default</span><span class="op" id="6960652">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6960656">panic</span><span class="op" id="6960661">(</span><span class="string" id="6960662">&#34;usableListenPacketPort&nbsp;net=&#34;</span>&nbsp;<span class="op" id="6960692">+</span>&nbsp;<span class="ident" id="6960694"><a href="/net/unicast_posix_test.go.html#6960547">net</a></span><span class="op" id="6960697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6960700">case</span>&nbsp;<span class="string" id="6960705">&#34;udp&#34;</span><span class="op" id="6960710">,</span>&nbsp;<span class="string" id="6960712">&#34;udp4&#34;</span><span class="op" id="6960718">,</span>&nbsp;<span class="string" id="6960720">&#34;udp6&#34;</span><span class="op" id="6960726">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6960730"><a href="/net/unicast_posix_test.go.html#6960567">l</a></span><span class="op" id="6960731">,</span>&nbsp;<span class="ident" id="6960733"><a href="/net/unicast_posix_test.go.html#6960620">err</a></span>&nbsp;<span class="op" id="6960737">=</span>&nbsp;<span class="ident" id="6960739"><a href="/net/dial.go.html#2525968">ListenPacket</a></span><span class="op" id="6960751">(</span><span class="ident" id="6960752"><a href="/net/unicast_posix_test.go.html#6960547">net</a></span><span class="op" id="6960755">,</span>&nbsp;<span class="ident" id="6960757"><a href="/net/unicast_posix_test.go.html#6960552">laddr</a></span><span class="op" id="6960762">+</span><span class="string" id="6960763">&#34;:0&#34;</span><span class="op" id="6960767">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6960771">if</span>&nbsp;<span class="ident" id="6960774"><a href="/net/unicast_posix_test.go.html#6960620">err</a></span>&nbsp;<span class="op" id="6960778">!=</span>&nbsp;<span class="ident" id="6960781">nil</span>&nbsp;<span class="op" id="6960785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6960790"><a href="/net/unicast_posix_test.go.html#6960533">t</a></span><span class="op" id="6960791">.</span><span class="ident" id="6960792">Fatalf</span><span class="op" id="6960798">(</span><span class="string" id="6960799">&#34;Probe&nbsp;ListenPacket(%q,&nbsp;%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6960838">,</span>&nbsp;<span class="ident" id="6960840"><a href="/net/unicast_posix_test.go.html#6960547">net</a></span><span class="op" id="6960843">,</span>&nbsp;<span class="ident" id="6960845"><a href="/net/unicast_posix_test.go.html#6960552">laddr</a></span><span class="op" id="6960850">,</span>&nbsp;<span class="ident" id="6960852"><a href="/net/unicast_posix_test.go.html#6960620">err</a></span><span class="op" id="6960855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6960859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6960863"><a href="/net/unicast_posix_test.go.html#6960601">nladdr</a></span>&nbsp;<span class="op" id="6960870">=</span>&nbsp;<span class="ident" id="6960872"><a href="/net/unicast_posix_test.go.html#6960567">l</a></span><span class="op" id="6960873">.</span><span class="op" id="6960874">(</span><span class="op" id="6960875">*</span><span class="ident" id="6960876"><a href="/net/udpsock_posix.go.html#2706235">UDPConn</a></span><span class="op" id="6960883">)</span><span class="op" id="6960884">.</span><span class="ident" id="6960885">LocalAddr</span><span class="op" id="6960894">(</span><span class="op" id="6960895">)</span><span class="op" id="6960896">.</span><span class="ident" id="6960897">String</span><span class="op" id="6960903">(</span><span class="op" id="6960904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6960907">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6960910">_</span><span class="op" id="6960911">,</span>&nbsp;<span class="ident" id="6960913"><a href="/net/unicast_posix_test.go.html#6960581">port</a></span><span class="op" id="6960917">,</span>&nbsp;<span class="ident" id="6960919"><a href="/net/unicast_posix_test.go.html#6960620">err</a></span>&nbsp;<span class="op" id="6960923">=</span>&nbsp;<span class="ident" id="6960925"><a href="/net/ipsock.go.html#2631267">SplitHostPort</a></span><span class="op" id="6960938">(</span><span class="ident" id="6960939"><a href="/net/unicast_posix_test.go.html#6960601">nladdr</a></span><span class="op" id="6960945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6960948">if</span>&nbsp;<span class="ident" id="6960951"><a href="/net/unicast_posix_test.go.html#6960620">err</a></span>&nbsp;<span class="op" id="6960955">!=</span>&nbsp;<span class="ident" id="6960958">nil</span>&nbsp;<span class="op" id="6960962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6960966"><a href="/net/unicast_posix_test.go.html#6960533">t</a></span><span class="op" id="6960967">.</span><span class="ident" id="6960968">Fatalf</span><span class="op" id="6960974">(</span><span class="string" id="6960975">&#34;SplitHostPort&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6961001">,</span>&nbsp;<span class="ident" id="6961003"><a href="/net/unicast_posix_test.go.html#6960620">err</a></span><span class="op" id="6961006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6961009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6961012">return</span>&nbsp;<span class="ident" id="6961019"><a href="/net/unicast_posix_test.go.html#6960567">l</a></span><span class="op" id="6961020">,</span>&nbsp;<span class="ident" id="6961022"><a href="/net/unicast_posix_test.go.html#6960581">port</a></span><br>
<span class="lineno">290</span><span class="op" id="6961027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6961030">func</span>&nbsp;<span class="ident" id="6961035">differentWildcardAddr</span><span class="op" id="6961056">(</span><span class="ident" id="6961057">i</span><span class="op" id="6961058">,</span>&nbsp;<span class="ident" id="6961060">j</span>&nbsp;<span class="builtintype" id="6961062">string</span><span class="op" id="6961068">)</span>&nbsp;<span class="builtintype" id="6961070">bool</span>&nbsp;<span class="op" id="6961075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6961078">if</span>&nbsp;<span class="op" id="6961081">(</span><span class="ident" id="6961082"><a href="/net/unicast_posix_test.go.html#6961057">i</a></span>&nbsp;<span class="op" id="6961084">==</span>&nbsp;<span class="string" id="6961087">&#34;&#34;</span>&nbsp;<span class="op" id="6961090">||</span>&nbsp;<span class="ident" id="6961093"><a href="/net/unicast_posix_test.go.html#6961057">i</a></span>&nbsp;<span class="op" id="6961095">==</span>&nbsp;<span class="string" id="6961098">&#34;0.0.0.0&#34;</span>&nbsp;<span class="op" id="6961108">||</span>&nbsp;<span class="ident" id="6961111"><a href="/net/unicast_posix_test.go.html#6961057">i</a></span>&nbsp;<span class="op" id="6961113">==</span>&nbsp;<span class="string" id="6961116">&#34;::ffff:0.0.0.0&#34;</span><span class="op" id="6961132">)</span>&nbsp;<span class="op" id="6961134">&amp;&amp;</span>&nbsp;<span class="op" id="6961137">(</span><span class="ident" id="6961138"><a href="/net/unicast_posix_test.go.html#6961060">j</a></span>&nbsp;<span class="op" id="6961140">==</span>&nbsp;<span class="string" id="6961143">&#34;&#34;</span>&nbsp;<span class="op" id="6961146">||</span>&nbsp;<span class="ident" id="6961149"><a href="/net/unicast_posix_test.go.html#6961060">j</a></span>&nbsp;<span class="op" id="6961151">==</span>&nbsp;<span class="string" id="6961154">&#34;0.0.0.0&#34;</span>&nbsp;<span class="op" id="6961164">||</span>&nbsp;<span class="ident" id="6961167"><a href="/net/unicast_posix_test.go.html#6961060">j</a></span>&nbsp;<span class="op" id="6961169">==</span>&nbsp;<span class="string" id="6961172">&#34;::ffff:0.0.0.0&#34;</span><span class="op" id="6961188">)</span>&nbsp;<span class="op" id="6961190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6961194">return</span>&nbsp;<span class="ident" id="6961201">false</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6961208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6961211">if</span>&nbsp;<span class="ident" id="6961214"><a href="/net/unicast_posix_test.go.html#6961057">i</a></span>&nbsp;<span class="op" id="6961216">==</span>&nbsp;<span class="string" id="6961219">&#34;[::]&#34;</span>&nbsp;<span class="op" id="6961226">&amp;&amp;</span>&nbsp;<span class="ident" id="6961229"><a href="/net/unicast_posix_test.go.html#6961060">j</a></span>&nbsp;<span class="op" id="6961231">==</span>&nbsp;<span class="string" id="6961234">&#34;[::]&#34;</span>&nbsp;<span class="op" id="6961241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6961245">return</span>&nbsp;<span class="ident" id="6961252">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6961259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6961262">return</span>&nbsp;<span class="ident" id="6961269">true</span><br>
<span class="lineno">300</span><span class="op" id="6961274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6961277">func</span>&nbsp;<span class="ident" id="6961282">checkFirstListener</span><span class="op" id="6961300">(</span><span class="ident" id="6961301">t</span>&nbsp;<span class="op" id="6961303">*</span><span class="ident" id="6961304"><a href="/net/unicast_posix_test.go.html#6951169">testing</a></span><span class="op" id="6961311">.</span><span class="ident" id="6961312">T</span><span class="op" id="6961313">,</span>&nbsp;<span class="ident" id="6961315">net</span><span class="op" id="6961318">,</span>&nbsp;<span class="ident" id="6961320">laddr</span>&nbsp;<span class="builtintype" id="6961326">string</span><span class="op" id="6961332">,</span>&nbsp;<span class="ident" id="6961334">l</span>&nbsp;<span class="keyword" id="6961336">interface</span><span class="op" id="6961345">{</span><span class="op" id="6961346">}</span><span class="op" id="6961347">)</span>&nbsp;<span class="op" id="6961349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6961352">switch</span>&nbsp;<span class="ident" id="6961359"><a href="/net/unicast_posix_test.go.html#6961315">net</a></span>&nbsp;<span class="op" id="6961363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6961366">case</span>&nbsp;<span class="string" id="6961371">&#34;tcp&#34;</span><span class="op" id="6961376">:</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6961380">fd</span>&nbsp;<span class="op" id="6961383">:=</span>&nbsp;<span class="ident" id="6961386"><a href="/net/unicast_posix_test.go.html#6961334">l</a></span><span class="op" id="6961387">.</span><span class="op" id="6961388">(</span><span class="op" id="6961389">*</span><span class="ident" id="6961390"><a href="/net/tcpsock_posix.go.html#2699965">TCPListener</a></span><span class="op" id="6961401">)</span><span class="op" id="6961402">.</span><span class="ident" id="6961403">fd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6961408"><a href="/net/unicast_posix_test.go.html#6963467">checkDualStackAddrFamily</a></span><span class="op" id="6961432">(</span><span class="ident" id="6961433"><a href="/net/unicast_posix_test.go.html#6961301">t</a></span><span class="op" id="6961434">,</span>&nbsp;<span class="ident" id="6961436"><a href="/net/unicast_posix_test.go.html#6961315">net</a></span><span class="op" id="6961439">,</span>&nbsp;<span class="ident" id="6961441"><a href="/net/unicast_posix_test.go.html#6961320">laddr</a></span><span class="op" id="6961446">,</span>&nbsp;<span class="ident" id="6961448"><a href="/net/unicast_posix_test.go.html#6961380">fd</a></span><span class="op" id="6961450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6961453">case</span>&nbsp;<span class="string" id="6961458">&#34;tcp4&#34;</span><span class="op" id="6961464">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6961468">fd</span>&nbsp;<span class="op" id="6961471">:=</span>&nbsp;<span class="ident" id="6961474"><a href="/net/unicast_posix_test.go.html#6961334">l</a></span><span class="op" id="6961475">.</span><span class="op" id="6961476">(</span><span class="op" id="6961477">*</span><span class="ident" id="6961478"><a href="/net/tcpsock_posix.go.html#2699965">TCPListener</a></span><span class="op" id="6961489">)</span><span class="op" id="6961490">.</span><span class="ident" id="6961491">fd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6961496">if</span>&nbsp;<span class="ident" id="6961499"><a href="/net/unicast_posix_test.go.html#6961468">fd</a></span><span class="op" id="6961501">.</span><span class="ident" id="6961502">family</span>&nbsp;<span class="op" id="6961509">!=</span>&nbsp;<span class="ident" id="6961512"><a href="/net/unicast_posix_test.go.html#6951158">syscall</a></span><span class="op" id="6961519">.</span><span class="ident" id="6961520">AF_INET</span>&nbsp;<span class="op" id="6961528">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6961533"><a href="/net/unicast_posix_test.go.html#6961301">t</a></span><span class="op" id="6961534">.</span><span class="ident" id="6961535">Fatalf</span><span class="op" id="6961541">(</span><span class="string" id="6961542">&#34;First&nbsp;Listen(%q,&nbsp;%q)&nbsp;returns&nbsp;address&nbsp;family&nbsp;%v,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="6961603">,</span>&nbsp;<span class="ident" id="6961605"><a href="/net/unicast_posix_test.go.html#6961315">net</a></span><span class="op" id="6961608">,</span>&nbsp;<span class="ident" id="6961610"><a href="/net/unicast_posix_test.go.html#6961320">laddr</a></span><span class="op" id="6961615">,</span>&nbsp;<span class="ident" id="6961617"><a href="/net/unicast_posix_test.go.html#6961468">fd</a></span><span class="op" id="6961619">.</span><span class="ident" id="6961620">family</span><span class="op" id="6961626">,</span>&nbsp;<span class="ident" id="6961628"><a href="/net/unicast_posix_test.go.html#6951158">syscall</a></span><span class="op" id="6961635">.</span><span class="ident" id="6961636">AF_INET</span><span class="op" id="6961643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6961647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6961650">case</span>&nbsp;<span class="string" id="6961655">&#34;tcp6&#34;</span><span class="op" id="6961661">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6961665">fd</span>&nbsp;<span class="op" id="6961668">:=</span>&nbsp;<span class="ident" id="6961671"><a href="/net/unicast_posix_test.go.html#6961334">l</a></span><span class="op" id="6961672">.</span><span class="op" id="6961673">(</span><span class="op" id="6961674">*</span><span class="ident" id="6961675"><a href="/net/tcpsock_posix.go.html#2699965">TCPListener</a></span><span class="op" id="6961686">)</span><span class="op" id="6961687">.</span><span class="ident" id="6961688">fd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6961693">if</span>&nbsp;<span class="ident" id="6961696"><a href="/net/unicast_posix_test.go.html#6961665">fd</a></span><span class="op" id="6961698">.</span><span class="ident" id="6961699">family</span>&nbsp;<span class="op" id="6961706">!=</span>&nbsp;<span class="ident" id="6961709"><a href="/net/unicast_posix_test.go.html#6951158">syscall</a></span><span class="op" id="6961716">.</span><span class="ident" id="6961717">AF_INET6</span>&nbsp;<span class="op" id="6961726">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6961731"><a href="/net/unicast_posix_test.go.html#6961301">t</a></span><span class="op" id="6961732">.</span><span class="ident" id="6961733">Fatalf</span><span class="op" id="6961739">(</span><span class="string" id="6961740">&#34;First&nbsp;Listen(%q,&nbsp;%q)&nbsp;returns&nbsp;address&nbsp;family&nbsp;%v,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="6961801">,</span>&nbsp;<span class="ident" id="6961803"><a href="/net/unicast_posix_test.go.html#6961315">net</a></span><span class="op" id="6961806">,</span>&nbsp;<span class="ident" id="6961808"><a href="/net/unicast_posix_test.go.html#6961320">laddr</a></span><span class="op" id="6961813">,</span>&nbsp;<span class="ident" id="6961815"><a href="/net/unicast_posix_test.go.html#6961665">fd</a></span><span class="op" id="6961817">.</span><span class="ident" id="6961818">family</span><span class="op" id="6961824">,</span>&nbsp;<span class="ident" id="6961826"><a href="/net/unicast_posix_test.go.html#6951158">syscall</a></span><span class="op" id="6961833">.</span><span class="ident" id="6961834">AF_INET6</span><span class="op" id="6961842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6961846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6961849">case</span>&nbsp;<span class="string" id="6961854">&#34;udp&#34;</span><span class="op" id="6961859">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6961863">fd</span>&nbsp;<span class="op" id="6961866">:=</span>&nbsp;<span class="ident" id="6961869"><a href="/net/unicast_posix_test.go.html#6961334">l</a></span><span class="op" id="6961870">.</span><span class="op" id="6961871">(</span><span class="op" id="6961872">*</span><span class="ident" id="6961873"><a href="/net/udpsock_posix.go.html#2706235">UDPConn</a></span><span class="op" id="6961880">)</span><span class="op" id="6961881">.</span><span class="ident" id="6961882">fd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6961887"><a href="/net/unicast_posix_test.go.html#6963467">checkDualStackAddrFamily</a></span><span class="op" id="6961911">(</span><span class="ident" id="6961912"><a href="/net/unicast_posix_test.go.html#6961301">t</a></span><span class="op" id="6961913">,</span>&nbsp;<span class="ident" id="6961915"><a href="/net/unicast_posix_test.go.html#6961315">net</a></span><span class="op" id="6961918">,</span>&nbsp;<span class="ident" id="6961920"><a href="/net/unicast_posix_test.go.html#6961320">laddr</a></span><span class="op" id="6961925">,</span>&nbsp;<span class="ident" id="6961927"><a href="/net/unicast_posix_test.go.html#6961863">fd</a></span><span class="op" id="6961929">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6961932">case</span>&nbsp;<span class="string" id="6961937">&#34;udp4&#34;</span><span class="op" id="6961943">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6961947">fd</span>&nbsp;<span class="op" id="6961950">:=</span>&nbsp;<span class="ident" id="6961953"><a href="/net/unicast_posix_test.go.html#6961334">l</a></span><span class="op" id="6961954">.</span><span class="op" id="6961955">(</span><span class="op" id="6961956">*</span><span class="ident" id="6961957"><a href="/net/udpsock_posix.go.html#2706235">UDPConn</a></span><span class="op" id="6961964">)</span><span class="op" id="6961965">.</span><span class="ident" id="6961966">fd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6961971">if</span>&nbsp;<span class="ident" id="6961974"><a href="/net/unicast_posix_test.go.html#6961947">fd</a></span><span class="op" id="6961976">.</span><span class="ident" id="6961977">family</span>&nbsp;<span class="op" id="6961984">!=</span>&nbsp;<span class="ident" id="6961987"><a href="/net/unicast_posix_test.go.html#6951158">syscall</a></span><span class="op" id="6961994">.</span><span class="ident" id="6961995">AF_INET</span>&nbsp;<span class="op" id="6962003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6962008"><a href="/net/unicast_posix_test.go.html#6961301">t</a></span><span class="op" id="6962009">.</span><span class="ident" id="6962010">Fatalf</span><span class="op" id="6962016">(</span><span class="string" id="6962017">&#34;First&nbsp;ListenPacket(%q,&nbsp;%q)&nbsp;returns&nbsp;address&nbsp;family&nbsp;%v,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="6962084">,</span>&nbsp;<span class="ident" id="6962086"><a href="/net/unicast_posix_test.go.html#6961315">net</a></span><span class="op" id="6962089">,</span>&nbsp;<span class="ident" id="6962091"><a href="/net/unicast_posix_test.go.html#6961320">laddr</a></span><span class="op" id="6962096">,</span>&nbsp;<span class="ident" id="6962098"><a href="/net/unicast_posix_test.go.html#6961947">fd</a></span><span class="op" id="6962100">.</span><span class="ident" id="6962101">family</span><span class="op" id="6962107">,</span>&nbsp;<span class="ident" id="6962109"><a href="/net/unicast_posix_test.go.html#6951158">syscall</a></span><span class="op" id="6962116">.</span><span class="ident" id="6962117">AF_INET</span><span class="op" id="6962124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6962128">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6962131">case</span>&nbsp;<span class="string" id="6962136">&#34;udp6&#34;</span><span class="op" id="6962142">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6962146">fd</span>&nbsp;<span class="op" id="6962149">:=</span>&nbsp;<span class="ident" id="6962152"><a href="/net/unicast_posix_test.go.html#6961334">l</a></span><span class="op" id="6962153">.</span><span class="op" id="6962154">(</span><span class="op" id="6962155">*</span><span class="ident" id="6962156"><a href="/net/udpsock_posix.go.html#2706235">UDPConn</a></span><span class="op" id="6962163">)</span><span class="op" id="6962164">.</span><span class="ident" id="6962165">fd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6962170">if</span>&nbsp;<span class="ident" id="6962173"><a href="/net/unicast_posix_test.go.html#6962146">fd</a></span><span class="op" id="6962175">.</span><span class="ident" id="6962176">family</span>&nbsp;<span class="op" id="6962183">!=</span>&nbsp;<span class="ident" id="6962186"><a href="/net/unicast_posix_test.go.html#6951158">syscall</a></span><span class="op" id="6962193">.</span><span class="ident" id="6962194">AF_INET6</span>&nbsp;<span class="op" id="6962203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6962208"><a href="/net/unicast_posix_test.go.html#6961301">t</a></span><span class="op" id="6962209">.</span><span class="ident" id="6962210">Fatalf</span><span class="op" id="6962216">(</span><span class="string" id="6962217">&#34;First&nbsp;ListenPacket(%q,&nbsp;%q)&nbsp;returns&nbsp;address&nbsp;family&nbsp;%v,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="6962284">,</span>&nbsp;<span class="ident" id="6962286"><a href="/net/unicast_posix_test.go.html#6961315">net</a></span><span class="op" id="6962289">,</span>&nbsp;<span class="ident" id="6962291"><a href="/net/unicast_posix_test.go.html#6961320">laddr</a></span><span class="op" id="6962296">,</span>&nbsp;<span class="ident" id="6962298"><a href="/net/unicast_posix_test.go.html#6962146">fd</a></span><span class="op" id="6962300">.</span><span class="ident" id="6962301">family</span><span class="op" id="6962307">,</span>&nbsp;<span class="ident" id="6962309"><a href="/net/unicast_posix_test.go.html#6951158">syscall</a></span><span class="op" id="6962316">.</span><span class="ident" id="6962317">AF_INET6</span><span class="op" id="6962325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6962329">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6962332">default</span><span class="op" id="6962339">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6962343"><a href="/net/unicast_posix_test.go.html#6961301">t</a></span><span class="op" id="6962344">.</span><span class="ident" id="6962345">Fatalf</span><span class="op" id="6962351">(</span><span class="string" id="6962352">&#34;Unexpected&nbsp;network:&nbsp;%q&#34;</span><span class="op" id="6962376">,</span>&nbsp;<span class="ident" id="6962378"><a href="/net/unicast_posix_test.go.html#6961315">net</a></span><span class="op" id="6962381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6962384">}</span><br>
<span class="lineno"></span><span class="op" id="6962386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="6962389">func</span>&nbsp;<span class="ident" id="6962394">checkSecondListener</span><span class="op" id="6962413">(</span><span class="ident" id="6962414">t</span>&nbsp;<span class="op" id="6962416">*</span><span class="ident" id="6962417"><a href="/net/unicast_posix_test.go.html#6951169">testing</a></span><span class="op" id="6962424">.</span><span class="ident" id="6962425">T</span><span class="op" id="6962426">,</span>&nbsp;<span class="ident" id="6962428">net</span><span class="op" id="6962431">,</span>&nbsp;<span class="ident" id="6962433">laddr</span>&nbsp;<span class="builtintype" id="6962439">string</span><span class="op" id="6962445">,</span>&nbsp;<span class="ident" id="6962447">err</span>&nbsp;<span class="builtintype" id="6962451">error</span><span class="op" id="6962456">,</span>&nbsp;<span class="ident" id="6962458">l</span>&nbsp;<span class="keyword" id="6962460">interface</span><span class="op" id="6962469">{</span><span class="op" id="6962470">}</span><span class="op" id="6962471">)</span>&nbsp;<span class="op" id="6962473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6962476">switch</span>&nbsp;<span class="ident" id="6962483"><a href="/net/unicast_posix_test.go.html#6962428">net</a></span>&nbsp;<span class="op" id="6962487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6962490">case</span>&nbsp;<span class="string" id="6962495">&#34;tcp&#34;</span><span class="op" id="6962500">,</span>&nbsp;<span class="string" id="6962502">&#34;tcp4&#34;</span><span class="op" id="6962508">,</span>&nbsp;<span class="string" id="6962510">&#34;tcp6&#34;</span><span class="op" id="6962516">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6962520">if</span>&nbsp;<span class="ident" id="6962523"><a href="/net/unicast_posix_test.go.html#6962447">err</a></span>&nbsp;<span class="op" id="6962527">==</span>&nbsp;<span class="ident" id="6962530">nil</span>&nbsp;<span class="op" id="6962534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6962539"><a href="/net/unicast_posix_test.go.html#6962458">l</a></span><span class="op" id="6962540">.</span><span class="op" id="6962541">(</span><span class="op" id="6962542">*</span><span class="ident" id="6962543"><a href="/net/tcpsock_posix.go.html#2699965">TCPListener</a></span><span class="op" id="6962554">)</span><span class="op" id="6962555">.</span><span class="ident" id="6962556">Close</span><span class="op" id="6962561">(</span><span class="op" id="6962562">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6962567"><a href="/net/unicast_posix_test.go.html#6962414">t</a></span><span class="op" id="6962568">.</span><span class="ident" id="6962569">Fatalf</span><span class="op" id="6962575">(</span><span class="string" id="6962576">&#34;Second&nbsp;Listen(%q,&nbsp;%q)&nbsp;should&nbsp;fail&#34;</span><span class="op" id="6962611">,</span>&nbsp;<span class="ident" id="6962613"><a href="/net/unicast_posix_test.go.html#6962428">net</a></span><span class="op" id="6962616">,</span>&nbsp;<span class="ident" id="6962618"><a href="/net/unicast_posix_test.go.html#6962433">laddr</a></span><span class="op" id="6962623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6962627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6962630">case</span>&nbsp;<span class="string" id="6962635">&#34;udp&#34;</span><span class="op" id="6962640">,</span>&nbsp;<span class="string" id="6962642">&#34;udp4&#34;</span><span class="op" id="6962648">,</span>&nbsp;<span class="string" id="6962650">&#34;udp6&#34;</span><span class="op" id="6962656">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6962660">if</span>&nbsp;<span class="ident" id="6962663"><a href="/net/unicast_posix_test.go.html#6962447">err</a></span>&nbsp;<span class="op" id="6962667">==</span>&nbsp;<span class="ident" id="6962670">nil</span>&nbsp;<span class="op" id="6962674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6962679"><a href="/net/unicast_posix_test.go.html#6962458">l</a></span><span class="op" id="6962680">.</span><span class="op" id="6962681">(</span><span class="op" id="6962682">*</span><span class="ident" id="6962683"><a href="/net/udpsock_posix.go.html#2706235">UDPConn</a></span><span class="op" id="6962690">)</span><span class="op" id="6962691">.</span><span class="ident" id="6962692">Close</span><span class="op" id="6962697">(</span><span class="op" id="6962698">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6962703"><a href="/net/unicast_posix_test.go.html#6962414">t</a></span><span class="op" id="6962704">.</span><span class="ident" id="6962705">Fatalf</span><span class="op" id="6962711">(</span><span class="string" id="6962712">&#34;Second&nbsp;ListenPacket(%q,&nbsp;%q)&nbsp;should&nbsp;fail&#34;</span><span class="op" id="6962753">,</span>&nbsp;<span class="ident" id="6962755"><a href="/net/unicast_posix_test.go.html#6962428">net</a></span><span class="op" id="6962758">,</span>&nbsp;<span class="ident" id="6962760"><a href="/net/unicast_posix_test.go.html#6962433">laddr</a></span><span class="op" id="6962765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6962769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6962772">default</span><span class="op" id="6962779">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6962783"><a href="/net/unicast_posix_test.go.html#6962414">t</a></span><span class="op" id="6962784">.</span><span class="ident" id="6962785">Fatalf</span><span class="op" id="6962791">(</span><span class="string" id="6962792">&#34;Unexpected&nbsp;network:&nbsp;%q&#34;</span><span class="op" id="6962816">,</span>&nbsp;<span class="ident" id="6962818"><a href="/net/unicast_posix_test.go.html#6962428">net</a></span><span class="op" id="6962821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6962824">}</span><br>
<span class="lineno">350</span><span class="op" id="6962826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6962829">func</span>&nbsp;<span class="ident" id="6962834">checkDualStackSecondListener</span><span class="op" id="6962862">(</span><span class="ident" id="6962863">t</span>&nbsp;<span class="op" id="6962865">*</span><span class="ident" id="6962866"><a href="/net/unicast_posix_test.go.html#6951169">testing</a></span><span class="op" id="6962873">.</span><span class="ident" id="6962874">T</span><span class="op" id="6962875">,</span>&nbsp;<span class="ident" id="6962877">net</span><span class="op" id="6962880">,</span>&nbsp;<span class="ident" id="6962882">laddr</span>&nbsp;<span class="builtintype" id="6962888">string</span><span class="op" id="6962894">,</span>&nbsp;<span class="ident" id="6962896">xerr</span><span class="op" id="6962900">,</span>&nbsp;<span class="ident" id="6962902">err</span>&nbsp;<span class="builtintype" id="6962906">error</span><span class="op" id="6962911">,</span>&nbsp;<span class="ident" id="6962913">l</span>&nbsp;<span class="keyword" id="6962915">interface</span><span class="op" id="6962924">{</span><span class="op" id="6962925">}</span><span class="op" id="6962926">)</span>&nbsp;<span class="op" id="6962928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6962931">switch</span>&nbsp;<span class="ident" id="6962938"><a href="/net/unicast_posix_test.go.html#6962877">net</a></span>&nbsp;<span class="op" id="6962942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6962945">case</span>&nbsp;<span class="string" id="6962950">&#34;tcp&#34;</span><span class="op" id="6962955">,</span>&nbsp;<span class="string" id="6962957">&#34;tcp4&#34;</span><span class="op" id="6962963">,</span>&nbsp;<span class="string" id="6962965">&#34;tcp6&#34;</span><span class="op" id="6962971">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6962975">if</span>&nbsp;<span class="ident" id="6962978"><a href="/net/unicast_posix_test.go.html#6962896">xerr</a></span>&nbsp;<span class="op" id="6962983">==</span>&nbsp;<span class="ident" id="6962986">nil</span>&nbsp;<span class="op" id="6962990">&amp;&amp;</span>&nbsp;<span class="ident" id="6962993"><a href="/net/unicast_posix_test.go.html#6962902">err</a></span>&nbsp;<span class="op" id="6962997">!=</span>&nbsp;<span class="ident" id="6963000">nil</span>&nbsp;<span class="op" id="6963004">||</span>&nbsp;<span class="ident" id="6963007"><a href="/net/unicast_posix_test.go.html#6962896">xerr</a></span>&nbsp;<span class="op" id="6963012">!=</span>&nbsp;<span class="ident" id="6963015">nil</span>&nbsp;<span class="op" id="6963019">&amp;&amp;</span>&nbsp;<span class="ident" id="6963022"><a href="/net/unicast_posix_test.go.html#6962902">err</a></span>&nbsp;<span class="op" id="6963026">==</span>&nbsp;<span class="ident" id="6963029">nil</span>&nbsp;<span class="op" id="6963033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6963038"><a href="/net/unicast_posix_test.go.html#6962863">t</a></span><span class="op" id="6963039">.</span><span class="ident" id="6963040">Fatalf</span><span class="op" id="6963046">(</span><span class="string" id="6963047">&#34;Second&nbsp;Listen(%q,&nbsp;%q)&nbsp;returns&nbsp;%v,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="6963094">,</span>&nbsp;<span class="ident" id="6963096"><a href="/net/unicast_posix_test.go.html#6962877">net</a></span><span class="op" id="6963099">,</span>&nbsp;<span class="ident" id="6963101"><a href="/net/unicast_posix_test.go.html#6962882">laddr</a></span><span class="op" id="6963106">,</span>&nbsp;<span class="ident" id="6963108"><a href="/net/unicast_posix_test.go.html#6962902">err</a></span><span class="op" id="6963111">,</span>&nbsp;<span class="ident" id="6963113"><a href="/net/unicast_posix_test.go.html#6962896">xerr</a></span><span class="op" id="6963117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6963121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6963125">if</span>&nbsp;<span class="ident" id="6963128"><a href="/net/unicast_posix_test.go.html#6962902">err</a></span>&nbsp;<span class="op" id="6963132">==</span>&nbsp;<span class="ident" id="6963135">nil</span>&nbsp;<span class="op" id="6963139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6963144"><a href="/net/unicast_posix_test.go.html#6962913">l</a></span><span class="op" id="6963145">.</span><span class="op" id="6963146">(</span><span class="op" id="6963147">*</span><span class="ident" id="6963148"><a href="/net/tcpsock_posix.go.html#2699965">TCPListener</a></span><span class="op" id="6963159">)</span><span class="op" id="6963160">.</span><span class="ident" id="6963161">Close</span><span class="op" id="6963166">(</span><span class="op" id="6963167">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6963171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6963174">case</span>&nbsp;<span class="string" id="6963179">&#34;udp&#34;</span><span class="op" id="6963184">,</span>&nbsp;<span class="string" id="6963186">&#34;udp4&#34;</span><span class="op" id="6963192">,</span>&nbsp;<span class="string" id="6963194">&#34;udp6&#34;</span><span class="op" id="6963200">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6963204">if</span>&nbsp;<span class="ident" id="6963207"><a href="/net/unicast_posix_test.go.html#6962896">xerr</a></span>&nbsp;<span class="op" id="6963212">==</span>&nbsp;<span class="ident" id="6963215">nil</span>&nbsp;<span class="op" id="6963219">&amp;&amp;</span>&nbsp;<span class="ident" id="6963222"><a href="/net/unicast_posix_test.go.html#6962902">err</a></span>&nbsp;<span class="op" id="6963226">!=</span>&nbsp;<span class="ident" id="6963229">nil</span>&nbsp;<span class="op" id="6963233">||</span>&nbsp;<span class="ident" id="6963236"><a href="/net/unicast_posix_test.go.html#6962896">xerr</a></span>&nbsp;<span class="op" id="6963241">!=</span>&nbsp;<span class="ident" id="6963244">nil</span>&nbsp;<span class="op" id="6963248">&amp;&amp;</span>&nbsp;<span class="ident" id="6963251"><a href="/net/unicast_posix_test.go.html#6962902">err</a></span>&nbsp;<span class="op" id="6963255">==</span>&nbsp;<span class="ident" id="6963258">nil</span>&nbsp;<span class="op" id="6963262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6963267"><a href="/net/unicast_posix_test.go.html#6962863">t</a></span><span class="op" id="6963268">.</span><span class="ident" id="6963269">Fatalf</span><span class="op" id="6963275">(</span><span class="string" id="6963276">&#34;Second&nbsp;ListenPacket(%q,&nbsp;%q)&nbsp;returns&nbsp;%v,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="6963329">,</span>&nbsp;<span class="ident" id="6963331"><a href="/net/unicast_posix_test.go.html#6962877">net</a></span><span class="op" id="6963334">,</span>&nbsp;<span class="ident" id="6963336"><a href="/net/unicast_posix_test.go.html#6962882">laddr</a></span><span class="op" id="6963341">,</span>&nbsp;<span class="ident" id="6963343"><a href="/net/unicast_posix_test.go.html#6962902">err</a></span><span class="op" id="6963346">,</span>&nbsp;<span class="ident" id="6963348"><a href="/net/unicast_posix_test.go.html#6962896">xerr</a></span><span class="op" id="6963352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6963356">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6963360">if</span>&nbsp;<span class="ident" id="6963363"><a href="/net/unicast_posix_test.go.html#6962902">err</a></span>&nbsp;<span class="op" id="6963367">==</span>&nbsp;<span class="ident" id="6963370">nil</span>&nbsp;<span class="op" id="6963374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6963379"><a href="/net/unicast_posix_test.go.html#6962913">l</a></span><span class="op" id="6963380">.</span><span class="op" id="6963381">(</span><span class="op" id="6963382">*</span><span class="ident" id="6963383"><a href="/net/udpsock_posix.go.html#2706235">UDPConn</a></span><span class="op" id="6963390">)</span><span class="op" id="6963391">.</span><span class="ident" id="6963392">Close</span><span class="op" id="6963397">(</span><span class="op" id="6963398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6963402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6963405">default</span><span class="op" id="6963412">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6963416"><a href="/net/unicast_posix_test.go.html#6962863">t</a></span><span class="op" id="6963417">.</span><span class="ident" id="6963418">Fatalf</span><span class="op" id="6963424">(</span><span class="string" id="6963425">&#34;Unexpected&nbsp;network:&nbsp;%q&#34;</span><span class="op" id="6963449">,</span>&nbsp;<span class="ident" id="6963451"><a href="/net/unicast_posix_test.go.html#6962877">net</a></span><span class="op" id="6963454">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6963457">}</span><br>
<span class="lineno"></span><span class="op" id="6963459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6963462">func</span>&nbsp;<span class="ident" id="6963467">checkDualStackAddrFamily</span><span class="op" id="6963491">(</span><span class="ident" id="6963492">t</span>&nbsp;<span class="op" id="6963494">*</span><span class="ident" id="6963495"><a href="/net/unicast_posix_test.go.html#6951169">testing</a></span><span class="op" id="6963502">.</span><span class="ident" id="6963503">T</span><span class="op" id="6963504">,</span>&nbsp;<span class="ident" id="6963506">net</span><span class="op" id="6963509">,</span>&nbsp;<span class="ident" id="6963511">laddr</span>&nbsp;<span class="builtintype" id="6963517">string</span><span class="op" id="6963523">,</span>&nbsp;<span class="ident" id="6963525">fd</span>&nbsp;<span class="op" id="6963528">*</span><span class="ident" id="6963529"><a href="/net/fd_unix.go.html#2575420">netFD</a></span><span class="op" id="6963534">)</span>&nbsp;<span class="op" id="6963536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6963539">switch</span>&nbsp;<span class="ident" id="6963546">a</span>&nbsp;<span class="op" id="6963548">:=</span>&nbsp;<span class="ident" id="6963551"><a href="/net/unicast_posix_test.go.html#6963525">fd</a></span><span class="op" id="6963553">.</span><span class="ident" id="6963554">laddr</span><span class="op" id="6963559">.</span><span class="op" id="6963560">(</span><span class="keyword" id="6963561">type</span><span class="op" id="6963565">)</span>&nbsp;<span class="op" id="6963567">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6963570">case</span>&nbsp;<span class="op" id="6963575">*</span><span class="ident" id="6963576"><a href="/net/tcpsock.go.html#2691528">TCPAddr</a></span><span class="op" id="6963583">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6963587">//&nbsp;If&nbsp;a&nbsp;node&nbsp;under&nbsp;test&nbsp;supports&nbsp;both&nbsp;IPv6&nbsp;capability</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6963643">//&nbsp;and&nbsp;IPv6&nbsp;IPv4-mapping&nbsp;capability,&nbsp;we&nbsp;can&nbsp;assume</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6963696">//&nbsp;that&nbsp;the&nbsp;node&nbsp;listens&nbsp;on&nbsp;a&nbsp;wildcard&nbsp;address&nbsp;with&nbsp;an</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6963753">//&nbsp;AF_INET6&nbsp;socket.</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6963775">if</span>&nbsp;<span class="ident" id="6963778"><a href="/net/ipsock.go.html#2627970">supportsIPv4map</a></span>&nbsp;<span class="op" id="6963794">&amp;&amp;</span>&nbsp;<span class="ident" id="6963797"><a href="/net/unicast_posix_test.go.html#6963525">fd</a></span><span class="op" id="6963799">.</span><span class="ident" id="6963800">laddr</span><span class="op" id="6963805">.</span><span class="op" id="6963806">(</span><span class="op" id="6963807">*</span><span class="ident" id="6963808"><a href="/net/tcpsock.go.html#2691528">TCPAddr</a></span><span class="op" id="6963815">)</span><span class="op" id="6963816">.</span><span class="ident" id="6963817">isWildcard</span><span class="op" id="6963827">(</span><span class="op" id="6963828">)</span>&nbsp;<span class="op" id="6963830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6963835">if</span>&nbsp;<span class="ident" id="6963838"><a href="/net/unicast_posix_test.go.html#6963525">fd</a></span><span class="op" id="6963840">.</span><span class="ident" id="6963841">family</span>&nbsp;<span class="op" id="6963848">!=</span>&nbsp;<span class="ident" id="6963851"><a href="/net/unicast_posix_test.go.html#6951158">syscall</a></span><span class="op" id="6963858">.</span><span class="ident" id="6963859">AF_INET6</span>&nbsp;<span class="op" id="6963868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6963874"><a href="/net/unicast_posix_test.go.html#6963492">t</a></span><span class="op" id="6963875">.</span><span class="ident" id="6963876">Fatalf</span><span class="op" id="6963882">(</span><span class="string" id="6963883">&#34;Listen(%q,&nbsp;%q)&nbsp;returns&nbsp;address&nbsp;family&nbsp;%v,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="6963938">,</span>&nbsp;<span class="ident" id="6963940"><a href="/net/unicast_posix_test.go.html#6963506">net</a></span><span class="op" id="6963943">,</span>&nbsp;<span class="ident" id="6963945"><a href="/net/unicast_posix_test.go.html#6963511">laddr</a></span><span class="op" id="6963950">,</span>&nbsp;<span class="ident" id="6963952"><a href="/net/unicast_posix_test.go.html#6963525">fd</a></span><span class="op" id="6963954">.</span><span class="ident" id="6963955">family</span><span class="op" id="6963961">,</span>&nbsp;<span class="ident" id="6963963"><a href="/net/unicast_posix_test.go.html#6951158">syscall</a></span><span class="op" id="6963970">.</span><span class="ident" id="6963971">AF_INET6</span><span class="op" id="6963979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6963984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6963988">}</span>&nbsp;<span class="keyword" id="6963990">else</span>&nbsp;<span class="op" id="6963995">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6964000">if</span>&nbsp;<span class="ident" id="6964003"><a href="/net/unicast_posix_test.go.html#6963525">fd</a></span><span class="op" id="6964005">.</span><span class="ident" id="6964006">family</span>&nbsp;<span class="op" id="6964013">!=</span>&nbsp;<span class="ident" id="6964016"><a href="/net/unicast_posix_test.go.html#6963546">a</a></span><span class="op" id="6964017">.</span><span class="ident" id="6964018">family</span><span class="op" id="6964024">(</span><span class="op" id="6964025">)</span>&nbsp;<span class="op" id="6964027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6964033"><a href="/net/unicast_posix_test.go.html#6963492">t</a></span><span class="op" id="6964034">.</span><span class="ident" id="6964035">Fatalf</span><span class="op" id="6964041">(</span><span class="string" id="6964042">&#34;Listen(%q,&nbsp;%q)&nbsp;returns&nbsp;address&nbsp;family&nbsp;%v,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="6964097">,</span>&nbsp;<span class="ident" id="6964099"><a href="/net/unicast_posix_test.go.html#6963506">net</a></span><span class="op" id="6964102">,</span>&nbsp;<span class="ident" id="6964104"><a href="/net/unicast_posix_test.go.html#6963511">laddr</a></span><span class="op" id="6964109">,</span>&nbsp;<span class="ident" id="6964111"><a href="/net/unicast_posix_test.go.html#6963525">fd</a></span><span class="op" id="6964113">.</span><span class="ident" id="6964114">family</span><span class="op" id="6964120">,</span>&nbsp;<span class="ident" id="6964122"><a href="/net/unicast_posix_test.go.html#6963546">a</a></span><span class="op" id="6964123">.</span><span class="ident" id="6964124">family</span><span class="op" id="6964130">(</span><span class="op" id="6964131">)</span><span class="op" id="6964132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6964137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6964141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6964144">case</span>&nbsp;<span class="op" id="6964149">*</span><span class="ident" id="6964150"><a href="/net/udpsock.go.html#2703901">UDPAddr</a></span><span class="op" id="6964157">:</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6964161">//&nbsp;If&nbsp;a&nbsp;node&nbsp;under&nbsp;test&nbsp;supports&nbsp;both&nbsp;IPv6&nbsp;capability</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6964217">//&nbsp;and&nbsp;IPv6&nbsp;IPv4-mapping&nbsp;capability,&nbsp;we&nbsp;can&nbsp;assume</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6964270">//&nbsp;that&nbsp;the&nbsp;node&nbsp;listens&nbsp;on&nbsp;a&nbsp;wildcard&nbsp;address&nbsp;with&nbsp;an</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6964327">//&nbsp;AF_INET6&nbsp;socket.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6964349">if</span>&nbsp;<span class="ident" id="6964352"><a href="/net/ipsock.go.html#2627970">supportsIPv4map</a></span>&nbsp;<span class="op" id="6964368">&amp;&amp;</span>&nbsp;<span class="ident" id="6964371"><a href="/net/unicast_posix_test.go.html#6963525">fd</a></span><span class="op" id="6964373">.</span><span class="ident" id="6964374">laddr</span><span class="op" id="6964379">.</span><span class="op" id="6964380">(</span><span class="op" id="6964381">*</span><span class="ident" id="6964382"><a href="/net/udpsock.go.html#2703901">UDPAddr</a></span><span class="op" id="6964389">)</span><span class="op" id="6964390">.</span><span class="ident" id="6964391">isWildcard</span><span class="op" id="6964401">(</span><span class="op" id="6964402">)</span>&nbsp;<span class="op" id="6964404">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6964409">if</span>&nbsp;<span class="ident" id="6964412"><a href="/net/unicast_posix_test.go.html#6963525">fd</a></span><span class="op" id="6964414">.</span><span class="ident" id="6964415">family</span>&nbsp;<span class="op" id="6964422">!=</span>&nbsp;<span class="ident" id="6964425"><a href="/net/unicast_posix_test.go.html#6951158">syscall</a></span><span class="op" id="6964432">.</span><span class="ident" id="6964433">AF_INET6</span>&nbsp;<span class="op" id="6964442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6964448"><a href="/net/unicast_posix_test.go.html#6963492">t</a></span><span class="op" id="6964449">.</span><span class="ident" id="6964450">Fatalf</span><span class="op" id="6964456">(</span><span class="string" id="6964457">&#34;ListenPacket(%q,&nbsp;%q)&nbsp;returns&nbsp;address&nbsp;family&nbsp;%v,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="6964518">,</span>&nbsp;<span class="ident" id="6964520"><a href="/net/unicast_posix_test.go.html#6963506">net</a></span><span class="op" id="6964523">,</span>&nbsp;<span class="ident" id="6964525"><a href="/net/unicast_posix_test.go.html#6963511">laddr</a></span><span class="op" id="6964530">,</span>&nbsp;<span class="ident" id="6964532"><a href="/net/unicast_posix_test.go.html#6963525">fd</a></span><span class="op" id="6964534">.</span><span class="ident" id="6964535">family</span><span class="op" id="6964541">,</span>&nbsp;<span class="ident" id="6964543"><a href="/net/unicast_posix_test.go.html#6951158">syscall</a></span><span class="op" id="6964550">.</span><span class="ident" id="6964551">AF_INET6</span><span class="op" id="6964559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6964564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6964568">}</span>&nbsp;<span class="keyword" id="6964570">else</span>&nbsp;<span class="op" id="6964575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6964580">if</span>&nbsp;<span class="ident" id="6964583"><a href="/net/unicast_posix_test.go.html#6963525">fd</a></span><span class="op" id="6964585">.</span><span class="ident" id="6964586">family</span>&nbsp;<span class="op" id="6964593">!=</span>&nbsp;<span class="ident" id="6964596"><a href="/net/unicast_posix_test.go.html#6963546">a</a></span><span class="op" id="6964597">.</span><span class="ident" id="6964598">family</span><span class="op" id="6964604">(</span><span class="op" id="6964605">)</span>&nbsp;<span class="op" id="6964607">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6964613"><a href="/net/unicast_posix_test.go.html#6963492">t</a></span><span class="op" id="6964614">.</span><span class="ident" id="6964615">Fatalf</span><span class="op" id="6964621">(</span><span class="string" id="6964622">&#34;ListenPacket(%q,&nbsp;%q)&nbsp;returns&nbsp;address&nbsp;family&nbsp;%v,&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="6964683">,</span>&nbsp;<span class="ident" id="6964685"><a href="/net/unicast_posix_test.go.html#6963506">net</a></span><span class="op" id="6964688">,</span>&nbsp;<span class="ident" id="6964690"><a href="/net/unicast_posix_test.go.html#6963511">laddr</a></span><span class="op" id="6964695">,</span>&nbsp;<span class="ident" id="6964697"><a href="/net/unicast_posix_test.go.html#6963525">fd</a></span><span class="op" id="6964699">.</span><span class="ident" id="6964700">family</span><span class="op" id="6964706">,</span>&nbsp;<span class="ident" id="6964708"><a href="/net/unicast_posix_test.go.html#6963546">a</a></span><span class="op" id="6964709">.</span><span class="ident" id="6964710">family</span><span class="op" id="6964716">(</span><span class="op" id="6964717">)</span><span class="op" id="6964718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6964723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6964727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6964730">default</span><span class="op" id="6964737">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6964741"><a href="/net/unicast_posix_test.go.html#6963492">t</a></span><span class="op" id="6964742">.</span><span class="ident" id="6964743">Fatalf</span><span class="op" id="6964749">(</span><span class="string" id="6964750">&#34;Unexpected&nbsp;protocol&nbsp;address&nbsp;type:&nbsp;%T&#34;</span><span class="op" id="6964788">,</span>&nbsp;<span class="ident" id="6964790"><a href="/net/unicast_posix_test.go.html#6963546">a</a></span><span class="op" id="6964791">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6964794">}</span><br>
<span class="lineno"></span><span class="op" id="6964796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6964799">var</span>&nbsp;<span class="ident" id="6964803">prohibitionaryDialArgTests</span>&nbsp;<span class="op" id="6964830">=</span>&nbsp;<span class="op" id="6964832">[</span><span class="op" id="6964833">]</span><span class="keyword" id="6964834">struct</span>&nbsp;<span class="op" id="6964841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6964844">net</span>&nbsp;&nbsp;<span class="builtintype" id="6964849">string</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6964857">addr</span>&nbsp;<span class="builtintype" id="6964862">string</span><br>
<span class="lineno"></span><span class="op" id="6964869">}</span><span class="op" id="6964870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6964873">{</span><span class="string" id="6964874">&#34;tcp6&#34;</span><span class="op" id="6964880">,</span>&nbsp;<span class="string" id="6964882">&#34;127.0.0.1&#34;</span><span class="op" id="6964893">}</span><span class="op" id="6964894">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6964897">{</span><span class="string" id="6964898">&#34;tcp6&#34;</span><span class="op" id="6964904">,</span>&nbsp;<span class="string" id="6964906">&#34;[::ffff:127.0.0.1]&#34;</span><span class="op" id="6964926">}</span><span class="op" id="6964927">,</span><br>
<span class="lineno"></span><span class="op" id="6964929">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="keyword" id="6964932">func</span>&nbsp;<span class="ident" id="6964937">TestProhibitionaryDialArgs</span><span class="op" id="6964963">(</span><span class="ident" id="6964964">t</span>&nbsp;<span class="op" id="6964966">*</span><span class="ident" id="6964967"><a href="/net/unicast_posix_test.go.html#6951169">testing</a></span><span class="op" id="6964974">.</span><span class="ident" id="6964975">T</span><span class="op" id="6964976">)</span>&nbsp;<span class="op" id="6964978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6964981">switch</span>&nbsp;<span class="ident" id="6964988"><a href="/net/unicast_posix_test.go.html#6951147">runtime</a></span><span class="op" id="6964995">.</span><span class="ident" id="6964996">GOOS</span>&nbsp;<span class="op" id="6965001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6965004">case</span>&nbsp;<span class="string" id="6965009">&#34;plan9&#34;</span><span class="op" id="6965016">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6965020"><a href="/net/unicast_posix_test.go.html#6964964">t</a></span><span class="op" id="6965021">.</span><span class="ident" id="6965022">Skipf</span><span class="op" id="6965027">(</span><span class="string" id="6965028">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6965049">,</span>&nbsp;<span class="ident" id="6965051"><a href="/net/unicast_posix_test.go.html#6951147">runtime</a></span><span class="op" id="6965058">.</span><span class="ident" id="6965059">GOOS</span><span class="op" id="6965063">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6965066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6965069">//&nbsp;This&nbsp;test&nbsp;requires&nbsp;both&nbsp;IPv6&nbsp;and&nbsp;IPv6&nbsp;IPv4-mapping&nbsp;functionality.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6965139">if</span>&nbsp;<span class="op" id="6965142">!</span><span class="ident" id="6965143"><a href="/net/ipsock.go.html#2627970">supportsIPv4map</a></span>&nbsp;<span class="op" id="6965159">||</span>&nbsp;<span class="ident" id="6965162"><a href="/net/unicast_posix_test.go.html#6951169">testing</a></span><span class="op" id="6965169">.</span><span class="ident" id="6965170">Short</span><span class="op" id="6965175">(</span><span class="op" id="6965176">)</span>&nbsp;<span class="op" id="6965178">||</span>&nbsp;<span class="op" id="6965181">!</span><span class="op" id="6965182">*</span><span class="ident" id="6965183"><a href="/net/lookup_test.go.html#6856134">testExternal</a></span>&nbsp;<span class="op" id="6965196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6965200">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6965208">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6965212">l</span><span class="op" id="6965213">,</span>&nbsp;<span class="ident" id="6965215">port</span>&nbsp;<span class="op" id="6965220">:=</span>&nbsp;<span class="ident" id="6965223"><a href="/net/unicast_posix_test.go.html#6960012">usableListenPort</a></span><span class="op" id="6965239">(</span><span class="ident" id="6965240"><a href="/net/unicast_posix_test.go.html#6964964">t</a></span><span class="op" id="6965241">,</span>&nbsp;<span class="string" id="6965243">&#34;tcp&#34;</span><span class="op" id="6965248">,</span>&nbsp;<span class="string" id="6965250">&#34;[::]&#34;</span><span class="op" id="6965256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6965259">defer</span>&nbsp;<span class="ident" id="6965265"><a href="/net/unicast_posix_test.go.html#6965212">l</a></span><span class="op" id="6965266">.</span><span class="ident" id="6965267">Close</span><span class="op" id="6965272">(</span><span class="op" id="6965273">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6965277">for</span>&nbsp;<span class="ident" id="6965281">_</span><span class="op" id="6965282">,</span>&nbsp;<span class="ident" id="6965284">tt</span>&nbsp;<span class="op" id="6965287">:=</span>&nbsp;<span class="keyword" id="6965290">range</span>&nbsp;<span class="ident" id="6965296"><a href="/net/unicast_posix_test.go.html#6964803">prohibitionaryDialArgTests</a></span>&nbsp;<span class="op" id="6965323">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6965327">c</span><span class="op" id="6965328">,</span>&nbsp;<span class="ident" id="6965330">err</span>&nbsp;<span class="op" id="6965334">:=</span>&nbsp;<span class="ident" id="6965337"><a href="/net/dial.go.html#2521518">Dial</a></span><span class="op" id="6965341">(</span><span class="ident" id="6965342"><a href="/net/unicast_posix_test.go.html#6965284">tt</a></span><span class="op" id="6965344">.</span><span class="ident" id="6965345">net</span><span class="op" id="6965348">,</span>&nbsp;<span class="ident" id="6965350"><a href="/net/unicast_posix_test.go.html#6965284">tt</a></span><span class="op" id="6965352">.</span><span class="ident" id="6965353">addr</span><span class="op" id="6965357">+</span><span class="string" id="6965358">&#34;:&#34;</span><span class="op" id="6965361">+</span><span class="ident" id="6965362"><a href="/net/unicast_posix_test.go.html#6965215">port</a></span><span class="op" id="6965366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6965370">if</span>&nbsp;<span class="ident" id="6965373"><a href="/net/unicast_posix_test.go.html#6965330">err</a></span>&nbsp;<span class="op" id="6965377">==</span>&nbsp;<span class="ident" id="6965380">nil</span>&nbsp;<span class="op" id="6965384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6965389"><a href="/net/unicast_posix_test.go.html#6965327">c</a></span><span class="op" id="6965390">.</span><span class="ident" id="6965391">Close</span><span class="op" id="6965396">(</span><span class="op" id="6965397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6965402"><a href="/net/unicast_posix_test.go.html#6964964">t</a></span><span class="op" id="6965403">.</span><span class="ident" id="6965404">Fatalf</span><span class="op" id="6965410">(</span><span class="string" id="6965411">&#34;Dial(%q,&nbsp;%q)&nbsp;should&nbsp;fail&#34;</span><span class="op" id="6965437">,</span>&nbsp;<span class="ident" id="6965439"><a href="/net/unicast_posix_test.go.html#6965284">tt</a></span><span class="op" id="6965441">.</span><span class="ident" id="6965442">net</span><span class="op" id="6965445">,</span>&nbsp;<span class="ident" id="6965447"><a href="/net/unicast_posix_test.go.html#6965284">tt</a></span><span class="op" id="6965449">.</span><span class="ident" id="6965450">addr</span><span class="op" id="6965454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6965458">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6965461">}</span><br>
<span class="lineno"></span><span class="op" id="6965463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6965466">func</span>&nbsp;<span class="ident" id="6965471">TestWildWildcardListener</span><span class="op" id="6965495">(</span><span class="ident" id="6965496">t</span>&nbsp;<span class="op" id="6965498">*</span><span class="ident" id="6965499"><a href="/net/unicast_posix_test.go.html#6951169">testing</a></span><span class="op" id="6965506">.</span><span class="ident" id="6965507">T</span><span class="op" id="6965508">)</span>&nbsp;<span class="op" id="6965510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6965513">switch</span>&nbsp;<span class="ident" id="6965520"><a href="/net/unicast_posix_test.go.html#6951147">runtime</a></span><span class="op" id="6965527">.</span><span class="ident" id="6965528">GOOS</span>&nbsp;<span class="op" id="6965533">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6965536">case</span>&nbsp;<span class="string" id="6965541">&#34;plan9&#34;</span><span class="op" id="6965548">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6965552"><a href="/net/unicast_posix_test.go.html#6965496">t</a></span><span class="op" id="6965553">.</span><span class="ident" id="6965554">Skipf</span><span class="op" id="6965559">(</span><span class="string" id="6965560">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6965581">,</span>&nbsp;<span class="ident" id="6965583"><a href="/net/unicast_posix_test.go.html#6951147">runtime</a></span><span class="op" id="6965590">.</span><span class="ident" id="6965591">GOOS</span><span class="op" id="6965595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6965598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6965602">if</span>&nbsp;<span class="ident" id="6965605"><a href="/net/unicast_posix_test.go.html#6951169">testing</a></span><span class="op" id="6965612">.</span><span class="ident" id="6965613">Short</span><span class="op" id="6965618">(</span><span class="op" id="6965619">)</span>&nbsp;<span class="op" id="6965621">||</span>&nbsp;<span class="op" id="6965624">!</span><span class="op" id="6965625">*</span><span class="ident" id="6965626"><a href="/net/lookup_test.go.html#6856134">testExternal</a></span>&nbsp;<span class="op" id="6965639">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6965643"><a href="/net/unicast_posix_test.go.html#6965496">t</a></span><span class="op" id="6965644">.</span><span class="ident" id="6965645">Skip</span><span class="op" id="6965649">(</span><span class="string" id="6965650">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6965691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6965694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6965698">defer</span>&nbsp;<span class="keyword" id="6965704">func</span><span class="op" id="6965708">(</span><span class="op" id="6965709">)</span>&nbsp;<span class="op" id="6965711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6965715">if</span>&nbsp;<span class="ident" id="6965718">p</span>&nbsp;<span class="op" id="6965720">:=</span>&nbsp;<span class="builtinfunc" id="6965723">recover</span><span class="op" id="6965730">(</span><span class="op" id="6965731">)</span><span class="op" id="6965732">;</span>&nbsp;<span class="ident" id="6965734"><a href="/net/unicast_posix_test.go.html#6965718">p</a></span>&nbsp;<span class="op" id="6965736">!=</span>&nbsp;<span class="ident" id="6965739">nil</span>&nbsp;<span class="op" id="6965743">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6965748"><a href="/net/unicast_posix_test.go.html#6965496">t</a></span><span class="op" id="6965749">.</span><span class="ident" id="6965750">Fatalf</span><span class="op" id="6965756">(</span><span class="string" id="6965757">&#34;Listen,&nbsp;ListenPacket&nbsp;or&nbsp;protocol-specific&nbsp;Listen&nbsp;panicked:&nbsp;%v&#34;</span><span class="op" id="6965820">,</span>&nbsp;<span class="ident" id="6965822"><a href="/net/unicast_posix_test.go.html#6965718">p</a></span><span class="op" id="6965823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6965827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6965830">}</span><span class="op" id="6965831">(</span><span class="op" id="6965832">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6965836">if</span>&nbsp;<span class="ident" id="6965839">ln</span><span class="op" id="6965841">,</span>&nbsp;<span class="ident" id="6965843">err</span>&nbsp;<span class="op" id="6965847">:=</span>&nbsp;<span class="ident" id="6965850"><a href="/net/dial.go.html#2525176">Listen</a></span><span class="op" id="6965856">(</span><span class="string" id="6965857">&#34;tcp&#34;</span><span class="op" id="6965862">,</span>&nbsp;<span class="string" id="6965864">&#34;&#34;</span><span class="op" id="6965866">)</span><span class="op" id="6965867">;</span>&nbsp;<span class="ident" id="6965869"><a href="/net/unicast_posix_test.go.html#6965843">err</a></span>&nbsp;<span class="op" id="6965873">==</span>&nbsp;<span class="ident" id="6965876">nil</span>&nbsp;<span class="op" id="6965880">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6965884"><a href="/net/unicast_posix_test.go.html#6965839">ln</a></span><span class="op" id="6965886">.</span><span class="ident" id="6965887">Close</span><span class="op" id="6965892">(</span><span class="op" id="6965893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6965896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6965899">if</span>&nbsp;<span class="ident" id="6965902">ln</span><span class="op" id="6965904">,</span>&nbsp;<span class="ident" id="6965906">err</span>&nbsp;<span class="op" id="6965910">:=</span>&nbsp;<span class="ident" id="6965913"><a href="/net/dial.go.html#2525968">ListenPacket</a></span><span class="op" id="6965925">(</span><span class="string" id="6965926">&#34;udp&#34;</span><span class="op" id="6965931">,</span>&nbsp;<span class="string" id="6965933">&#34;&#34;</span><span class="op" id="6965935">)</span><span class="op" id="6965936">;</span>&nbsp;<span class="ident" id="6965938"><a href="/net/unicast_posix_test.go.html#6965906">err</a></span>&nbsp;<span class="op" id="6965942">==</span>&nbsp;<span class="ident" id="6965945">nil</span>&nbsp;<span class="op" id="6965949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6965953"><a href="/net/unicast_posix_test.go.html#6965902">ln</a></span><span class="op" id="6965955">.</span><span class="ident" id="6965956">Close</span><span class="op" id="6965961">(</span><span class="op" id="6965962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6965965">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6965968">if</span>&nbsp;<span class="ident" id="6965971">ln</span><span class="op" id="6965973">,</span>&nbsp;<span class="ident" id="6965975">err</span>&nbsp;<span class="op" id="6965979">:=</span>&nbsp;<span class="ident" id="6965982"><a href="/net/tcpsock_posix.go.html#2701875">ListenTCP</a></span><span class="op" id="6965991">(</span><span class="string" id="6965992">&#34;tcp&#34;</span><span class="op" id="6965997">,</span>&nbsp;<span class="ident" id="6965999">nil</span><span class="op" id="6966002">)</span><span class="op" id="6966003">;</span>&nbsp;<span class="ident" id="6966005"><a href="/net/unicast_posix_test.go.html#6965975">err</a></span>&nbsp;<span class="op" id="6966009">==</span>&nbsp;<span class="ident" id="6966012">nil</span>&nbsp;<span class="op" id="6966016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6966020"><a href="/net/unicast_posix_test.go.html#6965971">ln</a></span><span class="op" id="6966022">.</span><span class="ident" id="6966023">Close</span><span class="op" id="6966028">(</span><span class="op" id="6966029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6966032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6966035">if</span>&nbsp;<span class="ident" id="6966038">ln</span><span class="op" id="6966040">,</span>&nbsp;<span class="ident" id="6966042">err</span>&nbsp;<span class="op" id="6966046">:=</span>&nbsp;<span class="ident" id="6966049"><a href="/net/udpsock_posix.go.html#2710994">ListenUDP</a></span><span class="op" id="6966058">(</span><span class="string" id="6966059">&#34;udp&#34;</span><span class="op" id="6966064">,</span>&nbsp;<span class="ident" id="6966066">nil</span><span class="op" id="6966069">)</span><span class="op" id="6966070">;</span>&nbsp;<span class="ident" id="6966072"><a href="/net/unicast_posix_test.go.html#6966042">err</a></span>&nbsp;<span class="op" id="6966076">==</span>&nbsp;<span class="ident" id="6966079">nil</span>&nbsp;<span class="op" id="6966083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6966087"><a href="/net/unicast_posix_test.go.html#6966038">ln</a></span><span class="op" id="6966089">.</span><span class="ident" id="6966090">Close</span><span class="op" id="6966095">(</span><span class="op" id="6966096">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6966099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6966102">if</span>&nbsp;<span class="ident" id="6966105">ln</span><span class="op" id="6966107">,</span>&nbsp;<span class="ident" id="6966109">err</span>&nbsp;<span class="op" id="6966113">:=</span>&nbsp;<span class="ident" id="6966116"><a href="/net/iprawsock_posix.go.html#2626755">ListenIP</a></span><span class="op" id="6966124">(</span><span class="string" id="6966125">&#34;ip:icmp&#34;</span><span class="op" id="6966134">,</span>&nbsp;<span class="ident" id="6966136">nil</span><span class="op" id="6966139">)</span><span class="op" id="6966140">;</span>&nbsp;<span class="ident" id="6966142"><a href="/net/unicast_posix_test.go.html#6966109">err</a></span>&nbsp;<span class="op" id="6966146">==</span>&nbsp;<span class="ident" id="6966149">nil</span>&nbsp;<span class="op" id="6966153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6966157"><a href="/net/unicast_posix_test.go.html#6966105">ln</a></span><span class="op" id="6966159">.</span><span class="ident" id="6966160">Close</span><span class="op" id="6966165">(</span><span class="op" id="6966166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6966169">}</span><br>
<span class="lineno"></span><span class="op" id="6966171">}</span>
</div>
</body>
</html>
