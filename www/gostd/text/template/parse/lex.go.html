<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template/parse</h2>
<ul>
<li><a href="/gostd/text/template/parse/lex.go.html" class="current">lex.go</a></li>
<li><a href="/gostd/text/template/parse/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/text/template/parse/node.go.html">node.go</a></li>
<li><a href="/gostd/text/template/parse/parse.go.html">parse.go</a></li>
<li><a href="/gostd/text/template/parse/parse_test.go.html">parse_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3600408">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3600463">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3600517">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3600568">package</span>&nbsp;<span class="ident" id="3600576">parse</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3600583">import</span>&nbsp;<span class="op" id="3600590">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3600593">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3600600">&#34;strings&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3600611">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3600622">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3600637">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3600640">//&nbsp;item&nbsp;represents&nbsp;a&nbsp;token&nbsp;or&nbsp;text&nbsp;string&nbsp;returned&nbsp;from&nbsp;the&nbsp;scanner.</span><br>
<span class="lineno">15</span><span class="keyword" id="3600709">type</span>&nbsp;<span class="ident" id="3600714">item</span>&nbsp;<span class="keyword" id="3600719">struct</span>&nbsp;<span class="op" id="3600726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3600729">typ</span>&nbsp;<span class="ident" id="3600733">itemType</span>&nbsp;<span class="comment" id="3600742">//&nbsp;The&nbsp;type&nbsp;of&nbsp;this&nbsp;item.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3600769">pos</span>&nbsp;<span class="ident" id="3600773">Pos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3600782">//&nbsp;The&nbsp;starting&nbsp;position,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;this&nbsp;item&nbsp;in&nbsp;the&nbsp;input&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3600853">val</span>&nbsp;<span class="builtintype" id="3600857">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3600866">//&nbsp;The&nbsp;value&nbsp;of&nbsp;this&nbsp;item.</span><br>
<span class="lineno"></span><span class="op" id="3600893">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="3600896">func</span>&nbsp;<span class="op" id="3600901">(</span><span class="ident" id="3600902">i</span>&nbsp;<span class="ident" id="3600904">item</span><span class="op" id="3600908">)</span>&nbsp;<span class="ident" id="3600910">String</span><span class="op" id="3600916">(</span><span class="op" id="3600917">)</span>&nbsp;<span class="builtintype" id="3600919">string</span>&nbsp;<span class="op" id="3600926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3600929">switch</span>&nbsp;<span class="op" id="3600936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3600939">case</span>&nbsp;<span class="ident" id="3600944">i</span><span class="op" id="3600945">.</span><span class="ident" id="3600946">typ</span>&nbsp;<span class="op" id="3600950">==</span>&nbsp;<span class="ident" id="3600953">itemEOF</span><span class="op" id="3600960">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3600964">return</span>&nbsp;<span class="string" id="3600971">&#34;EOF&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3600978">case</span>&nbsp;<span class="ident" id="3600983">i</span><span class="op" id="3600984">.</span><span class="ident" id="3600985">typ</span>&nbsp;<span class="op" id="3600989">==</span>&nbsp;<span class="ident" id="3600992">itemError</span><span class="op" id="3601001">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3601005">return</span>&nbsp;<span class="ident" id="3601012">i</span><span class="op" id="3601013">.</span><span class="ident" id="3601014">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3601019">case</span>&nbsp;<span class="ident" id="3601024">i</span><span class="op" id="3601025">.</span><span class="ident" id="3601026">typ</span>&nbsp;<span class="op" id="3601030">&gt;</span>&nbsp;<span class="ident" id="3601032">itemKeyword</span><span class="op" id="3601043">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3601047">return</span>&nbsp;<span class="ident" id="3601054">fmt</span><span class="op" id="3601057">.</span><span class="ident" id="3601058">Sprintf</span><span class="op" id="3601065">(</span><span class="string" id="3601066">&#34;&lt;%s&gt;&#34;</span><span class="op" id="3601072">,</span>&nbsp;<span class="ident" id="3601074">i</span><span class="op" id="3601075">.</span><span class="ident" id="3601076">val</span><span class="op" id="3601079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3601082">case</span>&nbsp;<span class="builtinfunc" id="3601087">len</span><span class="op" id="3601090">(</span><span class="ident" id="3601091">i</span><span class="op" id="3601092">.</span><span class="ident" id="3601093">val</span><span class="op" id="3601096">)</span>&nbsp;<span class="op" id="3601098">&gt;</span>&nbsp;<span class="num" id="3601100">10</span><span class="op" id="3601102">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3601106">return</span>&nbsp;<span class="ident" id="3601113">fmt</span><span class="op" id="3601116">.</span><span class="ident" id="3601117">Sprintf</span><span class="op" id="3601124">(</span><span class="string" id="3601125">&#34;%.10q...&#34;</span><span class="op" id="3601135">,</span>&nbsp;<span class="ident" id="3601137">i</span><span class="op" id="3601138">.</span><span class="ident" id="3601139">val</span><span class="op" id="3601142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3601145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3601148">return</span>&nbsp;<span class="ident" id="3601155">fmt</span><span class="op" id="3601158">.</span><span class="ident" id="3601159">Sprintf</span><span class="op" id="3601166">(</span><span class="string" id="3601167">&#34;%q&#34;</span><span class="op" id="3601171">,</span>&nbsp;<span class="ident" id="3601173">i</span><span class="op" id="3601174">.</span><span class="ident" id="3601175">val</span><span class="op" id="3601178">)</span><br>
<span class="lineno"></span><span class="op" id="3601180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="3601183">//&nbsp;itemType&nbsp;identifies&nbsp;the&nbsp;type&nbsp;of&nbsp;lex&nbsp;items.</span><br>
<span class="lineno"></span><span class="keyword" id="3601229">type</span>&nbsp;<span class="ident" id="3601234">itemType</span>&nbsp;<span class="builtintype" id="3601243">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3601248">const</span>&nbsp;<span class="op" id="3601254">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3601257">itemError</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3601274">itemType</span>&nbsp;<span class="op" id="3601283">=</span>&nbsp;<span class="ident" id="3601285">iota</span>&nbsp;<span class="comment" id="3601290">//&nbsp;error&nbsp;occurred;&nbsp;value&nbsp;is&nbsp;text&nbsp;of&nbsp;error</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3601333">itemBool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3601366">//&nbsp;boolean&nbsp;constant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3601387">itemChar</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3601420">//&nbsp;printable&nbsp;ASCII&nbsp;character;&nbsp;grab&nbsp;bag&nbsp;for&nbsp;comma&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3601475">itemCharConstant</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3601508">//&nbsp;character&nbsp;constant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3601531">itemComplex</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3601564">//&nbsp;complex&nbsp;constant&nbsp;(1+2i);&nbsp;imaginary&nbsp;is&nbsp;just&nbsp;a&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3601620">itemColonEquals</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3601653">//&nbsp;colon-equals&nbsp;(&#39;:=&#39;)&nbsp;introducing&nbsp;a&nbsp;declaration</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3601703">itemEOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3601712">itemField</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3601727">//&nbsp;alphanumeric&nbsp;identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3601773">itemIdentifier</span>&nbsp;<span class="comment" id="3601788">//&nbsp;alphanumeric&nbsp;identifier&nbsp;not&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3601838">itemLeftDelim</span>&nbsp;&nbsp;<span class="comment" id="3601853">//&nbsp;left&nbsp;action&nbsp;delimiter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3601879">itemLeftParen</span>&nbsp;&nbsp;<span class="comment" id="3601894">//&nbsp;&#39;(&#39;&nbsp;inside&nbsp;action</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3601916">itemNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3601931">//&nbsp;simple&nbsp;number,&nbsp;including&nbsp;imaginary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3601970">itemPipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3601985">//&nbsp;pipe&nbsp;symbol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3602001">itemRawString</span>&nbsp;&nbsp;<span class="comment" id="3602016">//&nbsp;raw&nbsp;quoted&nbsp;string&nbsp;(includes&nbsp;quotes)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3602056">itemRightDelim</span>&nbsp;<span class="comment" id="3602071">//&nbsp;right&nbsp;action&nbsp;delimiter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3602098">itemRightParen</span>&nbsp;<span class="comment" id="3602113">//&nbsp;&#39;)&#39;&nbsp;inside&nbsp;action</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3602135">itemSpace</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3602150">//&nbsp;run&nbsp;of&nbsp;spaces&nbsp;separating&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3602189">itemString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3602204">//&nbsp;quoted&nbsp;string&nbsp;(includes&nbsp;quotes)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3602240">itemText</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3602255">//&nbsp;plain&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3602270">itemVariable</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3602285">//&nbsp;variable&nbsp;starting&nbsp;with&nbsp;&#39;$&#39;,&nbsp;such&nbsp;as&nbsp;&#39;$&#39;&nbsp;or&nbsp;&nbsp;&#39;$1&#39;&nbsp;or&nbsp;&#39;$hello&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3602350">//&nbsp;Keywords&nbsp;appear&nbsp;after&nbsp;all&nbsp;the&nbsp;rest.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3602390">itemKeyword</span>&nbsp;&nbsp;<span class="comment" id="3602403">//&nbsp;used&nbsp;only&nbsp;to&nbsp;delimit&nbsp;the&nbsp;keywords</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3602441">itemDot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3602454">//&nbsp;the&nbsp;cursor,&nbsp;spelled&nbsp;&#39;.&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3602482">itemDefine</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3602495">//&nbsp;define&nbsp;keyword</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3602514">itemElse</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3602527">//&nbsp;else&nbsp;keyword</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3602544">itemEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3602557">//&nbsp;end&nbsp;keyword</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3602573">itemIf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3602586">//&nbsp;if&nbsp;keyword</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3602601">itemNil</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3602614">//&nbsp;the&nbsp;untyped&nbsp;nil&nbsp;constant,&nbsp;easiest&nbsp;to&nbsp;treat&nbsp;as&nbsp;a&nbsp;keyword</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3602674">itemRange</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3602687">//&nbsp;range&nbsp;keyword</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3602705">itemTemplate</span>&nbsp;<span class="comment" id="3602718">//&nbsp;template&nbsp;keyword</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3602739">itemWith</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3602752">//&nbsp;with&nbsp;keyword</span><br>
<span class="lineno">70</span><span class="op" id="3602768">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3602771">var</span>&nbsp;<span class="ident" id="3602775">key</span>&nbsp;<span class="op" id="3602779">=</span>&nbsp;<span class="keyword" id="3602781">map</span><span class="op" id="3602784">[</span><span class="builtintype" id="3602785">string</span><span class="op" id="3602791">]</span><span class="ident" id="3602792">itemType</span><span class="op" id="3602800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3602803">&#34;.&#34;</span><span class="op" id="3602806">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3602815">itemDot</span><span class="op" id="3602822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3602825">&#34;define&#34;</span><span class="op" id="3602833">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3602837">itemDefine</span><span class="op" id="3602847">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3602850">&#34;else&#34;</span><span class="op" id="3602856">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3602862">itemElse</span><span class="op" id="3602870">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3602873">&#34;end&#34;</span><span class="op" id="3602878">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3602885">itemEnd</span><span class="op" id="3602892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3602895">&#34;if&#34;</span><span class="op" id="3602899">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3602907">itemIf</span><span class="op" id="3602913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3602916">&#34;range&#34;</span><span class="op" id="3602923">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3602928">itemRange</span><span class="op" id="3602937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3602940">&#34;nil&#34;</span><span class="op" id="3602945">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3602952">itemNil</span><span class="op" id="3602959">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3602962">&#34;template&#34;</span><span class="op" id="3602972">:</span>&nbsp;<span class="ident" id="3602974">itemTemplate</span><span class="op" id="3602986">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3602989">&#34;with&#34;</span><span class="op" id="3602995">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3603001">itemWith</span><span class="op" id="3603009">,</span><br>
<span class="lineno"></span><span class="op" id="3603011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3603014">const</span>&nbsp;<span class="ident" id="3603020">eof</span>&nbsp;<span class="op" id="3603024">=</span>&nbsp;<span class="op" id="3603026">-</span><span class="num" id="3603027">1</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="3603030">//&nbsp;stateFn&nbsp;represents&nbsp;the&nbsp;state&nbsp;of&nbsp;the&nbsp;scanner&nbsp;as&nbsp;a&nbsp;function&nbsp;that&nbsp;returns&nbsp;the&nbsp;next&nbsp;state.</span><br>
<span class="lineno"></span><span class="keyword" id="3603120">type</span>&nbsp;<span class="ident" id="3603125">stateFn</span>&nbsp;<span class="keyword" id="3603133">func</span><span class="op" id="3603137">(</span><span class="op" id="3603138">*</span><span class="ident" id="3603139">lexer</span><span class="op" id="3603144">)</span>&nbsp;<span class="ident" id="3603146">stateFn</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3603155">//&nbsp;lexer&nbsp;holds&nbsp;the&nbsp;state&nbsp;of&nbsp;the&nbsp;scanner.</span><br>
<span class="lineno">90</span><span class="keyword" id="3603196">type</span>&nbsp;<span class="ident" id="3603201">lexer</span>&nbsp;<span class="keyword" id="3603207">struct</span>&nbsp;<span class="op" id="3603214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3603217">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3603228">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3603238">//&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;input;&nbsp;used&nbsp;only&nbsp;for&nbsp;error&nbsp;reports</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3603293">input</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3603304">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3603314">//&nbsp;the&nbsp;string&nbsp;being&nbsp;scanned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3603343">leftDelim</span>&nbsp;&nbsp;<span class="builtintype" id="3603354">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3603364">//&nbsp;start&nbsp;of&nbsp;action</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3603384">rightDelim</span>&nbsp;<span class="builtintype" id="3603395">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3603405">//&nbsp;end&nbsp;of&nbsp;action</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3603423">state</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3603434">stateFn</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3603444">//&nbsp;the&nbsp;next&nbsp;lexing&nbsp;function&nbsp;to&nbsp;enter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3603482">pos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3603493">Pos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3603503">//&nbsp;current&nbsp;position&nbsp;in&nbsp;the&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3603537">start</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3603548">Pos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3603558">//&nbsp;start&nbsp;position&nbsp;of&nbsp;this&nbsp;item</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3603590">width</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3603601">Pos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3603611">//&nbsp;width&nbsp;of&nbsp;last&nbsp;rune&nbsp;read&nbsp;from&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3603650">lastPos</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3603661">Pos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3603671">//&nbsp;position&nbsp;of&nbsp;most&nbsp;recent&nbsp;item&nbsp;returned&nbsp;by&nbsp;nextItem</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3603725">items</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3603736">chan</span>&nbsp;<span class="ident" id="3603741">item</span>&nbsp;<span class="comment" id="3603746">//&nbsp;channel&nbsp;of&nbsp;scanned&nbsp;items</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3603775">parenDepth</span>&nbsp;<span class="builtintype" id="3603786">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3603796">//&nbsp;nesting&nbsp;depth&nbsp;of&nbsp;(&nbsp;)&nbsp;exprs</span><br>
<span class="lineno"></span><span class="op" id="3603826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3603829">//&nbsp;next&nbsp;returns&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno">105</span><span class="keyword" id="3603873">func</span>&nbsp;<span class="op" id="3603878">(</span><span class="ident" id="3603879">l</span>&nbsp;<span class="op" id="3603881">*</span><span class="ident" id="3603882">lexer</span><span class="op" id="3603887">)</span>&nbsp;<span class="ident" id="3603889">next</span><span class="op" id="3603893">(</span><span class="op" id="3603894">)</span>&nbsp;<span class="builtintype" id="3603896">rune</span>&nbsp;<span class="op" id="3603901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3603904">if</span>&nbsp;<span class="builtintype" id="3603907">int</span><span class="op" id="3603910">(</span><span class="ident" id="3603911">l</span><span class="op" id="3603912">.</span><span class="ident" id="3603913">pos</span><span class="op" id="3603916">)</span>&nbsp;<span class="op" id="3603918">&gt;=</span>&nbsp;<span class="builtinfunc" id="3603921">len</span><span class="op" id="3603924">(</span><span class="ident" id="3603925">l</span><span class="op" id="3603926">.</span><span class="ident" id="3603927">input</span><span class="op" id="3603932">)</span>&nbsp;<span class="op" id="3603934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3603938">l</span><span class="op" id="3603939">.</span><span class="ident" id="3603940">width</span>&nbsp;<span class="op" id="3603946">=</span>&nbsp;<span class="num" id="3603948">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3603952">return</span>&nbsp;<span class="ident" id="3603959">eof</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3603964">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3603967">r</span><span class="op" id="3603968">,</span>&nbsp;<span class="ident" id="3603970">w</span>&nbsp;<span class="op" id="3603972">:=</span>&nbsp;<span class="ident" id="3603975">utf8</span><span class="op" id="3603979">.</span><span class="ident" id="3603980">DecodeRuneInString</span><span class="op" id="3603998">(</span><span class="ident" id="3603999">l</span><span class="op" id="3604000">.</span><span class="ident" id="3604001">input</span><span class="op" id="3604006">[</span><span class="ident" id="3604007">l</span><span class="op" id="3604008">.</span><span class="ident" id="3604009">pos</span><span class="op" id="3604012">:</span><span class="op" id="3604013">]</span><span class="op" id="3604014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3604017">l</span><span class="op" id="3604018">.</span><span class="ident" id="3604019">width</span>&nbsp;<span class="op" id="3604025">=</span>&nbsp;<span class="ident" id="3604027">Pos</span><span class="op" id="3604030">(</span><span class="ident" id="3604031">w</span><span class="op" id="3604032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3604035">l</span><span class="op" id="3604036">.</span><span class="ident" id="3604037">pos</span>&nbsp;<span class="op" id="3604041">+=</span>&nbsp;<span class="ident" id="3604044">l</span><span class="op" id="3604045">.</span><span class="ident" id="3604046">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3604053">return</span>&nbsp;<span class="ident" id="3604060">r</span><br>
<span class="lineno"></span><span class="op" id="3604062">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="3604065">//&nbsp;peek&nbsp;returns&nbsp;but&nbsp;does&nbsp;not&nbsp;consume&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="keyword" id="3604130">func</span>&nbsp;<span class="op" id="3604135">(</span><span class="ident" id="3604136">l</span>&nbsp;<span class="op" id="3604138">*</span><span class="ident" id="3604139">lexer</span><span class="op" id="3604144">)</span>&nbsp;<span class="ident" id="3604146">peek</span><span class="op" id="3604150">(</span><span class="op" id="3604151">)</span>&nbsp;<span class="builtintype" id="3604153">rune</span>&nbsp;<span class="op" id="3604158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3604161">r</span>&nbsp;<span class="op" id="3604163">:=</span>&nbsp;<span class="ident" id="3604166">l</span><span class="op" id="3604167">.</span><span class="ident" id="3604168">next</span><span class="op" id="3604172">(</span><span class="op" id="3604173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3604176">l</span><span class="op" id="3604177">.</span><span class="ident" id="3604178">backup</span><span class="op" id="3604184">(</span><span class="op" id="3604185">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3604188">return</span>&nbsp;<span class="ident" id="3604195">r</span><br>
<span class="lineno"></span><span class="op" id="3604197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3604200">//&nbsp;backup&nbsp;steps&nbsp;back&nbsp;one&nbsp;rune.&nbsp;Can&nbsp;only&nbsp;be&nbsp;called&nbsp;once&nbsp;per&nbsp;call&nbsp;of&nbsp;next.</span><br>
<span class="lineno"></span><span class="keyword" id="3604273">func</span>&nbsp;<span class="op" id="3604278">(</span><span class="ident" id="3604279">l</span>&nbsp;<span class="op" id="3604281">*</span><span class="ident" id="3604282">lexer</span><span class="op" id="3604287">)</span>&nbsp;<span class="ident" id="3604289">backup</span><span class="op" id="3604295">(</span><span class="op" id="3604296">)</span>&nbsp;<span class="op" id="3604298">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3604301">l</span><span class="op" id="3604302">.</span><span class="ident" id="3604303">pos</span>&nbsp;<span class="op" id="3604307">-=</span>&nbsp;<span class="ident" id="3604310">l</span><span class="op" id="3604311">.</span><span class="ident" id="3604312">width</span><br>
<span class="lineno"></span><span class="op" id="3604318">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3604321">//&nbsp;emit&nbsp;passes&nbsp;an&nbsp;item&nbsp;back&nbsp;to&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span><span class="keyword" id="3604364">func</span>&nbsp;<span class="op" id="3604369">(</span><span class="ident" id="3604370">l</span>&nbsp;<span class="op" id="3604372">*</span><span class="ident" id="3604373">lexer</span><span class="op" id="3604378">)</span>&nbsp;<span class="ident" id="3604380">emit</span><span class="op" id="3604384">(</span><span class="ident" id="3604385">t</span>&nbsp;<span class="ident" id="3604387">itemType</span><span class="op" id="3604395">)</span>&nbsp;<span class="op" id="3604397">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3604400">l</span><span class="op" id="3604401">.</span><span class="ident" id="3604402">items</span>&nbsp;<span class="op" id="3604408">&lt;-</span>&nbsp;<span class="ident" id="3604411">item</span><span class="op" id="3604415">{</span><span class="ident" id="3604416">t</span><span class="op" id="3604417">,</span>&nbsp;<span class="ident" id="3604419">l</span><span class="op" id="3604420">.</span><span class="ident" id="3604421">start</span><span class="op" id="3604426">,</span>&nbsp;<span class="ident" id="3604428">l</span><span class="op" id="3604429">.</span><span class="ident" id="3604430">input</span><span class="op" id="3604435">[</span><span class="ident" id="3604436">l</span><span class="op" id="3604437">.</span><span class="ident" id="3604438">start</span><span class="op" id="3604443">:</span><span class="ident" id="3604444">l</span><span class="op" id="3604445">.</span><span class="ident" id="3604446">pos</span><span class="op" id="3604449">]</span><span class="op" id="3604450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3604453">l</span><span class="op" id="3604454">.</span><span class="ident" id="3604455">start</span>&nbsp;<span class="op" id="3604461">=</span>&nbsp;<span class="ident" id="3604463">l</span><span class="op" id="3604464">.</span><span class="ident" id="3604465">pos</span><br>
<span class="lineno"></span><span class="op" id="3604469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3604472">//&nbsp;ignore&nbsp;skips&nbsp;over&nbsp;the&nbsp;pending&nbsp;input&nbsp;before&nbsp;this&nbsp;point.</span><br>
<span class="lineno">135</span><span class="keyword" id="3604530">func</span>&nbsp;<span class="op" id="3604535">(</span><span class="ident" id="3604536">l</span>&nbsp;<span class="op" id="3604538">*</span><span class="ident" id="3604539">lexer</span><span class="op" id="3604544">)</span>&nbsp;<span class="ident" id="3604546">ignore</span><span class="op" id="3604552">(</span><span class="op" id="3604553">)</span>&nbsp;<span class="op" id="3604555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3604558">l</span><span class="op" id="3604559">.</span><span class="ident" id="3604560">start</span>&nbsp;<span class="op" id="3604566">=</span>&nbsp;<span class="ident" id="3604568">l</span><span class="op" id="3604569">.</span><span class="ident" id="3604570">pos</span><br>
<span class="lineno"></span><span class="op" id="3604574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3604577">//&nbsp;accept&nbsp;consumes&nbsp;the&nbsp;next&nbsp;rune&nbsp;if&nbsp;it&#39;s&nbsp;from&nbsp;the&nbsp;valid&nbsp;set.</span><br>
<span class="lineno">140</span><span class="keyword" id="3604638">func</span>&nbsp;<span class="op" id="3604643">(</span><span class="ident" id="3604644">l</span>&nbsp;<span class="op" id="3604646">*</span><span class="ident" id="3604647">lexer</span><span class="op" id="3604652">)</span>&nbsp;<span class="ident" id="3604654">accept</span><span class="op" id="3604660">(</span><span class="ident" id="3604661">valid</span>&nbsp;<span class="builtintype" id="3604667">string</span><span class="op" id="3604673">)</span>&nbsp;<span class="builtintype" id="3604675">bool</span>&nbsp;<span class="op" id="3604680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3604683">if</span>&nbsp;<span class="ident" id="3604686">strings</span><span class="op" id="3604693">.</span><span class="ident" id="3604694">IndexRune</span><span class="op" id="3604703">(</span><span class="ident" id="3604704">valid</span><span class="op" id="3604709">,</span>&nbsp;<span class="ident" id="3604711">l</span><span class="op" id="3604712">.</span><span class="ident" id="3604713">next</span><span class="op" id="3604717">(</span><span class="op" id="3604718">)</span><span class="op" id="3604719">)</span>&nbsp;<span class="op" id="3604721">&gt;=</span>&nbsp;<span class="num" id="3604724">0</span>&nbsp;<span class="op" id="3604726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3604730">return</span>&nbsp;<span class="builtintype" id="3604737">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3604743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3604746">l</span><span class="op" id="3604747">.</span><span class="ident" id="3604748">backup</span><span class="op" id="3604754">(</span><span class="op" id="3604755">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3604758">return</span>&nbsp;<span class="builtintype" id="3604765">false</span><br>
<span class="lineno"></span><span class="op" id="3604771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3604774">//&nbsp;acceptRun&nbsp;consumes&nbsp;a&nbsp;run&nbsp;of&nbsp;runes&nbsp;from&nbsp;the&nbsp;valid&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="3604831">func</span>&nbsp;<span class="op" id="3604836">(</span><span class="ident" id="3604837">l</span>&nbsp;<span class="op" id="3604839">*</span><span class="ident" id="3604840">lexer</span><span class="op" id="3604845">)</span>&nbsp;<span class="ident" id="3604847">acceptRun</span><span class="op" id="3604856">(</span><span class="ident" id="3604857">valid</span>&nbsp;<span class="builtintype" id="3604863">string</span><span class="op" id="3604869">)</span>&nbsp;<span class="op" id="3604871">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3604874">for</span>&nbsp;<span class="ident" id="3604878">strings</span><span class="op" id="3604885">.</span><span class="ident" id="3604886">IndexRune</span><span class="op" id="3604895">(</span><span class="ident" id="3604896">valid</span><span class="op" id="3604901">,</span>&nbsp;<span class="ident" id="3604903">l</span><span class="op" id="3604904">.</span><span class="ident" id="3604905">next</span><span class="op" id="3604909">(</span><span class="op" id="3604910">)</span><span class="op" id="3604911">)</span>&nbsp;<span class="op" id="3604913">&gt;=</span>&nbsp;<span class="num" id="3604916">0</span>&nbsp;<span class="op" id="3604918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3604921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3604924">l</span><span class="op" id="3604925">.</span><span class="ident" id="3604926">backup</span><span class="op" id="3604932">(</span><span class="op" id="3604933">)</span><br>
<span class="lineno"></span><span class="op" id="3604935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="comment" id="3604938">//&nbsp;lineNumber&nbsp;reports&nbsp;which&nbsp;line&nbsp;we&#39;re&nbsp;on,&nbsp;based&nbsp;on&nbsp;the&nbsp;position&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3605006">//&nbsp;the&nbsp;previous&nbsp;item&nbsp;returned&nbsp;by&nbsp;nextItem.&nbsp;Doing&nbsp;it&nbsp;this&nbsp;way</span><br>
<span class="lineno"></span><span class="comment" id="3605067">//&nbsp;means&nbsp;we&nbsp;don&#39;t&nbsp;have&nbsp;to&nbsp;worry&nbsp;about&nbsp;peek&nbsp;double&nbsp;counting.</span><br>
<span class="lineno"></span><span class="keyword" id="3605127">func</span>&nbsp;<span class="op" id="3605132">(</span><span class="ident" id="3605133">l</span>&nbsp;<span class="op" id="3605135">*</span><span class="ident" id="3605136">lexer</span><span class="op" id="3605141">)</span>&nbsp;<span class="ident" id="3605143">lineNumber</span><span class="op" id="3605153">(</span><span class="op" id="3605154">)</span>&nbsp;<span class="builtintype" id="3605156">int</span>&nbsp;<span class="op" id="3605160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3605163">return</span>&nbsp;<span class="num" id="3605170">1</span>&nbsp;<span class="op" id="3605172">+</span>&nbsp;<span class="ident" id="3605174">strings</span><span class="op" id="3605181">.</span><span class="ident" id="3605182">Count</span><span class="op" id="3605187">(</span><span class="ident" id="3605188">l</span><span class="op" id="3605189">.</span><span class="ident" id="3605190">input</span><span class="op" id="3605195">[</span><span class="op" id="3605196">:</span><span class="ident" id="3605197">l</span><span class="op" id="3605198">.</span><span class="ident" id="3605199">lastPos</span><span class="op" id="3605206">]</span><span class="op" id="3605207">,</span>&nbsp;<span class="string" id="3605209">&#34;\n&#34;</span><span class="op" id="3605213">)</span><br>
<span class="lineno">160</span><span class="op" id="3605215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3605218">//&nbsp;errorf&nbsp;returns&nbsp;an&nbsp;error&nbsp;token&nbsp;and&nbsp;terminates&nbsp;the&nbsp;scan&nbsp;by&nbsp;passing</span><br>
<span class="lineno"></span><span class="comment" id="3605286">//&nbsp;back&nbsp;a&nbsp;nil&nbsp;pointer&nbsp;that&nbsp;will&nbsp;be&nbsp;the&nbsp;next&nbsp;state,&nbsp;terminating&nbsp;l.nextItem.</span><br>
<span class="lineno"></span><span class="keyword" id="3605361">func</span>&nbsp;<span class="op" id="3605366">(</span><span class="ident" id="3605367">l</span>&nbsp;<span class="op" id="3605369">*</span><span class="ident" id="3605370">lexer</span><span class="op" id="3605375">)</span>&nbsp;<span class="ident" id="3605377">errorf</span><span class="op" id="3605383">(</span><span class="ident" id="3605384">format</span>&nbsp;<span class="builtintype" id="3605391">string</span><span class="op" id="3605397">,</span>&nbsp;<span class="ident" id="3605399">args</span>&nbsp;<span class="op" id="3605404">...</span><span class="keyword" id="3605407">interface</span><span class="op" id="3605416">{</span><span class="op" id="3605417">}</span><span class="op" id="3605418">)</span>&nbsp;<span class="ident" id="3605420">stateFn</span>&nbsp;<span class="op" id="3605428">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3605431">l</span><span class="op" id="3605432">.</span><span class="ident" id="3605433">items</span>&nbsp;<span class="op" id="3605439">&lt;-</span>&nbsp;<span class="ident" id="3605442">item</span><span class="op" id="3605446">{</span><span class="ident" id="3605447">itemError</span><span class="op" id="3605456">,</span>&nbsp;<span class="ident" id="3605458">l</span><span class="op" id="3605459">.</span><span class="ident" id="3605460">start</span><span class="op" id="3605465">,</span>&nbsp;<span class="ident" id="3605467">fmt</span><span class="op" id="3605470">.</span><span class="ident" id="3605471">Sprintf</span><span class="op" id="3605478">(</span><span class="ident" id="3605479">format</span><span class="op" id="3605485">,</span>&nbsp;<span class="ident" id="3605487">args</span><span class="op" id="3605491">...</span><span class="op" id="3605494">)</span><span class="op" id="3605495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3605498">return</span>&nbsp;<span class="builtintype" id="3605505">nil</span><br>
<span class="lineno"></span><span class="op" id="3605509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3605512">//&nbsp;nextItem&nbsp;returns&nbsp;the&nbsp;next&nbsp;item&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno">170</span><span class="keyword" id="3605562">func</span>&nbsp;<span class="op" id="3605567">(</span><span class="ident" id="3605568">l</span>&nbsp;<span class="op" id="3605570">*</span><span class="ident" id="3605571">lexer</span><span class="op" id="3605576">)</span>&nbsp;<span class="ident" id="3605578">nextItem</span><span class="op" id="3605586">(</span><span class="op" id="3605587">)</span>&nbsp;<span class="ident" id="3605589">item</span>&nbsp;<span class="op" id="3605594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3605597">item</span>&nbsp;<span class="op" id="3605602">:=</span>&nbsp;<span class="op" id="3605605">&lt;-</span><span class="ident" id="3605607">l</span><span class="op" id="3605608">.</span><span class="ident" id="3605609">items</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3605616">l</span><span class="op" id="3605617">.</span><span class="ident" id="3605618">lastPos</span>&nbsp;<span class="op" id="3605626">=</span>&nbsp;<span class="ident" id="3605628">item</span><span class="op" id="3605632">.</span><span class="ident" id="3605633">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3605638">return</span>&nbsp;<span class="ident" id="3605645">item</span><br>
<span class="lineno"></span><span class="op" id="3605650">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="3605653">//&nbsp;lex&nbsp;creates&nbsp;a&nbsp;new&nbsp;scanner&nbsp;for&nbsp;the&nbsp;input&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3605704">func</span>&nbsp;<span class="ident" id="3605709">lex</span><span class="op" id="3605712">(</span><span class="ident" id="3605713">name</span><span class="op" id="3605717">,</span>&nbsp;<span class="ident" id="3605719">input</span><span class="op" id="3605724">,</span>&nbsp;<span class="ident" id="3605726">left</span><span class="op" id="3605730">,</span>&nbsp;<span class="ident" id="3605732">right</span>&nbsp;<span class="builtintype" id="3605738">string</span><span class="op" id="3605744">)</span>&nbsp;<span class="op" id="3605746">*</span><span class="ident" id="3605747">lexer</span>&nbsp;<span class="op" id="3605753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3605756">if</span>&nbsp;<span class="ident" id="3605759">left</span>&nbsp;<span class="op" id="3605764">==</span>&nbsp;<span class="string" id="3605767">&#34;&#34;</span>&nbsp;<span class="op" id="3605770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3605774">left</span>&nbsp;<span class="op" id="3605779">=</span>&nbsp;<span class="ident" id="3605781">leftDelim</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3605792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3605795">if</span>&nbsp;<span class="ident" id="3605798">right</span>&nbsp;<span class="op" id="3605804">==</span>&nbsp;<span class="string" id="3605807">&#34;&#34;</span>&nbsp;<span class="op" id="3605810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3605814">right</span>&nbsp;<span class="op" id="3605820">=</span>&nbsp;<span class="ident" id="3605822">rightDelim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3605834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3605837">l</span>&nbsp;<span class="op" id="3605839">:=</span>&nbsp;<span class="op" id="3605842">&amp;</span><span class="ident" id="3605843">lexer</span><span class="op" id="3605848">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3605852">name</span><span class="op" id="3605856">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3605864">name</span><span class="op" id="3605868">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3605872">input</span><span class="op" id="3605877">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3605884">input</span><span class="op" id="3605889">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3605893">leftDelim</span><span class="op" id="3605902">:</span>&nbsp;&nbsp;<span class="ident" id="3605905">left</span><span class="op" id="3605909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3605913">rightDelim</span><span class="op" id="3605923">:</span>&nbsp;<span class="ident" id="3605925">right</span><span class="op" id="3605930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3605934">items</span><span class="op" id="3605939">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3605946">make</span><span class="op" id="3605950">(</span><span class="keyword" id="3605951">chan</span>&nbsp;<span class="ident" id="3605956">item</span><span class="op" id="3605960">)</span><span class="op" id="3605961">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3605964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3605967">go</span>&nbsp;<span class="ident" id="3605970">l</span><span class="op" id="3605971">.</span><span class="ident" id="3605972">run</span><span class="op" id="3605975">(</span><span class="op" id="3605976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3605979">return</span>&nbsp;<span class="ident" id="3605986">l</span><br>
<span class="lineno"></span><span class="op" id="3605988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="3605991">//&nbsp;run&nbsp;runs&nbsp;the&nbsp;state&nbsp;machine&nbsp;for&nbsp;the&nbsp;lexer.</span><br>
<span class="lineno"></span><span class="keyword" id="3606036">func</span>&nbsp;<span class="op" id="3606041">(</span><span class="ident" id="3606042">l</span>&nbsp;<span class="op" id="3606044">*</span><span class="ident" id="3606045">lexer</span><span class="op" id="3606050">)</span>&nbsp;<span class="ident" id="3606052">run</span><span class="op" id="3606055">(</span><span class="op" id="3606056">)</span>&nbsp;<span class="op" id="3606058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3606061">for</span>&nbsp;<span class="ident" id="3606065">l</span><span class="op" id="3606066">.</span><span class="ident" id="3606067">state</span>&nbsp;<span class="op" id="3606073">=</span>&nbsp;<span class="ident" id="3606075">lexText</span><span class="op" id="3606082">;</span>&nbsp;<span class="ident" id="3606084">l</span><span class="op" id="3606085">.</span><span class="ident" id="3606086">state</span>&nbsp;<span class="op" id="3606092">!=</span>&nbsp;<span class="builtintype" id="3606095">nil</span><span class="op" id="3606098">;</span>&nbsp;<span class="op" id="3606100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3606104">l</span><span class="op" id="3606105">.</span><span class="ident" id="3606106">state</span>&nbsp;<span class="op" id="3606112">=</span>&nbsp;<span class="ident" id="3606114">l</span><span class="op" id="3606115">.</span><span class="ident" id="3606116">state</span><span class="op" id="3606121">(</span><span class="ident" id="3606122">l</span><span class="op" id="3606123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3606126">}</span><br>
<span class="lineno">200</span><span class="op" id="3606128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3606131">//&nbsp;state&nbsp;functions</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3606151">const</span>&nbsp;<span class="op" id="3606157">(</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3606160">leftDelim</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3606173">=</span>&nbsp;<span class="string" id="3606175">&#34;{{&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3606181">rightDelim</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3606194">=</span>&nbsp;<span class="string" id="3606196">&#34;}}&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3606202">leftComment</span>&nbsp;&nbsp;<span class="op" id="3606215">=</span>&nbsp;<span class="string" id="3606217">&#34;/*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3606223">rightComment</span>&nbsp;<span class="op" id="3606236">=</span>&nbsp;<span class="string" id="3606238">&#34;*/&#34;</span><br>
<span class="lineno"></span><span class="op" id="3606243">)</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="comment" id="3606246">//&nbsp;lexText&nbsp;scans&nbsp;until&nbsp;an&nbsp;opening&nbsp;action&nbsp;delimiter,&nbsp;&#34;{{&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3606304">func</span>&nbsp;<span class="ident" id="3606309">lexText</span><span class="op" id="3606316">(</span><span class="ident" id="3606317">l</span>&nbsp;<span class="op" id="3606319">*</span><span class="ident" id="3606320">lexer</span><span class="op" id="3606325">)</span>&nbsp;<span class="ident" id="3606327">stateFn</span>&nbsp;<span class="op" id="3606335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3606338">for</span>&nbsp;<span class="op" id="3606342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3606346">if</span>&nbsp;<span class="ident" id="3606349">strings</span><span class="op" id="3606356">.</span><span class="ident" id="3606357">HasPrefix</span><span class="op" id="3606366">(</span><span class="ident" id="3606367">l</span><span class="op" id="3606368">.</span><span class="ident" id="3606369">input</span><span class="op" id="3606374">[</span><span class="ident" id="3606375">l</span><span class="op" id="3606376">.</span><span class="ident" id="3606377">pos</span><span class="op" id="3606380">:</span><span class="op" id="3606381">]</span><span class="op" id="3606382">,</span>&nbsp;<span class="ident" id="3606384">l</span><span class="op" id="3606385">.</span><span class="ident" id="3606386">leftDelim</span><span class="op" id="3606395">)</span>&nbsp;<span class="op" id="3606397">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3606402">if</span>&nbsp;<span class="ident" id="3606405">l</span><span class="op" id="3606406">.</span><span class="ident" id="3606407">pos</span>&nbsp;<span class="op" id="3606411">&gt;</span>&nbsp;<span class="ident" id="3606413">l</span><span class="op" id="3606414">.</span><span class="ident" id="3606415">start</span>&nbsp;<span class="op" id="3606421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3606427">l</span><span class="op" id="3606428">.</span><span class="ident" id="3606429">emit</span><span class="op" id="3606433">(</span><span class="ident" id="3606434">itemText</span><span class="op" id="3606442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3606447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3606452">return</span>&nbsp;<span class="ident" id="3606459">lexLeftDelim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3606474">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3606478">if</span>&nbsp;<span class="ident" id="3606481">l</span><span class="op" id="3606482">.</span><span class="ident" id="3606483">next</span><span class="op" id="3606487">(</span><span class="op" id="3606488">)</span>&nbsp;<span class="op" id="3606490">==</span>&nbsp;<span class="ident" id="3606493">eof</span>&nbsp;<span class="op" id="3606497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3606502">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3606510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3606513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3606516">//&nbsp;Correctly&nbsp;reached&nbsp;EOF.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3606543">if</span>&nbsp;<span class="ident" id="3606546">l</span><span class="op" id="3606547">.</span><span class="ident" id="3606548">pos</span>&nbsp;<span class="op" id="3606552">&gt;</span>&nbsp;<span class="ident" id="3606554">l</span><span class="op" id="3606555">.</span><span class="ident" id="3606556">start</span>&nbsp;<span class="op" id="3606562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3606566">l</span><span class="op" id="3606567">.</span><span class="ident" id="3606568">emit</span><span class="op" id="3606572">(</span><span class="ident" id="3606573">itemText</span><span class="op" id="3606581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3606584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3606587">l</span><span class="op" id="3606588">.</span><span class="ident" id="3606589">emit</span><span class="op" id="3606593">(</span><span class="ident" id="3606594">itemEOF</span><span class="op" id="3606601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3606604">return</span>&nbsp;<span class="builtintype" id="3606611">nil</span><br>
<span class="lineno">230</span><span class="op" id="3606615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3606618">//&nbsp;lexLeftDelim&nbsp;scans&nbsp;the&nbsp;left&nbsp;delimiter,&nbsp;which&nbsp;is&nbsp;known&nbsp;to&nbsp;be&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="3606690">func</span>&nbsp;<span class="ident" id="3606695">lexLeftDelim</span><span class="op" id="3606707">(</span><span class="ident" id="3606708">l</span>&nbsp;<span class="op" id="3606710">*</span><span class="ident" id="3606711">lexer</span><span class="op" id="3606716">)</span>&nbsp;<span class="ident" id="3606718">stateFn</span>&nbsp;<span class="op" id="3606726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3606729">l</span><span class="op" id="3606730">.</span><span class="ident" id="3606731">pos</span>&nbsp;<span class="op" id="3606735">+=</span>&nbsp;<span class="ident" id="3606738">Pos</span><span class="op" id="3606741">(</span><span class="builtinfunc" id="3606742">len</span><span class="op" id="3606745">(</span><span class="ident" id="3606746">l</span><span class="op" id="3606747">.</span><span class="ident" id="3606748">leftDelim</span><span class="op" id="3606757">)</span><span class="op" id="3606758">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3606761">if</span>&nbsp;<span class="ident" id="3606764">strings</span><span class="op" id="3606771">.</span><span class="ident" id="3606772">HasPrefix</span><span class="op" id="3606781">(</span><span class="ident" id="3606782">l</span><span class="op" id="3606783">.</span><span class="ident" id="3606784">input</span><span class="op" id="3606789">[</span><span class="ident" id="3606790">l</span><span class="op" id="3606791">.</span><span class="ident" id="3606792">pos</span><span class="op" id="3606795">:</span><span class="op" id="3606796">]</span><span class="op" id="3606797">,</span>&nbsp;<span class="ident" id="3606799">leftComment</span><span class="op" id="3606810">)</span>&nbsp;<span class="op" id="3606812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3606816">return</span>&nbsp;<span class="ident" id="3606823">lexComment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3606835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3606838">l</span><span class="op" id="3606839">.</span><span class="ident" id="3606840">emit</span><span class="op" id="3606844">(</span><span class="ident" id="3606845">itemLeftDelim</span><span class="op" id="3606858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3606861">l</span><span class="op" id="3606862">.</span><span class="ident" id="3606863">parenDepth</span>&nbsp;<span class="op" id="3606874">=</span>&nbsp;<span class="num" id="3606876">0</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3606879">return</span>&nbsp;<span class="ident" id="3606886">lexInsideAction</span><br>
<span class="lineno"></span><span class="op" id="3606902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3606905">//&nbsp;lexComment&nbsp;scans&nbsp;a&nbsp;comment.&nbsp;The&nbsp;left&nbsp;comment&nbsp;marker&nbsp;is&nbsp;known&nbsp;to&nbsp;be&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="3606984">func</span>&nbsp;<span class="ident" id="3606989">lexComment</span><span class="op" id="3606999">(</span><span class="ident" id="3607000">l</span>&nbsp;<span class="op" id="3607002">*</span><span class="ident" id="3607003">lexer</span><span class="op" id="3607008">)</span>&nbsp;<span class="ident" id="3607010">stateFn</span>&nbsp;<span class="op" id="3607018">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3607021">l</span><span class="op" id="3607022">.</span><span class="ident" id="3607023">pos</span>&nbsp;<span class="op" id="3607027">+=</span>&nbsp;<span class="ident" id="3607030">Pos</span><span class="op" id="3607033">(</span><span class="builtinfunc" id="3607034">len</span><span class="op" id="3607037">(</span><span class="ident" id="3607038">leftComment</span><span class="op" id="3607049">)</span><span class="op" id="3607050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3607053">i</span>&nbsp;<span class="op" id="3607055">:=</span>&nbsp;<span class="ident" id="3607058">strings</span><span class="op" id="3607065">.</span><span class="ident" id="3607066">Index</span><span class="op" id="3607071">(</span><span class="ident" id="3607072">l</span><span class="op" id="3607073">.</span><span class="ident" id="3607074">input</span><span class="op" id="3607079">[</span><span class="ident" id="3607080">l</span><span class="op" id="3607081">.</span><span class="ident" id="3607082">pos</span><span class="op" id="3607085">:</span><span class="op" id="3607086">]</span><span class="op" id="3607087">,</span>&nbsp;<span class="ident" id="3607089">rightComment</span><span class="op" id="3607101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3607104">if</span>&nbsp;<span class="ident" id="3607107">i</span>&nbsp;<span class="op" id="3607109">&lt;</span>&nbsp;<span class="num" id="3607111">0</span>&nbsp;<span class="op" id="3607113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3607117">return</span>&nbsp;<span class="ident" id="3607124">l</span><span class="op" id="3607125">.</span><span class="ident" id="3607126">errorf</span><span class="op" id="3607132">(</span><span class="string" id="3607133">&#34;unclosed&nbsp;comment&#34;</span><span class="op" id="3607151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3607154">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3607157">l</span><span class="op" id="3607158">.</span><span class="ident" id="3607159">pos</span>&nbsp;<span class="op" id="3607163">+=</span>&nbsp;<span class="ident" id="3607166">Pos</span><span class="op" id="3607169">(</span><span class="ident" id="3607170">i</span>&nbsp;<span class="op" id="3607172">+</span>&nbsp;<span class="builtinfunc" id="3607174">len</span><span class="op" id="3607177">(</span><span class="ident" id="3607178">rightComment</span><span class="op" id="3607190">)</span><span class="op" id="3607191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3607194">if</span>&nbsp;<span class="op" id="3607197">!</span><span class="ident" id="3607198">strings</span><span class="op" id="3607205">.</span><span class="ident" id="3607206">HasPrefix</span><span class="op" id="3607215">(</span><span class="ident" id="3607216">l</span><span class="op" id="3607217">.</span><span class="ident" id="3607218">input</span><span class="op" id="3607223">[</span><span class="ident" id="3607224">l</span><span class="op" id="3607225">.</span><span class="ident" id="3607226">pos</span><span class="op" id="3607229">:</span><span class="op" id="3607230">]</span><span class="op" id="3607231">,</span>&nbsp;<span class="ident" id="3607233">l</span><span class="op" id="3607234">.</span><span class="ident" id="3607235">rightDelim</span><span class="op" id="3607245">)</span>&nbsp;<span class="op" id="3607247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3607251">return</span>&nbsp;<span class="ident" id="3607258">l</span><span class="op" id="3607259">.</span><span class="ident" id="3607260">errorf</span><span class="op" id="3607266">(</span><span class="string" id="3607267">&#34;comment&nbsp;ends&nbsp;before&nbsp;closing&nbsp;delimiter&#34;</span><span class="op" id="3607306">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3607310">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3607313">l</span><span class="op" id="3607314">.</span><span class="ident" id="3607315">pos</span>&nbsp;<span class="op" id="3607319">+=</span>&nbsp;<span class="ident" id="3607322">Pos</span><span class="op" id="3607325">(</span><span class="builtinfunc" id="3607326">len</span><span class="op" id="3607329">(</span><span class="ident" id="3607330">l</span><span class="op" id="3607331">.</span><span class="ident" id="3607332">rightDelim</span><span class="op" id="3607342">)</span><span class="op" id="3607343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3607346">l</span><span class="op" id="3607347">.</span><span class="ident" id="3607348">ignore</span><span class="op" id="3607354">(</span><span class="op" id="3607355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3607358">return</span>&nbsp;<span class="ident" id="3607365">lexText</span><br>
<span class="lineno"></span><span class="op" id="3607373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="3607376">//&nbsp;lexRightDelim&nbsp;scans&nbsp;the&nbsp;right&nbsp;delimiter,&nbsp;which&nbsp;is&nbsp;known&nbsp;to&nbsp;be&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="3607450">func</span>&nbsp;<span class="ident" id="3607455">lexRightDelim</span><span class="op" id="3607468">(</span><span class="ident" id="3607469">l</span>&nbsp;<span class="op" id="3607471">*</span><span class="ident" id="3607472">lexer</span><span class="op" id="3607477">)</span>&nbsp;<span class="ident" id="3607479">stateFn</span>&nbsp;<span class="op" id="3607487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3607490">l</span><span class="op" id="3607491">.</span><span class="ident" id="3607492">pos</span>&nbsp;<span class="op" id="3607496">+=</span>&nbsp;<span class="ident" id="3607499">Pos</span><span class="op" id="3607502">(</span><span class="builtinfunc" id="3607503">len</span><span class="op" id="3607506">(</span><span class="ident" id="3607507">l</span><span class="op" id="3607508">.</span><span class="ident" id="3607509">rightDelim</span><span class="op" id="3607519">)</span><span class="op" id="3607520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3607523">l</span><span class="op" id="3607524">.</span><span class="ident" id="3607525">emit</span><span class="op" id="3607529">(</span><span class="ident" id="3607530">itemRightDelim</span><span class="op" id="3607544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3607547">return</span>&nbsp;<span class="ident" id="3607554">lexText</span><br>
<span class="lineno">265</span><span class="op" id="3607562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3607565">//&nbsp;lexInsideAction&nbsp;scans&nbsp;the&nbsp;elements&nbsp;inside&nbsp;action&nbsp;delimiters.</span><br>
<span class="lineno"></span><span class="keyword" id="3607629">func</span>&nbsp;<span class="ident" id="3607634">lexInsideAction</span><span class="op" id="3607649">(</span><span class="ident" id="3607650">l</span>&nbsp;<span class="op" id="3607652">*</span><span class="ident" id="3607653">lexer</span><span class="op" id="3607658">)</span>&nbsp;<span class="ident" id="3607660">stateFn</span>&nbsp;<span class="op" id="3607668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3607671">//&nbsp;Either&nbsp;number,&nbsp;quoted&nbsp;string,&nbsp;or&nbsp;identifier.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3607720">//&nbsp;Spaces&nbsp;separate&nbsp;arguments;&nbsp;runs&nbsp;of&nbsp;spaces&nbsp;turn&nbsp;into&nbsp;itemSpace.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3607787">//&nbsp;Pipe&nbsp;symbols&nbsp;separate&nbsp;and&nbsp;are&nbsp;emitted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3607830">if</span>&nbsp;<span class="ident" id="3607833">strings</span><span class="op" id="3607840">.</span><span class="ident" id="3607841">HasPrefix</span><span class="op" id="3607850">(</span><span class="ident" id="3607851">l</span><span class="op" id="3607852">.</span><span class="ident" id="3607853">input</span><span class="op" id="3607858">[</span><span class="ident" id="3607859">l</span><span class="op" id="3607860">.</span><span class="ident" id="3607861">pos</span><span class="op" id="3607864">:</span><span class="op" id="3607865">]</span><span class="op" id="3607866">,</span>&nbsp;<span class="ident" id="3607868">l</span><span class="op" id="3607869">.</span><span class="ident" id="3607870">rightDelim</span><span class="op" id="3607880">)</span>&nbsp;<span class="op" id="3607882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3607886">if</span>&nbsp;<span class="ident" id="3607889">l</span><span class="op" id="3607890">.</span><span class="ident" id="3607891">parenDepth</span>&nbsp;<span class="op" id="3607902">==</span>&nbsp;<span class="num" id="3607905">0</span>&nbsp;<span class="op" id="3607907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3607912">return</span>&nbsp;<span class="ident" id="3607919">lexRightDelim</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3607935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3607939">return</span>&nbsp;<span class="ident" id="3607946">l</span><span class="op" id="3607947">.</span><span class="ident" id="3607948">errorf</span><span class="op" id="3607954">(</span><span class="string" id="3607955">&#34;unclosed&nbsp;left&nbsp;paren&#34;</span><span class="op" id="3607976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3607979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3607982">switch</span>&nbsp;<span class="ident" id="3607989">r</span>&nbsp;<span class="op" id="3607991">:=</span>&nbsp;<span class="ident" id="3607994">l</span><span class="op" id="3607995">.</span><span class="ident" id="3607996">next</span><span class="op" id="3608000">(</span><span class="op" id="3608001">)</span><span class="op" id="3608002">;</span>&nbsp;<span class="op" id="3608004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608007">case</span>&nbsp;<span class="ident" id="3608012">r</span>&nbsp;<span class="op" id="3608014">==</span>&nbsp;<span class="ident" id="3608017">eof</span>&nbsp;<span class="op" id="3608021">||</span>&nbsp;<span class="ident" id="3608024">isEndOfLine</span><span class="op" id="3608035">(</span><span class="ident" id="3608036">r</span><span class="op" id="3608037">)</span><span class="op" id="3608038">:</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608042">return</span>&nbsp;<span class="ident" id="3608049">l</span><span class="op" id="3608050">.</span><span class="ident" id="3608051">errorf</span><span class="op" id="3608057">(</span><span class="string" id="3608058">&#34;unclosed&nbsp;action&#34;</span><span class="op" id="3608075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608078">case</span>&nbsp;<span class="ident" id="3608083">isSpace</span><span class="op" id="3608090">(</span><span class="ident" id="3608091">r</span><span class="op" id="3608092">)</span><span class="op" id="3608093">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608097">return</span>&nbsp;<span class="ident" id="3608104">lexSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608114">case</span>&nbsp;<span class="ident" id="3608119">r</span>&nbsp;<span class="op" id="3608121">==</span>&nbsp;<span class="string" id="3608124">&#39;:&#39;</span><span class="op" id="3608127">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608131">if</span>&nbsp;<span class="ident" id="3608134">l</span><span class="op" id="3608135">.</span><span class="ident" id="3608136">next</span><span class="op" id="3608140">(</span><span class="op" id="3608141">)</span>&nbsp;<span class="op" id="3608143">!=</span>&nbsp;<span class="string" id="3608146">&#39;=&#39;</span>&nbsp;<span class="op" id="3608150">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608155">return</span>&nbsp;<span class="ident" id="3608162">l</span><span class="op" id="3608163">.</span><span class="ident" id="3608164">errorf</span><span class="op" id="3608170">(</span><span class="string" id="3608171">&#34;expected&nbsp;:=&#34;</span><span class="op" id="3608184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3608188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3608192">l</span><span class="op" id="3608193">.</span><span class="ident" id="3608194">emit</span><span class="op" id="3608198">(</span><span class="ident" id="3608199">itemColonEquals</span><span class="op" id="3608214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608217">case</span>&nbsp;<span class="ident" id="3608222">r</span>&nbsp;<span class="op" id="3608224">==</span>&nbsp;<span class="string" id="3608227">&#39;|&#39;</span><span class="op" id="3608230">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3608234">l</span><span class="op" id="3608235">.</span><span class="ident" id="3608236">emit</span><span class="op" id="3608240">(</span><span class="ident" id="3608241">itemPipe</span><span class="op" id="3608249">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608252">case</span>&nbsp;<span class="ident" id="3608257">r</span>&nbsp;<span class="op" id="3608259">==</span>&nbsp;<span class="string" id="3608262">&#39;&#34;&#39;</span><span class="op" id="3608265">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608269">return</span>&nbsp;<span class="ident" id="3608276">lexQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608286">case</span>&nbsp;<span class="ident" id="3608291">r</span>&nbsp;<span class="op" id="3608293">==</span>&nbsp;<span class="string" id="3608296">&#39;`&#39;</span><span class="op" id="3608299">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608303">return</span>&nbsp;<span class="ident" id="3608310">lexRawQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608323">case</span>&nbsp;<span class="ident" id="3608328">r</span>&nbsp;<span class="op" id="3608330">==</span>&nbsp;<span class="string" id="3608333">&#39;$&#39;</span><span class="op" id="3608336">:</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608340">return</span>&nbsp;<span class="ident" id="3608347">lexVariable</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608360">case</span>&nbsp;<span class="ident" id="3608365">r</span>&nbsp;<span class="op" id="3608367">==</span>&nbsp;<span class="string" id="3608370">&#39;\&#39;&#39;</span><span class="op" id="3608374">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608378">return</span>&nbsp;<span class="ident" id="3608385">lexChar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608394">case</span>&nbsp;<span class="ident" id="3608399">r</span>&nbsp;<span class="op" id="3608401">==</span>&nbsp;<span class="string" id="3608404">&#39;.&#39;</span><span class="op" id="3608407">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3608411">//&nbsp;special&nbsp;look-ahead&nbsp;for&nbsp;&#34;.field&#34;&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;break&nbsp;l.backup().</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608478">if</span>&nbsp;<span class="ident" id="3608481">l</span><span class="op" id="3608482">.</span><span class="ident" id="3608483">pos</span>&nbsp;<span class="op" id="3608487">&lt;</span>&nbsp;<span class="ident" id="3608489">Pos</span><span class="op" id="3608492">(</span><span class="builtinfunc" id="3608493">len</span><span class="op" id="3608496">(</span><span class="ident" id="3608497">l</span><span class="op" id="3608498">.</span><span class="ident" id="3608499">input</span><span class="op" id="3608504">)</span><span class="op" id="3608505">)</span>&nbsp;<span class="op" id="3608507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3608512">r</span>&nbsp;<span class="op" id="3608514">:=</span>&nbsp;<span class="ident" id="3608517">l</span><span class="op" id="3608518">.</span><span class="ident" id="3608519">input</span><span class="op" id="3608524">[</span><span class="ident" id="3608525">l</span><span class="op" id="3608526">.</span><span class="ident" id="3608527">pos</span><span class="op" id="3608530">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608535">if</span>&nbsp;<span class="ident" id="3608538">r</span>&nbsp;<span class="op" id="3608540">&lt;</span>&nbsp;<span class="string" id="3608542">&#39;0&#39;</span>&nbsp;<span class="op" id="3608546">||</span>&nbsp;<span class="string" id="3608549">&#39;9&#39;</span>&nbsp;<span class="op" id="3608553">&lt;</span>&nbsp;<span class="ident" id="3608555">r</span>&nbsp;<span class="op" id="3608557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608563">return</span>&nbsp;<span class="ident" id="3608570">lexField</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3608582">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3608586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608590">fallthrough</span>&nbsp;<span class="comment" id="3608602">//&nbsp;&#39;.&#39;&nbsp;can&nbsp;start&nbsp;a&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608630">case</span>&nbsp;<span class="ident" id="3608635">r</span>&nbsp;<span class="op" id="3608637">==</span>&nbsp;<span class="string" id="3608640">&#39;+&#39;</span>&nbsp;<span class="op" id="3608644">||</span>&nbsp;<span class="ident" id="3608647">r</span>&nbsp;<span class="op" id="3608649">==</span>&nbsp;<span class="string" id="3608652">&#39;-&#39;</span>&nbsp;<span class="op" id="3608656">||</span>&nbsp;<span class="op" id="3608659">(</span><span class="string" id="3608660">&#39;0&#39;</span>&nbsp;<span class="op" id="3608664">&lt;=</span>&nbsp;<span class="ident" id="3608667">r</span>&nbsp;<span class="op" id="3608669">&amp;&amp;</span>&nbsp;<span class="ident" id="3608672">r</span>&nbsp;<span class="op" id="3608674">&lt;=</span>&nbsp;<span class="string" id="3608677">&#39;9&#39;</span><span class="op" id="3608680">)</span><span class="op" id="3608681">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3608685">l</span><span class="op" id="3608686">.</span><span class="ident" id="3608687">backup</span><span class="op" id="3608693">(</span><span class="op" id="3608694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608698">return</span>&nbsp;<span class="ident" id="3608705">lexNumber</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608716">case</span>&nbsp;<span class="ident" id="3608721">isAlphaNumeric</span><span class="op" id="3608735">(</span><span class="ident" id="3608736">r</span><span class="op" id="3608737">)</span><span class="op" id="3608738">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3608742">l</span><span class="op" id="3608743">.</span><span class="ident" id="3608744">backup</span><span class="op" id="3608750">(</span><span class="op" id="3608751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608755">return</span>&nbsp;<span class="ident" id="3608762">lexIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608777">case</span>&nbsp;<span class="ident" id="3608782">r</span>&nbsp;<span class="op" id="3608784">==</span>&nbsp;<span class="string" id="3608787">&#39;(&#39;</span><span class="op" id="3608790">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3608794">l</span><span class="op" id="3608795">.</span><span class="ident" id="3608796">emit</span><span class="op" id="3608800">(</span><span class="ident" id="3608801">itemLeftParen</span><span class="op" id="3608814">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3608818">l</span><span class="op" id="3608819">.</span><span class="ident" id="3608820">parenDepth</span><span class="op" id="3608830">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608835">return</span>&nbsp;<span class="ident" id="3608842">lexInsideAction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608859">case</span>&nbsp;<span class="ident" id="3608864">r</span>&nbsp;<span class="op" id="3608866">==</span>&nbsp;<span class="string" id="3608869">&#39;)&#39;</span><span class="op" id="3608872">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3608876">l</span><span class="op" id="3608877">.</span><span class="ident" id="3608878">emit</span><span class="op" id="3608882">(</span><span class="ident" id="3608883">itemRightParen</span><span class="op" id="3608897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3608901">l</span><span class="op" id="3608902">.</span><span class="ident" id="3608903">parenDepth</span><span class="op" id="3608913">--</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608918">if</span>&nbsp;<span class="ident" id="3608921">l</span><span class="op" id="3608922">.</span><span class="ident" id="3608923">parenDepth</span>&nbsp;<span class="op" id="3608934">&lt;</span>&nbsp;<span class="num" id="3608936">0</span>&nbsp;<span class="op" id="3608938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608943">return</span>&nbsp;<span class="ident" id="3608950">l</span><span class="op" id="3608951">.</span><span class="ident" id="3608952">errorf</span><span class="op" id="3608958">(</span><span class="string" id="3608959">&#34;unexpected&nbsp;right&nbsp;paren&nbsp;%#U&#34;</span><span class="op" id="3608987">,</span>&nbsp;<span class="ident" id="3608989">r</span><span class="op" id="3608990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3608994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3608998">return</span>&nbsp;<span class="ident" id="3609005">lexInsideAction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3609022">case</span>&nbsp;<span class="ident" id="3609027">r</span>&nbsp;<span class="op" id="3609029">&lt;=</span>&nbsp;<span class="ident" id="3609032">unicode</span><span class="op" id="3609039">.</span><span class="ident" id="3609040">MaxASCII</span>&nbsp;<span class="op" id="3609049">&amp;&amp;</span>&nbsp;<span class="ident" id="3609052">unicode</span><span class="op" id="3609059">.</span><span class="ident" id="3609060">IsPrint</span><span class="op" id="3609067">(</span><span class="ident" id="3609068">r</span><span class="op" id="3609069">)</span><span class="op" id="3609070">:</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3609074">l</span><span class="op" id="3609075">.</span><span class="ident" id="3609076">emit</span><span class="op" id="3609080">(</span><span class="ident" id="3609081">itemChar</span><span class="op" id="3609089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3609093">return</span>&nbsp;<span class="ident" id="3609100">lexInsideAction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3609117">default</span><span class="op" id="3609124">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3609128">return</span>&nbsp;<span class="ident" id="3609135">l</span><span class="op" id="3609136">.</span><span class="ident" id="3609137">errorf</span><span class="op" id="3609143">(</span><span class="string" id="3609144">&#34;unrecognized&nbsp;character&nbsp;in&nbsp;action:&nbsp;%#U&#34;</span><span class="op" id="3609183">,</span>&nbsp;<span class="ident" id="3609185">r</span><span class="op" id="3609186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3609189">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3609192">return</span>&nbsp;<span class="ident" id="3609199">lexInsideAction</span><br>
<span class="lineno"></span><span class="op" id="3609215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3609218">//&nbsp;lexSpace&nbsp;scans&nbsp;a&nbsp;run&nbsp;of&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span><span class="comment" id="3609263">//&nbsp;One&nbsp;space&nbsp;has&nbsp;already&nbsp;been&nbsp;seen.</span><br>
<span class="lineno">335</span><span class="keyword" id="3609299">func</span>&nbsp;<span class="ident" id="3609304">lexSpace</span><span class="op" id="3609312">(</span><span class="ident" id="3609313">l</span>&nbsp;<span class="op" id="3609315">*</span><span class="ident" id="3609316">lexer</span><span class="op" id="3609321">)</span>&nbsp;<span class="ident" id="3609323">stateFn</span>&nbsp;<span class="op" id="3609331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3609334">for</span>&nbsp;<span class="ident" id="3609338">isSpace</span><span class="op" id="3609345">(</span><span class="ident" id="3609346">l</span><span class="op" id="3609347">.</span><span class="ident" id="3609348">peek</span><span class="op" id="3609352">(</span><span class="op" id="3609353">)</span><span class="op" id="3609354">)</span>&nbsp;<span class="op" id="3609356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3609360">l</span><span class="op" id="3609361">.</span><span class="ident" id="3609362">next</span><span class="op" id="3609366">(</span><span class="op" id="3609367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3609370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3609373">l</span><span class="op" id="3609374">.</span><span class="ident" id="3609375">emit</span><span class="op" id="3609379">(</span><span class="ident" id="3609380">itemSpace</span><span class="op" id="3609389">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3609392">return</span>&nbsp;<span class="ident" id="3609399">lexInsideAction</span><br>
<span class="lineno"></span><span class="op" id="3609415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3609418">//&nbsp;lexIdentifier&nbsp;scans&nbsp;an&nbsp;alphanumeric.</span><br>
<span class="lineno"></span><span class="keyword" id="3609458">func</span>&nbsp;<span class="ident" id="3609463">lexIdentifier</span><span class="op" id="3609476">(</span><span class="ident" id="3609477">l</span>&nbsp;<span class="op" id="3609479">*</span><span class="ident" id="3609480">lexer</span><span class="op" id="3609485">)</span>&nbsp;<span class="ident" id="3609487">stateFn</span>&nbsp;<span class="op" id="3609495">{</span><br>
<span class="lineno">345</span><span class="ident" id="3609497">Loop</span><span class="op" id="3609501">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3609504">for</span>&nbsp;<span class="op" id="3609508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3609512">switch</span>&nbsp;<span class="ident" id="3609519">r</span>&nbsp;<span class="op" id="3609521">:=</span>&nbsp;<span class="ident" id="3609524">l</span><span class="op" id="3609525">.</span><span class="ident" id="3609526">next</span><span class="op" id="3609530">(</span><span class="op" id="3609531">)</span><span class="op" id="3609532">;</span>&nbsp;<span class="op" id="3609534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3609538">case</span>&nbsp;<span class="ident" id="3609543">isAlphaNumeric</span><span class="op" id="3609557">(</span><span class="ident" id="3609558">r</span><span class="op" id="3609559">)</span><span class="op" id="3609560">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3609565">//&nbsp;absorb.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3609578">default</span><span class="op" id="3609585">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3609590">l</span><span class="op" id="3609591">.</span><span class="ident" id="3609592">backup</span><span class="op" id="3609598">(</span><span class="op" id="3609599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3609604">word</span>&nbsp;<span class="op" id="3609609">:=</span>&nbsp;<span class="ident" id="3609612">l</span><span class="op" id="3609613">.</span><span class="ident" id="3609614">input</span><span class="op" id="3609619">[</span><span class="ident" id="3609620">l</span><span class="op" id="3609621">.</span><span class="ident" id="3609622">start</span><span class="op" id="3609627">:</span><span class="ident" id="3609628">l</span><span class="op" id="3609629">.</span><span class="ident" id="3609630">pos</span><span class="op" id="3609633">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3609638">if</span>&nbsp;<span class="op" id="3609641">!</span><span class="ident" id="3609642">l</span><span class="op" id="3609643">.</span><span class="ident" id="3609644">atTerminator</span><span class="op" id="3609656">(</span><span class="op" id="3609657">)</span>&nbsp;<span class="op" id="3609659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3609665">return</span>&nbsp;<span class="ident" id="3609672">l</span><span class="op" id="3609673">.</span><span class="ident" id="3609674">errorf</span><span class="op" id="3609680">(</span><span class="string" id="3609681">&#34;bad&nbsp;character&nbsp;%#U&#34;</span><span class="op" id="3609700">,</span>&nbsp;<span class="ident" id="3609702">r</span><span class="op" id="3609703">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3609708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3609713">switch</span>&nbsp;<span class="op" id="3609720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3609725">case</span>&nbsp;<span class="ident" id="3609730">key</span><span class="op" id="3609733">[</span><span class="ident" id="3609734">word</span><span class="op" id="3609738">]</span>&nbsp;<span class="op" id="3609740">&gt;</span>&nbsp;<span class="ident" id="3609742">itemKeyword</span><span class="op" id="3609753">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3609759">l</span><span class="op" id="3609760">.</span><span class="ident" id="3609761">emit</span><span class="op" id="3609765">(</span><span class="ident" id="3609766">key</span><span class="op" id="3609769">[</span><span class="ident" id="3609770">word</span><span class="op" id="3609774">]</span><span class="op" id="3609775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3609780">case</span>&nbsp;<span class="ident" id="3609785">word</span><span class="op" id="3609789">[</span><span class="num" id="3609790">0</span><span class="op" id="3609791">]</span>&nbsp;<span class="op" id="3609793">==</span>&nbsp;<span class="string" id="3609796">&#39;.&#39;</span><span class="op" id="3609799">:</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3609805">l</span><span class="op" id="3609806">.</span><span class="ident" id="3609807">emit</span><span class="op" id="3609811">(</span><span class="ident" id="3609812">itemField</span><span class="op" id="3609821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3609826">case</span>&nbsp;<span class="ident" id="3609831">word</span>&nbsp;<span class="op" id="3609836">==</span>&nbsp;<span class="string" id="3609839">&#34;true&#34;</span><span class="op" id="3609845">,</span>&nbsp;<span class="ident" id="3609847">word</span>&nbsp;<span class="op" id="3609852">==</span>&nbsp;<span class="string" id="3609855">&#34;false&#34;</span><span class="op" id="3609862">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3609868">l</span><span class="op" id="3609869">.</span><span class="ident" id="3609870">emit</span><span class="op" id="3609874">(</span><span class="ident" id="3609875">itemBool</span><span class="op" id="3609883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3609888">default</span><span class="op" id="3609895">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3609901">l</span><span class="op" id="3609902">.</span><span class="ident" id="3609903">emit</span><span class="op" id="3609907">(</span><span class="ident" id="3609908">itemIdentifier</span><span class="op" id="3609922">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3609927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3609932">break</span>&nbsp;<span class="ident" id="3609938">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3609945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3609948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3609951">return</span>&nbsp;<span class="ident" id="3609958">lexInsideAction</span><br>
<span class="lineno">370</span><span class="op" id="3609974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3609977">//&nbsp;lexField&nbsp;scans&nbsp;a&nbsp;field:&nbsp;.Alphanumeric.</span><br>
<span class="lineno"></span><span class="comment" id="3610019">//&nbsp;The&nbsp;.&nbsp;has&nbsp;been&nbsp;scanned.</span><br>
<span class="lineno"></span><span class="keyword" id="3610046">func</span>&nbsp;<span class="ident" id="3610051">lexField</span><span class="op" id="3610059">(</span><span class="ident" id="3610060">l</span>&nbsp;<span class="op" id="3610062">*</span><span class="ident" id="3610063">lexer</span><span class="op" id="3610068">)</span>&nbsp;<span class="ident" id="3610070">stateFn</span>&nbsp;<span class="op" id="3610078">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3610081">return</span>&nbsp;<span class="ident" id="3610088">lexFieldOrVariable</span><span class="op" id="3610106">(</span><span class="ident" id="3610107">l</span><span class="op" id="3610108">,</span>&nbsp;<span class="ident" id="3610110">itemField</span><span class="op" id="3610119">)</span><br>
<span class="lineno"></span><span class="op" id="3610121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3610124">//&nbsp;lexVariable&nbsp;scans&nbsp;a&nbsp;Variable:&nbsp;$Alphanumeric.</span><br>
<span class="lineno"></span><span class="comment" id="3610172">//&nbsp;The&nbsp;$&nbsp;has&nbsp;been&nbsp;scanned.</span><br>
<span class="lineno">380</span><span class="keyword" id="3610199">func</span>&nbsp;<span class="ident" id="3610204">lexVariable</span><span class="op" id="3610215">(</span><span class="ident" id="3610216">l</span>&nbsp;<span class="op" id="3610218">*</span><span class="ident" id="3610219">lexer</span><span class="op" id="3610224">)</span>&nbsp;<span class="ident" id="3610226">stateFn</span>&nbsp;<span class="op" id="3610234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3610237">if</span>&nbsp;<span class="ident" id="3610240">l</span><span class="op" id="3610241">.</span><span class="ident" id="3610242">atTerminator</span><span class="op" id="3610254">(</span><span class="op" id="3610255">)</span>&nbsp;<span class="op" id="3610257">{</span>&nbsp;<span class="comment" id="3610259">//&nbsp;Nothing&nbsp;interesting&nbsp;follows&nbsp;-&gt;&nbsp;&#34;$&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610300">l</span><span class="op" id="3610301">.</span><span class="ident" id="3610302">emit</span><span class="op" id="3610306">(</span><span class="ident" id="3610307">itemVariable</span><span class="op" id="3610319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3610323">return</span>&nbsp;<span class="ident" id="3610330">lexInsideAction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3610347">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3610350">return</span>&nbsp;<span class="ident" id="3610357">lexFieldOrVariable</span><span class="op" id="3610375">(</span><span class="ident" id="3610376">l</span><span class="op" id="3610377">,</span>&nbsp;<span class="ident" id="3610379">itemVariable</span><span class="op" id="3610391">)</span><br>
<span class="lineno"></span><span class="op" id="3610393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3610396">//&nbsp;lexVariable&nbsp;scans&nbsp;a&nbsp;field&nbsp;or&nbsp;variable:&nbsp;[.$]Alphanumeric.</span><br>
<span class="lineno"></span><span class="comment" id="3610456">//&nbsp;The&nbsp;.&nbsp;or&nbsp;$&nbsp;has&nbsp;been&nbsp;scanned.</span><br>
<span class="lineno">390</span><span class="keyword" id="3610488">func</span>&nbsp;<span class="ident" id="3610493">lexFieldOrVariable</span><span class="op" id="3610511">(</span><span class="ident" id="3610512">l</span>&nbsp;<span class="op" id="3610514">*</span><span class="ident" id="3610515">lexer</span><span class="op" id="3610520">,</span>&nbsp;<span class="ident" id="3610522">typ</span>&nbsp;<span class="ident" id="3610526">itemType</span><span class="op" id="3610534">)</span>&nbsp;<span class="ident" id="3610536">stateFn</span>&nbsp;<span class="op" id="3610544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3610547">if</span>&nbsp;<span class="ident" id="3610550">l</span><span class="op" id="3610551">.</span><span class="ident" id="3610552">atTerminator</span><span class="op" id="3610564">(</span><span class="op" id="3610565">)</span>&nbsp;<span class="op" id="3610567">{</span>&nbsp;<span class="comment" id="3610569">//&nbsp;Nothing&nbsp;interesting&nbsp;follows&nbsp;-&gt;&nbsp;&#34;.&#34;&nbsp;or&nbsp;&#34;$&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3610617">if</span>&nbsp;<span class="ident" id="3610620">typ</span>&nbsp;<span class="op" id="3610624">==</span>&nbsp;<span class="ident" id="3610627">itemVariable</span>&nbsp;<span class="op" id="3610640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610645">l</span><span class="op" id="3610646">.</span><span class="ident" id="3610647">emit</span><span class="op" id="3610651">(</span><span class="ident" id="3610652">itemVariable</span><span class="op" id="3610664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3610668">}</span>&nbsp;<span class="keyword" id="3610670">else</span>&nbsp;<span class="op" id="3610675">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610680">l</span><span class="op" id="3610681">.</span><span class="ident" id="3610682">emit</span><span class="op" id="3610686">(</span><span class="ident" id="3610687">itemDot</span><span class="op" id="3610694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3610698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3610702">return</span>&nbsp;<span class="ident" id="3610709">lexInsideAction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3610726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3610729">var</span>&nbsp;<span class="ident" id="3610733">r</span>&nbsp;<span class="builtintype" id="3610735">rune</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3610741">for</span>&nbsp;<span class="op" id="3610745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610749">r</span>&nbsp;<span class="op" id="3610751">=</span>&nbsp;<span class="ident" id="3610753">l</span><span class="op" id="3610754">.</span><span class="ident" id="3610755">next</span><span class="op" id="3610759">(</span><span class="op" id="3610760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3610764">if</span>&nbsp;<span class="op" id="3610767">!</span><span class="ident" id="3610768">isAlphaNumeric</span><span class="op" id="3610782">(</span><span class="ident" id="3610783">r</span><span class="op" id="3610784">)</span>&nbsp;<span class="op" id="3610786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610791">l</span><span class="op" id="3610792">.</span><span class="ident" id="3610793">backup</span><span class="op" id="3610799">(</span><span class="op" id="3610800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3610805">break</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3610813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3610816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3610819">if</span>&nbsp;<span class="op" id="3610822">!</span><span class="ident" id="3610823">l</span><span class="op" id="3610824">.</span><span class="ident" id="3610825">atTerminator</span><span class="op" id="3610837">(</span><span class="op" id="3610838">)</span>&nbsp;<span class="op" id="3610840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3610844">return</span>&nbsp;<span class="ident" id="3610851">l</span><span class="op" id="3610852">.</span><span class="ident" id="3610853">errorf</span><span class="op" id="3610859">(</span><span class="string" id="3610860">&#34;bad&nbsp;character&nbsp;%#U&#34;</span><span class="op" id="3610879">,</span>&nbsp;<span class="ident" id="3610881">r</span><span class="op" id="3610882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3610885">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610888">l</span><span class="op" id="3610889">.</span><span class="ident" id="3610890">emit</span><span class="op" id="3610894">(</span><span class="ident" id="3610895">typ</span><span class="op" id="3610898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3610901">return</span>&nbsp;<span class="ident" id="3610908">lexInsideAction</span><br>
<span class="lineno"></span><span class="op" id="3610924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3610927">//&nbsp;atTerminator&nbsp;reports&nbsp;whether&nbsp;the&nbsp;input&nbsp;is&nbsp;at&nbsp;valid&nbsp;termination&nbsp;character&nbsp;to</span><br>
<span class="lineno">415</span><span class="comment" id="3611006">//&nbsp;appear&nbsp;after&nbsp;an&nbsp;identifier.&nbsp;Breaks&nbsp;.X.Y&nbsp;into&nbsp;two&nbsp;pieces.&nbsp;Also&nbsp;catches&nbsp;cases</span><br>
<span class="lineno"></span><span class="comment" id="3611085">//&nbsp;like&nbsp;&#34;$x+2&#34;&nbsp;not&nbsp;being&nbsp;acceptable&nbsp;without&nbsp;a&nbsp;space,&nbsp;in&nbsp;case&nbsp;we&nbsp;decide&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="3611160">//&nbsp;day&nbsp;to&nbsp;implement&nbsp;arithmetic.</span><br>
<span class="lineno"></span><span class="keyword" id="3611192">func</span>&nbsp;<span class="op" id="3611197">(</span><span class="ident" id="3611198">l</span>&nbsp;<span class="op" id="3611200">*</span><span class="ident" id="3611201">lexer</span><span class="op" id="3611206">)</span>&nbsp;<span class="ident" id="3611208">atTerminator</span><span class="op" id="3611220">(</span><span class="op" id="3611221">)</span>&nbsp;<span class="builtintype" id="3611223">bool</span>&nbsp;<span class="op" id="3611228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3611231">r</span>&nbsp;<span class="op" id="3611233">:=</span>&nbsp;<span class="ident" id="3611236">l</span><span class="op" id="3611237">.</span><span class="ident" id="3611238">peek</span><span class="op" id="3611242">(</span><span class="op" id="3611243">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3611246">if</span>&nbsp;<span class="ident" id="3611249">isSpace</span><span class="op" id="3611256">(</span><span class="ident" id="3611257">r</span><span class="op" id="3611258">)</span>&nbsp;<span class="op" id="3611260">||</span>&nbsp;<span class="ident" id="3611263">isEndOfLine</span><span class="op" id="3611274">(</span><span class="ident" id="3611275">r</span><span class="op" id="3611276">)</span>&nbsp;<span class="op" id="3611278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3611282">return</span>&nbsp;<span class="builtintype" id="3611289">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3611295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3611298">switch</span>&nbsp;<span class="ident" id="3611305">r</span>&nbsp;<span class="op" id="3611307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3611310">case</span>&nbsp;<span class="ident" id="3611315">eof</span><span class="op" id="3611318">,</span>&nbsp;<span class="string" id="3611320">&#39;.&#39;</span><span class="op" id="3611323">,</span>&nbsp;<span class="string" id="3611325">&#39;,&#39;</span><span class="op" id="3611328">,</span>&nbsp;<span class="string" id="3611330">&#39;|&#39;</span><span class="op" id="3611333">,</span>&nbsp;<span class="string" id="3611335">&#39;:&#39;</span><span class="op" id="3611338">,</span>&nbsp;<span class="string" id="3611340">&#39;)&#39;</span><span class="op" id="3611343">,</span>&nbsp;<span class="string" id="3611345">&#39;(&#39;</span><span class="op" id="3611348">:</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3611352">return</span>&nbsp;<span class="builtintype" id="3611359">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3611365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3611368">//&nbsp;Does&nbsp;r&nbsp;start&nbsp;the&nbsp;delimiter?&nbsp;This&nbsp;can&nbsp;be&nbsp;ambiguous&nbsp;(with&nbsp;delim==&#34;//&#34;,&nbsp;$x/2&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3611451">//&nbsp;succeed&nbsp;but&nbsp;should&nbsp;fail)&nbsp;but&nbsp;only&nbsp;in&nbsp;extremely&nbsp;rare&nbsp;cases&nbsp;caused&nbsp;by&nbsp;willfully</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3611533">//&nbsp;bad&nbsp;choice&nbsp;of&nbsp;delimiter.</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3611562">if</span>&nbsp;<span class="ident" id="3611565">rd</span><span class="op" id="3611567">,</span>&nbsp;<span class="ident" id="3611569">_</span>&nbsp;<span class="op" id="3611571">:=</span>&nbsp;<span class="ident" id="3611574">utf8</span><span class="op" id="3611578">.</span><span class="ident" id="3611579">DecodeRuneInString</span><span class="op" id="3611597">(</span><span class="ident" id="3611598">l</span><span class="op" id="3611599">.</span><span class="ident" id="3611600">rightDelim</span><span class="op" id="3611610">)</span><span class="op" id="3611611">;</span>&nbsp;<span class="ident" id="3611613">rd</span>&nbsp;<span class="op" id="3611616">==</span>&nbsp;<span class="ident" id="3611619">r</span>&nbsp;<span class="op" id="3611621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3611625">return</span>&nbsp;<span class="builtintype" id="3611632">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3611638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3611641">return</span>&nbsp;<span class="builtintype" id="3611648">false</span><br>
<span class="lineno"></span><span class="op" id="3611654">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="comment" id="3611657">//&nbsp;lexChar&nbsp;scans&nbsp;a&nbsp;character&nbsp;constant.&nbsp;The&nbsp;initial&nbsp;quote&nbsp;is&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="3611725">//&nbsp;scanned.&nbsp;Syntax&nbsp;checking&nbsp;is&nbsp;done&nbsp;by&nbsp;the&nbsp;parser.</span><br>
<span class="lineno"></span><span class="keyword" id="3611776">func</span>&nbsp;<span class="ident" id="3611781">lexChar</span><span class="op" id="3611788">(</span><span class="ident" id="3611789">l</span>&nbsp;<span class="op" id="3611791">*</span><span class="ident" id="3611792">lexer</span><span class="op" id="3611797">)</span>&nbsp;<span class="ident" id="3611799">stateFn</span>&nbsp;<span class="op" id="3611807">{</span><br>
<span class="lineno"></span><span class="ident" id="3611809">Loop</span><span class="op" id="3611813">:</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3611816">for</span>&nbsp;<span class="op" id="3611820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3611824">switch</span>&nbsp;<span class="ident" id="3611831">l</span><span class="op" id="3611832">.</span><span class="ident" id="3611833">next</span><span class="op" id="3611837">(</span><span class="op" id="3611838">)</span>&nbsp;<span class="op" id="3611840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3611844">case</span>&nbsp;<span class="string" id="3611849">&#39;\\&#39;</span><span class="op" id="3611853">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3611858">if</span>&nbsp;<span class="ident" id="3611861">r</span>&nbsp;<span class="op" id="3611863">:=</span>&nbsp;<span class="ident" id="3611866">l</span><span class="op" id="3611867">.</span><span class="ident" id="3611868">next</span><span class="op" id="3611872">(</span><span class="op" id="3611873">)</span><span class="op" id="3611874">;</span>&nbsp;<span class="ident" id="3611876">r</span>&nbsp;<span class="op" id="3611878">!=</span>&nbsp;<span class="ident" id="3611881">eof</span>&nbsp;<span class="op" id="3611885">&amp;&amp;</span>&nbsp;<span class="ident" id="3611888">r</span>&nbsp;<span class="op" id="3611890">!=</span>&nbsp;<span class="string" id="3611893">&#39;\n&#39;</span>&nbsp;<span class="op" id="3611898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3611904">break</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3611913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3611918">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3611932">case</span>&nbsp;<span class="ident" id="3611937">eof</span><span class="op" id="3611940">,</span>&nbsp;<span class="string" id="3611942">&#39;\n&#39;</span><span class="op" id="3611946">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3611951">return</span>&nbsp;<span class="ident" id="3611958">l</span><span class="op" id="3611959">.</span><span class="ident" id="3611960">errorf</span><span class="op" id="3611966">(</span><span class="string" id="3611967">&#34;unterminated&nbsp;character&nbsp;constant&#34;</span><span class="op" id="3612000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3612004">case</span>&nbsp;<span class="string" id="3612009">&#39;\&#39;&#39;</span><span class="op" id="3612013">:</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3612018">break</span>&nbsp;<span class="ident" id="3612024">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3612031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3612034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612037">l</span><span class="op" id="3612038">.</span><span class="ident" id="3612039">emit</span><span class="op" id="3612043">(</span><span class="ident" id="3612044">itemCharConstant</span><span class="op" id="3612060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3612063">return</span>&nbsp;<span class="ident" id="3612070">lexInsideAction</span><br>
<span class="lineno">455</span><span class="op" id="3612086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3612089">//&nbsp;lexNumber&nbsp;scans&nbsp;a&nbsp;number:&nbsp;decimal,&nbsp;octal,&nbsp;hex,&nbsp;float,&nbsp;or&nbsp;imaginary.&nbsp;This</span><br>
<span class="lineno"></span><span class="comment" id="3612165">//&nbsp;isn&#39;t&nbsp;a&nbsp;perfect&nbsp;number&nbsp;scanner&nbsp;-&nbsp;for&nbsp;instance&nbsp;it&nbsp;accepts&nbsp;&#34;.&#34;&nbsp;and&nbsp;&#34;0x0.2&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3612241">//&nbsp;and&nbsp;&#34;089&#34;&nbsp;-&nbsp;but&nbsp;when&nbsp;it&#39;s&nbsp;wrong&nbsp;the&nbsp;input&nbsp;is&nbsp;invalid&nbsp;and&nbsp;the&nbsp;parser&nbsp;(via</span><br>
<span class="lineno">460</span><span class="comment" id="3612317">//&nbsp;strconv)&nbsp;will&nbsp;notice.</span><br>
<span class="lineno"></span><span class="keyword" id="3612342">func</span>&nbsp;<span class="ident" id="3612347">lexNumber</span><span class="op" id="3612356">(</span><span class="ident" id="3612357">l</span>&nbsp;<span class="op" id="3612359">*</span><span class="ident" id="3612360">lexer</span><span class="op" id="3612365">)</span>&nbsp;<span class="ident" id="3612367">stateFn</span>&nbsp;<span class="op" id="3612375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3612378">if</span>&nbsp;<span class="op" id="3612381">!</span><span class="ident" id="3612382">l</span><span class="op" id="3612383">.</span><span class="ident" id="3612384">scanNumber</span><span class="op" id="3612394">(</span><span class="op" id="3612395">)</span>&nbsp;<span class="op" id="3612397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3612401">return</span>&nbsp;<span class="ident" id="3612408">l</span><span class="op" id="3612409">.</span><span class="ident" id="3612410">errorf</span><span class="op" id="3612416">(</span><span class="string" id="3612417">&#34;bad&nbsp;number&nbsp;syntax:&nbsp;%q&#34;</span><span class="op" id="3612440">,</span>&nbsp;<span class="ident" id="3612442">l</span><span class="op" id="3612443">.</span><span class="ident" id="3612444">input</span><span class="op" id="3612449">[</span><span class="ident" id="3612450">l</span><span class="op" id="3612451">.</span><span class="ident" id="3612452">start</span><span class="op" id="3612457">:</span><span class="ident" id="3612458">l</span><span class="op" id="3612459">.</span><span class="ident" id="3612460">pos</span><span class="op" id="3612463">]</span><span class="op" id="3612464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3612467">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3612470">if</span>&nbsp;<span class="ident" id="3612473">sign</span>&nbsp;<span class="op" id="3612478">:=</span>&nbsp;<span class="ident" id="3612481">l</span><span class="op" id="3612482">.</span><span class="ident" id="3612483">peek</span><span class="op" id="3612487">(</span><span class="op" id="3612488">)</span><span class="op" id="3612489">;</span>&nbsp;<span class="ident" id="3612491">sign</span>&nbsp;<span class="op" id="3612496">==</span>&nbsp;<span class="string" id="3612499">&#39;+&#39;</span>&nbsp;<span class="op" id="3612503">||</span>&nbsp;<span class="ident" id="3612506">sign</span>&nbsp;<span class="op" id="3612511">==</span>&nbsp;<span class="string" id="3612514">&#39;-&#39;</span>&nbsp;<span class="op" id="3612518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3612522">//&nbsp;Complex:&nbsp;1+2i.&nbsp;No&nbsp;spaces,&nbsp;must&nbsp;end&nbsp;in&nbsp;&#39;i&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3612570">if</span>&nbsp;<span class="op" id="3612573">!</span><span class="ident" id="3612574">l</span><span class="op" id="3612575">.</span><span class="ident" id="3612576">scanNumber</span><span class="op" id="3612586">(</span><span class="op" id="3612587">)</span>&nbsp;<span class="op" id="3612589">||</span>&nbsp;<span class="ident" id="3612592">l</span><span class="op" id="3612593">.</span><span class="ident" id="3612594">input</span><span class="op" id="3612599">[</span><span class="ident" id="3612600">l</span><span class="op" id="3612601">.</span><span class="ident" id="3612602">pos</span><span class="op" id="3612605">-</span><span class="num" id="3612606">1</span><span class="op" id="3612607">]</span>&nbsp;<span class="op" id="3612609">!=</span>&nbsp;<span class="string" id="3612612">&#39;i&#39;</span>&nbsp;<span class="op" id="3612616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3612621">return</span>&nbsp;<span class="ident" id="3612628">l</span><span class="op" id="3612629">.</span><span class="ident" id="3612630">errorf</span><span class="op" id="3612636">(</span><span class="string" id="3612637">&#34;bad&nbsp;number&nbsp;syntax:&nbsp;%q&#34;</span><span class="op" id="3612660">,</span>&nbsp;<span class="ident" id="3612662">l</span><span class="op" id="3612663">.</span><span class="ident" id="3612664">input</span><span class="op" id="3612669">[</span><span class="ident" id="3612670">l</span><span class="op" id="3612671">.</span><span class="ident" id="3612672">start</span><span class="op" id="3612677">:</span><span class="ident" id="3612678">l</span><span class="op" id="3612679">.</span><span class="ident" id="3612680">pos</span><span class="op" id="3612683">]</span><span class="op" id="3612684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3612688">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612692">l</span><span class="op" id="3612693">.</span><span class="ident" id="3612694">emit</span><span class="op" id="3612698">(</span><span class="ident" id="3612699">itemComplex</span><span class="op" id="3612710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3612713">}</span>&nbsp;<span class="keyword" id="3612715">else</span>&nbsp;<span class="op" id="3612720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612724">l</span><span class="op" id="3612725">.</span><span class="ident" id="3612726">emit</span><span class="op" id="3612730">(</span><span class="ident" id="3612731">itemNumber</span><span class="op" id="3612741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3612744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3612747">return</span>&nbsp;<span class="ident" id="3612754">lexInsideAction</span><br>
<span class="lineno">475</span><span class="op" id="3612770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3612773">func</span>&nbsp;<span class="op" id="3612778">(</span><span class="ident" id="3612779">l</span>&nbsp;<span class="op" id="3612781">*</span><span class="ident" id="3612782">lexer</span><span class="op" id="3612787">)</span>&nbsp;<span class="ident" id="3612789">scanNumber</span><span class="op" id="3612799">(</span><span class="op" id="3612800">)</span>&nbsp;<span class="builtintype" id="3612802">bool</span>&nbsp;<span class="op" id="3612807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3612810">//&nbsp;Optional&nbsp;leading&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612837">l</span><span class="op" id="3612838">.</span><span class="ident" id="3612839">accept</span><span class="op" id="3612845">(</span><span class="string" id="3612846">&#34;+-&#34;</span><span class="op" id="3612850">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3612853">//&nbsp;Is&nbsp;it&nbsp;hex?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612868">digits</span>&nbsp;<span class="op" id="3612875">:=</span>&nbsp;<span class="string" id="3612878">&#34;0123456789&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3612892">if</span>&nbsp;<span class="ident" id="3612895">l</span><span class="op" id="3612896">.</span><span class="ident" id="3612897">accept</span><span class="op" id="3612903">(</span><span class="string" id="3612904">&#34;0&#34;</span><span class="op" id="3612907">)</span>&nbsp;<span class="op" id="3612909">&amp;&amp;</span>&nbsp;<span class="ident" id="3612912">l</span><span class="op" id="3612913">.</span><span class="ident" id="3612914">accept</span><span class="op" id="3612920">(</span><span class="string" id="3612921">&#34;xX&#34;</span><span class="op" id="3612925">)</span>&nbsp;<span class="op" id="3612927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612931">digits</span>&nbsp;<span class="op" id="3612938">=</span>&nbsp;<span class="string" id="3612940">&#34;0123456789abcdefABCDEF&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3612966">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612969">l</span><span class="op" id="3612970">.</span><span class="ident" id="3612971">acceptRun</span><span class="op" id="3612980">(</span><span class="ident" id="3612981">digits</span><span class="op" id="3612987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3612990">if</span>&nbsp;<span class="ident" id="3612993">l</span><span class="op" id="3612994">.</span><span class="ident" id="3612995">accept</span><span class="op" id="3613001">(</span><span class="string" id="3613002">&#34;.&#34;</span><span class="op" id="3613005">)</span>&nbsp;<span class="op" id="3613007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3613011">l</span><span class="op" id="3613012">.</span><span class="ident" id="3613013">acceptRun</span><span class="op" id="3613022">(</span><span class="ident" id="3613023">digits</span><span class="op" id="3613029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3613032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613035">if</span>&nbsp;<span class="ident" id="3613038">l</span><span class="op" id="3613039">.</span><span class="ident" id="3613040">accept</span><span class="op" id="3613046">(</span><span class="string" id="3613047">&#34;eE&#34;</span><span class="op" id="3613051">)</span>&nbsp;<span class="op" id="3613053">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3613057">l</span><span class="op" id="3613058">.</span><span class="ident" id="3613059">accept</span><span class="op" id="3613065">(</span><span class="string" id="3613066">&#34;+-&#34;</span><span class="op" id="3613070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3613074">l</span><span class="op" id="3613075">.</span><span class="ident" id="3613076">acceptRun</span><span class="op" id="3613085">(</span><span class="string" id="3613086">&#34;0123456789&#34;</span><span class="op" id="3613098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3613101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3613104">//&nbsp;Is&nbsp;it&nbsp;imaginary?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3613125">l</span><span class="op" id="3613126">.</span><span class="ident" id="3613127">accept</span><span class="op" id="3613133">(</span><span class="string" id="3613134">&#34;i&#34;</span><span class="op" id="3613137">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3613140">//&nbsp;Next&nbsp;thing&nbsp;mustn&#39;t&nbsp;be&nbsp;alphanumeric.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613180">if</span>&nbsp;<span class="ident" id="3613183">isAlphaNumeric</span><span class="op" id="3613197">(</span><span class="ident" id="3613198">l</span><span class="op" id="3613199">.</span><span class="ident" id="3613200">peek</span><span class="op" id="3613204">(</span><span class="op" id="3613205">)</span><span class="op" id="3613206">)</span>&nbsp;<span class="op" id="3613208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3613212">l</span><span class="op" id="3613213">.</span><span class="ident" id="3613214">next</span><span class="op" id="3613218">(</span><span class="op" id="3613219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613223">return</span>&nbsp;<span class="builtintype" id="3613230">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3613237">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613240">return</span>&nbsp;<span class="builtintype" id="3613247">true</span><br>
<span class="lineno"></span><span class="op" id="3613252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3613255">//&nbsp;lexQuote&nbsp;scans&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3613290">func</span>&nbsp;<span class="ident" id="3613295">lexQuote</span><span class="op" id="3613303">(</span><span class="ident" id="3613304">l</span>&nbsp;<span class="op" id="3613306">*</span><span class="ident" id="3613307">lexer</span><span class="op" id="3613312">)</span>&nbsp;<span class="ident" id="3613314">stateFn</span>&nbsp;<span class="op" id="3613322">{</span><br>
<span class="lineno">505</span><span class="ident" id="3613324">Loop</span><span class="op" id="3613328">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613331">for</span>&nbsp;<span class="op" id="3613335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613339">switch</span>&nbsp;<span class="ident" id="3613346">l</span><span class="op" id="3613347">.</span><span class="ident" id="3613348">next</span><span class="op" id="3613352">(</span><span class="op" id="3613353">)</span>&nbsp;<span class="op" id="3613355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613359">case</span>&nbsp;<span class="string" id="3613364">&#39;\\&#39;</span><span class="op" id="3613368">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613373">if</span>&nbsp;<span class="ident" id="3613376">r</span>&nbsp;<span class="op" id="3613378">:=</span>&nbsp;<span class="ident" id="3613381">l</span><span class="op" id="3613382">.</span><span class="ident" id="3613383">next</span><span class="op" id="3613387">(</span><span class="op" id="3613388">)</span><span class="op" id="3613389">;</span>&nbsp;<span class="ident" id="3613391">r</span>&nbsp;<span class="op" id="3613393">!=</span>&nbsp;<span class="ident" id="3613396">eof</span>&nbsp;<span class="op" id="3613400">&amp;&amp;</span>&nbsp;<span class="ident" id="3613403">r</span>&nbsp;<span class="op" id="3613405">!=</span>&nbsp;<span class="string" id="3613408">&#39;\n&#39;</span>&nbsp;<span class="op" id="3613413">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613419">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3613428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613433">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613447">case</span>&nbsp;<span class="ident" id="3613452">eof</span><span class="op" id="3613455">,</span>&nbsp;<span class="string" id="3613457">&#39;\n&#39;</span><span class="op" id="3613461">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613466">return</span>&nbsp;<span class="ident" id="3613473">l</span><span class="op" id="3613474">.</span><span class="ident" id="3613475">errorf</span><span class="op" id="3613481">(</span><span class="string" id="3613482">&#34;unterminated&nbsp;quoted&nbsp;string&#34;</span><span class="op" id="3613510">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613514">case</span>&nbsp;<span class="string" id="3613519">&#39;&#34;&#39;</span><span class="op" id="3613522">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613527">break</span>&nbsp;<span class="ident" id="3613533">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3613540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3613543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3613546">l</span><span class="op" id="3613547">.</span><span class="ident" id="3613548">emit</span><span class="op" id="3613552">(</span><span class="ident" id="3613553">itemString</span><span class="op" id="3613563">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613566">return</span>&nbsp;<span class="ident" id="3613573">lexInsideAction</span><br>
<span class="lineno"></span><span class="op" id="3613589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3613592">//&nbsp;lexRawQuote&nbsp;scans&nbsp;a&nbsp;raw&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3613634">func</span>&nbsp;<span class="ident" id="3613639">lexRawQuote</span><span class="op" id="3613650">(</span><span class="ident" id="3613651">l</span>&nbsp;<span class="op" id="3613653">*</span><span class="ident" id="3613654">lexer</span><span class="op" id="3613659">)</span>&nbsp;<span class="ident" id="3613661">stateFn</span>&nbsp;<span class="op" id="3613669">{</span><br>
<span class="lineno">525</span><span class="ident" id="3613671">Loop</span><span class="op" id="3613675">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613678">for</span>&nbsp;<span class="op" id="3613682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613686">switch</span>&nbsp;<span class="ident" id="3613693">l</span><span class="op" id="3613694">.</span><span class="ident" id="3613695">next</span><span class="op" id="3613699">(</span><span class="op" id="3613700">)</span>&nbsp;<span class="op" id="3613702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613706">case</span>&nbsp;<span class="ident" id="3613711">eof</span><span class="op" id="3613714">,</span>&nbsp;<span class="string" id="3613716">&#39;\n&#39;</span><span class="op" id="3613720">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613725">return</span>&nbsp;<span class="ident" id="3613732">l</span><span class="op" id="3613733">.</span><span class="ident" id="3613734">errorf</span><span class="op" id="3613740">(</span><span class="string" id="3613741">&#34;unterminated&nbsp;raw&nbsp;quoted&nbsp;string&#34;</span><span class="op" id="3613773">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613777">case</span>&nbsp;<span class="string" id="3613782">&#39;`&#39;</span><span class="op" id="3613785">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613790">break</span>&nbsp;<span class="ident" id="3613796">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3613803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3613806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3613809">l</span><span class="op" id="3613810">.</span><span class="ident" id="3613811">emit</span><span class="op" id="3613815">(</span><span class="ident" id="3613816">itemRawString</span><span class="op" id="3613829">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613832">return</span>&nbsp;<span class="ident" id="3613839">lexInsideAction</span><br>
<span class="lineno"></span><span class="op" id="3613855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3613858">//&nbsp;isSpace&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;a&nbsp;space&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="3613909">func</span>&nbsp;<span class="ident" id="3613914">isSpace</span><span class="op" id="3613921">(</span><span class="ident" id="3613922">r</span>&nbsp;<span class="builtintype" id="3613924">rune</span><span class="op" id="3613928">)</span>&nbsp;<span class="builtintype" id="3613930">bool</span>&nbsp;<span class="op" id="3613935">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613938">return</span>&nbsp;<span class="ident" id="3613945">r</span>&nbsp;<span class="op" id="3613947">==</span>&nbsp;<span class="string" id="3613950">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3613954">||</span>&nbsp;<span class="ident" id="3613957">r</span>&nbsp;<span class="op" id="3613959">==</span>&nbsp;<span class="string" id="3613962">&#39;\t&#39;</span><br>
<span class="lineno"></span><span class="op" id="3613967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3613970">//&nbsp;isEndOfLine&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;an&nbsp;end-of-line&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="3614032">func</span>&nbsp;<span class="ident" id="3614037">isEndOfLine</span><span class="op" id="3614048">(</span><span class="ident" id="3614049">r</span>&nbsp;<span class="builtintype" id="3614051">rune</span><span class="op" id="3614055">)</span>&nbsp;<span class="builtintype" id="3614057">bool</span>&nbsp;<span class="op" id="3614062">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3614065">return</span>&nbsp;<span class="ident" id="3614072">r</span>&nbsp;<span class="op" id="3614074">==</span>&nbsp;<span class="string" id="3614077">&#39;\r&#39;</span>&nbsp;<span class="op" id="3614082">||</span>&nbsp;<span class="ident" id="3614085">r</span>&nbsp;<span class="op" id="3614087">==</span>&nbsp;<span class="string" id="3614090">&#39;\n&#39;</span><br>
<span class="lineno"></span><span class="op" id="3614095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3614098">//&nbsp;isAlphaNumeric&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;an&nbsp;alphabetic,&nbsp;digit,&nbsp;or&nbsp;underscore.</span><br>
<span class="lineno"></span><span class="keyword" id="3614174">func</span>&nbsp;<span class="ident" id="3614179">isAlphaNumeric</span><span class="op" id="3614193">(</span><span class="ident" id="3614194">r</span>&nbsp;<span class="builtintype" id="3614196">rune</span><span class="op" id="3614200">)</span>&nbsp;<span class="builtintype" id="3614202">bool</span>&nbsp;<span class="op" id="3614207">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3614210">return</span>&nbsp;<span class="ident" id="3614217">r</span>&nbsp;<span class="op" id="3614219">==</span>&nbsp;<span class="string" id="3614222">&#39;_&#39;</span>&nbsp;<span class="op" id="3614226">||</span>&nbsp;<span class="ident" id="3614229">unicode</span><span class="op" id="3614236">.</span><span class="ident" id="3614237">IsLetter</span><span class="op" id="3614245">(</span><span class="ident" id="3614246">r</span><span class="op" id="3614247">)</span>&nbsp;<span class="op" id="3614249">||</span>&nbsp;<span class="ident" id="3614252">unicode</span><span class="op" id="3614259">.</span><span class="ident" id="3614260">IsDigit</span><span class="op" id="3614267">(</span><span class="ident" id="3614268">r</span><span class="op" id="3614269">)</span><br>
<span class="lineno"></span><span class="op" id="3614271">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
