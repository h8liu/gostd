<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rsa</h2>
<ul>
<li><a href="/gostd/crypto/rsa/pkcs1v15.go.html">pkcs1v15.go</a></li>
<li><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html">pkcs1v15_test.go</a></li>
<li><a href="/gostd/crypto/rsa/pss.go.html">pss.go</a></li>
<li><a href="/gostd/crypto/rsa/pss_test.go.html">pss_test.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa.go.html" class="current">rsa.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa_test.go.html">rsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4742497">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4742552">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4742606">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4742657">//&nbsp;Package&nbsp;rsa&nbsp;implements&nbsp;RSA&nbsp;encryption&nbsp;as&nbsp;specified&nbsp;in&nbsp;PKCS#1.</span><br>
<span class="lineno"></span><span class="keyword" id="4742722">package</span>&nbsp;<span class="ident" id="4742730">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4742735">import</span>&nbsp;<span class="op" id="4742742">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4742745">&#34;crypto&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4742755">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4742770">&#34;crypto/subtle&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4742787">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4742797">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4742805">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4742811">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4742822">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4742825">var</span>&nbsp;<span class="ident" id="4742829">bigZero</span>&nbsp;<span class="op" id="4742837">=</span>&nbsp;<span class="ident" id="4742839"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4742842">.</span><span class="ident" id="4742843"><a href="/gostd/math/big/int.go.html#2036655">NewInt</a></span><span class="op" id="4742849">(</span><span class="num" id="4742850">0</span><span class="op" id="4742851">)</span><br>
<span class="lineno"></span><span class="keyword" id="4742853">var</span>&nbsp;<span class="ident" id="4742857">bigOne</span>&nbsp;<span class="op" id="4742864">=</span>&nbsp;<span class="ident" id="4742866"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4742869">.</span><span class="ident" id="4742870"><a href="/gostd/math/big/int.go.html#2036655">NewInt</a></span><span class="op" id="4742876">(</span><span class="num" id="4742877">1</span><span class="op" id="4742878">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="4742881">//&nbsp;A&nbsp;PublicKey&nbsp;represents&nbsp;the&nbsp;public&nbsp;part&nbsp;of&nbsp;an&nbsp;RSA&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4742938">type</span>&nbsp;<span class="ident" id="4742943">PublicKey</span>&nbsp;<span class="keyword" id="4742953">struct</span>&nbsp;<span class="op" id="4742960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742963">N</span>&nbsp;<span class="op" id="4742965">*</span><span class="ident" id="4742966"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4742969">.</span><span class="ident" id="4742970"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span>&nbsp;<span class="comment" id="4742974">//&nbsp;modulus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4742986">E</span>&nbsp;<span class="builtintype" id="4742988">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4742997">//&nbsp;public&nbsp;exponent</span><br>
<span class="lineno">25</span><span class="op" id="4743016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4743019">var</span>&nbsp;<span class="op" id="4743023">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743026">errPublicModulus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4743049">=</span>&nbsp;<span class="ident" id="4743051"><a href="/gostd/crypto/rsa/rsa.go.html#4742787">errors</a></span><span class="op" id="4743057">.</span><span class="ident" id="4743058"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4743061">(</span><span class="string" id="4743062">&#34;crypto/rsa:&nbsp;missing&nbsp;public&nbsp;modulus&#34;</span><span class="op" id="4743098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743101">errPublicExponentSmall</span>&nbsp;<span class="op" id="4743124">=</span>&nbsp;<span class="ident" id="4743126"><a href="/gostd/crypto/rsa/rsa.go.html#4742787">errors</a></span><span class="op" id="4743132">.</span><span class="ident" id="4743133"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4743136">(</span><span class="string" id="4743137">&#34;crypto/rsa:&nbsp;public&nbsp;exponent&nbsp;too&nbsp;small&#34;</span><span class="op" id="4743176">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743179">errPublicExponentLarge</span>&nbsp;<span class="op" id="4743202">=</span>&nbsp;<span class="ident" id="4743204"><a href="/gostd/crypto/rsa/rsa.go.html#4742787">errors</a></span><span class="op" id="4743210">.</span><span class="ident" id="4743211"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4743214">(</span><span class="string" id="4743215">&#34;crypto/rsa:&nbsp;public&nbsp;exponent&nbsp;too&nbsp;large&#34;</span><span class="op" id="4743254">)</span><br>
<span class="lineno"></span><span class="op" id="4743256">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4743259">//&nbsp;checkPub&nbsp;sanity&nbsp;checks&nbsp;the&nbsp;public&nbsp;key&nbsp;before&nbsp;we&nbsp;use&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="4743318">//&nbsp;We&nbsp;require&nbsp;pub.E&nbsp;to&nbsp;fit&nbsp;into&nbsp;a&nbsp;32-bit&nbsp;integer&nbsp;so&nbsp;that&nbsp;we</span><br>
<span class="lineno">35</span><span class="comment" id="4743378">//&nbsp;do&nbsp;not&nbsp;have&nbsp;different&nbsp;behavior&nbsp;depending&nbsp;on&nbsp;whether</span><br>
<span class="lineno"></span><span class="comment" id="4743433">//&nbsp;int&nbsp;is&nbsp;32&nbsp;or&nbsp;64&nbsp;bits.&nbsp;See&nbsp;also</span><br>
<span class="lineno"></span><span class="comment" id="4743467">//&nbsp;http://www.imperialviolet.org/2012/03/16/rsae.html.</span><br>
<span class="lineno"></span><span class="keyword" id="4743522">func</span>&nbsp;<span class="ident" id="4743527">checkPub</span><span class="op" id="4743535">(</span><span class="ident" id="4743536">pub</span>&nbsp;<span class="op" id="4743540">*</span><span class="ident" id="4743541"><a href="/gostd/crypto/rsa/rsa.go.html#4742943">PublicKey</a></span><span class="op" id="4743550">)</span>&nbsp;<span class="builtintype" id="4743552">error</span>&nbsp;<span class="op" id="4743558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4743561">if</span>&nbsp;<span class="ident" id="4743564"><a href="/gostd/crypto/rsa/rsa.go.html#4743536">pub</a></span><span class="op" id="4743567">.</span><span class="ident" id="4743568"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span>&nbsp;<span class="op" id="4743570">==</span>&nbsp;<span class="builtintype" id="4743573">nil</span>&nbsp;<span class="op" id="4743577">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4743581">return</span>&nbsp;<span class="ident" id="4743588"><a href="/gostd/crypto/rsa/rsa.go.html#4743026">errPublicModulus</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4743606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4743609">if</span>&nbsp;<span class="ident" id="4743612"><a href="/gostd/crypto/rsa/rsa.go.html#4743536">pub</a></span><span class="op" id="4743615">.</span><span class="ident" id="4743616"><a href="/gostd/crypto/rsa/rsa.go.html#4742986">E</a></span>&nbsp;<span class="op" id="4743618">&lt;</span>&nbsp;<span class="num" id="4743620">2</span>&nbsp;<span class="op" id="4743622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4743626">return</span>&nbsp;<span class="ident" id="4743633"><a href="/gostd/crypto/rsa/rsa.go.html#4743101">errPublicExponentSmall</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4743657">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4743660">if</span>&nbsp;<span class="ident" id="4743663"><a href="/gostd/crypto/rsa/rsa.go.html#4743536">pub</a></span><span class="op" id="4743666">.</span><span class="ident" id="4743667"><a href="/gostd/crypto/rsa/rsa.go.html#4742986">E</a></span>&nbsp;<span class="op" id="4743669">&gt;</span>&nbsp;<span class="num" id="4743671">1</span><span class="op" id="4743672">&lt;&lt;</span><span class="num" id="4743674">31</span><span class="op" id="4743676">-</span><span class="num" id="4743677">1</span>&nbsp;<span class="op" id="4743679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4743683">return</span>&nbsp;<span class="ident" id="4743690"><a href="/gostd/crypto/rsa/rsa.go.html#4743179">errPublicExponentLarge</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4743714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4743717">return</span>&nbsp;<span class="builtintype" id="4743724">nil</span><br>
<span class="lineno"></span><span class="op" id="4743728">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="4743731">//&nbsp;A&nbsp;PrivateKey&nbsp;represents&nbsp;an&nbsp;RSA&nbsp;key</span><br>
<span class="lineno"></span><span class="keyword" id="4743769">type</span>&nbsp;<span class="ident" id="4743774">PrivateKey</span>&nbsp;<span class="keyword" id="4743785">struct</span>&nbsp;<span class="op" id="4743792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743795"><a href="/gostd/crypto/rsa/rsa.go.html#4742943">PublicKey</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4743816">//&nbsp;public&nbsp;part.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743833">D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4743843">*</span><span class="ident" id="4743844"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4743847">.</span><span class="ident" id="4743848"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4743854">//&nbsp;private&nbsp;exponent</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4743875">Primes</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4743885">[</span><span class="op" id="4743886">]</span><span class="op" id="4743887">*</span><span class="ident" id="4743888"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4743891">.</span><span class="ident" id="4743892"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span>&nbsp;<span class="comment" id="4743896">//&nbsp;prime&nbsp;factors&nbsp;of&nbsp;N,&nbsp;has&nbsp;&gt;=&nbsp;2&nbsp;elements.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4743940">//&nbsp;Precomputed&nbsp;contains&nbsp;precomputed&nbsp;values&nbsp;that&nbsp;speed&nbsp;up&nbsp;private</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4744006">//&nbsp;operations,&nbsp;if&nbsp;available.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4744036">Precomputed</span>&nbsp;<span class="ident" id="4744048"><a href="/gostd/crypto/rsa/rsa.go.html#4744807">PrecomputedValues</a></span><br>
<span class="lineno">60</span><span class="op" id="4744066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4744069">//&nbsp;Public&nbsp;returns&nbsp;the&nbsp;public&nbsp;key&nbsp;corresponding&nbsp;to&nbsp;priv.</span><br>
<span class="lineno"></span><span class="keyword" id="4744125">func</span>&nbsp;<span class="op" id="4744130">(</span><span class="ident" id="4744131">priv</span>&nbsp;<span class="op" id="4744136">*</span><span class="ident" id="4744137"><a href="/gostd/crypto/rsa/rsa.go.html#4743774">PrivateKey</a></span><span class="op" id="4744147">)</span>&nbsp;<span class="ident" id="4744149">Public</span><span class="op" id="4744155">(</span><span class="op" id="4744156">)</span>&nbsp;<span class="ident" id="4744158"><a href="/gostd/crypto/rsa/rsa.go.html#4742745">crypto</a></span><span class="op" id="4744164">.</span><span class="ident" id="4744165"><a href="/gostd/crypto/crypto.go.html#3012471">PublicKey</a></span>&nbsp;<span class="op" id="4744175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4744178">return</span>&nbsp;<span class="op" id="4744185">&amp;</span><span class="ident" id="4744186"><a href="/gostd/crypto/rsa/rsa.go.html#4744131">priv</a></span><span class="op" id="4744190">.</span><span class="ident" id="4744191"><a href="/gostd/crypto/rsa/rsa.go.html#4743795">PublicKey</a></span><br>
<span class="lineno">65</span><span class="op" id="4744201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4744204">//&nbsp;Sign&nbsp;signs&nbsp;msg&nbsp;with&nbsp;priv,&nbsp;reading&nbsp;randomness&nbsp;from&nbsp;rand.&nbsp;If&nbsp;opts&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4744276">//&nbsp;*PSSOptions&nbsp;then&nbsp;the&nbsp;PSS&nbsp;algorithm&nbsp;will&nbsp;be&nbsp;used,&nbsp;otherwise&nbsp;PKCS#1&nbsp;v1.5&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="4744355">//&nbsp;be&nbsp;used.&nbsp;This&nbsp;method&nbsp;is&nbsp;intended&nbsp;to&nbsp;support&nbsp;keys&nbsp;where&nbsp;the&nbsp;private&nbsp;part&nbsp;is</span><br>
<span class="lineno">70</span><span class="comment" id="4744433">//&nbsp;kept&nbsp;in,&nbsp;for&nbsp;example,&nbsp;a&nbsp;hardware&nbsp;module.&nbsp;Common&nbsp;uses&nbsp;should&nbsp;use&nbsp;the&nbsp;Sign*</span><br>
<span class="lineno"></span><span class="comment" id="4744510">//&nbsp;functions&nbsp;in&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="4744540">func</span>&nbsp;<span class="op" id="4744545">(</span><span class="ident" id="4744546">priv</span>&nbsp;<span class="op" id="4744551">*</span><span class="ident" id="4744552"><a href="/gostd/crypto/rsa/rsa.go.html#4743774">PrivateKey</a></span><span class="op" id="4744562">)</span>&nbsp;<span class="ident" id="4744564">Sign</span><span class="op" id="4744568">(</span><span class="ident" id="4744569">rand</span>&nbsp;<span class="ident" id="4744574"><a href="/gostd/crypto/rsa/rsa.go.html#4742805">io</a></span><span class="op" id="4744576">.</span><span class="ident" id="4744577"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="4744583">,</span>&nbsp;<span class="ident" id="4744585">msg</span>&nbsp;<span class="op" id="4744589">[</span><span class="op" id="4744590">]</span><span class="builtintype" id="4744591">byte</span><span class="op" id="4744595">,</span>&nbsp;<span class="ident" id="4744597">opts</span>&nbsp;<span class="ident" id="4744602"><a href="/gostd/crypto/rsa/rsa.go.html#4742745">crypto</a></span><span class="op" id="4744608">.</span><span class="ident" id="4744609"><a href="/gostd/crypto/crypto.go.html#3013580">SignerOpts</a></span><span class="op" id="4744619">)</span>&nbsp;<span class="op" id="4744621">(</span><span class="op" id="4744622">[</span><span class="op" id="4744623">]</span><span class="builtintype" id="4744624">byte</span><span class="op" id="4744628">,</span>&nbsp;<span class="builtintype" id="4744630">error</span><span class="op" id="4744635">)</span>&nbsp;<span class="op" id="4744637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4744640">if</span>&nbsp;<span class="ident" id="4744643">pssOpts</span><span class="op" id="4744650">,</span>&nbsp;<span class="ident" id="4744652">ok</span>&nbsp;<span class="op" id="4744655">:=</span>&nbsp;<span class="ident" id="4744658"><a href="/gostd/crypto/rsa/rsa.go.html#4744597">opts</a></span><span class="op" id="4744662">.</span><span class="op" id="4744663">(</span><span class="op" id="4744664">*</span><span class="ident" id="4744665"><a href="/gostd/crypto/rsa/pss.go.html#4739999">PSSOptions</a></span><span class="op" id="4744675">)</span><span class="op" id="4744676">;</span>&nbsp;<span class="ident" id="4744678"><a href="/gostd/crypto/rsa/rsa.go.html#4744652">ok</a></span>&nbsp;<span class="op" id="4744681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4744685">return</span>&nbsp;<span class="ident" id="4744692"><a href="/gostd/crypto/rsa/pss.go.html#4740919">SignPSS</a></span><span class="op" id="4744699">(</span><span class="ident" id="4744700"><a href="/gostd/crypto/rsa/rsa.go.html#4744569">rand</a></span><span class="op" id="4744704">,</span>&nbsp;<span class="ident" id="4744706"><a href="/gostd/crypto/rsa/rsa.go.html#4744546">priv</a></span><span class="op" id="4744710">,</span>&nbsp;<span class="ident" id="4744712"><a href="/gostd/crypto/rsa/rsa.go.html#4744643">pssOpts</a></span><span class="op" id="4744719">.</span><span class="ident" id="4744720"><a href="/gostd/crypto/rsa/pss.go.html#4740370">Hash</a></span><span class="op" id="4744724">,</span>&nbsp;<span class="ident" id="4744726"><a href="/gostd/crypto/rsa/rsa.go.html#4744585">msg</a></span><span class="op" id="4744729">,</span>&nbsp;<span class="ident" id="4744731"><a href="/gostd/crypto/rsa/rsa.go.html#4744643">pssOpts</a></span><span class="op" id="4744738">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4744741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4744745">return</span>&nbsp;<span class="ident" id="4744752"><a href="/gostd/crypto/rsa/pkcs1v15.go.html#4731399">SignPKCS1v15</a></span><span class="op" id="4744764">(</span><span class="ident" id="4744765"><a href="/gostd/crypto/rsa/rsa.go.html#4744569">rand</a></span><span class="op" id="4744769">,</span>&nbsp;<span class="ident" id="4744771"><a href="/gostd/crypto/rsa/rsa.go.html#4744546">priv</a></span><span class="op" id="4744775">,</span>&nbsp;<span class="ident" id="4744777"><a href="/gostd/crypto/rsa/rsa.go.html#4744597">opts</a></span><span class="op" id="4744781">.</span><span class="ident" id="4744782"><a href="/gostd/crypto/crypto.go.html#3013771">HashFunc</a></span><span class="op" id="4744790">(</span><span class="op" id="4744791">)</span><span class="op" id="4744792">,</span>&nbsp;<span class="ident" id="4744794"><a href="/gostd/crypto/rsa/rsa.go.html#4744585">msg</a></span><span class="op" id="4744797">)</span><br>
<span class="lineno"></span><span class="op" id="4744799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="4744802">type</span>&nbsp;<span class="ident" id="4744807">PrecomputedValues</span>&nbsp;<span class="keyword" id="4744825">struct</span>&nbsp;<span class="op" id="4744832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4744835">Dp</span><span class="op" id="4744837">,</span>&nbsp;<span class="ident" id="4744839">Dq</span>&nbsp;<span class="op" id="4744842">*</span><span class="ident" id="4744843"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4744846">.</span><span class="ident" id="4744847"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span>&nbsp;<span class="comment" id="4744851">//&nbsp;D&nbsp;mod&nbsp;(P-1)&nbsp;(or&nbsp;mod&nbsp;Q-1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4744880">Qinv</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4744887">*</span><span class="ident" id="4744888"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4744891">.</span><span class="ident" id="4744892"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span>&nbsp;<span class="comment" id="4744896">//&nbsp;Q^-1&nbsp;mod&nbsp;P</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4744912">//&nbsp;CRTValues&nbsp;is&nbsp;used&nbsp;for&nbsp;the&nbsp;3rd&nbsp;and&nbsp;subsequent&nbsp;primes.&nbsp;Due&nbsp;to&nbsp;a</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4744978">//&nbsp;historical&nbsp;accident,&nbsp;the&nbsp;CRT&nbsp;for&nbsp;the&nbsp;first&nbsp;two&nbsp;primes&nbsp;is&nbsp;handled</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4745047">//&nbsp;differently&nbsp;in&nbsp;PKCS#1&nbsp;and&nbsp;interoperability&nbsp;is&nbsp;sufficiently</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4745110">//&nbsp;important&nbsp;that&nbsp;we&nbsp;mirror&nbsp;this.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745145">CRTValues</span>&nbsp;<span class="op" id="4745155">[</span><span class="op" id="4745156">]</span><span class="ident" id="4745157"><a href="/gostd/crypto/rsa/rsa.go.html#4745245">CRTValue</a></span><br>
<span class="lineno"></span><span class="op" id="4745166">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="4745169">//&nbsp;CRTValue&nbsp;contains&nbsp;the&nbsp;precomputed&nbsp;chinese&nbsp;remainder&nbsp;theorem&nbsp;values.</span><br>
<span class="lineno"></span><span class="keyword" id="4745240">type</span>&nbsp;<span class="ident" id="4745245">CRTValue</span>&nbsp;<span class="keyword" id="4745254">struct</span>&nbsp;<span class="op" id="4745261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745264">Exp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4745270">*</span><span class="ident" id="4745271"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4745274">.</span><span class="ident" id="4745275"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span>&nbsp;<span class="comment" id="4745279">//&nbsp;D&nbsp;mod&nbsp;(prime-1).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745300">Coeff</span>&nbsp;<span class="op" id="4745306">*</span><span class="ident" id="4745307"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4745310">.</span><span class="ident" id="4745311"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span>&nbsp;<span class="comment" id="4745315">//&nbsp;R·Coeff&nbsp;≡&nbsp;1&nbsp;mod&nbsp;Prime.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4745345">R</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4745351">*</span><span class="ident" id="4745352"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4745355">.</span><span class="ident" id="4745356"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span>&nbsp;<span class="comment" id="4745360">//&nbsp;product&nbsp;of&nbsp;primes&nbsp;prior&nbsp;to&nbsp;this&nbsp;(inc&nbsp;p&nbsp;and&nbsp;q).</span><br>
<span class="lineno"></span><span class="op" id="4745410">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4745413">//&nbsp;Validate&nbsp;performs&nbsp;basic&nbsp;sanity&nbsp;checks&nbsp;on&nbsp;the&nbsp;key.</span><br>
<span class="lineno"></span><span class="comment" id="4745466">//&nbsp;It&nbsp;returns&nbsp;nil&nbsp;if&nbsp;the&nbsp;key&nbsp;is&nbsp;valid,&nbsp;or&nbsp;else&nbsp;an&nbsp;error&nbsp;describing&nbsp;a&nbsp;problem.</span><br>
<span class="lineno">100</span><span class="keyword" id="4745544">func</span>&nbsp;<span class="op" id="4745549">(</span><span class="ident" id="4745550">priv</span>&nbsp;<span class="op" id="4745555">*</span><span class="ident" id="4745556"><a href="/gostd/crypto/rsa/rsa.go.html#4743774">PrivateKey</a></span><span class="op" id="4745566">)</span>&nbsp;<span class="ident" id="4745568">Validate</span><span class="op" id="4745576">(</span><span class="op" id="4745577">)</span>&nbsp;<span class="builtintype" id="4745579">error</span>&nbsp;<span class="op" id="4745585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4745588">if</span>&nbsp;<span class="ident" id="4745591">err</span>&nbsp;<span class="op" id="4745595">:=</span>&nbsp;<span class="ident" id="4745598"><a href="/gostd/crypto/rsa/rsa.go.html#4743527">checkPub</a></span><span class="op" id="4745606">(</span><span class="op" id="4745607">&amp;</span><span class="ident" id="4745608"><a href="/gostd/crypto/rsa/rsa.go.html#4745550">priv</a></span><span class="op" id="4745612">.</span><span class="ident" id="4745613"><a href="/gostd/crypto/rsa/rsa.go.html#4743795">PublicKey</a></span><span class="op" id="4745622">)</span><span class="op" id="4745623">;</span>&nbsp;<span class="ident" id="4745625"><a href="/gostd/crypto/rsa/rsa.go.html#4745591">err</a></span>&nbsp;<span class="op" id="4745629">!=</span>&nbsp;<span class="builtintype" id="4745632">nil</span>&nbsp;<span class="op" id="4745636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4745640">return</span>&nbsp;<span class="ident" id="4745647"><a href="/gostd/crypto/rsa/rsa.go.html#4745591">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4745652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4745656">//&nbsp;Check&nbsp;that&nbsp;the&nbsp;prime&nbsp;factors&nbsp;are&nbsp;actually&nbsp;prime.&nbsp;Note&nbsp;that&nbsp;this&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4745727">//&nbsp;just&nbsp;a&nbsp;sanity&nbsp;check.&nbsp;Since&nbsp;the&nbsp;random&nbsp;witnesses&nbsp;chosen&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4745789">//&nbsp;ProbablyPrime&nbsp;are&nbsp;deterministic,&nbsp;given&nbsp;the&nbsp;candidate&nbsp;number,&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4745859">//&nbsp;easy&nbsp;for&nbsp;an&nbsp;attack&nbsp;to&nbsp;generate&nbsp;composites&nbsp;that&nbsp;pass&nbsp;this&nbsp;test.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4745926">for</span>&nbsp;<span class="ident" id="4745930">_</span><span class="op" id="4745931">,</span>&nbsp;<span class="ident" id="4745933">prime</span>&nbsp;<span class="op" id="4745939">:=</span>&nbsp;<span class="keyword" id="4745942">range</span>&nbsp;<span class="ident" id="4745948"><a href="/gostd/crypto/rsa/rsa.go.html#4745550">priv</a></span><span class="op" id="4745952">.</span><span class="ident" id="4745953"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span>&nbsp;<span class="op" id="4745960">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4745964">if</span>&nbsp;<span class="op" id="4745967">!</span><span class="ident" id="4745968"><a href="/gostd/crypto/rsa/rsa.go.html#4745933">prime</a></span><span class="op" id="4745973">.</span><span class="ident" id="4745974"><a href="/gostd/math/big/int.go.html#2053360">ProbablyPrime</a></span><span class="op" id="4745987">(</span><span class="num" id="4745988">20</span><span class="op" id="4745990">)</span>&nbsp;<span class="op" id="4745992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4745997">return</span>&nbsp;<span class="ident" id="4746004"><a href="/gostd/crypto/rsa/rsa.go.html#4742787">errors</a></span><span class="op" id="4746010">.</span><span class="ident" id="4746011"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4746014">(</span><span class="string" id="4746015">&#34;crypto/rsa:&nbsp;prime&nbsp;factor&nbsp;is&nbsp;composite&#34;</span><span class="op" id="4746054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4746058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4746061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4746065">//&nbsp;Check&nbsp;that&nbsp;Πprimes&nbsp;==&nbsp;n.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746095">modulus</span>&nbsp;<span class="op" id="4746103">:=</span>&nbsp;<span class="builtinfunc" id="4746106">new</span><span class="op" id="4746109">(</span><span class="ident" id="4746110"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4746113">.</span><span class="ident" id="4746114"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4746117">)</span><span class="op" id="4746118">.</span><span class="ident" id="4746119"><a href="/gostd/math/big/int.go.html#2036758">Set</a></span><span class="op" id="4746122">(</span><span class="ident" id="4746123"><a href="/gostd/crypto/rsa/rsa.go.html#4742857">bigOne</a></span><span class="op" id="4746129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4746132">for</span>&nbsp;<span class="ident" id="4746136">_</span><span class="op" id="4746137">,</span>&nbsp;<span class="ident" id="4746139">prime</span>&nbsp;<span class="op" id="4746145">:=</span>&nbsp;<span class="keyword" id="4746148">range</span>&nbsp;<span class="ident" id="4746154"><a href="/gostd/crypto/rsa/rsa.go.html#4745550">priv</a></span><span class="op" id="4746158">.</span><span class="ident" id="4746159"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span>&nbsp;<span class="op" id="4746166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746170"><a href="/gostd/crypto/rsa/rsa.go.html#4746095">modulus</a></span><span class="op" id="4746177">.</span><span class="ident" id="4746178"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="4746181">(</span><span class="ident" id="4746182"><a href="/gostd/crypto/rsa/rsa.go.html#4746095">modulus</a></span><span class="op" id="4746189">,</span>&nbsp;<span class="ident" id="4746191"><a href="/gostd/crypto/rsa/rsa.go.html#4746139">prime</a></span><span class="op" id="4746196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4746199">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4746202">if</span>&nbsp;<span class="ident" id="4746205"><a href="/gostd/crypto/rsa/rsa.go.html#4746095">modulus</a></span><span class="op" id="4746212">.</span><span class="ident" id="4746213"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="4746216">(</span><span class="ident" id="4746217"><a href="/gostd/crypto/rsa/rsa.go.html#4745550">priv</a></span><span class="op" id="4746221">.</span><span class="ident" id="4746222"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span><span class="op" id="4746223">)</span>&nbsp;<span class="op" id="4746225">!=</span>&nbsp;<span class="num" id="4746228">0</span>&nbsp;<span class="op" id="4746230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4746234">return</span>&nbsp;<span class="ident" id="4746241"><a href="/gostd/crypto/rsa/rsa.go.html#4742787">errors</a></span><span class="op" id="4746247">.</span><span class="ident" id="4746248"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4746251">(</span><span class="string" id="4746252">&#34;crypto/rsa:&nbsp;invalid&nbsp;modulus&#34;</span><span class="op" id="4746281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4746284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4746288">//&nbsp;Check&nbsp;that&nbsp;de&nbsp;≡&nbsp;1&nbsp;mod&nbsp;p-1,&nbsp;for&nbsp;each&nbsp;prime.</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4746337">//&nbsp;This&nbsp;implies&nbsp;that&nbsp;e&nbsp;is&nbsp;coprime&nbsp;to&nbsp;each&nbsp;p-1&nbsp;as&nbsp;e&nbsp;has&nbsp;a&nbsp;multiplicative</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4746410">//&nbsp;inverse.&nbsp;Therefore&nbsp;e&nbsp;is&nbsp;coprime&nbsp;to&nbsp;lcm(p-1,q-1,r-1,...)&nbsp;=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4746472">//&nbsp;exponent(ℤ/nℤ).&nbsp;It&nbsp;also&nbsp;implies&nbsp;that&nbsp;a^de&nbsp;≡&nbsp;a&nbsp;mod&nbsp;p&nbsp;as&nbsp;a^(p-1)&nbsp;≡&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4746551">//&nbsp;mod&nbsp;p.&nbsp;Thus&nbsp;a^de&nbsp;≡&nbsp;a&nbsp;mod&nbsp;n&nbsp;for&nbsp;all&nbsp;a&nbsp;coprime&nbsp;to&nbsp;n,&nbsp;as&nbsp;required.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746621">congruence</span>&nbsp;<span class="op" id="4746632">:=</span>&nbsp;<span class="builtinfunc" id="4746635">new</span><span class="op" id="4746638">(</span><span class="ident" id="4746639"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4746642">.</span><span class="ident" id="4746643"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4746646">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746649">de</span>&nbsp;<span class="op" id="4746652">:=</span>&nbsp;<span class="builtinfunc" id="4746655">new</span><span class="op" id="4746658">(</span><span class="ident" id="4746659"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4746662">.</span><span class="ident" id="4746663"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4746666">)</span><span class="op" id="4746667">.</span><span class="ident" id="4746668"><a href="/gostd/math/big/int.go.html#2036323">SetInt64</a></span><span class="op" id="4746676">(</span><span class="builtintype" id="4746677">int64</span><span class="op" id="4746682">(</span><span class="ident" id="4746683"><a href="/gostd/crypto/rsa/rsa.go.html#4745550">priv</a></span><span class="op" id="4746687">.</span><span class="ident" id="4746688"><a href="/gostd/crypto/rsa/rsa.go.html#4742986">E</a></span><span class="op" id="4746689">)</span><span class="op" id="4746690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746693"><a href="/gostd/crypto/rsa/rsa.go.html#4746649">de</a></span><span class="op" id="4746695">.</span><span class="ident" id="4746696"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="4746699">(</span><span class="ident" id="4746700"><a href="/gostd/crypto/rsa/rsa.go.html#4746649">de</a></span><span class="op" id="4746702">,</span>&nbsp;<span class="ident" id="4746704"><a href="/gostd/crypto/rsa/rsa.go.html#4745550">priv</a></span><span class="op" id="4746708">.</span><span class="ident" id="4746709"><a href="/gostd/crypto/rsa/rsa.go.html#4743833">D</a></span><span class="op" id="4746710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4746713">for</span>&nbsp;<span class="ident" id="4746717">_</span><span class="op" id="4746718">,</span>&nbsp;<span class="ident" id="4746720">prime</span>&nbsp;<span class="op" id="4746726">:=</span>&nbsp;<span class="keyword" id="4746729">range</span>&nbsp;<span class="ident" id="4746735"><a href="/gostd/crypto/rsa/rsa.go.html#4745550">priv</a></span><span class="op" id="4746739">.</span><span class="ident" id="4746740"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span>&nbsp;<span class="op" id="4746747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746751">pminus1</span>&nbsp;<span class="op" id="4746759">:=</span>&nbsp;<span class="builtinfunc" id="4746762">new</span><span class="op" id="4746765">(</span><span class="ident" id="4746766"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4746769">.</span><span class="ident" id="4746770"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4746773">)</span><span class="op" id="4746774">.</span><span class="ident" id="4746775"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="4746778">(</span><span class="ident" id="4746779"><a href="/gostd/crypto/rsa/rsa.go.html#4746720">prime</a></span><span class="op" id="4746784">,</span>&nbsp;<span class="ident" id="4746786"><a href="/gostd/crypto/rsa/rsa.go.html#4742857">bigOne</a></span><span class="op" id="4746792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4746796"><a href="/gostd/crypto/rsa/rsa.go.html#4746621">congruence</a></span><span class="op" id="4746806">.</span><span class="ident" id="4746807"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="4746810">(</span><span class="ident" id="4746811"><a href="/gostd/crypto/rsa/rsa.go.html#4746649">de</a></span><span class="op" id="4746813">,</span>&nbsp;<span class="ident" id="4746815"><a href="/gostd/crypto/rsa/rsa.go.html#4746751">pminus1</a></span><span class="op" id="4746822">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4746826">if</span>&nbsp;<span class="ident" id="4746829"><a href="/gostd/crypto/rsa/rsa.go.html#4746621">congruence</a></span><span class="op" id="4746839">.</span><span class="ident" id="4746840"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="4746843">(</span><span class="ident" id="4746844"><a href="/gostd/crypto/rsa/rsa.go.html#4742857">bigOne</a></span><span class="op" id="4746850">)</span>&nbsp;<span class="op" id="4746852">!=</span>&nbsp;<span class="num" id="4746855">0</span>&nbsp;<span class="op" id="4746857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4746862">return</span>&nbsp;<span class="ident" id="4746869"><a href="/gostd/crypto/rsa/rsa.go.html#4742787">errors</a></span><span class="op" id="4746875">.</span><span class="ident" id="4746876"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4746879">(</span><span class="string" id="4746880">&#34;crypto/rsa:&nbsp;invalid&nbsp;exponents&#34;</span><span class="op" id="4746911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4746915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4746918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4746921">return</span>&nbsp;<span class="builtintype" id="4746928">nil</span><br>
<span class="lineno">140</span><span class="op" id="4746932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4746935">//&nbsp;GenerateKey&nbsp;generates&nbsp;an&nbsp;RSA&nbsp;keypair&nbsp;of&nbsp;the&nbsp;given&nbsp;bit&nbsp;size&nbsp;using&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4747007">//&nbsp;random&nbsp;source&nbsp;random&nbsp;(for&nbsp;example,&nbsp;crypto/rand.Reader).</span><br>
<span class="lineno"></span><span class="keyword" id="4747066">func</span>&nbsp;<span class="ident" id="4747071">GenerateKey</span><span class="op" id="4747082">(</span><span class="ident" id="4747083">random</span>&nbsp;<span class="ident" id="4747090"><a href="/gostd/crypto/rsa/rsa.go.html#4742805">io</a></span><span class="op" id="4747092">.</span><span class="ident" id="4747093"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="4747099">,</span>&nbsp;<span class="ident" id="4747101">bits</span>&nbsp;<span class="builtintype" id="4747106">int</span><span class="op" id="4747109">)</span>&nbsp;<span class="op" id="4747111">(</span><span class="ident" id="4747112">priv</span>&nbsp;<span class="op" id="4747117">*</span><span class="ident" id="4747118"><a href="/gostd/crypto/rsa/rsa.go.html#4743774">PrivateKey</a></span><span class="op" id="4747128">,</span>&nbsp;<span class="ident" id="4747130">err</span>&nbsp;<span class="builtintype" id="4747134">error</span><span class="op" id="4747139">)</span>&nbsp;<span class="op" id="4747141">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4747144">return</span>&nbsp;<span class="ident" id="4747151"><a href="/gostd/crypto/rsa/rsa.go.html#4747787">GenerateMultiPrimeKey</a></span><span class="op" id="4747172">(</span><span class="ident" id="4747173"><a href="/gostd/crypto/rsa/rsa.go.html#4747083">random</a></span><span class="op" id="4747179">,</span>&nbsp;<span class="num" id="4747181">2</span><span class="op" id="4747182">,</span>&nbsp;<span class="ident" id="4747184"><a href="/gostd/crypto/rsa/rsa.go.html#4747101">bits</a></span><span class="op" id="4747188">)</span><br>
<span class="lineno"></span><span class="op" id="4747190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4747193">//&nbsp;GenerateMultiPrimeKey&nbsp;generates&nbsp;a&nbsp;multi-prime&nbsp;RSA&nbsp;keypair&nbsp;of&nbsp;the&nbsp;given&nbsp;bit</span><br>
<span class="lineno"></span><span class="comment" id="4747271">//&nbsp;size&nbsp;and&nbsp;the&nbsp;given&nbsp;random&nbsp;source,&nbsp;as&nbsp;suggested&nbsp;in&nbsp;[1].&nbsp;Although&nbsp;the&nbsp;public</span><br>
<span class="lineno">150</span><span class="comment" id="4747349">//&nbsp;keys&nbsp;are&nbsp;compatible&nbsp;(actually,&nbsp;indistinguishable)&nbsp;from&nbsp;the&nbsp;2-prime&nbsp;case,</span><br>
<span class="lineno"></span><span class="comment" id="4747425">//&nbsp;the&nbsp;private&nbsp;keys&nbsp;are&nbsp;not.&nbsp;Thus&nbsp;it&nbsp;may&nbsp;not&nbsp;be&nbsp;possible&nbsp;to&nbsp;export&nbsp;multi-prime</span><br>
<span class="lineno"></span><span class="comment" id="4747504">//&nbsp;private&nbsp;keys&nbsp;in&nbsp;certain&nbsp;formats&nbsp;or&nbsp;to&nbsp;subsequently&nbsp;import&nbsp;them&nbsp;into&nbsp;other</span><br>
<span class="lineno"></span><span class="comment" id="4747581">//&nbsp;code.</span><br>
<span class="lineno"></span><span class="comment" id="4747590">//</span><br>
<span class="lineno">155</span><span class="comment" id="4747593">//&nbsp;Table&nbsp;1&nbsp;in&nbsp;[2]&nbsp;suggests&nbsp;maximum&nbsp;numbers&nbsp;of&nbsp;primes&nbsp;for&nbsp;a&nbsp;given&nbsp;size.</span><br>
<span class="lineno"></span><span class="comment" id="4747664">//</span><br>
<span class="lineno"></span><span class="comment" id="4747667">//&nbsp;[1]&nbsp;US&nbsp;patent&nbsp;4405829&nbsp;(1972,&nbsp;expired)</span><br>
<span class="lineno"></span><span class="comment" id="4747708">//&nbsp;[2]&nbsp;http://www.cacr.math.uwaterloo.ca/techreports/2006/cacr2006-16.pdf</span><br>
<span class="lineno"></span><span class="keyword" id="4747782">func</span>&nbsp;<span class="ident" id="4747787">GenerateMultiPrimeKey</span><span class="op" id="4747808">(</span><span class="ident" id="4747809">random</span>&nbsp;<span class="ident" id="4747816"><a href="/gostd/crypto/rsa/rsa.go.html#4742805">io</a></span><span class="op" id="4747818">.</span><span class="ident" id="4747819"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="4747825">,</span>&nbsp;<span class="ident" id="4747827">nprimes</span>&nbsp;<span class="builtintype" id="4747835">int</span><span class="op" id="4747838">,</span>&nbsp;<span class="ident" id="4747840">bits</span>&nbsp;<span class="builtintype" id="4747845">int</span><span class="op" id="4747848">)</span>&nbsp;<span class="op" id="4747850">(</span><span class="ident" id="4747851">priv</span>&nbsp;<span class="op" id="4747856">*</span><span class="ident" id="4747857"><a href="/gostd/crypto/rsa/rsa.go.html#4743774">PrivateKey</a></span><span class="op" id="4747867">,</span>&nbsp;<span class="ident" id="4747869">err</span>&nbsp;<span class="builtintype" id="4747873">error</span><span class="op" id="4747878">)</span>&nbsp;<span class="op" id="4747880">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4747883"><a href="/gostd/crypto/rsa/rsa.go.html#4747851">priv</a></span>&nbsp;<span class="op" id="4747888">=</span>&nbsp;<span class="builtinfunc" id="4747890">new</span><span class="op" id="4747893">(</span><span class="ident" id="4747894"><a href="/gostd/crypto/rsa/rsa.go.html#4743774">PrivateKey</a></span><span class="op" id="4747904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4747907"><a href="/gostd/crypto/rsa/rsa.go.html#4747851">priv</a></span><span class="op" id="4747911">.</span><span class="ident" id="4747912"><a href="/gostd/crypto/rsa/rsa.go.html#4742986">E</a></span>&nbsp;<span class="op" id="4747914">=</span>&nbsp;<span class="num" id="4747916">65537</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4747924">if</span>&nbsp;<span class="ident" id="4747927"><a href="/gostd/crypto/rsa/rsa.go.html#4747827">nprimes</a></span>&nbsp;<span class="op" id="4747935">&lt;</span>&nbsp;<span class="num" id="4747937">2</span>&nbsp;<span class="op" id="4747939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4747943">return</span>&nbsp;<span class="builtintype" id="4747950">nil</span><span class="op" id="4747953">,</span>&nbsp;<span class="ident" id="4747955"><a href="/gostd/crypto/rsa/rsa.go.html#4742787">errors</a></span><span class="op" id="4747961">.</span><span class="ident" id="4747962"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4747965">(</span><span class="string" id="4747966">&#34;crypto/rsa:&nbsp;GenerateMultiPrimeKey:&nbsp;nprimes&nbsp;must&nbsp;be&nbsp;&gt;=&nbsp;2&#34;</span><span class="op" id="4748023">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4748026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4748030">primes</span>&nbsp;<span class="op" id="4748037">:=</span>&nbsp;<span class="builtinfunc" id="4748040">make</span><span class="op" id="4748044">(</span><span class="op" id="4748045">[</span><span class="op" id="4748046">]</span><span class="op" id="4748047">*</span><span class="ident" id="4748048"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4748051">.</span><span class="ident" id="4748052"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4748055">,</span>&nbsp;<span class="ident" id="4748057"><a href="/gostd/crypto/rsa/rsa.go.html#4747827">nprimes</a></span><span class="op" id="4748064">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="4748067">NextSetOfPrimes</span><span class="op" id="4748082">:</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4748085">for</span>&nbsp;<span class="op" id="4748089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4748093">todo</span>&nbsp;<span class="op" id="4748098">:=</span>&nbsp;<span class="ident" id="4748101"><a href="/gostd/crypto/rsa/rsa.go.html#4747840">bits</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4748108">//&nbsp;crypto/rand&nbsp;should&nbsp;set&nbsp;the&nbsp;top&nbsp;two&nbsp;bits&nbsp;in&nbsp;each&nbsp;prime.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4748168">//&nbsp;Thus&nbsp;each&nbsp;prime&nbsp;has&nbsp;the&nbsp;form</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4748202">//&nbsp;&nbsp;&nbsp;p_i&nbsp;=&nbsp;2^bitlen(p_i)&nbsp;×&nbsp;0.11...&nbsp;(in&nbsp;base&nbsp;2).</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4748253">//&nbsp;And&nbsp;the&nbsp;product&nbsp;is:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4748278">//&nbsp;&nbsp;&nbsp;P&nbsp;=&nbsp;2^todo&nbsp;×&nbsp;α</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4748302">//&nbsp;where&nbsp;α&nbsp;is&nbsp;the&nbsp;product&nbsp;of&nbsp;nprimes&nbsp;numbers&nbsp;of&nbsp;the&nbsp;form&nbsp;0.11...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4748370">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4748375">//&nbsp;If&nbsp;α&nbsp;&lt;&nbsp;1/2&nbsp;(which&nbsp;can&nbsp;happen&nbsp;for&nbsp;nprimes&nbsp;&gt;&nbsp;2),&nbsp;we&nbsp;need&nbsp;to</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4748439">//&nbsp;shift&nbsp;todo&nbsp;to&nbsp;compensate&nbsp;for&nbsp;lost&nbsp;bits:&nbsp;the&nbsp;mean&nbsp;value&nbsp;of&nbsp;0.11...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4748510">//&nbsp;is&nbsp;7/8,&nbsp;so&nbsp;todo&nbsp;+&nbsp;shift&nbsp;-&nbsp;nprimes&nbsp;*&nbsp;log2(7/8)&nbsp;~=&nbsp;bits&nbsp;-&nbsp;1/2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4748575">//&nbsp;will&nbsp;give&nbsp;good&nbsp;results.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4748604">if</span>&nbsp;<span class="ident" id="4748607"><a href="/gostd/crypto/rsa/rsa.go.html#4747827">nprimes</a></span>&nbsp;<span class="op" id="4748615">&gt;=</span>&nbsp;<span class="num" id="4748618">7</span>&nbsp;<span class="op" id="4748620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4748625"><a href="/gostd/crypto/rsa/rsa.go.html#4748093">todo</a></span>&nbsp;<span class="op" id="4748630">+=</span>&nbsp;<span class="op" id="4748633">(</span><span class="ident" id="4748634"><a href="/gostd/crypto/rsa/rsa.go.html#4747827">nprimes</a></span>&nbsp;<span class="op" id="4748642">-</span>&nbsp;<span class="num" id="4748644">2</span><span class="op" id="4748645">)</span>&nbsp;<span class="op" id="4748647">/</span>&nbsp;<span class="num" id="4748649">5</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4748653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4748657">for</span>&nbsp;<span class="ident" id="4748661">i</span>&nbsp;<span class="op" id="4748663">:=</span>&nbsp;<span class="num" id="4748666">0</span><span class="op" id="4748667">;</span>&nbsp;<span class="ident" id="4748669"><a href="/gostd/crypto/rsa/rsa.go.html#4748661">i</a></span>&nbsp;<span class="op" id="4748671">&lt;</span>&nbsp;<span class="ident" id="4748673"><a href="/gostd/crypto/rsa/rsa.go.html#4747827">nprimes</a></span><span class="op" id="4748680">;</span>&nbsp;<span class="ident" id="4748682"><a href="/gostd/crypto/rsa/rsa.go.html#4748661">i</a></span><span class="op" id="4748683">++</span>&nbsp;<span class="op" id="4748686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4748691"><a href="/gostd/crypto/rsa/rsa.go.html#4748030">primes</a></span><span class="op" id="4748697">[</span><span class="ident" id="4748698"><a href="/gostd/crypto/rsa/rsa.go.html#4748661">i</a></span><span class="op" id="4748699">]</span><span class="op" id="4748700">,</span>&nbsp;<span class="ident" id="4748702"><a href="/gostd/crypto/rsa/rsa.go.html#4747869">err</a></span>&nbsp;<span class="op" id="4748706">=</span>&nbsp;<span class="ident" id="4748708"><a href="/gostd/crypto/rsa/rsa.go.html#4742755">rand</a></span><span class="op" id="4748712">.</span><span class="ident" id="4748713"><a href="/gostd/crypto/rand/util.go.html#4361475">Prime</a></span><span class="op" id="4748718">(</span><span class="ident" id="4748719"><a href="/gostd/crypto/rsa/rsa.go.html#4747809">random</a></span><span class="op" id="4748725">,</span>&nbsp;<span class="ident" id="4748727"><a href="/gostd/crypto/rsa/rsa.go.html#4748093">todo</a></span><span class="op" id="4748731">/</span><span class="op" id="4748732">(</span><span class="ident" id="4748733"><a href="/gostd/crypto/rsa/rsa.go.html#4747827">nprimes</a></span><span class="op" id="4748740">-</span><span class="ident" id="4748741"><a href="/gostd/crypto/rsa/rsa.go.html#4748661">i</a></span><span class="op" id="4748742">)</span><span class="op" id="4748743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4748748">if</span>&nbsp;<span class="ident" id="4748751"><a href="/gostd/crypto/rsa/rsa.go.html#4747869">err</a></span>&nbsp;<span class="op" id="4748755">!=</span>&nbsp;<span class="builtintype" id="4748758">nil</span>&nbsp;<span class="op" id="4748762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4748768">return</span>&nbsp;<span class="builtintype" id="4748775">nil</span><span class="op" id="4748778">,</span>&nbsp;<span class="ident" id="4748780"><a href="/gostd/crypto/rsa/rsa.go.html#4747869">err</a></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4748787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4748792"><a href="/gostd/crypto/rsa/rsa.go.html#4748093">todo</a></span>&nbsp;<span class="op" id="4748797">-=</span>&nbsp;<span class="ident" id="4748800"><a href="/gostd/crypto/rsa/rsa.go.html#4748030">primes</a></span><span class="op" id="4748806">[</span><span class="ident" id="4748807"><a href="/gostd/crypto/rsa/rsa.go.html#4748661">i</a></span><span class="op" id="4748808">]</span><span class="op" id="4748809">.</span><span class="ident" id="4748810"><a href="/gostd/math/big/int.go.html#2050389">BitLen</a></span><span class="op" id="4748816">(</span><span class="op" id="4748817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4748821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4748826">//&nbsp;Make&nbsp;sure&nbsp;that&nbsp;primes&nbsp;is&nbsp;pairwise&nbsp;unequal.</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4748874">for</span>&nbsp;<span class="ident" id="4748878">i</span><span class="op" id="4748879">,</span>&nbsp;<span class="ident" id="4748881">prime</span>&nbsp;<span class="op" id="4748887">:=</span>&nbsp;<span class="keyword" id="4748890">range</span>&nbsp;<span class="ident" id="4748896"><a href="/gostd/crypto/rsa/rsa.go.html#4748030">primes</a></span>&nbsp;<span class="op" id="4748903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4748908">for</span>&nbsp;<span class="ident" id="4748912">j</span>&nbsp;<span class="op" id="4748914">:=</span>&nbsp;<span class="num" id="4748917">0</span><span class="op" id="4748918">;</span>&nbsp;<span class="ident" id="4748920"><a href="/gostd/crypto/rsa/rsa.go.html#4748912">j</a></span>&nbsp;<span class="op" id="4748922">&lt;</span>&nbsp;<span class="ident" id="4748924"><a href="/gostd/crypto/rsa/rsa.go.html#4748878">i</a></span><span class="op" id="4748925">;</span>&nbsp;<span class="ident" id="4748927"><a href="/gostd/crypto/rsa/rsa.go.html#4748912">j</a></span><span class="op" id="4748928">++</span>&nbsp;<span class="op" id="4748931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4748937">if</span>&nbsp;<span class="ident" id="4748940"><a href="/gostd/crypto/rsa/rsa.go.html#4748881">prime</a></span><span class="op" id="4748945">.</span><span class="ident" id="4748946"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="4748949">(</span><span class="ident" id="4748950"><a href="/gostd/crypto/rsa/rsa.go.html#4748030">primes</a></span><span class="op" id="4748956">[</span><span class="ident" id="4748957"><a href="/gostd/crypto/rsa/rsa.go.html#4748912">j</a></span><span class="op" id="4748958">]</span><span class="op" id="4748959">)</span>&nbsp;<span class="op" id="4748961">==</span>&nbsp;<span class="num" id="4748964">0</span>&nbsp;<span class="op" id="4748966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4748973">continue</span>&nbsp;<span class="ident" id="4748982"><a href="/gostd/crypto/rsa/rsa.go.html#4748067">NextSetOfPrimes</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4749002">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4749007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4749011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4749016">n</span>&nbsp;<span class="op" id="4749018">:=</span>&nbsp;<span class="builtinfunc" id="4749021">new</span><span class="op" id="4749024">(</span><span class="ident" id="4749025"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4749028">.</span><span class="ident" id="4749029"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4749032">)</span><span class="op" id="4749033">.</span><span class="ident" id="4749034"><a href="/gostd/math/big/int.go.html#2036758">Set</a></span><span class="op" id="4749037">(</span><span class="ident" id="4749038"><a href="/gostd/crypto/rsa/rsa.go.html#4742857">bigOne</a></span><span class="op" id="4749044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4749048">totient</span>&nbsp;<span class="op" id="4749056">:=</span>&nbsp;<span class="builtinfunc" id="4749059">new</span><span class="op" id="4749062">(</span><span class="ident" id="4749063"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4749066">.</span><span class="ident" id="4749067"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4749070">)</span><span class="op" id="4749071">.</span><span class="ident" id="4749072"><a href="/gostd/math/big/int.go.html#2036758">Set</a></span><span class="op" id="4749075">(</span><span class="ident" id="4749076"><a href="/gostd/crypto/rsa/rsa.go.html#4742857">bigOne</a></span><span class="op" id="4749082">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4749086">pminus1</span>&nbsp;<span class="op" id="4749094">:=</span>&nbsp;<span class="builtinfunc" id="4749097">new</span><span class="op" id="4749100">(</span><span class="ident" id="4749101"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4749104">.</span><span class="ident" id="4749105"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4749108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4749112">for</span>&nbsp;<span class="ident" id="4749116">_</span><span class="op" id="4749117">,</span>&nbsp;<span class="ident" id="4749119">prime</span>&nbsp;<span class="op" id="4749125">:=</span>&nbsp;<span class="keyword" id="4749128">range</span>&nbsp;<span class="ident" id="4749134"><a href="/gostd/crypto/rsa/rsa.go.html#4748030">primes</a></span>&nbsp;<span class="op" id="4749141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4749146"><a href="/gostd/crypto/rsa/rsa.go.html#4749016">n</a></span><span class="op" id="4749147">.</span><span class="ident" id="4749148"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="4749151">(</span><span class="ident" id="4749152"><a href="/gostd/crypto/rsa/rsa.go.html#4749016">n</a></span><span class="op" id="4749153">,</span>&nbsp;<span class="ident" id="4749155"><a href="/gostd/crypto/rsa/rsa.go.html#4749119">prime</a></span><span class="op" id="4749160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4749165"><a href="/gostd/crypto/rsa/rsa.go.html#4749086">pminus1</a></span><span class="op" id="4749172">.</span><span class="ident" id="4749173"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="4749176">(</span><span class="ident" id="4749177"><a href="/gostd/crypto/rsa/rsa.go.html#4749119">prime</a></span><span class="op" id="4749182">,</span>&nbsp;<span class="ident" id="4749184"><a href="/gostd/crypto/rsa/rsa.go.html#4742857">bigOne</a></span><span class="op" id="4749190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4749195"><a href="/gostd/crypto/rsa/rsa.go.html#4749048">totient</a></span><span class="op" id="4749202">.</span><span class="ident" id="4749203"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="4749206">(</span><span class="ident" id="4749207"><a href="/gostd/crypto/rsa/rsa.go.html#4749048">totient</a></span><span class="op" id="4749214">,</span>&nbsp;<span class="ident" id="4749216"><a href="/gostd/crypto/rsa/rsa.go.html#4749086">pminus1</a></span><span class="op" id="4749223">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4749227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4749231">if</span>&nbsp;<span class="ident" id="4749234"><a href="/gostd/crypto/rsa/rsa.go.html#4749016">n</a></span><span class="op" id="4749235">.</span><span class="ident" id="4749236"><a href="/gostd/math/big/int.go.html#2050389">BitLen</a></span><span class="op" id="4749242">(</span><span class="op" id="4749243">)</span>&nbsp;<span class="op" id="4749245">!=</span>&nbsp;<span class="ident" id="4749248"><a href="/gostd/crypto/rsa/rsa.go.html#4747840">bits</a></span>&nbsp;<span class="op" id="4749253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4749258">//&nbsp;This&nbsp;should&nbsp;never&nbsp;happen&nbsp;for&nbsp;nprimes&nbsp;==&nbsp;2&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4749314">//&nbsp;crypto/rand&nbsp;should&nbsp;set&nbsp;the&nbsp;top&nbsp;two&nbsp;bits&nbsp;in&nbsp;each&nbsp;prime.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4749375">//&nbsp;For&nbsp;nprimes&nbsp;&gt;&nbsp;2&nbsp;we&nbsp;hope&nbsp;it&nbsp;does&nbsp;not&nbsp;happen&nbsp;often.</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4749431">continue</span>&nbsp;<span class="ident" id="4749440"><a href="/gostd/crypto/rsa/rsa.go.html#4748067">NextSetOfPrimes</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4749458">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4749463">g</span>&nbsp;<span class="op" id="4749465">:=</span>&nbsp;<span class="builtinfunc" id="4749468">new</span><span class="op" id="4749471">(</span><span class="ident" id="4749472"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4749475">.</span><span class="ident" id="4749476"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4749479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4749483"><a href="/gostd/crypto/rsa/rsa.go.html#4747851">priv</a></span><span class="op" id="4749487">.</span><span class="ident" id="4749488"><a href="/gostd/crypto/rsa/rsa.go.html#4743833">D</a></span>&nbsp;<span class="op" id="4749490">=</span>&nbsp;<span class="builtinfunc" id="4749492">new</span><span class="op" id="4749495">(</span><span class="ident" id="4749496"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4749499">.</span><span class="ident" id="4749500"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4749503">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4749507">y</span>&nbsp;<span class="op" id="4749509">:=</span>&nbsp;<span class="builtinfunc" id="4749512">new</span><span class="op" id="4749515">(</span><span class="ident" id="4749516"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4749519">.</span><span class="ident" id="4749520"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4749523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4749527">e</span>&nbsp;<span class="op" id="4749529">:=</span>&nbsp;<span class="ident" id="4749532"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4749535">.</span><span class="ident" id="4749536"><a href="/gostd/math/big/int.go.html#2036655">NewInt</a></span><span class="op" id="4749542">(</span><span class="builtintype" id="4749543">int64</span><span class="op" id="4749548">(</span><span class="ident" id="4749549"><a href="/gostd/crypto/rsa/rsa.go.html#4747851">priv</a></span><span class="op" id="4749553">.</span><span class="ident" id="4749554"><a href="/gostd/crypto/rsa/rsa.go.html#4742986">E</a></span><span class="op" id="4749555">)</span><span class="op" id="4749556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4749560"><a href="/gostd/crypto/rsa/rsa.go.html#4749463">g</a></span><span class="op" id="4749561">.</span><span class="ident" id="4749562"><a href="/gostd/math/big/int.go.html#2051339">GCD</a></span><span class="op" id="4749565">(</span><span class="ident" id="4749566"><a href="/gostd/crypto/rsa/rsa.go.html#4747851">priv</a></span><span class="op" id="4749570">.</span><span class="ident" id="4749571"><a href="/gostd/crypto/rsa/rsa.go.html#4743833">D</a></span><span class="op" id="4749572">,</span>&nbsp;<span class="ident" id="4749574"><a href="/gostd/crypto/rsa/rsa.go.html#4749507">y</a></span><span class="op" id="4749575">,</span>&nbsp;<span class="ident" id="4749577"><a href="/gostd/crypto/rsa/rsa.go.html#4749527">e</a></span><span class="op" id="4749578">,</span>&nbsp;<span class="ident" id="4749580"><a href="/gostd/crypto/rsa/rsa.go.html#4749048">totient</a></span><span class="op" id="4749587">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4749592">if</span>&nbsp;<span class="ident" id="4749595"><a href="/gostd/crypto/rsa/rsa.go.html#4749463">g</a></span><span class="op" id="4749596">.</span><span class="ident" id="4749597"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="4749600">(</span><span class="ident" id="4749601"><a href="/gostd/crypto/rsa/rsa.go.html#4742857">bigOne</a></span><span class="op" id="4749607">)</span>&nbsp;<span class="op" id="4749609">==</span>&nbsp;<span class="num" id="4749612">0</span>&nbsp;<span class="op" id="4749614">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4749619">if</span>&nbsp;<span class="ident" id="4749622"><a href="/gostd/crypto/rsa/rsa.go.html#4747851">priv</a></span><span class="op" id="4749626">.</span><span class="ident" id="4749627"><a href="/gostd/crypto/rsa/rsa.go.html#4743833">D</a></span><span class="op" id="4749628">.</span><span class="ident" id="4749629"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="4749633">(</span><span class="op" id="4749634">)</span>&nbsp;<span class="op" id="4749636">&lt;</span>&nbsp;<span class="num" id="4749638">0</span>&nbsp;<span class="op" id="4749640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4749646"><a href="/gostd/crypto/rsa/rsa.go.html#4747851">priv</a></span><span class="op" id="4749650">.</span><span class="ident" id="4749651"><a href="/gostd/crypto/rsa/rsa.go.html#4743833">D</a></span><span class="op" id="4749652">.</span><span class="ident" id="4749653"><a href="/gostd/math/big/int.go.html#2037987">Add</a></span><span class="op" id="4749656">(</span><span class="ident" id="4749657"><a href="/gostd/crypto/rsa/rsa.go.html#4747851">priv</a></span><span class="op" id="4749661">.</span><span class="ident" id="4749662"><a href="/gostd/crypto/rsa/rsa.go.html#4743833">D</a></span><span class="op" id="4749663">,</span>&nbsp;<span class="ident" id="4749665"><a href="/gostd/crypto/rsa/rsa.go.html#4749048">totient</a></span><span class="op" id="4749672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4749677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4749682"><a href="/gostd/crypto/rsa/rsa.go.html#4747851">priv</a></span><span class="op" id="4749686">.</span><span class="ident" id="4749687"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span>&nbsp;<span class="op" id="4749694">=</span>&nbsp;<span class="ident" id="4749696"><a href="/gostd/crypto/rsa/rsa.go.html#4748030">primes</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4749706"><a href="/gostd/crypto/rsa/rsa.go.html#4747851">priv</a></span><span class="op" id="4749710">.</span><span class="ident" id="4749711"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span>&nbsp;<span class="op" id="4749713">=</span>&nbsp;<span class="ident" id="4749715"><a href="/gostd/crypto/rsa/rsa.go.html#4749016">n</a></span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4749721">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4749729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4749732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4749736"><a href="/gostd/crypto/rsa/rsa.go.html#4747851">priv</a></span><span class="op" id="4749740">.</span><span class="ident" id="4749741"><a href="/gostd/crypto/rsa/rsa.go.html#4753012">Precompute</a></span><span class="op" id="4749751">(</span><span class="op" id="4749752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4749755">return</span><br>
<span class="lineno"></span><span class="op" id="4749762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4749765">//&nbsp;incCounter&nbsp;increments&nbsp;a&nbsp;four&nbsp;byte,&nbsp;big-endian&nbsp;counter.</span><br>
<span class="lineno">240</span><span class="keyword" id="4749823">func</span>&nbsp;<span class="ident" id="4749828">incCounter</span><span class="op" id="4749838">(</span><span class="ident" id="4749839">c</span>&nbsp;<span class="op" id="4749841">*</span><span class="op" id="4749842">[</span><span class="num" id="4749843">4</span><span class="op" id="4749844">]</span><span class="builtintype" id="4749845">byte</span><span class="op" id="4749849">)</span>&nbsp;<span class="op" id="4749851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4749854">if</span>&nbsp;<span class="ident" id="4749857"><a href="/gostd/crypto/rsa/rsa.go.html#4749839">c</a></span><span class="op" id="4749858">[</span><span class="num" id="4749859">3</span><span class="op" id="4749860">]</span><span class="op" id="4749861">++</span><span class="op" id="4749863">;</span>&nbsp;<span class="ident" id="4749865"><a href="/gostd/crypto/rsa/rsa.go.html#4749839">c</a></span><span class="op" id="4749866">[</span><span class="num" id="4749867">3</span><span class="op" id="4749868">]</span>&nbsp;<span class="op" id="4749870">!=</span>&nbsp;<span class="num" id="4749873">0</span>&nbsp;<span class="op" id="4749875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4749879">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4749887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4749890">if</span>&nbsp;<span class="ident" id="4749893"><a href="/gostd/crypto/rsa/rsa.go.html#4749839">c</a></span><span class="op" id="4749894">[</span><span class="num" id="4749895">2</span><span class="op" id="4749896">]</span><span class="op" id="4749897">++</span><span class="op" id="4749899">;</span>&nbsp;<span class="ident" id="4749901"><a href="/gostd/crypto/rsa/rsa.go.html#4749839">c</a></span><span class="op" id="4749902">[</span><span class="num" id="4749903">2</span><span class="op" id="4749904">]</span>&nbsp;<span class="op" id="4749906">!=</span>&nbsp;<span class="num" id="4749909">0</span>&nbsp;<span class="op" id="4749911">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4749915">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4749923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4749926">if</span>&nbsp;<span class="ident" id="4749929"><a href="/gostd/crypto/rsa/rsa.go.html#4749839">c</a></span><span class="op" id="4749930">[</span><span class="num" id="4749931">1</span><span class="op" id="4749932">]</span><span class="op" id="4749933">++</span><span class="op" id="4749935">;</span>&nbsp;<span class="ident" id="4749937"><a href="/gostd/crypto/rsa/rsa.go.html#4749839">c</a></span><span class="op" id="4749938">[</span><span class="num" id="4749939">1</span><span class="op" id="4749940">]</span>&nbsp;<span class="op" id="4749942">!=</span>&nbsp;<span class="num" id="4749945">0</span>&nbsp;<span class="op" id="4749947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4749951">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4749959">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4749962"><a href="/gostd/crypto/rsa/rsa.go.html#4749839">c</a></span><span class="op" id="4749963">[</span><span class="num" id="4749964">0</span><span class="op" id="4749965">]</span><span class="op" id="4749966">++</span><br>
<span class="lineno"></span><span class="op" id="4749969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4749972">//&nbsp;mgf1XOR&nbsp;XORs&nbsp;the&nbsp;bytes&nbsp;in&nbsp;out&nbsp;with&nbsp;a&nbsp;mask&nbsp;generated&nbsp;using&nbsp;the&nbsp;MGF1&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="4750051">//&nbsp;specified&nbsp;in&nbsp;PKCS#1&nbsp;v2.1.</span><br>
<span class="lineno">255</span><span class="keyword" id="4750080">func</span>&nbsp;<span class="ident" id="4750085">mgf1XOR</span><span class="op" id="4750092">(</span><span class="ident" id="4750093">out</span>&nbsp;<span class="op" id="4750097">[</span><span class="op" id="4750098">]</span><span class="builtintype" id="4750099">byte</span><span class="op" id="4750103">,</span>&nbsp;<span class="ident" id="4750105">hash</span>&nbsp;<span class="ident" id="4750110"><a href="/gostd/crypto/rsa/rsa.go.html#4742797">hash</a></span><span class="op" id="4750114">.</span><span class="ident" id="4750115"><a href="/gostd/hash/hash.go.html#3014105">Hash</a></span><span class="op" id="4750119">,</span>&nbsp;<span class="ident" id="4750121">seed</span>&nbsp;<span class="op" id="4750126">[</span><span class="op" id="4750127">]</span><span class="builtintype" id="4750128">byte</span><span class="op" id="4750132">)</span>&nbsp;<span class="op" id="4750134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4750137">var</span>&nbsp;<span class="ident" id="4750141">counter</span>&nbsp;<span class="op" id="4750149">[</span><span class="num" id="4750150">4</span><span class="op" id="4750151">]</span><span class="builtintype" id="4750152">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4750158">var</span>&nbsp;<span class="ident" id="4750162">digest</span>&nbsp;<span class="op" id="4750169">[</span><span class="op" id="4750170">]</span><span class="builtintype" id="4750171">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4750178">done</span>&nbsp;<span class="op" id="4750183">:=</span>&nbsp;<span class="num" id="4750186">0</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4750189">for</span>&nbsp;<span class="ident" id="4750193"><a href="/gostd/crypto/rsa/rsa.go.html#4750178">done</a></span>&nbsp;<span class="op" id="4750198">&lt;</span>&nbsp;<span class="builtinfunc" id="4750200">len</span><span class="op" id="4750203">(</span><span class="ident" id="4750204"><a href="/gostd/crypto/rsa/rsa.go.html#4750093">out</a></span><span class="op" id="4750207">)</span>&nbsp;<span class="op" id="4750209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4750213"><a href="/gostd/crypto/rsa/rsa.go.html#4750105">hash</a></span><span class="op" id="4750217">.</span><span class="ident" id="4750218"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4750223">(</span><span class="ident" id="4750224"><a href="/gostd/crypto/rsa/rsa.go.html#4750121">seed</a></span><span class="op" id="4750228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4750232"><a href="/gostd/crypto/rsa/rsa.go.html#4750105">hash</a></span><span class="op" id="4750236">.</span><span class="ident" id="4750237"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4750242">(</span><span class="ident" id="4750243"><a href="/gostd/crypto/rsa/rsa.go.html#4750141">counter</a></span><span class="op" id="4750250">[</span><span class="num" id="4750251">0</span><span class="op" id="4750252">:</span><span class="num" id="4750253">4</span><span class="op" id="4750254">]</span><span class="op" id="4750255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4750259"><a href="/gostd/crypto/rsa/rsa.go.html#4750162">digest</a></span>&nbsp;<span class="op" id="4750266">=</span>&nbsp;<span class="ident" id="4750268"><a href="/gostd/crypto/rsa/rsa.go.html#4750105">hash</a></span><span class="op" id="4750272">.</span><span class="ident" id="4750273"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4750276">(</span><span class="ident" id="4750277"><a href="/gostd/crypto/rsa/rsa.go.html#4750162">digest</a></span><span class="op" id="4750283">[</span><span class="op" id="4750284">:</span><span class="num" id="4750285">0</span><span class="op" id="4750286">]</span><span class="op" id="4750287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4750291"><a href="/gostd/crypto/rsa/rsa.go.html#4750105">hash</a></span><span class="op" id="4750295">.</span><span class="ident" id="4750296"><a href="/gostd/hash/hash.go.html#3014443">Reset</a></span><span class="op" id="4750301">(</span><span class="op" id="4750302">)</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4750307">for</span>&nbsp;<span class="ident" id="4750311">i</span>&nbsp;<span class="op" id="4750313">:=</span>&nbsp;<span class="num" id="4750316">0</span><span class="op" id="4750317">;</span>&nbsp;<span class="ident" id="4750319"><a href="/gostd/crypto/rsa/rsa.go.html#4750311">i</a></span>&nbsp;<span class="op" id="4750321">&lt;</span>&nbsp;<span class="builtinfunc" id="4750323">len</span><span class="op" id="4750326">(</span><span class="ident" id="4750327"><a href="/gostd/crypto/rsa/rsa.go.html#4750162">digest</a></span><span class="op" id="4750333">)</span>&nbsp;<span class="op" id="4750335">&amp;&amp;</span>&nbsp;<span class="ident" id="4750338"><a href="/gostd/crypto/rsa/rsa.go.html#4750178">done</a></span>&nbsp;<span class="op" id="4750343">&lt;</span>&nbsp;<span class="builtinfunc" id="4750345">len</span><span class="op" id="4750348">(</span><span class="ident" id="4750349"><a href="/gostd/crypto/rsa/rsa.go.html#4750093">out</a></span><span class="op" id="4750352">)</span><span class="op" id="4750353">;</span>&nbsp;<span class="ident" id="4750355"><a href="/gostd/crypto/rsa/rsa.go.html#4750311">i</a></span><span class="op" id="4750356">++</span>&nbsp;<span class="op" id="4750359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4750364"><a href="/gostd/crypto/rsa/rsa.go.html#4750093">out</a></span><span class="op" id="4750367">[</span><span class="ident" id="4750368"><a href="/gostd/crypto/rsa/rsa.go.html#4750178">done</a></span><span class="op" id="4750372">]</span>&nbsp;<span class="op" id="4750374">^=</span>&nbsp;<span class="ident" id="4750377"><a href="/gostd/crypto/rsa/rsa.go.html#4750162">digest</a></span><span class="op" id="4750383">[</span><span class="ident" id="4750384"><a href="/gostd/crypto/rsa/rsa.go.html#4750311">i</a></span><span class="op" id="4750385">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4750390"><a href="/gostd/crypto/rsa/rsa.go.html#4750178">done</a></span><span class="op" id="4750394">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4750399">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4750403"><a href="/gostd/crypto/rsa/rsa.go.html#4749828">incCounter</a></span><span class="op" id="4750413">(</span><span class="op" id="4750414">&amp;</span><span class="ident" id="4750415"><a href="/gostd/crypto/rsa/rsa.go.html#4750141">counter</a></span><span class="op" id="4750422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4750425">}</span><br>
<span class="lineno"></span><span class="op" id="4750427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4750430">//&nbsp;ErrMessageTooLong&nbsp;is&nbsp;returned&nbsp;when&nbsp;attempting&nbsp;to&nbsp;encrypt&nbsp;a&nbsp;message&nbsp;which&nbsp;is</span><br>
<span class="lineno">275</span><span class="comment" id="4750509">//&nbsp;too&nbsp;large&nbsp;for&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4750554">var</span>&nbsp;<span class="ident" id="4750558">ErrMessageTooLong</span>&nbsp;<span class="op" id="4750576">=</span>&nbsp;<span class="ident" id="4750578"><a href="/gostd/crypto/rsa/rsa.go.html#4742787">errors</a></span><span class="op" id="4750584">.</span><span class="ident" id="4750585"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4750588">(</span><span class="string" id="4750589">&#34;crypto/rsa:&nbsp;message&nbsp;too&nbsp;long&nbsp;for&nbsp;RSA&nbsp;public&nbsp;key&nbsp;size&#34;</span><span class="op" id="4750643">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4750646">func</span>&nbsp;<span class="ident" id="4750651">encrypt</span><span class="op" id="4750658">(</span><span class="ident" id="4750659">c</span>&nbsp;<span class="op" id="4750661">*</span><span class="ident" id="4750662"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4750665">.</span><span class="ident" id="4750666"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4750669">,</span>&nbsp;<span class="ident" id="4750671">pub</span>&nbsp;<span class="op" id="4750675">*</span><span class="ident" id="4750676"><a href="/gostd/crypto/rsa/rsa.go.html#4742943">PublicKey</a></span><span class="op" id="4750685">,</span>&nbsp;<span class="ident" id="4750687">m</span>&nbsp;<span class="op" id="4750689">*</span><span class="ident" id="4750690"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4750693">.</span><span class="ident" id="4750694"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4750697">)</span>&nbsp;<span class="op" id="4750699">*</span><span class="ident" id="4750700"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4750703">.</span><span class="ident" id="4750704"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span>&nbsp;<span class="op" id="4750708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4750711">e</span>&nbsp;<span class="op" id="4750713">:=</span>&nbsp;<span class="ident" id="4750716"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4750719">.</span><span class="ident" id="4750720"><a href="/gostd/math/big/int.go.html#2036655">NewInt</a></span><span class="op" id="4750726">(</span><span class="builtintype" id="4750727">int64</span><span class="op" id="4750732">(</span><span class="ident" id="4750733"><a href="/gostd/crypto/rsa/rsa.go.html#4750671">pub</a></span><span class="op" id="4750736">.</span><span class="ident" id="4750737"><a href="/gostd/crypto/rsa/rsa.go.html#4742986">E</a></span><span class="op" id="4750738">)</span><span class="op" id="4750739">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4750742"><a href="/gostd/crypto/rsa/rsa.go.html#4750659">c</a></span><span class="op" id="4750743">.</span><span class="ident" id="4750744"><a href="/gostd/math/big/int.go.html#2050632">Exp</a></span><span class="op" id="4750747">(</span><span class="ident" id="4750748"><a href="/gostd/crypto/rsa/rsa.go.html#4750687">m</a></span><span class="op" id="4750749">,</span>&nbsp;<span class="ident" id="4750751"><a href="/gostd/crypto/rsa/rsa.go.html#4750711">e</a></span><span class="op" id="4750752">,</span>&nbsp;<span class="ident" id="4750754"><a href="/gostd/crypto/rsa/rsa.go.html#4750671">pub</a></span><span class="op" id="4750757">.</span><span class="ident" id="4750758"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span><span class="op" id="4750759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4750762">return</span>&nbsp;<span class="ident" id="4750769"><a href="/gostd/crypto/rsa/rsa.go.html#4750659">c</a></span><br>
<span class="lineno"></span><span class="op" id="4750771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4750774">//&nbsp;EncryptOAEP&nbsp;encrypts&nbsp;the&nbsp;given&nbsp;message&nbsp;with&nbsp;RSA-OAEP.</span><br>
<span class="lineno">285</span><span class="comment" id="4750831">//&nbsp;The&nbsp;message&nbsp;must&nbsp;be&nbsp;no&nbsp;longer&nbsp;than&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;public&nbsp;modulus&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="4750907">//&nbsp;twice&nbsp;the&nbsp;hash&nbsp;length&nbsp;plus&nbsp;2.</span><br>
<span class="lineno"></span><span class="keyword" id="4750940">func</span>&nbsp;<span class="ident" id="4750945">EncryptOAEP</span><span class="op" id="4750956">(</span><span class="ident" id="4750957">hash</span>&nbsp;<span class="ident" id="4750962"><a href="/gostd/crypto/rsa/rsa.go.html#4742797">hash</a></span><span class="op" id="4750966">.</span><span class="ident" id="4750967"><a href="/gostd/hash/hash.go.html#3014105">Hash</a></span><span class="op" id="4750971">,</span>&nbsp;<span class="ident" id="4750973">random</span>&nbsp;<span class="ident" id="4750980"><a href="/gostd/crypto/rsa/rsa.go.html#4742805">io</a></span><span class="op" id="4750982">.</span><span class="ident" id="4750983"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="4750989">,</span>&nbsp;<span class="ident" id="4750991">pub</span>&nbsp;<span class="op" id="4750995">*</span><span class="ident" id="4750996"><a href="/gostd/crypto/rsa/rsa.go.html#4742943">PublicKey</a></span><span class="op" id="4751005">,</span>&nbsp;<span class="ident" id="4751007">msg</span>&nbsp;<span class="op" id="4751011">[</span><span class="op" id="4751012">]</span><span class="builtintype" id="4751013">byte</span><span class="op" id="4751017">,</span>&nbsp;<span class="ident" id="4751019">label</span>&nbsp;<span class="op" id="4751025">[</span><span class="op" id="4751026">]</span><span class="builtintype" id="4751027">byte</span><span class="op" id="4751031">)</span>&nbsp;<span class="op" id="4751033">(</span><span class="ident" id="4751034">out</span>&nbsp;<span class="op" id="4751038">[</span><span class="op" id="4751039">]</span><span class="builtintype" id="4751040">byte</span><span class="op" id="4751044">,</span>&nbsp;<span class="ident" id="4751046">err</span>&nbsp;<span class="builtintype" id="4751050">error</span><span class="op" id="4751055">)</span>&nbsp;<span class="op" id="4751057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4751060">if</span>&nbsp;<span class="ident" id="4751063">err</span>&nbsp;<span class="op" id="4751067">:=</span>&nbsp;<span class="ident" id="4751070"><a href="/gostd/crypto/rsa/rsa.go.html#4743527">checkPub</a></span><span class="op" id="4751078">(</span><span class="ident" id="4751079"><a href="/gostd/crypto/rsa/rsa.go.html#4750991">pub</a></span><span class="op" id="4751082">)</span><span class="op" id="4751083">;</span>&nbsp;<span class="ident" id="4751085"><a href="/gostd/crypto/rsa/rsa.go.html#4751063">err</a></span>&nbsp;<span class="op" id="4751089">!=</span>&nbsp;<span class="builtintype" id="4751092">nil</span>&nbsp;<span class="op" id="4751096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4751100">return</span>&nbsp;<span class="builtintype" id="4751107">nil</span><span class="op" id="4751110">,</span>&nbsp;<span class="ident" id="4751112"><a href="/gostd/crypto/rsa/rsa.go.html#4751063">err</a></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4751117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751120"><a href="/gostd/crypto/rsa/rsa.go.html#4750957">hash</a></span><span class="op" id="4751124">.</span><span class="ident" id="4751125"><a href="/gostd/hash/hash.go.html#3014443">Reset</a></span><span class="op" id="4751130">(</span><span class="op" id="4751131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751134">k</span>&nbsp;<span class="op" id="4751136">:=</span>&nbsp;<span class="op" id="4751139">(</span><span class="ident" id="4751140"><a href="/gostd/crypto/rsa/rsa.go.html#4750991">pub</a></span><span class="op" id="4751143">.</span><span class="ident" id="4751144"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span><span class="op" id="4751145">.</span><span class="ident" id="4751146"><a href="/gostd/math/big/int.go.html#2050389">BitLen</a></span><span class="op" id="4751152">(</span><span class="op" id="4751153">)</span>&nbsp;<span class="op" id="4751155">+</span>&nbsp;<span class="num" id="4751157">7</span><span class="op" id="4751158">)</span>&nbsp;<span class="op" id="4751160">/</span>&nbsp;<span class="num" id="4751162">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4751165">if</span>&nbsp;<span class="builtinfunc" id="4751168">len</span><span class="op" id="4751171">(</span><span class="ident" id="4751172"><a href="/gostd/crypto/rsa/rsa.go.html#4751007">msg</a></span><span class="op" id="4751175">)</span>&nbsp;<span class="op" id="4751177">&gt;</span>&nbsp;<span class="ident" id="4751179"><a href="/gostd/crypto/rsa/rsa.go.html#4751134">k</a></span><span class="op" id="4751180">-</span><span class="num" id="4751181">2</span><span class="op" id="4751182">*</span><span class="ident" id="4751183"><a href="/gostd/crypto/rsa/rsa.go.html#4750957">hash</a></span><span class="op" id="4751187">.</span><span class="ident" id="4751188"><a href="/gostd/hash/hash.go.html#3014507">Size</a></span><span class="op" id="4751192">(</span><span class="op" id="4751193">)</span><span class="op" id="4751194">-</span><span class="num" id="4751195">2</span>&nbsp;<span class="op" id="4751197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751201"><a href="/gostd/crypto/rsa/rsa.go.html#4751046">err</a></span>&nbsp;<span class="op" id="4751205">=</span>&nbsp;<span class="ident" id="4751207"><a href="/gostd/crypto/rsa/rsa.go.html#4750558">ErrMessageTooLong</a></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4751227">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4751235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751239"><a href="/gostd/crypto/rsa/rsa.go.html#4750957">hash</a></span><span class="op" id="4751243">.</span><span class="ident" id="4751244"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4751249">(</span><span class="ident" id="4751250"><a href="/gostd/crypto/rsa/rsa.go.html#4751019">label</a></span><span class="op" id="4751255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751258">lHash</span>&nbsp;<span class="op" id="4751264">:=</span>&nbsp;<span class="ident" id="4751267"><a href="/gostd/crypto/rsa/rsa.go.html#4750957">hash</a></span><span class="op" id="4751271">.</span><span class="ident" id="4751272"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4751275">(</span><span class="builtintype" id="4751276">nil</span><span class="op" id="4751279">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751282"><a href="/gostd/crypto/rsa/rsa.go.html#4750957">hash</a></span><span class="op" id="4751286">.</span><span class="ident" id="4751287"><a href="/gostd/hash/hash.go.html#3014443">Reset</a></span><span class="op" id="4751292">(</span><span class="op" id="4751293">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751297">em</span>&nbsp;<span class="op" id="4751300">:=</span>&nbsp;<span class="builtinfunc" id="4751303">make</span><span class="op" id="4751307">(</span><span class="op" id="4751308">[</span><span class="op" id="4751309">]</span><span class="builtintype" id="4751310">byte</span><span class="op" id="4751314">,</span>&nbsp;<span class="ident" id="4751316"><a href="/gostd/crypto/rsa/rsa.go.html#4751134">k</a></span><span class="op" id="4751317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751320">seed</span>&nbsp;<span class="op" id="4751325">:=</span>&nbsp;<span class="ident" id="4751328"><a href="/gostd/crypto/rsa/rsa.go.html#4751297">em</a></span><span class="op" id="4751330">[</span><span class="num" id="4751331">1</span>&nbsp;<span class="op" id="4751333">:</span>&nbsp;<span class="num" id="4751335">1</span><span class="op" id="4751336">+</span><span class="ident" id="4751337"><a href="/gostd/crypto/rsa/rsa.go.html#4750957">hash</a></span><span class="op" id="4751341">.</span><span class="ident" id="4751342"><a href="/gostd/hash/hash.go.html#3014507">Size</a></span><span class="op" id="4751346">(</span><span class="op" id="4751347">)</span><span class="op" id="4751348">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751351">db</span>&nbsp;<span class="op" id="4751354">:=</span>&nbsp;<span class="ident" id="4751357"><a href="/gostd/crypto/rsa/rsa.go.html#4751297">em</a></span><span class="op" id="4751359">[</span><span class="num" id="4751360">1</span><span class="op" id="4751361">+</span><span class="ident" id="4751362"><a href="/gostd/crypto/rsa/rsa.go.html#4750957">hash</a></span><span class="op" id="4751366">.</span><span class="ident" id="4751367"><a href="/gostd/hash/hash.go.html#3014507">Size</a></span><span class="op" id="4751371">(</span><span class="op" id="4751372">)</span><span class="op" id="4751373">:</span><span class="op" id="4751374">]</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4751378">copy</span><span class="op" id="4751382">(</span><span class="ident" id="4751383"><a href="/gostd/crypto/rsa/rsa.go.html#4751351">db</a></span><span class="op" id="4751385">[</span><span class="num" id="4751386">0</span><span class="op" id="4751387">:</span><span class="ident" id="4751388"><a href="/gostd/crypto/rsa/rsa.go.html#4750957">hash</a></span><span class="op" id="4751392">.</span><span class="ident" id="4751393"><a href="/gostd/hash/hash.go.html#3014507">Size</a></span><span class="op" id="4751397">(</span><span class="op" id="4751398">)</span><span class="op" id="4751399">]</span><span class="op" id="4751400">,</span>&nbsp;<span class="ident" id="4751402"><a href="/gostd/crypto/rsa/rsa.go.html#4751258">lHash</a></span><span class="op" id="4751407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751410"><a href="/gostd/crypto/rsa/rsa.go.html#4751351">db</a></span><span class="op" id="4751412">[</span><span class="builtinfunc" id="4751413">len</span><span class="op" id="4751416">(</span><span class="ident" id="4751417"><a href="/gostd/crypto/rsa/rsa.go.html#4751351">db</a></span><span class="op" id="4751419">)</span><span class="op" id="4751420">-</span><span class="builtinfunc" id="4751421">len</span><span class="op" id="4751424">(</span><span class="ident" id="4751425"><a href="/gostd/crypto/rsa/rsa.go.html#4751007">msg</a></span><span class="op" id="4751428">)</span><span class="op" id="4751429">-</span><span class="num" id="4751430">1</span><span class="op" id="4751431">]</span>&nbsp;<span class="op" id="4751433">=</span>&nbsp;<span class="num" id="4751435">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4751438">copy</span><span class="op" id="4751442">(</span><span class="ident" id="4751443"><a href="/gostd/crypto/rsa/rsa.go.html#4751351">db</a></span><span class="op" id="4751445">[</span><span class="builtinfunc" id="4751446">len</span><span class="op" id="4751449">(</span><span class="ident" id="4751450"><a href="/gostd/crypto/rsa/rsa.go.html#4751351">db</a></span><span class="op" id="4751452">)</span><span class="op" id="4751453">-</span><span class="builtinfunc" id="4751454">len</span><span class="op" id="4751457">(</span><span class="ident" id="4751458"><a href="/gostd/crypto/rsa/rsa.go.html#4751007">msg</a></span><span class="op" id="4751461">)</span><span class="op" id="4751462">:</span><span class="op" id="4751463">]</span><span class="op" id="4751464">,</span>&nbsp;<span class="ident" id="4751466"><a href="/gostd/crypto/rsa/rsa.go.html#4751007">msg</a></span><span class="op" id="4751469">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751473">_</span><span class="op" id="4751474">,</span>&nbsp;<span class="ident" id="4751476"><a href="/gostd/crypto/rsa/rsa.go.html#4751046">err</a></span>&nbsp;<span class="op" id="4751480">=</span>&nbsp;<span class="ident" id="4751482"><a href="/gostd/crypto/rsa/rsa.go.html#4742805">io</a></span><span class="op" id="4751484">.</span><span class="ident" id="4751485"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="4751493">(</span><span class="ident" id="4751494"><a href="/gostd/crypto/rsa/rsa.go.html#4750973">random</a></span><span class="op" id="4751500">,</span>&nbsp;<span class="ident" id="4751502"><a href="/gostd/crypto/rsa/rsa.go.html#4751320">seed</a></span><span class="op" id="4751506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4751509">if</span>&nbsp;<span class="ident" id="4751512"><a href="/gostd/crypto/rsa/rsa.go.html#4751046">err</a></span>&nbsp;<span class="op" id="4751516">!=</span>&nbsp;<span class="builtintype" id="4751519">nil</span>&nbsp;<span class="op" id="4751523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4751527">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4751535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751539"><a href="/gostd/crypto/rsa/rsa.go.html#4750085">mgf1XOR</a></span><span class="op" id="4751546">(</span><span class="ident" id="4751547"><a href="/gostd/crypto/rsa/rsa.go.html#4751351">db</a></span><span class="op" id="4751549">,</span>&nbsp;<span class="ident" id="4751551"><a href="/gostd/crypto/rsa/rsa.go.html#4750957">hash</a></span><span class="op" id="4751555">,</span>&nbsp;<span class="ident" id="4751557"><a href="/gostd/crypto/rsa/rsa.go.html#4751320">seed</a></span><span class="op" id="4751561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751564"><a href="/gostd/crypto/rsa/rsa.go.html#4750085">mgf1XOR</a></span><span class="op" id="4751571">(</span><span class="ident" id="4751572"><a href="/gostd/crypto/rsa/rsa.go.html#4751320">seed</a></span><span class="op" id="4751576">,</span>&nbsp;<span class="ident" id="4751578"><a href="/gostd/crypto/rsa/rsa.go.html#4750957">hash</a></span><span class="op" id="4751582">,</span>&nbsp;<span class="ident" id="4751584"><a href="/gostd/crypto/rsa/rsa.go.html#4751351">db</a></span><span class="op" id="4751586">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751590">m</span>&nbsp;<span class="op" id="4751592">:=</span>&nbsp;<span class="builtinfunc" id="4751595">new</span><span class="op" id="4751598">(</span><span class="ident" id="4751599"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4751602">.</span><span class="ident" id="4751603"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4751606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751609"><a href="/gostd/crypto/rsa/rsa.go.html#4751590">m</a></span><span class="op" id="4751610">.</span><span class="ident" id="4751611"><a href="/gostd/math/big/int.go.html#2050026">SetBytes</a></span><span class="op" id="4751619">(</span><span class="ident" id="4751620"><a href="/gostd/crypto/rsa/rsa.go.html#4751297">em</a></span><span class="op" id="4751622">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751625">c</span>&nbsp;<span class="op" id="4751627">:=</span>&nbsp;<span class="ident" id="4751630"><a href="/gostd/crypto/rsa/rsa.go.html#4750651">encrypt</a></span><span class="op" id="4751637">(</span><span class="builtinfunc" id="4751638">new</span><span class="op" id="4751641">(</span><span class="ident" id="4751642"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4751645">.</span><span class="ident" id="4751646"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4751649">)</span><span class="op" id="4751650">,</span>&nbsp;<span class="ident" id="4751652"><a href="/gostd/crypto/rsa/rsa.go.html#4750991">pub</a></span><span class="op" id="4751655">,</span>&nbsp;<span class="ident" id="4751657"><a href="/gostd/crypto/rsa/rsa.go.html#4751590">m</a></span><span class="op" id="4751658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751661"><a href="/gostd/crypto/rsa/rsa.go.html#4751034">out</a></span>&nbsp;<span class="op" id="4751665">=</span>&nbsp;<span class="ident" id="4751667"><a href="/gostd/crypto/rsa/rsa.go.html#4751625">c</a></span><span class="op" id="4751668">.</span><span class="ident" id="4751669"><a href="/gostd/math/big/int.go.html#2050194">Bytes</a></span><span class="op" id="4751674">(</span><span class="op" id="4751675">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4751679">if</span>&nbsp;<span class="builtinfunc" id="4751682">len</span><span class="op" id="4751685">(</span><span class="ident" id="4751686"><a href="/gostd/crypto/rsa/rsa.go.html#4751034">out</a></span><span class="op" id="4751689">)</span>&nbsp;<span class="op" id="4751691">&lt;</span>&nbsp;<span class="ident" id="4751693"><a href="/gostd/crypto/rsa/rsa.go.html#4751134">k</a></span>&nbsp;<span class="op" id="4751695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4751699">//&nbsp;If&nbsp;the&nbsp;output&nbsp;is&nbsp;too&nbsp;small,&nbsp;we&nbsp;need&nbsp;to&nbsp;left-pad&nbsp;with&nbsp;zeros.</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751764">t</span>&nbsp;<span class="op" id="4751766">:=</span>&nbsp;<span class="builtinfunc" id="4751769">make</span><span class="op" id="4751773">(</span><span class="op" id="4751774">[</span><span class="op" id="4751775">]</span><span class="builtintype" id="4751776">byte</span><span class="op" id="4751780">,</span>&nbsp;<span class="ident" id="4751782"><a href="/gostd/crypto/rsa/rsa.go.html#4751134">k</a></span><span class="op" id="4751783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4751787">copy</span><span class="op" id="4751791">(</span><span class="ident" id="4751792"><a href="/gostd/crypto/rsa/rsa.go.html#4751764">t</a></span><span class="op" id="4751793">[</span><span class="ident" id="4751794"><a href="/gostd/crypto/rsa/rsa.go.html#4751134">k</a></span><span class="op" id="4751795">-</span><span class="builtinfunc" id="4751796">len</span><span class="op" id="4751799">(</span><span class="ident" id="4751800"><a href="/gostd/crypto/rsa/rsa.go.html#4751034">out</a></span><span class="op" id="4751803">)</span><span class="op" id="4751804">:</span><span class="op" id="4751805">]</span><span class="op" id="4751806">,</span>&nbsp;<span class="ident" id="4751808"><a href="/gostd/crypto/rsa/rsa.go.html#4751034">out</a></span><span class="op" id="4751811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751815"><a href="/gostd/crypto/rsa/rsa.go.html#4751034">out</a></span>&nbsp;<span class="op" id="4751819">=</span>&nbsp;<span class="ident" id="4751821"><a href="/gostd/crypto/rsa/rsa.go.html#4751764">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4751824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4751828">return</span><br>
<span class="lineno"></span><span class="op" id="4751835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4751838">//&nbsp;ErrDecryption&nbsp;represents&nbsp;a&nbsp;failure&nbsp;to&nbsp;decrypt&nbsp;a&nbsp;message.</span><br>
<span class="lineno"></span><span class="comment" id="4751898">//&nbsp;It&nbsp;is&nbsp;deliberately&nbsp;vague&nbsp;to&nbsp;avoid&nbsp;adaptive&nbsp;attacks.</span><br>
<span class="lineno">335</span><span class="keyword" id="4751953">var</span>&nbsp;<span class="ident" id="4751957">ErrDecryption</span>&nbsp;<span class="op" id="4751971">=</span>&nbsp;<span class="ident" id="4751973"><a href="/gostd/crypto/rsa/rsa.go.html#4742787">errors</a></span><span class="op" id="4751979">.</span><span class="ident" id="4751980"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4751983">(</span><span class="string" id="4751984">&#34;crypto/rsa:&nbsp;decryption&nbsp;error&#34;</span><span class="op" id="4752014">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4752017">//&nbsp;ErrVerification&nbsp;represents&nbsp;a&nbsp;failure&nbsp;to&nbsp;verify&nbsp;a&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="4752080">//&nbsp;It&nbsp;is&nbsp;deliberately&nbsp;vague&nbsp;to&nbsp;avoid&nbsp;adaptive&nbsp;attacks.</span><br>
<span class="lineno"></span><span class="keyword" id="4752135">var</span>&nbsp;<span class="ident" id="4752139">ErrVerification</span>&nbsp;<span class="op" id="4752155">=</span>&nbsp;<span class="ident" id="4752157"><a href="/gostd/crypto/rsa/rsa.go.html#4742787">errors</a></span><span class="op" id="4752163">.</span><span class="ident" id="4752164"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4752167">(</span><span class="string" id="4752168">&#34;crypto/rsa:&nbsp;verification&nbsp;error&#34;</span><span class="op" id="4752200">)</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="comment" id="4752203">//&nbsp;modInverse&nbsp;returns&nbsp;ia,&nbsp;the&nbsp;inverse&nbsp;of&nbsp;a&nbsp;in&nbsp;the&nbsp;multiplicative&nbsp;group&nbsp;of&nbsp;prime</span><br>
<span class="lineno"></span><span class="comment" id="4752283">//&nbsp;order&nbsp;n.&nbsp;It&nbsp;requires&nbsp;that&nbsp;a&nbsp;be&nbsp;a&nbsp;member&nbsp;of&nbsp;the&nbsp;group&nbsp;(i.e.&nbsp;less&nbsp;than&nbsp;n).</span><br>
<span class="lineno"></span><span class="keyword" id="4752359">func</span>&nbsp;<span class="ident" id="4752364">modInverse</span><span class="op" id="4752374">(</span><span class="ident" id="4752375">a</span><span class="op" id="4752376">,</span>&nbsp;<span class="ident" id="4752378">n</span>&nbsp;<span class="op" id="4752380">*</span><span class="ident" id="4752381"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4752384">.</span><span class="ident" id="4752385"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4752388">)</span>&nbsp;<span class="op" id="4752390">(</span><span class="ident" id="4752391">ia</span>&nbsp;<span class="op" id="4752394">*</span><span class="ident" id="4752395"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4752398">.</span><span class="ident" id="4752399"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4752402">,</span>&nbsp;<span class="ident" id="4752404">ok</span>&nbsp;<span class="builtintype" id="4752407">bool</span><span class="op" id="4752411">)</span>&nbsp;<span class="op" id="4752413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4752416">g</span>&nbsp;<span class="op" id="4752418">:=</span>&nbsp;<span class="builtinfunc" id="4752421">new</span><span class="op" id="4752424">(</span><span class="ident" id="4752425"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4752428">.</span><span class="ident" id="4752429"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4752432">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4752435">x</span>&nbsp;<span class="op" id="4752437">:=</span>&nbsp;<span class="builtinfunc" id="4752440">new</span><span class="op" id="4752443">(</span><span class="ident" id="4752444"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4752447">.</span><span class="ident" id="4752448"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4752451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4752454">y</span>&nbsp;<span class="op" id="4752456">:=</span>&nbsp;<span class="builtinfunc" id="4752459">new</span><span class="op" id="4752462">(</span><span class="ident" id="4752463"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4752466">.</span><span class="ident" id="4752467"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4752470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4752473"><a href="/gostd/crypto/rsa/rsa.go.html#4752416">g</a></span><span class="op" id="4752474">.</span><span class="ident" id="4752475"><a href="/gostd/math/big/int.go.html#2051339">GCD</a></span><span class="op" id="4752478">(</span><span class="ident" id="4752479"><a href="/gostd/crypto/rsa/rsa.go.html#4752435">x</a></span><span class="op" id="4752480">,</span>&nbsp;<span class="ident" id="4752482"><a href="/gostd/crypto/rsa/rsa.go.html#4752454">y</a></span><span class="op" id="4752483">,</span>&nbsp;<span class="ident" id="4752485"><a href="/gostd/crypto/rsa/rsa.go.html#4752375">a</a></span><span class="op" id="4752486">,</span>&nbsp;<span class="ident" id="4752488"><a href="/gostd/crypto/rsa/rsa.go.html#4752378">n</a></span><span class="op" id="4752489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4752492">if</span>&nbsp;<span class="ident" id="4752495"><a href="/gostd/crypto/rsa/rsa.go.html#4752416">g</a></span><span class="op" id="4752496">.</span><span class="ident" id="4752497"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="4752500">(</span><span class="ident" id="4752501"><a href="/gostd/crypto/rsa/rsa.go.html#4742857">bigOne</a></span><span class="op" id="4752507">)</span>&nbsp;<span class="op" id="4752509">!=</span>&nbsp;<span class="num" id="4752512">0</span>&nbsp;<span class="op" id="4752514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4752518">//&nbsp;In&nbsp;this&nbsp;case,&nbsp;a&nbsp;and&nbsp;n&nbsp;aren&#39;t&nbsp;coprime&nbsp;and&nbsp;we&nbsp;cannot&nbsp;calculate</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4752584">//&nbsp;the&nbsp;inverse.&nbsp;This&nbsp;happens&nbsp;because&nbsp;the&nbsp;values&nbsp;of&nbsp;n&nbsp;are&nbsp;nearly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4752650">//&nbsp;prime&nbsp;(being&nbsp;the&nbsp;product&nbsp;of&nbsp;two&nbsp;primes)&nbsp;rather&nbsp;than&nbsp;truly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4752713">//&nbsp;prime.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4752725">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4752733">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4752737">if</span>&nbsp;<span class="ident" id="4752740"><a href="/gostd/crypto/rsa/rsa.go.html#4752435">x</a></span><span class="op" id="4752741">.</span><span class="ident" id="4752742"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="4752745">(</span><span class="ident" id="4752746"><a href="/gostd/crypto/rsa/rsa.go.html#4742857">bigOne</a></span><span class="op" id="4752752">)</span>&nbsp;<span class="op" id="4752754">&lt;</span>&nbsp;<span class="num" id="4752756">0</span>&nbsp;<span class="op" id="4752758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4752762">//&nbsp;0&nbsp;is&nbsp;not&nbsp;the&nbsp;multiplicative&nbsp;inverse&nbsp;of&nbsp;any&nbsp;element&nbsp;so,&nbsp;if&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4752827">//&nbsp;&lt;&nbsp;1,&nbsp;then&nbsp;x&nbsp;is&nbsp;negative.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4752857"><a href="/gostd/crypto/rsa/rsa.go.html#4752435">x</a></span><span class="op" id="4752858">.</span><span class="ident" id="4752859"><a href="/gostd/math/big/int.go.html#2037987">Add</a></span><span class="op" id="4752862">(</span><span class="ident" id="4752863"><a href="/gostd/crypto/rsa/rsa.go.html#4752435">x</a></span><span class="op" id="4752864">,</span>&nbsp;<span class="ident" id="4752866"><a href="/gostd/crypto/rsa/rsa.go.html#4752378">n</a></span><span class="op" id="4752867">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4752870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4752874">return</span>&nbsp;<span class="ident" id="4752881"><a href="/gostd/crypto/rsa/rsa.go.html#4752435">x</a></span><span class="op" id="4752882">,</span>&nbsp;<span class="builtintype" id="4752884">true</span><br>
<span class="lineno"></span><span class="op" id="4752889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="4752892">//&nbsp;Precompute&nbsp;performs&nbsp;some&nbsp;calculations&nbsp;that&nbsp;speed&nbsp;up&nbsp;private&nbsp;key&nbsp;operations</span><br>
<span class="lineno"></span><span class="comment" id="4752970">//&nbsp;in&nbsp;the&nbsp;future.</span><br>
<span class="lineno"></span><span class="keyword" id="4752988">func</span>&nbsp;<span class="op" id="4752993">(</span><span class="ident" id="4752994">priv</span>&nbsp;<span class="op" id="4752999">*</span><span class="ident" id="4753000"><a href="/gostd/crypto/rsa/rsa.go.html#4743774">PrivateKey</a></span><span class="op" id="4753010">)</span>&nbsp;<span class="ident" id="4753012">Precompute</span><span class="op" id="4753022">(</span><span class="op" id="4753023">)</span>&nbsp;<span class="op" id="4753025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4753028">if</span>&nbsp;<span class="ident" id="4753031"><a href="/gostd/crypto/rsa/rsa.go.html#4752994">priv</a></span><span class="op" id="4753035">.</span><span class="ident" id="4753036"><a href="/gostd/crypto/rsa/rsa.go.html#4744036">Precomputed</a></span><span class="op" id="4753047">.</span><span class="ident" id="4753048"><a href="/gostd/crypto/rsa/rsa.go.html#4744835">Dp</a></span>&nbsp;<span class="op" id="4753051">!=</span>&nbsp;<span class="builtintype" id="4753054">nil</span>&nbsp;<span class="op" id="4753058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4753062">return</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4753070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4753074"><a href="/gostd/crypto/rsa/rsa.go.html#4752994">priv</a></span><span class="op" id="4753078">.</span><span class="ident" id="4753079"><a href="/gostd/crypto/rsa/rsa.go.html#4744036">Precomputed</a></span><span class="op" id="4753090">.</span><span class="ident" id="4753091"><a href="/gostd/crypto/rsa/rsa.go.html#4744835">Dp</a></span>&nbsp;<span class="op" id="4753094">=</span>&nbsp;<span class="builtinfunc" id="4753096">new</span><span class="op" id="4753099">(</span><span class="ident" id="4753100"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4753103">.</span><span class="ident" id="4753104"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4753107">)</span><span class="op" id="4753108">.</span><span class="ident" id="4753109"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="4753112">(</span><span class="ident" id="4753113"><a href="/gostd/crypto/rsa/rsa.go.html#4752994">priv</a></span><span class="op" id="4753117">.</span><span class="ident" id="4753118"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="4753124">[</span><span class="num" id="4753125">0</span><span class="op" id="4753126">]</span><span class="op" id="4753127">,</span>&nbsp;<span class="ident" id="4753129"><a href="/gostd/crypto/rsa/rsa.go.html#4742857">bigOne</a></span><span class="op" id="4753135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4753138"><a href="/gostd/crypto/rsa/rsa.go.html#4752994">priv</a></span><span class="op" id="4753142">.</span><span class="ident" id="4753143"><a href="/gostd/crypto/rsa/rsa.go.html#4744036">Precomputed</a></span><span class="op" id="4753154">.</span><span class="ident" id="4753155"><a href="/gostd/crypto/rsa/rsa.go.html#4744835">Dp</a></span><span class="op" id="4753157">.</span><span class="ident" id="4753158"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="4753161">(</span><span class="ident" id="4753162"><a href="/gostd/crypto/rsa/rsa.go.html#4752994">priv</a></span><span class="op" id="4753166">.</span><span class="ident" id="4753167"><a href="/gostd/crypto/rsa/rsa.go.html#4743833">D</a></span><span class="op" id="4753168">,</span>&nbsp;<span class="ident" id="4753170"><a href="/gostd/crypto/rsa/rsa.go.html#4752994">priv</a></span><span class="op" id="4753174">.</span><span class="ident" id="4753175"><a href="/gostd/crypto/rsa/rsa.go.html#4744036">Precomputed</a></span><span class="op" id="4753186">.</span><span class="ident" id="4753187"><a href="/gostd/crypto/rsa/rsa.go.html#4744835">Dp</a></span><span class="op" id="4753189">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4753193"><a href="/gostd/crypto/rsa/rsa.go.html#4752994">priv</a></span><span class="op" id="4753197">.</span><span class="ident" id="4753198"><a href="/gostd/crypto/rsa/rsa.go.html#4744036">Precomputed</a></span><span class="op" id="4753209">.</span><span class="ident" id="4753210"><a href="/gostd/crypto/rsa/rsa.go.html#4744839">Dq</a></span>&nbsp;<span class="op" id="4753213">=</span>&nbsp;<span class="builtinfunc" id="4753215">new</span><span class="op" id="4753218">(</span><span class="ident" id="4753219"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4753222">.</span><span class="ident" id="4753223"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4753226">)</span><span class="op" id="4753227">.</span><span class="ident" id="4753228"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="4753231">(</span><span class="ident" id="4753232"><a href="/gostd/crypto/rsa/rsa.go.html#4752994">priv</a></span><span class="op" id="4753236">.</span><span class="ident" id="4753237"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="4753243">[</span><span class="num" id="4753244">1</span><span class="op" id="4753245">]</span><span class="op" id="4753246">,</span>&nbsp;<span class="ident" id="4753248"><a href="/gostd/crypto/rsa/rsa.go.html#4742857">bigOne</a></span><span class="op" id="4753254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4753257"><a href="/gostd/crypto/rsa/rsa.go.html#4752994">priv</a></span><span class="op" id="4753261">.</span><span class="ident" id="4753262"><a href="/gostd/crypto/rsa/rsa.go.html#4744036">Precomputed</a></span><span class="op" id="4753273">.</span><span class="ident" id="4753274"><a href="/gostd/crypto/rsa/rsa.go.html#4744839">Dq</a></span><span class="op" id="4753276">.</span><span class="ident" id="4753277"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="4753280">(</span><span class="ident" id="4753281"><a href="/gostd/crypto/rsa/rsa.go.html#4752994">priv</a></span><span class="op" id="4753285">.</span><span class="ident" id="4753286"><a href="/gostd/crypto/rsa/rsa.go.html#4743833">D</a></span><span class="op" id="4753287">,</span>&nbsp;<span class="ident" id="4753289"><a href="/gostd/crypto/rsa/rsa.go.html#4752994">priv</a></span><span class="op" id="4753293">.</span><span class="ident" id="4753294"><a href="/gostd/crypto/rsa/rsa.go.html#4744036">Precomputed</a></span><span class="op" id="4753305">.</span><span class="ident" id="4753306"><a href="/gostd/crypto/rsa/rsa.go.html#4744839">Dq</a></span><span class="op" id="4753308">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4753312"><a href="/gostd/crypto/rsa/rsa.go.html#4752994">priv</a></span><span class="op" id="4753316">.</span><span class="ident" id="4753317"><a href="/gostd/crypto/rsa/rsa.go.html#4744036">Precomputed</a></span><span class="op" id="4753328">.</span><span class="ident" id="4753329"><a href="/gostd/crypto/rsa/rsa.go.html#4744880">Qinv</a></span>&nbsp;<span class="op" id="4753334">=</span>&nbsp;<span class="builtinfunc" id="4753336">new</span><span class="op" id="4753339">(</span><span class="ident" id="4753340"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4753343">.</span><span class="ident" id="4753344"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4753347">)</span><span class="op" id="4753348">.</span><span class="ident" id="4753349"><a href="/gostd/math/big/int.go.html#2053864">ModInverse</a></span><span class="op" id="4753359">(</span><span class="ident" id="4753360"><a href="/gostd/crypto/rsa/rsa.go.html#4752994">priv</a></span><span class="op" id="4753364">.</span><span class="ident" id="4753365"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="4753371">[</span><span class="num" id="4753372">1</span><span class="op" id="4753373">]</span><span class="op" id="4753374">,</span>&nbsp;<span class="ident" id="4753376"><a href="/gostd/crypto/rsa/rsa.go.html#4752994">priv</a></span><span class="op" id="4753380">.</span><span class="ident" id="4753381"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="4753387">[</span><span class="num" id="4753388">0</span><span class="op" id="4753389">]</span><span class="op" id="4753390">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4753394">r</span>&nbsp;<span class="op" id="4753396">:=</span>&nbsp;<span class="builtinfunc" id="4753399">new</span><span class="op" id="4753402">(</span><span class="ident" id="4753403"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4753406">.</span><span class="ident" id="4753407"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4753410">)</span><span class="op" id="4753411">.</span><span class="ident" id="4753412"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="4753415">(</span><span class="ident" id="4753416"><a href="/gostd/crypto/rsa/rsa.go.html#4752994">priv</a></span><span class="op" id="4753420">.</span><span class="ident" id="4753421"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="4753427">[</span><span class="num" id="4753428">0</span><span class="op" id="4753429">]</span><span class="op" id="4753430">,</span>&nbsp;<span class="ident" id="4753432"><a href="/gostd/crypto/rsa/rsa.go.html#4752994">priv</a></span><span class="op" id="4753436">.</span><span class="ident" id="4753437"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="4753443">[</span><span class="num" id="4753444">1</span><span class="op" id="4753445">]</span><span class="op" id="4753446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4753449"><a href="/gostd/crypto/rsa/rsa.go.html#4752994">priv</a></span><span class="op" id="4753453">.</span><span class="ident" id="4753454"><a href="/gostd/crypto/rsa/rsa.go.html#4744036">Precomputed</a></span><span class="op" id="4753465">.</span><span class="ident" id="4753466"><a href="/gostd/crypto/rsa/rsa.go.html#4745145">CRTValues</a></span>&nbsp;<span class="op" id="4753476">=</span>&nbsp;<span class="builtinfunc" id="4753478">make</span><span class="op" id="4753482">(</span><span class="op" id="4753483">[</span><span class="op" id="4753484">]</span><span class="ident" id="4753485"><a href="/gostd/crypto/rsa/rsa.go.html#4745245">CRTValue</a></span><span class="op" id="4753493">,</span>&nbsp;<span class="builtinfunc" id="4753495">len</span><span class="op" id="4753498">(</span><span class="ident" id="4753499"><a href="/gostd/crypto/rsa/rsa.go.html#4752994">priv</a></span><span class="op" id="4753503">.</span><span class="ident" id="4753504"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="4753510">)</span><span class="op" id="4753511">-</span><span class="num" id="4753512">2</span><span class="op" id="4753513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4753516">for</span>&nbsp;<span class="ident" id="4753520">i</span>&nbsp;<span class="op" id="4753522">:=</span>&nbsp;<span class="num" id="4753525">2</span><span class="op" id="4753526">;</span>&nbsp;<span class="ident" id="4753528"><a href="/gostd/crypto/rsa/rsa.go.html#4753520">i</a></span>&nbsp;<span class="op" id="4753530">&lt;</span>&nbsp;<span class="builtinfunc" id="4753532">len</span><span class="op" id="4753535">(</span><span class="ident" id="4753536"><a href="/gostd/crypto/rsa/rsa.go.html#4752994">priv</a></span><span class="op" id="4753540">.</span><span class="ident" id="4753541"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="4753547">)</span><span class="op" id="4753548">;</span>&nbsp;<span class="ident" id="4753550"><a href="/gostd/crypto/rsa/rsa.go.html#4753520">i</a></span><span class="op" id="4753551">++</span>&nbsp;<span class="op" id="4753554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4753558">prime</span>&nbsp;<span class="op" id="4753564">:=</span>&nbsp;<span class="ident" id="4753567"><a href="/gostd/crypto/rsa/rsa.go.html#4752994">priv</a></span><span class="op" id="4753571">.</span><span class="ident" id="4753572"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="4753578">[</span><span class="ident" id="4753579"><a href="/gostd/crypto/rsa/rsa.go.html#4753520">i</a></span><span class="op" id="4753580">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4753584">values</span>&nbsp;<span class="op" id="4753591">:=</span>&nbsp;<span class="op" id="4753594">&amp;</span><span class="ident" id="4753595"><a href="/gostd/crypto/rsa/rsa.go.html#4752994">priv</a></span><span class="op" id="4753599">.</span><span class="ident" id="4753600"><a href="/gostd/crypto/rsa/rsa.go.html#4744036">Precomputed</a></span><span class="op" id="4753611">.</span><span class="ident" id="4753612"><a href="/gostd/crypto/rsa/rsa.go.html#4745145">CRTValues</a></span><span class="op" id="4753621">[</span><span class="ident" id="4753622"><a href="/gostd/crypto/rsa/rsa.go.html#4753520">i</a></span><span class="op" id="4753623">-</span><span class="num" id="4753624">2</span><span class="op" id="4753625">]</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4753630"><a href="/gostd/crypto/rsa/rsa.go.html#4753584">values</a></span><span class="op" id="4753636">.</span><span class="ident" id="4753637"><a href="/gostd/crypto/rsa/rsa.go.html#4745264">Exp</a></span>&nbsp;<span class="op" id="4753641">=</span>&nbsp;<span class="builtinfunc" id="4753643">new</span><span class="op" id="4753646">(</span><span class="ident" id="4753647"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4753650">.</span><span class="ident" id="4753651"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4753654">)</span><span class="op" id="4753655">.</span><span class="ident" id="4753656"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="4753659">(</span><span class="ident" id="4753660"><a href="/gostd/crypto/rsa/rsa.go.html#4753558">prime</a></span><span class="op" id="4753665">,</span>&nbsp;<span class="ident" id="4753667"><a href="/gostd/crypto/rsa/rsa.go.html#4742857">bigOne</a></span><span class="op" id="4753673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4753677"><a href="/gostd/crypto/rsa/rsa.go.html#4753584">values</a></span><span class="op" id="4753683">.</span><span class="ident" id="4753684"><a href="/gostd/crypto/rsa/rsa.go.html#4745264">Exp</a></span><span class="op" id="4753687">.</span><span class="ident" id="4753688"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="4753691">(</span><span class="ident" id="4753692"><a href="/gostd/crypto/rsa/rsa.go.html#4752994">priv</a></span><span class="op" id="4753696">.</span><span class="ident" id="4753697"><a href="/gostd/crypto/rsa/rsa.go.html#4743833">D</a></span><span class="op" id="4753698">,</span>&nbsp;<span class="ident" id="4753700"><a href="/gostd/crypto/rsa/rsa.go.html#4753584">values</a></span><span class="op" id="4753706">.</span><span class="ident" id="4753707"><a href="/gostd/crypto/rsa/rsa.go.html#4745264">Exp</a></span><span class="op" id="4753710">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4753715"><a href="/gostd/crypto/rsa/rsa.go.html#4753584">values</a></span><span class="op" id="4753721">.</span><span class="ident" id="4753722"><a href="/gostd/crypto/rsa/rsa.go.html#4745345">R</a></span>&nbsp;<span class="op" id="4753724">=</span>&nbsp;<span class="builtinfunc" id="4753726">new</span><span class="op" id="4753729">(</span><span class="ident" id="4753730"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4753733">.</span><span class="ident" id="4753734"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4753737">)</span><span class="op" id="4753738">.</span><span class="ident" id="4753739"><a href="/gostd/math/big/int.go.html#2036758">Set</a></span><span class="op" id="4753742">(</span><span class="ident" id="4753743"><a href="/gostd/crypto/rsa/rsa.go.html#4753394">r</a></span><span class="op" id="4753744">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4753748"><a href="/gostd/crypto/rsa/rsa.go.html#4753584">values</a></span><span class="op" id="4753754">.</span><span class="ident" id="4753755"><a href="/gostd/crypto/rsa/rsa.go.html#4745300">Coeff</a></span>&nbsp;<span class="op" id="4753761">=</span>&nbsp;<span class="builtinfunc" id="4753763">new</span><span class="op" id="4753766">(</span><span class="ident" id="4753767"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4753770">.</span><span class="ident" id="4753771"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4753774">)</span><span class="op" id="4753775">.</span><span class="ident" id="4753776"><a href="/gostd/math/big/int.go.html#2053864">ModInverse</a></span><span class="op" id="4753786">(</span><span class="ident" id="4753787"><a href="/gostd/crypto/rsa/rsa.go.html#4753394">r</a></span><span class="op" id="4753788">,</span>&nbsp;<span class="ident" id="4753790"><a href="/gostd/crypto/rsa/rsa.go.html#4753558">prime</a></span><span class="op" id="4753795">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4753800"><a href="/gostd/crypto/rsa/rsa.go.html#4753394">r</a></span><span class="op" id="4753801">.</span><span class="ident" id="4753802"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="4753805">(</span><span class="ident" id="4753806"><a href="/gostd/crypto/rsa/rsa.go.html#4753394">r</a></span><span class="op" id="4753807">,</span>&nbsp;<span class="ident" id="4753809"><a href="/gostd/crypto/rsa/rsa.go.html#4753558">prime</a></span><span class="op" id="4753814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4753817">}</span><br>
<span class="lineno"></span><span class="op" id="4753819">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="4753822">//&nbsp;decrypt&nbsp;performs&nbsp;an&nbsp;RSA&nbsp;decryption,&nbsp;resulting&nbsp;in&nbsp;a&nbsp;plaintext&nbsp;integer.&nbsp;If&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4753900">//&nbsp;random&nbsp;source&nbsp;is&nbsp;given,&nbsp;RSA&nbsp;blinding&nbsp;is&nbsp;used.</span><br>
<span class="lineno"></span><span class="keyword" id="4753949">func</span>&nbsp;<span class="ident" id="4753954">decrypt</span><span class="op" id="4753961">(</span><span class="ident" id="4753962">random</span>&nbsp;<span class="ident" id="4753969"><a href="/gostd/crypto/rsa/rsa.go.html#4742805">io</a></span><span class="op" id="4753971">.</span><span class="ident" id="4753972"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="4753978">,</span>&nbsp;<span class="ident" id="4753980">priv</span>&nbsp;<span class="op" id="4753985">*</span><span class="ident" id="4753986"><a href="/gostd/crypto/rsa/rsa.go.html#4743774">PrivateKey</a></span><span class="op" id="4753996">,</span>&nbsp;<span class="ident" id="4753998">c</span>&nbsp;<span class="op" id="4754000">*</span><span class="ident" id="4754001"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4754004">.</span><span class="ident" id="4754005"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4754008">)</span>&nbsp;<span class="op" id="4754010">(</span><span class="ident" id="4754011">m</span>&nbsp;<span class="op" id="4754013">*</span><span class="ident" id="4754014"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4754017">.</span><span class="ident" id="4754018"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4754021">,</span>&nbsp;<span class="ident" id="4754023">err</span>&nbsp;<span class="builtintype" id="4754027">error</span><span class="op" id="4754032">)</span>&nbsp;<span class="op" id="4754034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4754037">//&nbsp;TODO(agl):&nbsp;can&nbsp;we&nbsp;get&nbsp;away&nbsp;with&nbsp;reusing&nbsp;blinds?</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4754089">if</span>&nbsp;<span class="ident" id="4754092"><a href="/gostd/crypto/rsa/rsa.go.html#4753998">c</a></span><span class="op" id="4754093">.</span><span class="ident" id="4754094"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="4754097">(</span><span class="ident" id="4754098"><a href="/gostd/crypto/rsa/rsa.go.html#4753980">priv</a></span><span class="op" id="4754102">.</span><span class="ident" id="4754103"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span><span class="op" id="4754104">)</span>&nbsp;<span class="op" id="4754106">&gt;</span>&nbsp;<span class="num" id="4754108">0</span>&nbsp;<span class="op" id="4754110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4754114"><a href="/gostd/crypto/rsa/rsa.go.html#4754023">err</a></span>&nbsp;<span class="op" id="4754118">=</span>&nbsp;<span class="ident" id="4754120"><a href="/gostd/crypto/rsa/rsa.go.html#4751957">ErrDecryption</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4754136">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4754144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4754148">var</span>&nbsp;<span class="ident" id="4754152">ir</span>&nbsp;<span class="op" id="4754155">*</span><span class="ident" id="4754156"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4754159">.</span><span class="ident" id="4754160"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4754165">if</span>&nbsp;<span class="ident" id="4754168"><a href="/gostd/crypto/rsa/rsa.go.html#4753962">random</a></span>&nbsp;<span class="op" id="4754175">!=</span>&nbsp;<span class="builtintype" id="4754178">nil</span>&nbsp;<span class="op" id="4754182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4754186">//&nbsp;Blinding&nbsp;enabled.&nbsp;Blinding&nbsp;involves&nbsp;multiplying&nbsp;c&nbsp;by&nbsp;r^e.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4754249">//&nbsp;Then&nbsp;the&nbsp;decryption&nbsp;operation&nbsp;performs&nbsp;(m^e&nbsp;*&nbsp;r^e)^d&nbsp;mod&nbsp;n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4754313">//&nbsp;which&nbsp;equals&nbsp;mr&nbsp;mod&nbsp;n.&nbsp;The&nbsp;factor&nbsp;of&nbsp;r&nbsp;can&nbsp;then&nbsp;be&nbsp;removed</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4754377">//&nbsp;by&nbsp;multiplying&nbsp;by&nbsp;the&nbsp;multiplicative&nbsp;inverse&nbsp;of&nbsp;r.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4754434">var</span>&nbsp;<span class="ident" id="4754438">r</span>&nbsp;<span class="op" id="4754440">*</span><span class="ident" id="4754441"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4754444">.</span><span class="ident" id="4754445"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4754452">for</span>&nbsp;<span class="op" id="4754456">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4754461"><a href="/gostd/crypto/rsa/rsa.go.html#4754438">r</a></span><span class="op" id="4754462">,</span>&nbsp;<span class="ident" id="4754464"><a href="/gostd/crypto/rsa/rsa.go.html#4754023">err</a></span>&nbsp;<span class="op" id="4754468">=</span>&nbsp;<span class="ident" id="4754470"><a href="/gostd/crypto/rsa/rsa.go.html#4742755">rand</a></span><span class="op" id="4754474">.</span><span class="ident" id="4754475"><a href="/gostd/crypto/rand/util.go.html#4363421">Int</a></span><span class="op" id="4754478">(</span><span class="ident" id="4754479"><a href="/gostd/crypto/rsa/rsa.go.html#4753962">random</a></span><span class="op" id="4754485">,</span>&nbsp;<span class="ident" id="4754487"><a href="/gostd/crypto/rsa/rsa.go.html#4753980">priv</a></span><span class="op" id="4754491">.</span><span class="ident" id="4754492"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span><span class="op" id="4754493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4754498">if</span>&nbsp;<span class="ident" id="4754501"><a href="/gostd/crypto/rsa/rsa.go.html#4754023">err</a></span>&nbsp;<span class="op" id="4754505">!=</span>&nbsp;<span class="builtintype" id="4754508">nil</span>&nbsp;<span class="op" id="4754512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4754518">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4754528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4754533">if</span>&nbsp;<span class="ident" id="4754536"><a href="/gostd/crypto/rsa/rsa.go.html#4754438">r</a></span><span class="op" id="4754537">.</span><span class="ident" id="4754538"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="4754541">(</span><span class="ident" id="4754542"><a href="/gostd/crypto/rsa/rsa.go.html#4742829">bigZero</a></span><span class="op" id="4754549">)</span>&nbsp;<span class="op" id="4754551">==</span>&nbsp;<span class="num" id="4754554">0</span>&nbsp;<span class="op" id="4754556">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4754562"><a href="/gostd/crypto/rsa/rsa.go.html#4754438">r</a></span>&nbsp;<span class="op" id="4754564">=</span>&nbsp;<span class="ident" id="4754566"><a href="/gostd/crypto/rsa/rsa.go.html#4742857">bigOne</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4754576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4754581">var</span>&nbsp;<span class="ident" id="4754585">ok</span>&nbsp;<span class="builtintype" id="4754588">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4754596"><a href="/gostd/crypto/rsa/rsa.go.html#4754152">ir</a></span><span class="op" id="4754598">,</span>&nbsp;<span class="ident" id="4754600"><a href="/gostd/crypto/rsa/rsa.go.html#4754585">ok</a></span>&nbsp;<span class="op" id="4754603">=</span>&nbsp;<span class="ident" id="4754605"><a href="/gostd/crypto/rsa/rsa.go.html#4752364">modInverse</a></span><span class="op" id="4754615">(</span><span class="ident" id="4754616"><a href="/gostd/crypto/rsa/rsa.go.html#4754438">r</a></span><span class="op" id="4754617">,</span>&nbsp;<span class="ident" id="4754619"><a href="/gostd/crypto/rsa/rsa.go.html#4753980">priv</a></span><span class="op" id="4754623">.</span><span class="ident" id="4754624"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span><span class="op" id="4754625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4754630">if</span>&nbsp;<span class="ident" id="4754633"><a href="/gostd/crypto/rsa/rsa.go.html#4754585">ok</a></span>&nbsp;<span class="op" id="4754636">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4754642">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4754651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4754655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4754659">bigE</span>&nbsp;<span class="op" id="4754664">:=</span>&nbsp;<span class="ident" id="4754667"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4754670">.</span><span class="ident" id="4754671"><a href="/gostd/math/big/int.go.html#2036655">NewInt</a></span><span class="op" id="4754677">(</span><span class="builtintype" id="4754678">int64</span><span class="op" id="4754683">(</span><span class="ident" id="4754684"><a href="/gostd/crypto/rsa/rsa.go.html#4753980">priv</a></span><span class="op" id="4754688">.</span><span class="ident" id="4754689"><a href="/gostd/crypto/rsa/rsa.go.html#4742986">E</a></span><span class="op" id="4754690">)</span><span class="op" id="4754691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4754695">rpowe</span>&nbsp;<span class="op" id="4754701">:=</span>&nbsp;<span class="builtinfunc" id="4754704">new</span><span class="op" id="4754707">(</span><span class="ident" id="4754708"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4754711">.</span><span class="ident" id="4754712"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4754715">)</span><span class="op" id="4754716">.</span><span class="ident" id="4754717"><a href="/gostd/math/big/int.go.html#2050632">Exp</a></span><span class="op" id="4754720">(</span><span class="ident" id="4754721"><a href="/gostd/crypto/rsa/rsa.go.html#4754438">r</a></span><span class="op" id="4754722">,</span>&nbsp;<span class="ident" id="4754724"><a href="/gostd/crypto/rsa/rsa.go.html#4754659">bigE</a></span><span class="op" id="4754728">,</span>&nbsp;<span class="ident" id="4754730"><a href="/gostd/crypto/rsa/rsa.go.html#4753980">priv</a></span><span class="op" id="4754734">.</span><span class="ident" id="4754735"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span><span class="op" id="4754736">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4754740">cCopy</span>&nbsp;<span class="op" id="4754746">:=</span>&nbsp;<span class="builtinfunc" id="4754749">new</span><span class="op" id="4754752">(</span><span class="ident" id="4754753"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4754756">.</span><span class="ident" id="4754757"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4754760">)</span><span class="op" id="4754761">.</span><span class="ident" id="4754762"><a href="/gostd/math/big/int.go.html#2036758">Set</a></span><span class="op" id="4754765">(</span><span class="ident" id="4754766"><a href="/gostd/crypto/rsa/rsa.go.html#4753998">c</a></span><span class="op" id="4754767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4754771"><a href="/gostd/crypto/rsa/rsa.go.html#4754740">cCopy</a></span><span class="op" id="4754776">.</span><span class="ident" id="4754777"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="4754780">(</span><span class="ident" id="4754781"><a href="/gostd/crypto/rsa/rsa.go.html#4754740">cCopy</a></span><span class="op" id="4754786">,</span>&nbsp;<span class="ident" id="4754788"><a href="/gostd/crypto/rsa/rsa.go.html#4754695">rpowe</a></span><span class="op" id="4754793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4754797"><a href="/gostd/crypto/rsa/rsa.go.html#4754740">cCopy</a></span><span class="op" id="4754802">.</span><span class="ident" id="4754803"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="4754806">(</span><span class="ident" id="4754807"><a href="/gostd/crypto/rsa/rsa.go.html#4754740">cCopy</a></span><span class="op" id="4754812">,</span>&nbsp;<span class="ident" id="4754814"><a href="/gostd/crypto/rsa/rsa.go.html#4753980">priv</a></span><span class="op" id="4754818">.</span><span class="ident" id="4754819"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span><span class="op" id="4754820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4754824"><a href="/gostd/crypto/rsa/rsa.go.html#4753998">c</a></span>&nbsp;<span class="op" id="4754826">=</span>&nbsp;<span class="ident" id="4754828"><a href="/gostd/crypto/rsa/rsa.go.html#4754740">cCopy</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4754835">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4754839">if</span>&nbsp;<span class="ident" id="4754842"><a href="/gostd/crypto/rsa/rsa.go.html#4753980">priv</a></span><span class="op" id="4754846">.</span><span class="ident" id="4754847"><a href="/gostd/crypto/rsa/rsa.go.html#4744036">Precomputed</a></span><span class="op" id="4754858">.</span><span class="ident" id="4754859"><a href="/gostd/crypto/rsa/rsa.go.html#4744835">Dp</a></span>&nbsp;<span class="op" id="4754862">==</span>&nbsp;<span class="builtintype" id="4754865">nil</span>&nbsp;<span class="op" id="4754869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4754873"><a href="/gostd/crypto/rsa/rsa.go.html#4754011">m</a></span>&nbsp;<span class="op" id="4754875">=</span>&nbsp;<span class="builtinfunc" id="4754877">new</span><span class="op" id="4754880">(</span><span class="ident" id="4754881"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4754884">.</span><span class="ident" id="4754885"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4754888">)</span><span class="op" id="4754889">.</span><span class="ident" id="4754890"><a href="/gostd/math/big/int.go.html#2050632">Exp</a></span><span class="op" id="4754893">(</span><span class="ident" id="4754894"><a href="/gostd/crypto/rsa/rsa.go.html#4753998">c</a></span><span class="op" id="4754895">,</span>&nbsp;<span class="ident" id="4754897"><a href="/gostd/crypto/rsa/rsa.go.html#4753980">priv</a></span><span class="op" id="4754901">.</span><span class="ident" id="4754902"><a href="/gostd/crypto/rsa/rsa.go.html#4743833">D</a></span><span class="op" id="4754903">,</span>&nbsp;<span class="ident" id="4754905"><a href="/gostd/crypto/rsa/rsa.go.html#4753980">priv</a></span><span class="op" id="4754909">.</span><span class="ident" id="4754910"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span><span class="op" id="4754911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4754914">}</span>&nbsp;<span class="keyword" id="4754916">else</span>&nbsp;<span class="op" id="4754921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4754925">//&nbsp;We&nbsp;have&nbsp;the&nbsp;precalculated&nbsp;values&nbsp;needed&nbsp;for&nbsp;the&nbsp;CRT.</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4754983"><a href="/gostd/crypto/rsa/rsa.go.html#4754011">m</a></span>&nbsp;<span class="op" id="4754985">=</span>&nbsp;<span class="builtinfunc" id="4754987">new</span><span class="op" id="4754990">(</span><span class="ident" id="4754991"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4754994">.</span><span class="ident" id="4754995"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4754998">)</span><span class="op" id="4754999">.</span><span class="ident" id="4755000"><a href="/gostd/math/big/int.go.html#2050632">Exp</a></span><span class="op" id="4755003">(</span><span class="ident" id="4755004"><a href="/gostd/crypto/rsa/rsa.go.html#4753998">c</a></span><span class="op" id="4755005">,</span>&nbsp;<span class="ident" id="4755007"><a href="/gostd/crypto/rsa/rsa.go.html#4753980">priv</a></span><span class="op" id="4755011">.</span><span class="ident" id="4755012"><a href="/gostd/crypto/rsa/rsa.go.html#4744036">Precomputed</a></span><span class="op" id="4755023">.</span><span class="ident" id="4755024"><a href="/gostd/crypto/rsa/rsa.go.html#4744835">Dp</a></span><span class="op" id="4755026">,</span>&nbsp;<span class="ident" id="4755028"><a href="/gostd/crypto/rsa/rsa.go.html#4753980">priv</a></span><span class="op" id="4755032">.</span><span class="ident" id="4755033"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="4755039">[</span><span class="num" id="4755040">0</span><span class="op" id="4755041">]</span><span class="op" id="4755042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755046">m2</span>&nbsp;<span class="op" id="4755049">:=</span>&nbsp;<span class="builtinfunc" id="4755052">new</span><span class="op" id="4755055">(</span><span class="ident" id="4755056"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4755059">.</span><span class="ident" id="4755060"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4755063">)</span><span class="op" id="4755064">.</span><span class="ident" id="4755065"><a href="/gostd/math/big/int.go.html#2050632">Exp</a></span><span class="op" id="4755068">(</span><span class="ident" id="4755069"><a href="/gostd/crypto/rsa/rsa.go.html#4753998">c</a></span><span class="op" id="4755070">,</span>&nbsp;<span class="ident" id="4755072"><a href="/gostd/crypto/rsa/rsa.go.html#4753980">priv</a></span><span class="op" id="4755076">.</span><span class="ident" id="4755077"><a href="/gostd/crypto/rsa/rsa.go.html#4744036">Precomputed</a></span><span class="op" id="4755088">.</span><span class="ident" id="4755089"><a href="/gostd/crypto/rsa/rsa.go.html#4744839">Dq</a></span><span class="op" id="4755091">,</span>&nbsp;<span class="ident" id="4755093"><a href="/gostd/crypto/rsa/rsa.go.html#4753980">priv</a></span><span class="op" id="4755097">.</span><span class="ident" id="4755098"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="4755104">[</span><span class="num" id="4755105">1</span><span class="op" id="4755106">]</span><span class="op" id="4755107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755111"><a href="/gostd/crypto/rsa/rsa.go.html#4754011">m</a></span><span class="op" id="4755112">.</span><span class="ident" id="4755113"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="4755116">(</span><span class="ident" id="4755117"><a href="/gostd/crypto/rsa/rsa.go.html#4754011">m</a></span><span class="op" id="4755118">,</span>&nbsp;<span class="ident" id="4755120"><a href="/gostd/crypto/rsa/rsa.go.html#4755046">m2</a></span><span class="op" id="4755122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4755126">if</span>&nbsp;<span class="ident" id="4755129"><a href="/gostd/crypto/rsa/rsa.go.html#4754011">m</a></span><span class="op" id="4755130">.</span><span class="ident" id="4755131"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="4755135">(</span><span class="op" id="4755136">)</span>&nbsp;<span class="op" id="4755138">&lt;</span>&nbsp;<span class="num" id="4755140">0</span>&nbsp;<span class="op" id="4755142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755147"><a href="/gostd/crypto/rsa/rsa.go.html#4754011">m</a></span><span class="op" id="4755148">.</span><span class="ident" id="4755149"><a href="/gostd/math/big/int.go.html#2037987">Add</a></span><span class="op" id="4755152">(</span><span class="ident" id="4755153"><a href="/gostd/crypto/rsa/rsa.go.html#4754011">m</a></span><span class="op" id="4755154">,</span>&nbsp;<span class="ident" id="4755156"><a href="/gostd/crypto/rsa/rsa.go.html#4753980">priv</a></span><span class="op" id="4755160">.</span><span class="ident" id="4755161"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="4755167">[</span><span class="num" id="4755168">0</span><span class="op" id="4755169">]</span><span class="op" id="4755170">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4755174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755178"><a href="/gostd/crypto/rsa/rsa.go.html#4754011">m</a></span><span class="op" id="4755179">.</span><span class="ident" id="4755180"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="4755183">(</span><span class="ident" id="4755184"><a href="/gostd/crypto/rsa/rsa.go.html#4754011">m</a></span><span class="op" id="4755185">,</span>&nbsp;<span class="ident" id="4755187"><a href="/gostd/crypto/rsa/rsa.go.html#4753980">priv</a></span><span class="op" id="4755191">.</span><span class="ident" id="4755192"><a href="/gostd/crypto/rsa/rsa.go.html#4744036">Precomputed</a></span><span class="op" id="4755203">.</span><span class="ident" id="4755204"><a href="/gostd/crypto/rsa/rsa.go.html#4744880">Qinv</a></span><span class="op" id="4755208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755212"><a href="/gostd/crypto/rsa/rsa.go.html#4754011">m</a></span><span class="op" id="4755213">.</span><span class="ident" id="4755214"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="4755217">(</span><span class="ident" id="4755218"><a href="/gostd/crypto/rsa/rsa.go.html#4754011">m</a></span><span class="op" id="4755219">,</span>&nbsp;<span class="ident" id="4755221"><a href="/gostd/crypto/rsa/rsa.go.html#4753980">priv</a></span><span class="op" id="4755225">.</span><span class="ident" id="4755226"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="4755232">[</span><span class="num" id="4755233">0</span><span class="op" id="4755234">]</span><span class="op" id="4755235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755239"><a href="/gostd/crypto/rsa/rsa.go.html#4754011">m</a></span><span class="op" id="4755240">.</span><span class="ident" id="4755241"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="4755244">(</span><span class="ident" id="4755245"><a href="/gostd/crypto/rsa/rsa.go.html#4754011">m</a></span><span class="op" id="4755246">,</span>&nbsp;<span class="ident" id="4755248"><a href="/gostd/crypto/rsa/rsa.go.html#4753980">priv</a></span><span class="op" id="4755252">.</span><span class="ident" id="4755253"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="4755259">[</span><span class="num" id="4755260">1</span><span class="op" id="4755261">]</span><span class="op" id="4755262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755266"><a href="/gostd/crypto/rsa/rsa.go.html#4754011">m</a></span><span class="op" id="4755267">.</span><span class="ident" id="4755268"><a href="/gostd/math/big/int.go.html#2037987">Add</a></span><span class="op" id="4755271">(</span><span class="ident" id="4755272"><a href="/gostd/crypto/rsa/rsa.go.html#4754011">m</a></span><span class="op" id="4755273">,</span>&nbsp;<span class="ident" id="4755275"><a href="/gostd/crypto/rsa/rsa.go.html#4755046">m2</a></span><span class="op" id="4755277">)</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4755282">for</span>&nbsp;<span class="ident" id="4755286">i</span><span class="op" id="4755287">,</span>&nbsp;<span class="ident" id="4755289">values</span>&nbsp;<span class="op" id="4755296">:=</span>&nbsp;<span class="keyword" id="4755299">range</span>&nbsp;<span class="ident" id="4755305"><a href="/gostd/crypto/rsa/rsa.go.html#4753980">priv</a></span><span class="op" id="4755309">.</span><span class="ident" id="4755310"><a href="/gostd/crypto/rsa/rsa.go.html#4744036">Precomputed</a></span><span class="op" id="4755321">.</span><span class="ident" id="4755322"><a href="/gostd/crypto/rsa/rsa.go.html#4745145">CRTValues</a></span>&nbsp;<span class="op" id="4755332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755337">prime</span>&nbsp;<span class="op" id="4755343">:=</span>&nbsp;<span class="ident" id="4755346"><a href="/gostd/crypto/rsa/rsa.go.html#4753980">priv</a></span><span class="op" id="4755350">.</span><span class="ident" id="4755351"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="4755357">[</span><span class="num" id="4755358">2</span><span class="op" id="4755359">+</span><span class="ident" id="4755360"><a href="/gostd/crypto/rsa/rsa.go.html#4755286">i</a></span><span class="op" id="4755361">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755366"><a href="/gostd/crypto/rsa/rsa.go.html#4755046">m2</a></span><span class="op" id="4755368">.</span><span class="ident" id="4755369"><a href="/gostd/math/big/int.go.html#2050632">Exp</a></span><span class="op" id="4755372">(</span><span class="ident" id="4755373"><a href="/gostd/crypto/rsa/rsa.go.html#4753998">c</a></span><span class="op" id="4755374">,</span>&nbsp;<span class="ident" id="4755376"><a href="/gostd/crypto/rsa/rsa.go.html#4755289">values</a></span><span class="op" id="4755382">.</span><span class="ident" id="4755383"><a href="/gostd/crypto/rsa/rsa.go.html#4745264">Exp</a></span><span class="op" id="4755386">,</span>&nbsp;<span class="ident" id="4755388"><a href="/gostd/crypto/rsa/rsa.go.html#4755337">prime</a></span><span class="op" id="4755393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755398"><a href="/gostd/crypto/rsa/rsa.go.html#4755046">m2</a></span><span class="op" id="4755400">.</span><span class="ident" id="4755401"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="4755404">(</span><span class="ident" id="4755405"><a href="/gostd/crypto/rsa/rsa.go.html#4755046">m2</a></span><span class="op" id="4755407">,</span>&nbsp;<span class="ident" id="4755409"><a href="/gostd/crypto/rsa/rsa.go.html#4754011">m</a></span><span class="op" id="4755410">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755415"><a href="/gostd/crypto/rsa/rsa.go.html#4755046">m2</a></span><span class="op" id="4755417">.</span><span class="ident" id="4755418"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="4755421">(</span><span class="ident" id="4755422"><a href="/gostd/crypto/rsa/rsa.go.html#4755046">m2</a></span><span class="op" id="4755424">,</span>&nbsp;<span class="ident" id="4755426"><a href="/gostd/crypto/rsa/rsa.go.html#4755289">values</a></span><span class="op" id="4755432">.</span><span class="ident" id="4755433"><a href="/gostd/crypto/rsa/rsa.go.html#4745300">Coeff</a></span><span class="op" id="4755438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755443"><a href="/gostd/crypto/rsa/rsa.go.html#4755046">m2</a></span><span class="op" id="4755445">.</span><span class="ident" id="4755446"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="4755449">(</span><span class="ident" id="4755450"><a href="/gostd/crypto/rsa/rsa.go.html#4755046">m2</a></span><span class="op" id="4755452">,</span>&nbsp;<span class="ident" id="4755454"><a href="/gostd/crypto/rsa/rsa.go.html#4755337">prime</a></span><span class="op" id="4755459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4755464">if</span>&nbsp;<span class="ident" id="4755467"><a href="/gostd/crypto/rsa/rsa.go.html#4755046">m2</a></span><span class="op" id="4755469">.</span><span class="ident" id="4755470"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="4755474">(</span><span class="op" id="4755475">)</span>&nbsp;<span class="op" id="4755477">&lt;</span>&nbsp;<span class="num" id="4755479">0</span>&nbsp;<span class="op" id="4755481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755487"><a href="/gostd/crypto/rsa/rsa.go.html#4755046">m2</a></span><span class="op" id="4755489">.</span><span class="ident" id="4755490"><a href="/gostd/math/big/int.go.html#2037987">Add</a></span><span class="op" id="4755493">(</span><span class="ident" id="4755494"><a href="/gostd/crypto/rsa/rsa.go.html#4755046">m2</a></span><span class="op" id="4755496">,</span>&nbsp;<span class="ident" id="4755498"><a href="/gostd/crypto/rsa/rsa.go.html#4755337">prime</a></span><span class="op" id="4755503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4755508">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755513"><a href="/gostd/crypto/rsa/rsa.go.html#4755046">m2</a></span><span class="op" id="4755515">.</span><span class="ident" id="4755516"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="4755519">(</span><span class="ident" id="4755520"><a href="/gostd/crypto/rsa/rsa.go.html#4755046">m2</a></span><span class="op" id="4755522">,</span>&nbsp;<span class="ident" id="4755524"><a href="/gostd/crypto/rsa/rsa.go.html#4755289">values</a></span><span class="op" id="4755530">.</span><span class="ident" id="4755531"><a href="/gostd/crypto/rsa/rsa.go.html#4745345">R</a></span><span class="op" id="4755532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755537"><a href="/gostd/crypto/rsa/rsa.go.html#4754011">m</a></span><span class="op" id="4755538">.</span><span class="ident" id="4755539"><a href="/gostd/math/big/int.go.html#2037987">Add</a></span><span class="op" id="4755542">(</span><span class="ident" id="4755543"><a href="/gostd/crypto/rsa/rsa.go.html#4754011">m</a></span><span class="op" id="4755544">,</span>&nbsp;<span class="ident" id="4755546"><a href="/gostd/crypto/rsa/rsa.go.html#4755046">m2</a></span><span class="op" id="4755548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4755552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4755555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4755559">if</span>&nbsp;<span class="ident" id="4755562"><a href="/gostd/crypto/rsa/rsa.go.html#4754152">ir</a></span>&nbsp;<span class="op" id="4755565">!=</span>&nbsp;<span class="builtintype" id="4755568">nil</span>&nbsp;<span class="op" id="4755572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4755576">//&nbsp;Unblind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755590"><a href="/gostd/crypto/rsa/rsa.go.html#4754011">m</a></span><span class="op" id="4755591">.</span><span class="ident" id="4755592"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="4755595">(</span><span class="ident" id="4755596"><a href="/gostd/crypto/rsa/rsa.go.html#4754011">m</a></span><span class="op" id="4755597">,</span>&nbsp;<span class="ident" id="4755599"><a href="/gostd/crypto/rsa/rsa.go.html#4754152">ir</a></span><span class="op" id="4755601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755605"><a href="/gostd/crypto/rsa/rsa.go.html#4754011">m</a></span><span class="op" id="4755606">.</span><span class="ident" id="4755607"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="4755610">(</span><span class="ident" id="4755611"><a href="/gostd/crypto/rsa/rsa.go.html#4754011">m</a></span><span class="op" id="4755612">,</span>&nbsp;<span class="ident" id="4755614"><a href="/gostd/crypto/rsa/rsa.go.html#4753980">priv</a></span><span class="op" id="4755618">.</span><span class="ident" id="4755619"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span><span class="op" id="4755620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4755623">}</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4755627">return</span><br>
<span class="lineno"></span><span class="op" id="4755634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4755637">//&nbsp;DecryptOAEP&nbsp;decrypts&nbsp;ciphertext&nbsp;using&nbsp;RSA-OAEP.</span><br>
<span class="lineno">475</span><span class="comment" id="4755688">//&nbsp;If&nbsp;random&nbsp;!=&nbsp;nil,&nbsp;DecryptOAEP&nbsp;uses&nbsp;RSA&nbsp;blinding&nbsp;to&nbsp;avoid&nbsp;timing&nbsp;side-channel&nbsp;attacks.</span><br>
<span class="lineno"></span><span class="keyword" id="4755777">func</span>&nbsp;<span class="ident" id="4755782">DecryptOAEP</span><span class="op" id="4755793">(</span><span class="ident" id="4755794">hash</span>&nbsp;<span class="ident" id="4755799"><a href="/gostd/crypto/rsa/rsa.go.html#4742797">hash</a></span><span class="op" id="4755803">.</span><span class="ident" id="4755804"><a href="/gostd/hash/hash.go.html#3014105">Hash</a></span><span class="op" id="4755808">,</span>&nbsp;<span class="ident" id="4755810">random</span>&nbsp;<span class="ident" id="4755817"><a href="/gostd/crypto/rsa/rsa.go.html#4742805">io</a></span><span class="op" id="4755819">.</span><span class="ident" id="4755820"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="4755826">,</span>&nbsp;<span class="ident" id="4755828">priv</span>&nbsp;<span class="op" id="4755833">*</span><span class="ident" id="4755834"><a href="/gostd/crypto/rsa/rsa.go.html#4743774">PrivateKey</a></span><span class="op" id="4755844">,</span>&nbsp;<span class="ident" id="4755846">ciphertext</span>&nbsp;<span class="op" id="4755857">[</span><span class="op" id="4755858">]</span><span class="builtintype" id="4755859">byte</span><span class="op" id="4755863">,</span>&nbsp;<span class="ident" id="4755865">label</span>&nbsp;<span class="op" id="4755871">[</span><span class="op" id="4755872">]</span><span class="builtintype" id="4755873">byte</span><span class="op" id="4755877">)</span>&nbsp;<span class="op" id="4755879">(</span><span class="ident" id="4755880">msg</span>&nbsp;<span class="op" id="4755884">[</span><span class="op" id="4755885">]</span><span class="builtintype" id="4755886">byte</span><span class="op" id="4755890">,</span>&nbsp;<span class="ident" id="4755892">err</span>&nbsp;<span class="builtintype" id="4755896">error</span><span class="op" id="4755901">)</span>&nbsp;<span class="op" id="4755903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4755906">if</span>&nbsp;<span class="ident" id="4755909">err</span>&nbsp;<span class="op" id="4755913">:=</span>&nbsp;<span class="ident" id="4755916"><a href="/gostd/crypto/rsa/rsa.go.html#4743527">checkPub</a></span><span class="op" id="4755924">(</span><span class="op" id="4755925">&amp;</span><span class="ident" id="4755926"><a href="/gostd/crypto/rsa/rsa.go.html#4755828">priv</a></span><span class="op" id="4755930">.</span><span class="ident" id="4755931"><a href="/gostd/crypto/rsa/rsa.go.html#4743795">PublicKey</a></span><span class="op" id="4755940">)</span><span class="op" id="4755941">;</span>&nbsp;<span class="ident" id="4755943"><a href="/gostd/crypto/rsa/rsa.go.html#4755909">err</a></span>&nbsp;<span class="op" id="4755947">!=</span>&nbsp;<span class="builtintype" id="4755950">nil</span>&nbsp;<span class="op" id="4755954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4755958">return</span>&nbsp;<span class="builtintype" id="4755965">nil</span><span class="op" id="4755968">,</span>&nbsp;<span class="ident" id="4755970"><a href="/gostd/crypto/rsa/rsa.go.html#4755909">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4755975">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755978">k</span>&nbsp;<span class="op" id="4755980">:=</span>&nbsp;<span class="op" id="4755983">(</span><span class="ident" id="4755984"><a href="/gostd/crypto/rsa/rsa.go.html#4755828">priv</a></span><span class="op" id="4755988">.</span><span class="ident" id="4755989"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span><span class="op" id="4755990">.</span><span class="ident" id="4755991"><a href="/gostd/math/big/int.go.html#2050389">BitLen</a></span><span class="op" id="4755997">(</span><span class="op" id="4755998">)</span>&nbsp;<span class="op" id="4756000">+</span>&nbsp;<span class="num" id="4756002">7</span><span class="op" id="4756003">)</span>&nbsp;<span class="op" id="4756005">/</span>&nbsp;<span class="num" id="4756007">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4756010">if</span>&nbsp;<span class="builtinfunc" id="4756013">len</span><span class="op" id="4756016">(</span><span class="ident" id="4756017"><a href="/gostd/crypto/rsa/rsa.go.html#4755846">ciphertext</a></span><span class="op" id="4756027">)</span>&nbsp;<span class="op" id="4756029">&gt;</span>&nbsp;<span class="ident" id="4756031"><a href="/gostd/crypto/rsa/rsa.go.html#4755978">k</a></span>&nbsp;<span class="op" id="4756033">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756038"><a href="/gostd/crypto/rsa/rsa.go.html#4755978">k</a></span>&nbsp;<span class="op" id="4756040">&lt;</span>&nbsp;<span class="ident" id="4756042"><a href="/gostd/crypto/rsa/rsa.go.html#4755794">hash</a></span><span class="op" id="4756046">.</span><span class="ident" id="4756047"><a href="/gostd/hash/hash.go.html#3014507">Size</a></span><span class="op" id="4756051">(</span><span class="op" id="4756052">)</span><span class="op" id="4756053">*</span><span class="num" id="4756054">2</span><span class="op" id="4756055">+</span><span class="num" id="4756056">2</span>&nbsp;<span class="op" id="4756058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756062"><a href="/gostd/crypto/rsa/rsa.go.html#4755892">err</a></span>&nbsp;<span class="op" id="4756066">=</span>&nbsp;<span class="ident" id="4756068"><a href="/gostd/crypto/rsa/rsa.go.html#4751957">ErrDecryption</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4756084">return</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4756092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756096">c</span>&nbsp;<span class="op" id="4756098">:=</span>&nbsp;<span class="builtinfunc" id="4756101">new</span><span class="op" id="4756104">(</span><span class="ident" id="4756105"><a href="/gostd/crypto/rsa/rsa.go.html#4742811">big</a></span><span class="op" id="4756108">.</span><span class="ident" id="4756109"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="4756112">)</span><span class="op" id="4756113">.</span><span class="ident" id="4756114"><a href="/gostd/math/big/int.go.html#2050026">SetBytes</a></span><span class="op" id="4756122">(</span><span class="ident" id="4756123"><a href="/gostd/crypto/rsa/rsa.go.html#4755846">ciphertext</a></span><span class="op" id="4756133">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756137">m</span><span class="op" id="4756138">,</span>&nbsp;<span class="ident" id="4756140"><a href="/gostd/crypto/rsa/rsa.go.html#4755892">err</a></span>&nbsp;<span class="op" id="4756144">:=</span>&nbsp;<span class="ident" id="4756147"><a href="/gostd/crypto/rsa/rsa.go.html#4753954">decrypt</a></span><span class="op" id="4756154">(</span><span class="ident" id="4756155"><a href="/gostd/crypto/rsa/rsa.go.html#4755810">random</a></span><span class="op" id="4756161">,</span>&nbsp;<span class="ident" id="4756163"><a href="/gostd/crypto/rsa/rsa.go.html#4755828">priv</a></span><span class="op" id="4756167">,</span>&nbsp;<span class="ident" id="4756169"><a href="/gostd/crypto/rsa/rsa.go.html#4756096">c</a></span><span class="op" id="4756170">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4756173">if</span>&nbsp;<span class="ident" id="4756176"><a href="/gostd/crypto/rsa/rsa.go.html#4755892">err</a></span>&nbsp;<span class="op" id="4756180">!=</span>&nbsp;<span class="builtintype" id="4756183">nil</span>&nbsp;<span class="op" id="4756187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4756191">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4756199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756203"><a href="/gostd/crypto/rsa/rsa.go.html#4755794">hash</a></span><span class="op" id="4756207">.</span><span class="ident" id="4756208"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4756213">(</span><span class="ident" id="4756214"><a href="/gostd/crypto/rsa/rsa.go.html#4755865">label</a></span><span class="op" id="4756219">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756222">lHash</span>&nbsp;<span class="op" id="4756228">:=</span>&nbsp;<span class="ident" id="4756231"><a href="/gostd/crypto/rsa/rsa.go.html#4755794">hash</a></span><span class="op" id="4756235">.</span><span class="ident" id="4756236"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4756239">(</span><span class="builtintype" id="4756240">nil</span><span class="op" id="4756243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756246"><a href="/gostd/crypto/rsa/rsa.go.html#4755794">hash</a></span><span class="op" id="4756250">.</span><span class="ident" id="4756251"><a href="/gostd/hash/hash.go.html#3014443">Reset</a></span><span class="op" id="4756256">(</span><span class="op" id="4756257">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4756261">//&nbsp;Converting&nbsp;the&nbsp;plaintext&nbsp;number&nbsp;to&nbsp;bytes&nbsp;will&nbsp;strip&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4756321">//&nbsp;leading&nbsp;zeros&nbsp;so&nbsp;we&nbsp;may&nbsp;have&nbsp;to&nbsp;left&nbsp;pad.&nbsp;We&nbsp;do&nbsp;this&nbsp;unconditionally</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4756394">//&nbsp;to&nbsp;avoid&nbsp;leaking&nbsp;timing&nbsp;information.&nbsp;(Although&nbsp;we&nbsp;still&nbsp;probably</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4756463">//&nbsp;leak&nbsp;the&nbsp;number&nbsp;of&nbsp;leading&nbsp;zeros.&nbsp;It&#39;s&nbsp;not&nbsp;clear&nbsp;that&nbsp;we&nbsp;can&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4756531">//&nbsp;anything&nbsp;about&nbsp;this.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756557">em</span>&nbsp;<span class="op" id="4756560">:=</span>&nbsp;<span class="ident" id="4756563"><a href="/gostd/crypto/rsa/rsa.go.html#4758084">leftPad</a></span><span class="op" id="4756570">(</span><span class="ident" id="4756571"><a href="/gostd/crypto/rsa/rsa.go.html#4756137">m</a></span><span class="op" id="4756572">.</span><span class="ident" id="4756573"><a href="/gostd/math/big/int.go.html#2050194">Bytes</a></span><span class="op" id="4756578">(</span><span class="op" id="4756579">)</span><span class="op" id="4756580">,</span>&nbsp;<span class="ident" id="4756582"><a href="/gostd/crypto/rsa/rsa.go.html#4755978">k</a></span><span class="op" id="4756583">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756587">firstByteIsZero</span>&nbsp;<span class="op" id="4756603">:=</span>&nbsp;<span class="ident" id="4756606"><a href="/gostd/crypto/rsa/rsa.go.html#4742770">subtle</a></span><span class="op" id="4756612">.</span><span class="ident" id="4756613"><a href="/gostd/crypto/subtle/constant_time.go.html#4428992">ConstantTimeByteEq</a></span><span class="op" id="4756631">(</span><span class="ident" id="4756632"><a href="/gostd/crypto/rsa/rsa.go.html#4756557">em</a></span><span class="op" id="4756634">[</span><span class="num" id="4756635">0</span><span class="op" id="4756636">]</span><span class="op" id="4756637">,</span>&nbsp;<span class="num" id="4756639">0</span><span class="op" id="4756640">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756644">seed</span>&nbsp;<span class="op" id="4756649">:=</span>&nbsp;<span class="ident" id="4756652"><a href="/gostd/crypto/rsa/rsa.go.html#4756557">em</a></span><span class="op" id="4756654">[</span><span class="num" id="4756655">1</span>&nbsp;<span class="op" id="4756657">:</span>&nbsp;<span class="ident" id="4756659"><a href="/gostd/crypto/rsa/rsa.go.html#4755794">hash</a></span><span class="op" id="4756663">.</span><span class="ident" id="4756664"><a href="/gostd/hash/hash.go.html#3014507">Size</a></span><span class="op" id="4756668">(</span><span class="op" id="4756669">)</span><span class="op" id="4756670">+</span><span class="num" id="4756671">1</span><span class="op" id="4756672">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756675">db</span>&nbsp;<span class="op" id="4756678">:=</span>&nbsp;<span class="ident" id="4756681"><a href="/gostd/crypto/rsa/rsa.go.html#4756557">em</a></span><span class="op" id="4756683">[</span><span class="ident" id="4756684"><a href="/gostd/crypto/rsa/rsa.go.html#4755794">hash</a></span><span class="op" id="4756688">.</span><span class="ident" id="4756689"><a href="/gostd/hash/hash.go.html#3014507">Size</a></span><span class="op" id="4756693">(</span><span class="op" id="4756694">)</span><span class="op" id="4756695">+</span><span class="num" id="4756696">1</span><span class="op" id="4756697">:</span><span class="op" id="4756698">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756702"><a href="/gostd/crypto/rsa/rsa.go.html#4750085">mgf1XOR</a></span><span class="op" id="4756709">(</span><span class="ident" id="4756710"><a href="/gostd/crypto/rsa/rsa.go.html#4756644">seed</a></span><span class="op" id="4756714">,</span>&nbsp;<span class="ident" id="4756716"><a href="/gostd/crypto/rsa/rsa.go.html#4755794">hash</a></span><span class="op" id="4756720">,</span>&nbsp;<span class="ident" id="4756722"><a href="/gostd/crypto/rsa/rsa.go.html#4756675">db</a></span><span class="op" id="4756724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756727"><a href="/gostd/crypto/rsa/rsa.go.html#4750085">mgf1XOR</a></span><span class="op" id="4756734">(</span><span class="ident" id="4756735"><a href="/gostd/crypto/rsa/rsa.go.html#4756675">db</a></span><span class="op" id="4756737">,</span>&nbsp;<span class="ident" id="4756739"><a href="/gostd/crypto/rsa/rsa.go.html#4755794">hash</a></span><span class="op" id="4756743">,</span>&nbsp;<span class="ident" id="4756745"><a href="/gostd/crypto/rsa/rsa.go.html#4756644">seed</a></span><span class="op" id="4756749">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756753">lHash2</span>&nbsp;<span class="op" id="4756760">:=</span>&nbsp;<span class="ident" id="4756763"><a href="/gostd/crypto/rsa/rsa.go.html#4756675">db</a></span><span class="op" id="4756765">[</span><span class="num" id="4756766">0</span><span class="op" id="4756767">:</span><span class="ident" id="4756768"><a href="/gostd/crypto/rsa/rsa.go.html#4755794">hash</a></span><span class="op" id="4756772">.</span><span class="ident" id="4756773"><a href="/gostd/hash/hash.go.html#3014507">Size</a></span><span class="op" id="4756777">(</span><span class="op" id="4756778">)</span><span class="op" id="4756779">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4756783">//&nbsp;We&nbsp;have&nbsp;to&nbsp;validate&nbsp;the&nbsp;plaintext&nbsp;in&nbsp;constant&nbsp;time&nbsp;in&nbsp;order&nbsp;to&nbsp;avoid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4756856">//&nbsp;attacks&nbsp;like:&nbsp;J.&nbsp;Manger.&nbsp;A&nbsp;Chosen&nbsp;Ciphertext&nbsp;Attack&nbsp;on&nbsp;RSA&nbsp;Optimal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4756927">//&nbsp;Asymmetric&nbsp;Encryption&nbsp;Padding&nbsp;(OAEP)&nbsp;as&nbsp;Standardized&nbsp;in&nbsp;PKCS&nbsp;#1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4756995">//&nbsp;v2.0.&nbsp;In&nbsp;J.&nbsp;Kilian,&nbsp;editor,&nbsp;Advances&nbsp;in&nbsp;Cryptology.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757051">lHash2Good</span>&nbsp;<span class="op" id="4757062">:=</span>&nbsp;<span class="ident" id="4757065"><a href="/gostd/crypto/rsa/rsa.go.html#4742770">subtle</a></span><span class="op" id="4757071">.</span><span class="ident" id="4757072"><a href="/gostd/crypto/subtle/constant_time.go.html#4428560">ConstantTimeCompare</a></span><span class="op" id="4757091">(</span><span class="ident" id="4757092"><a href="/gostd/crypto/rsa/rsa.go.html#4756222">lHash</a></span><span class="op" id="4757097">,</span>&nbsp;<span class="ident" id="4757099"><a href="/gostd/crypto/rsa/rsa.go.html#4756753">lHash2</a></span><span class="op" id="4757105">)</span><br>
<span class="lineno">520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4757109">//&nbsp;The&nbsp;remainder&nbsp;of&nbsp;the&nbsp;plaintext&nbsp;must&nbsp;be&nbsp;zero&nbsp;or&nbsp;more&nbsp;0x00,&nbsp;followed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4757180">//&nbsp;by&nbsp;0x01,&nbsp;followed&nbsp;by&nbsp;the&nbsp;message.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4757218">//&nbsp;&nbsp;&nbsp;lookingForIndex:&nbsp;1&nbsp;iff&nbsp;we&nbsp;are&nbsp;still&nbsp;looking&nbsp;for&nbsp;the&nbsp;0x01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4757281">//&nbsp;&nbsp;&nbsp;index:&nbsp;the&nbsp;offset&nbsp;of&nbsp;the&nbsp;first&nbsp;0x01&nbsp;byte</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4757328">//&nbsp;&nbsp;&nbsp;invalid:&nbsp;1&nbsp;iff&nbsp;we&nbsp;saw&nbsp;a&nbsp;non-zero&nbsp;byte&nbsp;before&nbsp;the&nbsp;0x01.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4757389">var</span>&nbsp;<span class="ident" id="4757393">lookingForIndex</span><span class="op" id="4757408">,</span>&nbsp;<span class="ident" id="4757410">index</span><span class="op" id="4757415">,</span>&nbsp;<span class="ident" id="4757417">invalid</span>&nbsp;<span class="builtintype" id="4757425">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757430"><a href="/gostd/crypto/rsa/rsa.go.html#4757393">lookingForIndex</a></span>&nbsp;<span class="op" id="4757446">=</span>&nbsp;<span class="num" id="4757448">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757451">rest</span>&nbsp;<span class="op" id="4757456">:=</span>&nbsp;<span class="ident" id="4757459"><a href="/gostd/crypto/rsa/rsa.go.html#4756675">db</a></span><span class="op" id="4757461">[</span><span class="ident" id="4757462"><a href="/gostd/crypto/rsa/rsa.go.html#4755794">hash</a></span><span class="op" id="4757466">.</span><span class="ident" id="4757467"><a href="/gostd/hash/hash.go.html#3014507">Size</a></span><span class="op" id="4757471">(</span><span class="op" id="4757472">)</span><span class="op" id="4757473">:</span><span class="op" id="4757474">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4757478">for</span>&nbsp;<span class="ident" id="4757482">i</span>&nbsp;<span class="op" id="4757484">:=</span>&nbsp;<span class="num" id="4757487">0</span><span class="op" id="4757488">;</span>&nbsp;<span class="ident" id="4757490"><a href="/gostd/crypto/rsa/rsa.go.html#4757482">i</a></span>&nbsp;<span class="op" id="4757492">&lt;</span>&nbsp;<span class="builtinfunc" id="4757494">len</span><span class="op" id="4757497">(</span><span class="ident" id="4757498"><a href="/gostd/crypto/rsa/rsa.go.html#4757451">rest</a></span><span class="op" id="4757502">)</span><span class="op" id="4757503">;</span>&nbsp;<span class="ident" id="4757505"><a href="/gostd/crypto/rsa/rsa.go.html#4757482">i</a></span><span class="op" id="4757506">++</span>&nbsp;<span class="op" id="4757509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757513">equals0</span>&nbsp;<span class="op" id="4757521">:=</span>&nbsp;<span class="ident" id="4757524"><a href="/gostd/crypto/rsa/rsa.go.html#4742770">subtle</a></span><span class="op" id="4757530">.</span><span class="ident" id="4757531"><a href="/gostd/crypto/subtle/constant_time.go.html#4428992">ConstantTimeByteEq</a></span><span class="op" id="4757549">(</span><span class="ident" id="4757550"><a href="/gostd/crypto/rsa/rsa.go.html#4757451">rest</a></span><span class="op" id="4757554">[</span><span class="ident" id="4757555"><a href="/gostd/crypto/rsa/rsa.go.html#4757482">i</a></span><span class="op" id="4757556">]</span><span class="op" id="4757557">,</span>&nbsp;<span class="num" id="4757559">0</span><span class="op" id="4757560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757564">equals1</span>&nbsp;<span class="op" id="4757572">:=</span>&nbsp;<span class="ident" id="4757575"><a href="/gostd/crypto/rsa/rsa.go.html#4742770">subtle</a></span><span class="op" id="4757581">.</span><span class="ident" id="4757582"><a href="/gostd/crypto/subtle/constant_time.go.html#4428992">ConstantTimeByteEq</a></span><span class="op" id="4757600">(</span><span class="ident" id="4757601"><a href="/gostd/crypto/rsa/rsa.go.html#4757451">rest</a></span><span class="op" id="4757605">[</span><span class="ident" id="4757606"><a href="/gostd/crypto/rsa/rsa.go.html#4757482">i</a></span><span class="op" id="4757607">]</span><span class="op" id="4757608">,</span>&nbsp;<span class="num" id="4757610">1</span><span class="op" id="4757611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757615"><a href="/gostd/crypto/rsa/rsa.go.html#4757410">index</a></span>&nbsp;<span class="op" id="4757621">=</span>&nbsp;<span class="ident" id="4757623"><a href="/gostd/crypto/rsa/rsa.go.html#4742770">subtle</a></span><span class="op" id="4757629">.</span><span class="ident" id="4757630"><a href="/gostd/crypto/subtle/constant_time.go.html#4428861">ConstantTimeSelect</a></span><span class="op" id="4757648">(</span><span class="ident" id="4757649"><a href="/gostd/crypto/rsa/rsa.go.html#4757393">lookingForIndex</a></span><span class="op" id="4757664">&amp;</span><span class="ident" id="4757665"><a href="/gostd/crypto/rsa/rsa.go.html#4757564">equals1</a></span><span class="op" id="4757672">,</span>&nbsp;<span class="ident" id="4757674"><a href="/gostd/crypto/rsa/rsa.go.html#4757482">i</a></span><span class="op" id="4757675">,</span>&nbsp;<span class="ident" id="4757677"><a href="/gostd/crypto/rsa/rsa.go.html#4757410">index</a></span><span class="op" id="4757682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757686"><a href="/gostd/crypto/rsa/rsa.go.html#4757393">lookingForIndex</a></span>&nbsp;<span class="op" id="4757702">=</span>&nbsp;<span class="ident" id="4757704"><a href="/gostd/crypto/rsa/rsa.go.html#4742770">subtle</a></span><span class="op" id="4757710">.</span><span class="ident" id="4757711"><a href="/gostd/crypto/subtle/constant_time.go.html#4428861">ConstantTimeSelect</a></span><span class="op" id="4757729">(</span><span class="ident" id="4757730"><a href="/gostd/crypto/rsa/rsa.go.html#4757564">equals1</a></span><span class="op" id="4757737">,</span>&nbsp;<span class="num" id="4757739">0</span><span class="op" id="4757740">,</span>&nbsp;<span class="ident" id="4757742"><a href="/gostd/crypto/rsa/rsa.go.html#4757393">lookingForIndex</a></span><span class="op" id="4757757">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757761"><a href="/gostd/crypto/rsa/rsa.go.html#4757417">invalid</a></span>&nbsp;<span class="op" id="4757769">=</span>&nbsp;<span class="ident" id="4757771"><a href="/gostd/crypto/rsa/rsa.go.html#4742770">subtle</a></span><span class="op" id="4757777">.</span><span class="ident" id="4757778"><a href="/gostd/crypto/subtle/constant_time.go.html#4428861">ConstantTimeSelect</a></span><span class="op" id="4757796">(</span><span class="ident" id="4757797"><a href="/gostd/crypto/rsa/rsa.go.html#4757393">lookingForIndex</a></span><span class="op" id="4757812">&amp;^</span><span class="ident" id="4757814"><a href="/gostd/crypto/rsa/rsa.go.html#4757513">equals0</a></span><span class="op" id="4757821">,</span>&nbsp;<span class="num" id="4757823">1</span><span class="op" id="4757824">,</span>&nbsp;<span class="ident" id="4757826"><a href="/gostd/crypto/rsa/rsa.go.html#4757417">invalid</a></span><span class="op" id="4757833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4757836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4757840">if</span>&nbsp;<span class="ident" id="4757843"><a href="/gostd/crypto/rsa/rsa.go.html#4756587">firstByteIsZero</a></span><span class="op" id="4757858">&amp;</span><span class="ident" id="4757859"><a href="/gostd/crypto/rsa/rsa.go.html#4757051">lHash2Good</a></span><span class="op" id="4757869">&amp;^</span><span class="ident" id="4757871"><a href="/gostd/crypto/rsa/rsa.go.html#4757417">invalid</a></span><span class="op" id="4757878">&amp;^</span><span class="ident" id="4757880"><a href="/gostd/crypto/rsa/rsa.go.html#4757393">lookingForIndex</a></span>&nbsp;<span class="op" id="4757896">!=</span>&nbsp;<span class="num" id="4757899">1</span>&nbsp;<span class="op" id="4757901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757905"><a href="/gostd/crypto/rsa/rsa.go.html#4755892">err</a></span>&nbsp;<span class="op" id="4757909">=</span>&nbsp;<span class="ident" id="4757911"><a href="/gostd/crypto/rsa/rsa.go.html#4751957">ErrDecryption</a></span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4757927">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4757935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757939"><a href="/gostd/crypto/rsa/rsa.go.html#4755880">msg</a></span>&nbsp;<span class="op" id="4757943">=</span>&nbsp;<span class="ident" id="4757945"><a href="/gostd/crypto/rsa/rsa.go.html#4757451">rest</a></span><span class="op" id="4757949">[</span><span class="ident" id="4757950"><a href="/gostd/crypto/rsa/rsa.go.html#4757410">index</a></span><span class="op" id="4757955">+</span><span class="num" id="4757956">1</span><span class="op" id="4757957">:</span><span class="op" id="4757958">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4757961">return</span><br>
<span class="lineno">545</span><span class="op" id="4757968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4757971">//&nbsp;leftPad&nbsp;returns&nbsp;a&nbsp;new&nbsp;slice&nbsp;of&nbsp;length&nbsp;size.&nbsp;The&nbsp;contents&nbsp;of&nbsp;input&nbsp;are&nbsp;right</span><br>
<span class="lineno"></span><span class="comment" id="4758050">//&nbsp;aligned&nbsp;in&nbsp;the&nbsp;new&nbsp;slice.</span><br>
<span class="lineno"></span><span class="keyword" id="4758079">func</span>&nbsp;<span class="ident" id="4758084">leftPad</span><span class="op" id="4758091">(</span><span class="ident" id="4758092">input</span>&nbsp;<span class="op" id="4758098">[</span><span class="op" id="4758099">]</span><span class="builtintype" id="4758100">byte</span><span class="op" id="4758104">,</span>&nbsp;<span class="ident" id="4758106">size</span>&nbsp;<span class="builtintype" id="4758111">int</span><span class="op" id="4758114">)</span>&nbsp;<span class="op" id="4758116">(</span><span class="ident" id="4758117">out</span>&nbsp;<span class="op" id="4758121">[</span><span class="op" id="4758122">]</span><span class="builtintype" id="4758123">byte</span><span class="op" id="4758127">)</span>&nbsp;<span class="op" id="4758129">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758132">n</span>&nbsp;<span class="op" id="4758134">:=</span>&nbsp;<span class="builtinfunc" id="4758137">len</span><span class="op" id="4758140">(</span><span class="ident" id="4758141"><a href="/gostd/crypto/rsa/rsa.go.html#4758092">input</a></span><span class="op" id="4758146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4758149">if</span>&nbsp;<span class="ident" id="4758152"><a href="/gostd/crypto/rsa/rsa.go.html#4758132">n</a></span>&nbsp;<span class="op" id="4758154">&gt;</span>&nbsp;<span class="ident" id="4758156"><a href="/gostd/crypto/rsa/rsa.go.html#4758106">size</a></span>&nbsp;<span class="op" id="4758161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758165"><a href="/gostd/crypto/rsa/rsa.go.html#4758132">n</a></span>&nbsp;<span class="op" id="4758167">=</span>&nbsp;<span class="ident" id="4758169"><a href="/gostd/crypto/rsa/rsa.go.html#4758106">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4758175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758178"><a href="/gostd/crypto/rsa/rsa.go.html#4758117">out</a></span>&nbsp;<span class="op" id="4758182">=</span>&nbsp;<span class="builtinfunc" id="4758184">make</span><span class="op" id="4758188">(</span><span class="op" id="4758189">[</span><span class="op" id="4758190">]</span><span class="builtintype" id="4758191">byte</span><span class="op" id="4758195">,</span>&nbsp;<span class="ident" id="4758197"><a href="/gostd/crypto/rsa/rsa.go.html#4758106">size</a></span><span class="op" id="4758201">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4758204">copy</span><span class="op" id="4758208">(</span><span class="ident" id="4758209"><a href="/gostd/crypto/rsa/rsa.go.html#4758117">out</a></span><span class="op" id="4758212">[</span><span class="builtinfunc" id="4758213">len</span><span class="op" id="4758216">(</span><span class="ident" id="4758217"><a href="/gostd/crypto/rsa/rsa.go.html#4758117">out</a></span><span class="op" id="4758220">)</span><span class="op" id="4758221">-</span><span class="ident" id="4758222"><a href="/gostd/crypto/rsa/rsa.go.html#4758132">n</a></span><span class="op" id="4758223">:</span><span class="op" id="4758224">]</span><span class="op" id="4758225">,</span>&nbsp;<span class="ident" id="4758227"><a href="/gostd/crypto/rsa/rsa.go.html#4758092">input</a></span><span class="op" id="4758232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4758235">return</span><br>
<span class="lineno"></span><span class="op" id="4758242">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
