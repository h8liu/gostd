<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6855260">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6855316">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6855370">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6855421">package</span>&nbsp;<span class="ident" id="6855429">xml</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6855434">import</span>&nbsp;<span class="op" id="6855441">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6855444">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6855453">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6855460">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6855466">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6855477">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6855488">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6855499">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">15</span><span class="op" id="6855514">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6855517">const</span>&nbsp;<span class="ident" id="6855523">testInput</span>&nbsp;<span class="op" id="6855533">=</span>&nbsp;<span class="string" id="6855535">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;?&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno">20</span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;&gt;<br>
<span class="lineno"></span>&lt;body&nbsp;xmlns:foo=&#34;ns1&#34;&nbsp;xmlns=&#34;ns2&#34;&nbsp;xmlns:tag=&#34;ns3&#34;&nbsp;`</span>&nbsp;<span class="op" id="6855752">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6855755">&#34;\r\n\t&#34;</span>&nbsp;<span class="op" id="6855764">+</span>&nbsp;<span class="string" id="6855766">`&nbsp;&nbsp;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;hello&nbsp;lang=&#34;en&#34;&gt;World&nbsp;&amp;lt;&amp;gt;&amp;apos;&amp;quot;&nbsp;&amp;#x767d;&amp;#40300;翔&lt;/hello&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;query&gt;&amp;何;&nbsp;&amp;is-it;&lt;/query&gt;<br>
<span class="lineno">25</span>&nbsp;&nbsp;&lt;goodbye&nbsp;/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;outer&nbsp;foo:attr=&#34;value&#34;&nbsp;xmlns:tag=&#34;ns4&#34;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;inner/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/outer&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;tag:name&gt;<br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;![CDATA[Some&nbsp;text&nbsp;here.]]&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/tag:name&gt;<br>
<span class="lineno"></span>&lt;/body&gt;&lt;!--&nbsp;missing&nbsp;final&nbsp;newline&nbsp;--&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6856056">var</span>&nbsp;<span class="ident" id="6856060">testEntity</span>&nbsp;<span class="op" id="6856071">=</span>&nbsp;<span class="keyword" id="6856073">map</span><span class="op" id="6856076">[</span><span class="builtintype" id="6856077">string</span><span class="op" id="6856083">]</span><span class="builtintype" id="6856084">string</span><span class="op" id="6856090">{</span><span class="string" id="6856091">&#34;何&#34;</span><span class="op" id="6856096">:</span>&nbsp;<span class="string" id="6856098">&#34;What&#34;</span><span class="op" id="6856104">,</span>&nbsp;<span class="string" id="6856106">&#34;is-it&#34;</span><span class="op" id="6856113">:</span>&nbsp;<span class="string" id="6856115">&#34;is&nbsp;it?&#34;</span><span class="op" id="6856123">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="6856126">var</span>&nbsp;<span class="ident" id="6856130">rawTokens</span>&nbsp;<span class="op" id="6856140">=</span>&nbsp;<span class="op" id="6856142">[</span><span class="op" id="6856143">]</span><span class="ident" id="6856144">Token</span><span class="op" id="6856149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856152">CharData</span><span class="op" id="6856160">(</span><span class="string" id="6856161">&#34;\n&#34;</span><span class="op" id="6856165">)</span><span class="op" id="6856166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856169">ProcInst</span><span class="op" id="6856177">{</span><span class="string" id="6856178">&#34;xml&#34;</span><span class="op" id="6856183">,</span>&nbsp;<span class="op" id="6856185">[</span><span class="op" id="6856186">]</span><span class="builtintype" id="6856187">byte</span><span class="op" id="6856191">(</span><span class="string" id="6856192">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="6856224">)</span><span class="op" id="6856225">}</span><span class="op" id="6856226">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856229">CharData</span><span class="op" id="6856237">(</span><span class="string" id="6856238">&#34;\n&#34;</span><span class="op" id="6856242">)</span><span class="op" id="6856243">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856246">Directive</span><span class="op" id="6856255">(</span><span class="string" id="6856256">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="6856378">)</span><span class="op" id="6856379">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856382">CharData</span><span class="op" id="6856390">(</span><span class="string" id="6856391">&#34;\n&#34;</span><span class="op" id="6856395">)</span><span class="op" id="6856396">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856399">StartElement</span><span class="op" id="6856411">{</span><span class="ident" id="6856412">Name</span><span class="op" id="6856416">{</span><span class="string" id="6856417">&#34;&#34;</span><span class="op" id="6856419">,</span>&nbsp;<span class="string" id="6856421">&#34;body&#34;</span><span class="op" id="6856427">}</span><span class="op" id="6856428">,</span>&nbsp;<span class="op" id="6856430">[</span><span class="op" id="6856431">]</span><span class="ident" id="6856432">Attr</span><span class="op" id="6856436">{</span><span class="op" id="6856437">{</span><span class="ident" id="6856438">Name</span><span class="op" id="6856442">{</span><span class="string" id="6856443">&#34;xmlns&#34;</span><span class="op" id="6856450">,</span>&nbsp;<span class="string" id="6856452">&#34;foo&#34;</span><span class="op" id="6856457">}</span><span class="op" id="6856458">,</span>&nbsp;<span class="string" id="6856460">&#34;ns1&#34;</span><span class="op" id="6856465">}</span><span class="op" id="6856466">,</span>&nbsp;<span class="op" id="6856468">{</span><span class="ident" id="6856469">Name</span><span class="op" id="6856473">{</span><span class="string" id="6856474">&#34;&#34;</span><span class="op" id="6856476">,</span>&nbsp;<span class="string" id="6856478">&#34;xmlns&#34;</span><span class="op" id="6856485">}</span><span class="op" id="6856486">,</span>&nbsp;<span class="string" id="6856488">&#34;ns2&#34;</span><span class="op" id="6856493">}</span><span class="op" id="6856494">,</span>&nbsp;<span class="op" id="6856496">{</span><span class="ident" id="6856497">Name</span><span class="op" id="6856501">{</span><span class="string" id="6856502">&#34;xmlns&#34;</span><span class="op" id="6856509">,</span>&nbsp;<span class="string" id="6856511">&#34;tag&#34;</span><span class="op" id="6856516">}</span><span class="op" id="6856517">,</span>&nbsp;<span class="string" id="6856519">&#34;ns3&#34;</span><span class="op" id="6856524">}</span><span class="op" id="6856525">}</span><span class="op" id="6856526">}</span><span class="op" id="6856527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856530">CharData</span><span class="op" id="6856538">(</span><span class="string" id="6856539">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6856545">)</span><span class="op" id="6856546">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856549">StartElement</span><span class="op" id="6856561">{</span><span class="ident" id="6856562">Name</span><span class="op" id="6856566">{</span><span class="string" id="6856567">&#34;&#34;</span><span class="op" id="6856569">,</span>&nbsp;<span class="string" id="6856571">&#34;hello&#34;</span><span class="op" id="6856578">}</span><span class="op" id="6856579">,</span>&nbsp;<span class="op" id="6856581">[</span><span class="op" id="6856582">]</span><span class="ident" id="6856583">Attr</span><span class="op" id="6856587">{</span><span class="op" id="6856588">{</span><span class="ident" id="6856589">Name</span><span class="op" id="6856593">{</span><span class="string" id="6856594">&#34;&#34;</span><span class="op" id="6856596">,</span>&nbsp;<span class="string" id="6856598">&#34;lang&#34;</span><span class="op" id="6856604">}</span><span class="op" id="6856605">,</span>&nbsp;<span class="string" id="6856607">&#34;en&#34;</span><span class="op" id="6856611">}</span><span class="op" id="6856612">}</span><span class="op" id="6856613">}</span><span class="op" id="6856614">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856617">CharData</span><span class="op" id="6856625">(</span><span class="string" id="6856626">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="6856649">)</span><span class="op" id="6856650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856653">EndElement</span><span class="op" id="6856663">{</span><span class="ident" id="6856664">Name</span><span class="op" id="6856668">{</span><span class="string" id="6856669">&#34;&#34;</span><span class="op" id="6856671">,</span>&nbsp;<span class="string" id="6856673">&#34;hello&#34;</span><span class="op" id="6856680">}</span><span class="op" id="6856681">}</span><span class="op" id="6856682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856685">CharData</span><span class="op" id="6856693">(</span><span class="string" id="6856694">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6856700">)</span><span class="op" id="6856701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856704">StartElement</span><span class="op" id="6856716">{</span><span class="ident" id="6856717">Name</span><span class="op" id="6856721">{</span><span class="string" id="6856722">&#34;&#34;</span><span class="op" id="6856724">,</span>&nbsp;<span class="string" id="6856726">&#34;query&#34;</span><span class="op" id="6856733">}</span><span class="op" id="6856734">,</span>&nbsp;<span class="op" id="6856736">[</span><span class="op" id="6856737">]</span><span class="ident" id="6856738">Attr</span><span class="op" id="6856742">{</span><span class="op" id="6856743">}</span><span class="op" id="6856744">}</span><span class="op" id="6856745">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856748">CharData</span><span class="op" id="6856756">(</span><span class="string" id="6856757">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="6856770">)</span><span class="op" id="6856771">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856774">EndElement</span><span class="op" id="6856784">{</span><span class="ident" id="6856785">Name</span><span class="op" id="6856789">{</span><span class="string" id="6856790">&#34;&#34;</span><span class="op" id="6856792">,</span>&nbsp;<span class="string" id="6856794">&#34;query&#34;</span><span class="op" id="6856801">}</span><span class="op" id="6856802">}</span><span class="op" id="6856803">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856806">CharData</span><span class="op" id="6856814">(</span><span class="string" id="6856815">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6856821">)</span><span class="op" id="6856822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856825">StartElement</span><span class="op" id="6856837">{</span><span class="ident" id="6856838">Name</span><span class="op" id="6856842">{</span><span class="string" id="6856843">&#34;&#34;</span><span class="op" id="6856845">,</span>&nbsp;<span class="string" id="6856847">&#34;goodbye&#34;</span><span class="op" id="6856856">}</span><span class="op" id="6856857">,</span>&nbsp;<span class="op" id="6856859">[</span><span class="op" id="6856860">]</span><span class="ident" id="6856861">Attr</span><span class="op" id="6856865">{</span><span class="op" id="6856866">}</span><span class="op" id="6856867">}</span><span class="op" id="6856868">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856871">EndElement</span><span class="op" id="6856881">{</span><span class="ident" id="6856882">Name</span><span class="op" id="6856886">{</span><span class="string" id="6856887">&#34;&#34;</span><span class="op" id="6856889">,</span>&nbsp;<span class="string" id="6856891">&#34;goodbye&#34;</span><span class="op" id="6856900">}</span><span class="op" id="6856901">}</span><span class="op" id="6856902">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856905">CharData</span><span class="op" id="6856913">(</span><span class="string" id="6856914">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6856920">)</span><span class="op" id="6856921">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856924">StartElement</span><span class="op" id="6856936">{</span><span class="ident" id="6856937">Name</span><span class="op" id="6856941">{</span><span class="string" id="6856942">&#34;&#34;</span><span class="op" id="6856944">,</span>&nbsp;<span class="string" id="6856946">&#34;outer&#34;</span><span class="op" id="6856953">}</span><span class="op" id="6856954">,</span>&nbsp;<span class="op" id="6856956">[</span><span class="op" id="6856957">]</span><span class="ident" id="6856958">Attr</span><span class="op" id="6856962">{</span><span class="op" id="6856963">{</span><span class="ident" id="6856964">Name</span><span class="op" id="6856968">{</span><span class="string" id="6856969">&#34;foo&#34;</span><span class="op" id="6856974">,</span>&nbsp;<span class="string" id="6856976">&#34;attr&#34;</span><span class="op" id="6856982">}</span><span class="op" id="6856983">,</span>&nbsp;<span class="string" id="6856985">&#34;value&#34;</span><span class="op" id="6856992">}</span><span class="op" id="6856993">,</span>&nbsp;<span class="op" id="6856995">{</span><span class="ident" id="6856996">Name</span><span class="op" id="6857000">{</span><span class="string" id="6857001">&#34;xmlns&#34;</span><span class="op" id="6857008">,</span>&nbsp;<span class="string" id="6857010">&#34;tag&#34;</span><span class="op" id="6857015">}</span><span class="op" id="6857016">,</span>&nbsp;<span class="string" id="6857018">&#34;ns4&#34;</span><span class="op" id="6857023">}</span><span class="op" id="6857024">}</span><span class="op" id="6857025">}</span><span class="op" id="6857026">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857029">CharData</span><span class="op" id="6857037">(</span><span class="string" id="6857038">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="6857046">)</span><span class="op" id="6857047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857050">StartElement</span><span class="op" id="6857062">{</span><span class="ident" id="6857063">Name</span><span class="op" id="6857067">{</span><span class="string" id="6857068">&#34;&#34;</span><span class="op" id="6857070">,</span>&nbsp;<span class="string" id="6857072">&#34;inner&#34;</span><span class="op" id="6857079">}</span><span class="op" id="6857080">,</span>&nbsp;<span class="op" id="6857082">[</span><span class="op" id="6857083">]</span><span class="ident" id="6857084">Attr</span><span class="op" id="6857088">{</span><span class="op" id="6857089">}</span><span class="op" id="6857090">}</span><span class="op" id="6857091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857094">EndElement</span><span class="op" id="6857104">{</span><span class="ident" id="6857105">Name</span><span class="op" id="6857109">{</span><span class="string" id="6857110">&#34;&#34;</span><span class="op" id="6857112">,</span>&nbsp;<span class="string" id="6857114">&#34;inner&#34;</span><span class="op" id="6857121">}</span><span class="op" id="6857122">}</span><span class="op" id="6857123">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857126">CharData</span><span class="op" id="6857134">(</span><span class="string" id="6857135">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6857141">)</span><span class="op" id="6857142">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857145">EndElement</span><span class="op" id="6857155">{</span><span class="ident" id="6857156">Name</span><span class="op" id="6857160">{</span><span class="string" id="6857161">&#34;&#34;</span><span class="op" id="6857163">,</span>&nbsp;<span class="string" id="6857165">&#34;outer&#34;</span><span class="op" id="6857172">}</span><span class="op" id="6857173">}</span><span class="op" id="6857174">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857177">CharData</span><span class="op" id="6857185">(</span><span class="string" id="6857186">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6857192">)</span><span class="op" id="6857193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857196">StartElement</span><span class="op" id="6857208">{</span><span class="ident" id="6857209">Name</span><span class="op" id="6857213">{</span><span class="string" id="6857214">&#34;tag&#34;</span><span class="op" id="6857219">,</span>&nbsp;<span class="string" id="6857221">&#34;name&#34;</span><span class="op" id="6857227">}</span><span class="op" id="6857228">,</span>&nbsp;<span class="op" id="6857230">[</span><span class="op" id="6857231">]</span><span class="ident" id="6857232">Attr</span><span class="op" id="6857236">{</span><span class="op" id="6857237">}</span><span class="op" id="6857238">}</span><span class="op" id="6857239">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857242">CharData</span><span class="op" id="6857250">(</span><span class="string" id="6857251">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="6857259">)</span><span class="op" id="6857260">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857263">CharData</span><span class="op" id="6857271">(</span><span class="string" id="6857272">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="6857289">)</span><span class="op" id="6857290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857293">CharData</span><span class="op" id="6857301">(</span><span class="string" id="6857302">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6857308">)</span><span class="op" id="6857309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857312">EndElement</span><span class="op" id="6857322">{</span><span class="ident" id="6857323">Name</span><span class="op" id="6857327">{</span><span class="string" id="6857328">&#34;tag&#34;</span><span class="op" id="6857333">,</span>&nbsp;<span class="string" id="6857335">&#34;name&#34;</span><span class="op" id="6857341">}</span><span class="op" id="6857342">}</span><span class="op" id="6857343">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857346">CharData</span><span class="op" id="6857354">(</span><span class="string" id="6857355">&#34;\n&#34;</span><span class="op" id="6857359">)</span><span class="op" id="6857360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857363">EndElement</span><span class="op" id="6857373">{</span><span class="ident" id="6857374">Name</span><span class="op" id="6857378">{</span><span class="string" id="6857379">&#34;&#34;</span><span class="op" id="6857381">,</span>&nbsp;<span class="string" id="6857383">&#34;body&#34;</span><span class="op" id="6857389">}</span><span class="op" id="6857390">}</span><span class="op" id="6857391">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857394">Comment</span><span class="op" id="6857401">(</span><span class="string" id="6857402">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="6857427">)</span><span class="op" id="6857428">,</span><br>
<span class="lineno"></span><span class="op" id="6857430">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6857433">var</span>&nbsp;<span class="ident" id="6857437">cookedTokens</span>&nbsp;<span class="op" id="6857450">=</span>&nbsp;<span class="op" id="6857452">[</span><span class="op" id="6857453">]</span><span class="ident" id="6857454">Token</span><span class="op" id="6857459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857462">CharData</span><span class="op" id="6857470">(</span><span class="string" id="6857471">&#34;\n&#34;</span><span class="op" id="6857475">)</span><span class="op" id="6857476">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857479">ProcInst</span><span class="op" id="6857487">{</span><span class="string" id="6857488">&#34;xml&#34;</span><span class="op" id="6857493">,</span>&nbsp;<span class="op" id="6857495">[</span><span class="op" id="6857496">]</span><span class="builtintype" id="6857497">byte</span><span class="op" id="6857501">(</span><span class="string" id="6857502">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="6857534">)</span><span class="op" id="6857535">}</span><span class="op" id="6857536">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857539">CharData</span><span class="op" id="6857547">(</span><span class="string" id="6857548">&#34;\n&#34;</span><span class="op" id="6857552">)</span><span class="op" id="6857553">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857556">Directive</span><span class="op" id="6857565">(</span><span class="string" id="6857566">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="6857688">)</span><span class="op" id="6857689">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857692">CharData</span><span class="op" id="6857700">(</span><span class="string" id="6857701">&#34;\n&#34;</span><span class="op" id="6857705">)</span><span class="op" id="6857706">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857709">StartElement</span><span class="op" id="6857721">{</span><span class="ident" id="6857722">Name</span><span class="op" id="6857726">{</span><span class="string" id="6857727">&#34;ns2&#34;</span><span class="op" id="6857732">,</span>&nbsp;<span class="string" id="6857734">&#34;body&#34;</span><span class="op" id="6857740">}</span><span class="op" id="6857741">,</span>&nbsp;<span class="op" id="6857743">[</span><span class="op" id="6857744">]</span><span class="ident" id="6857745">Attr</span><span class="op" id="6857749">{</span><span class="op" id="6857750">{</span><span class="ident" id="6857751">Name</span><span class="op" id="6857755">{</span><span class="string" id="6857756">&#34;xmlns&#34;</span><span class="op" id="6857763">,</span>&nbsp;<span class="string" id="6857765">&#34;foo&#34;</span><span class="op" id="6857770">}</span><span class="op" id="6857771">,</span>&nbsp;<span class="string" id="6857773">&#34;ns1&#34;</span><span class="op" id="6857778">}</span><span class="op" id="6857779">,</span>&nbsp;<span class="op" id="6857781">{</span><span class="ident" id="6857782">Name</span><span class="op" id="6857786">{</span><span class="string" id="6857787">&#34;&#34;</span><span class="op" id="6857789">,</span>&nbsp;<span class="string" id="6857791">&#34;xmlns&#34;</span><span class="op" id="6857798">}</span><span class="op" id="6857799">,</span>&nbsp;<span class="string" id="6857801">&#34;ns2&#34;</span><span class="op" id="6857806">}</span><span class="op" id="6857807">,</span>&nbsp;<span class="op" id="6857809">{</span><span class="ident" id="6857810">Name</span><span class="op" id="6857814">{</span><span class="string" id="6857815">&#34;xmlns&#34;</span><span class="op" id="6857822">,</span>&nbsp;<span class="string" id="6857824">&#34;tag&#34;</span><span class="op" id="6857829">}</span><span class="op" id="6857830">,</span>&nbsp;<span class="string" id="6857832">&#34;ns3&#34;</span><span class="op" id="6857837">}</span><span class="op" id="6857838">}</span><span class="op" id="6857839">}</span><span class="op" id="6857840">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857843">CharData</span><span class="op" id="6857851">(</span><span class="string" id="6857852">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6857858">)</span><span class="op" id="6857859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857862">StartElement</span><span class="op" id="6857874">{</span><span class="ident" id="6857875">Name</span><span class="op" id="6857879">{</span><span class="string" id="6857880">&#34;ns2&#34;</span><span class="op" id="6857885">,</span>&nbsp;<span class="string" id="6857887">&#34;hello&#34;</span><span class="op" id="6857894">}</span><span class="op" id="6857895">,</span>&nbsp;<span class="op" id="6857897">[</span><span class="op" id="6857898">]</span><span class="ident" id="6857899">Attr</span><span class="op" id="6857903">{</span><span class="op" id="6857904">{</span><span class="ident" id="6857905">Name</span><span class="op" id="6857909">{</span><span class="string" id="6857910">&#34;&#34;</span><span class="op" id="6857912">,</span>&nbsp;<span class="string" id="6857914">&#34;lang&#34;</span><span class="op" id="6857920">}</span><span class="op" id="6857921">,</span>&nbsp;<span class="string" id="6857923">&#34;en&#34;</span><span class="op" id="6857927">}</span><span class="op" id="6857928">}</span><span class="op" id="6857929">}</span><span class="op" id="6857930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857933">CharData</span><span class="op" id="6857941">(</span><span class="string" id="6857942">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="6857965">)</span><span class="op" id="6857966">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857969">EndElement</span><span class="op" id="6857979">{</span><span class="ident" id="6857980">Name</span><span class="op" id="6857984">{</span><span class="string" id="6857985">&#34;ns2&#34;</span><span class="op" id="6857990">,</span>&nbsp;<span class="string" id="6857992">&#34;hello&#34;</span><span class="op" id="6857999">}</span><span class="op" id="6858000">}</span><span class="op" id="6858001">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858004">CharData</span><span class="op" id="6858012">(</span><span class="string" id="6858013">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6858019">)</span><span class="op" id="6858020">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858023">StartElement</span><span class="op" id="6858035">{</span><span class="ident" id="6858036">Name</span><span class="op" id="6858040">{</span><span class="string" id="6858041">&#34;ns2&#34;</span><span class="op" id="6858046">,</span>&nbsp;<span class="string" id="6858048">&#34;query&#34;</span><span class="op" id="6858055">}</span><span class="op" id="6858056">,</span>&nbsp;<span class="op" id="6858058">[</span><span class="op" id="6858059">]</span><span class="ident" id="6858060">Attr</span><span class="op" id="6858064">{</span><span class="op" id="6858065">}</span><span class="op" id="6858066">}</span><span class="op" id="6858067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858070">CharData</span><span class="op" id="6858078">(</span><span class="string" id="6858079">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="6858092">)</span><span class="op" id="6858093">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858096">EndElement</span><span class="op" id="6858106">{</span><span class="ident" id="6858107">Name</span><span class="op" id="6858111">{</span><span class="string" id="6858112">&#34;ns2&#34;</span><span class="op" id="6858117">,</span>&nbsp;<span class="string" id="6858119">&#34;query&#34;</span><span class="op" id="6858126">}</span><span class="op" id="6858127">}</span><span class="op" id="6858128">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858131">CharData</span><span class="op" id="6858139">(</span><span class="string" id="6858140">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6858146">)</span><span class="op" id="6858147">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858150">StartElement</span><span class="op" id="6858162">{</span><span class="ident" id="6858163">Name</span><span class="op" id="6858167">{</span><span class="string" id="6858168">&#34;ns2&#34;</span><span class="op" id="6858173">,</span>&nbsp;<span class="string" id="6858175">&#34;goodbye&#34;</span><span class="op" id="6858184">}</span><span class="op" id="6858185">,</span>&nbsp;<span class="op" id="6858187">[</span><span class="op" id="6858188">]</span><span class="ident" id="6858189">Attr</span><span class="op" id="6858193">{</span><span class="op" id="6858194">}</span><span class="op" id="6858195">}</span><span class="op" id="6858196">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858199">EndElement</span><span class="op" id="6858209">{</span><span class="ident" id="6858210">Name</span><span class="op" id="6858214">{</span><span class="string" id="6858215">&#34;ns2&#34;</span><span class="op" id="6858220">,</span>&nbsp;<span class="string" id="6858222">&#34;goodbye&#34;</span><span class="op" id="6858231">}</span><span class="op" id="6858232">}</span><span class="op" id="6858233">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858236">CharData</span><span class="op" id="6858244">(</span><span class="string" id="6858245">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6858251">)</span><span class="op" id="6858252">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858255">StartElement</span><span class="op" id="6858267">{</span><span class="ident" id="6858268">Name</span><span class="op" id="6858272">{</span><span class="string" id="6858273">&#34;ns2&#34;</span><span class="op" id="6858278">,</span>&nbsp;<span class="string" id="6858280">&#34;outer&#34;</span><span class="op" id="6858287">}</span><span class="op" id="6858288">,</span>&nbsp;<span class="op" id="6858290">[</span><span class="op" id="6858291">]</span><span class="ident" id="6858292">Attr</span><span class="op" id="6858296">{</span><span class="op" id="6858297">{</span><span class="ident" id="6858298">Name</span><span class="op" id="6858302">{</span><span class="string" id="6858303">&#34;ns1&#34;</span><span class="op" id="6858308">,</span>&nbsp;<span class="string" id="6858310">&#34;attr&#34;</span><span class="op" id="6858316">}</span><span class="op" id="6858317">,</span>&nbsp;<span class="string" id="6858319">&#34;value&#34;</span><span class="op" id="6858326">}</span><span class="op" id="6858327">,</span>&nbsp;<span class="op" id="6858329">{</span><span class="ident" id="6858330">Name</span><span class="op" id="6858334">{</span><span class="string" id="6858335">&#34;xmlns&#34;</span><span class="op" id="6858342">,</span>&nbsp;<span class="string" id="6858344">&#34;tag&#34;</span><span class="op" id="6858349">}</span><span class="op" id="6858350">,</span>&nbsp;<span class="string" id="6858352">&#34;ns4&#34;</span><span class="op" id="6858357">}</span><span class="op" id="6858358">}</span><span class="op" id="6858359">}</span><span class="op" id="6858360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858363">CharData</span><span class="op" id="6858371">(</span><span class="string" id="6858372">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="6858380">)</span><span class="op" id="6858381">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858384">StartElement</span><span class="op" id="6858396">{</span><span class="ident" id="6858397">Name</span><span class="op" id="6858401">{</span><span class="string" id="6858402">&#34;ns2&#34;</span><span class="op" id="6858407">,</span>&nbsp;<span class="string" id="6858409">&#34;inner&#34;</span><span class="op" id="6858416">}</span><span class="op" id="6858417">,</span>&nbsp;<span class="op" id="6858419">[</span><span class="op" id="6858420">]</span><span class="ident" id="6858421">Attr</span><span class="op" id="6858425">{</span><span class="op" id="6858426">}</span><span class="op" id="6858427">}</span><span class="op" id="6858428">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858431">EndElement</span><span class="op" id="6858441">{</span><span class="ident" id="6858442">Name</span><span class="op" id="6858446">{</span><span class="string" id="6858447">&#34;ns2&#34;</span><span class="op" id="6858452">,</span>&nbsp;<span class="string" id="6858454">&#34;inner&#34;</span><span class="op" id="6858461">}</span><span class="op" id="6858462">}</span><span class="op" id="6858463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858466">CharData</span><span class="op" id="6858474">(</span><span class="string" id="6858475">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6858481">)</span><span class="op" id="6858482">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858485">EndElement</span><span class="op" id="6858495">{</span><span class="ident" id="6858496">Name</span><span class="op" id="6858500">{</span><span class="string" id="6858501">&#34;ns2&#34;</span><span class="op" id="6858506">,</span>&nbsp;<span class="string" id="6858508">&#34;outer&#34;</span><span class="op" id="6858515">}</span><span class="op" id="6858516">}</span><span class="op" id="6858517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858520">CharData</span><span class="op" id="6858528">(</span><span class="string" id="6858529">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6858535">)</span><span class="op" id="6858536">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858539">StartElement</span><span class="op" id="6858551">{</span><span class="ident" id="6858552">Name</span><span class="op" id="6858556">{</span><span class="string" id="6858557">&#34;ns3&#34;</span><span class="op" id="6858562">,</span>&nbsp;<span class="string" id="6858564">&#34;name&#34;</span><span class="op" id="6858570">}</span><span class="op" id="6858571">,</span>&nbsp;<span class="op" id="6858573">[</span><span class="op" id="6858574">]</span><span class="ident" id="6858575">Attr</span><span class="op" id="6858579">{</span><span class="op" id="6858580">}</span><span class="op" id="6858581">}</span><span class="op" id="6858582">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858585">CharData</span><span class="op" id="6858593">(</span><span class="string" id="6858594">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="6858602">)</span><span class="op" id="6858603">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858606">CharData</span><span class="op" id="6858614">(</span><span class="string" id="6858615">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="6858632">)</span><span class="op" id="6858633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858636">CharData</span><span class="op" id="6858644">(</span><span class="string" id="6858645">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6858651">)</span><span class="op" id="6858652">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858655">EndElement</span><span class="op" id="6858665">{</span><span class="ident" id="6858666">Name</span><span class="op" id="6858670">{</span><span class="string" id="6858671">&#34;ns3&#34;</span><span class="op" id="6858676">,</span>&nbsp;<span class="string" id="6858678">&#34;name&#34;</span><span class="op" id="6858684">}</span><span class="op" id="6858685">}</span><span class="op" id="6858686">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858689">CharData</span><span class="op" id="6858697">(</span><span class="string" id="6858698">&#34;\n&#34;</span><span class="op" id="6858702">)</span><span class="op" id="6858703">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858706">EndElement</span><span class="op" id="6858716">{</span><span class="ident" id="6858717">Name</span><span class="op" id="6858721">{</span><span class="string" id="6858722">&#34;ns2&#34;</span><span class="op" id="6858727">,</span>&nbsp;<span class="string" id="6858729">&#34;body&#34;</span><span class="op" id="6858735">}</span><span class="op" id="6858736">}</span><span class="op" id="6858737">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858740">Comment</span><span class="op" id="6858747">(</span><span class="string" id="6858748">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="6858773">)</span><span class="op" id="6858774">,</span><br>
<span class="lineno"></span><span class="op" id="6858776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="6858779">const</span>&nbsp;<span class="ident" id="6858785">testInputAltEncoding</span>&nbsp;<span class="op" id="6858806">=</span>&nbsp;<span class="string" id="6858808">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;?&gt;<br>
<span class="lineno"></span>&lt;TAG&gt;VALUE&lt;/TAG&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6858882">var</span>&nbsp;<span class="ident" id="6858886">rawTokensAltEncoding</span>&nbsp;<span class="op" id="6858907">=</span>&nbsp;<span class="op" id="6858909">[</span><span class="op" id="6858910">]</span><span class="ident" id="6858911">Token</span><span class="op" id="6858916">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858919">CharData</span><span class="op" id="6858927">(</span><span class="string" id="6858928">&#34;\n&#34;</span><span class="op" id="6858932">)</span><span class="op" id="6858933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858936">ProcInst</span><span class="op" id="6858944">{</span><span class="string" id="6858945">&#34;xml&#34;</span><span class="op" id="6858950">,</span>&nbsp;<span class="op" id="6858952">[</span><span class="op" id="6858953">]</span><span class="builtintype" id="6858954">byte</span><span class="op" id="6858958">(</span><span class="string" id="6858959">`version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;`</span><span class="op" id="6859005">)</span><span class="op" id="6859006">}</span><span class="op" id="6859007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6859010">CharData</span><span class="op" id="6859018">(</span><span class="string" id="6859019">&#34;\n&#34;</span><span class="op" id="6859023">)</span><span class="op" id="6859024">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6859027">StartElement</span><span class="op" id="6859039">{</span><span class="ident" id="6859040">Name</span><span class="op" id="6859044">{</span><span class="string" id="6859045">&#34;&#34;</span><span class="op" id="6859047">,</span>&nbsp;<span class="string" id="6859049">&#34;tag&#34;</span><span class="op" id="6859054">}</span><span class="op" id="6859055">,</span>&nbsp;<span class="op" id="6859057">[</span><span class="op" id="6859058">]</span><span class="ident" id="6859059">Attr</span><span class="op" id="6859063">{</span><span class="op" id="6859064">}</span><span class="op" id="6859065">}</span><span class="op" id="6859066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6859069">CharData</span><span class="op" id="6859077">(</span><span class="string" id="6859078">&#34;value&#34;</span><span class="op" id="6859085">)</span><span class="op" id="6859086">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6859089">EndElement</span><span class="op" id="6859099">{</span><span class="ident" id="6859100">Name</span><span class="op" id="6859104">{</span><span class="string" id="6859105">&#34;&#34;</span><span class="op" id="6859107">,</span>&nbsp;<span class="string" id="6859109">&#34;tag&#34;</span><span class="op" id="6859114">}</span><span class="op" id="6859115">}</span><span class="op" id="6859116">,</span><br>
<span class="lineno"></span><span class="op" id="6859118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6859121">var</span>&nbsp;<span class="ident" id="6859125">xmlInput</span>&nbsp;<span class="op" id="6859134">=</span>&nbsp;<span class="op" id="6859136">[</span><span class="op" id="6859137">]</span><span class="builtintype" id="6859138">string</span><span class="op" id="6859144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6859147">//&nbsp;unexpected&nbsp;EOF&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859172">&#34;&lt;&#34;</span><span class="op" id="6859175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859178">&#34;&lt;t&#34;</span><span class="op" id="6859182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859185">&#34;&lt;t&nbsp;&#34;</span><span class="op" id="6859190">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859193">&#34;&lt;t/&#34;</span><span class="op" id="6859198">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859201">&#34;&lt;!&#34;</span><span class="op" id="6859205">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859208">&#34;&lt;!-&#34;</span><span class="op" id="6859213">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859216">&#34;&lt;!--&#34;</span><span class="op" id="6859222">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859225">&#34;&lt;!--c-&#34;</span><span class="op" id="6859233">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859236">&#34;&lt;!--c--&#34;</span><span class="op" id="6859245">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859248">&#34;&lt;!d&#34;</span><span class="op" id="6859253">,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859256">&#34;&lt;t&gt;&lt;/&#34;</span><span class="op" id="6859263">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859266">&#34;&lt;t&gt;&lt;/t&#34;</span><span class="op" id="6859274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859277">&#34;&lt;?&#34;</span><span class="op" id="6859281">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859284">&#34;&lt;?p&#34;</span><span class="op" id="6859289">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859292">&#34;&lt;t&nbsp;a&#34;</span><span class="op" id="6859298">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859301">&#34;&lt;t&nbsp;a=&#34;</span><span class="op" id="6859308">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859311">&#34;&lt;t&nbsp;a=&#39;&#34;</span><span class="op" id="6859319">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859322">&#34;&lt;t&nbsp;a=&#39;&#39;&#34;</span><span class="op" id="6859331">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859334">&#34;&lt;t/&gt;&lt;![&#34;</span><span class="op" id="6859343">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859346">&#34;&lt;t/&gt;&lt;![C&#34;</span><span class="op" id="6859356">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859359">&#34;&lt;t/&gt;&lt;![CDATA[d&#34;</span><span class="op" id="6859375">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859378">&#34;&lt;t/&gt;&lt;![CDATA[d]&#34;</span><span class="op" id="6859395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859398">&#34;&lt;t/&gt;&lt;![CDATA[d]]&#34;</span><span class="op" id="6859416">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6859420">//&nbsp;other&nbsp;Syntax&nbsp;errors</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859444">&#34;&lt;&gt;&#34;</span><span class="op" id="6859448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859451">&#34;&lt;t/a&#34;</span><span class="op" id="6859457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859460">&#34;&lt;0&nbsp;/&gt;&#34;</span><span class="op" id="6859467">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859470">&#34;&lt;?0&nbsp;&gt;&#34;</span><span class="op" id="6859477">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6859480">//&nbsp;&nbsp;&nbsp;&nbsp&#34;&lt;!0&nbsp;&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859526">&#34;&lt;/0&gt;&#34;</span><span class="op" id="6859532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859535">&#34;&lt;t&nbsp;0=&#39;&#39;&gt;&#34;</span><span class="op" id="6859545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859548">&#34;&lt;t&nbsp;a=&#39;&amp;&#39;&gt;&#34;</span><span class="op" id="6859559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859562">&#34;&lt;t&nbsp;a=&#39;&lt;&#39;&gt;&#34;</span><span class="op" id="6859573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859576">&#34;&lt;t&gt;&amp;nbspc;&lt;/t&gt;&#34;</span><span class="op" id="6859592">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859595">&#34;&lt;t&nbsp;a&gt;&#34;</span><span class="op" id="6859602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859605">&#34;&lt;t&nbsp;a=&gt;&#34;</span><span class="op" id="6859613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859616">&#34;&lt;t&nbsp;a=v&gt;&#34;</span><span class="op" id="6859625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6859628">//&nbsp;&nbsp;&nbsp;&nbsp&#34;&lt;![CDATA[d]]&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859682">&#34;&lt;t&gt;&lt;/e&gt;&#34;</span><span class="op" id="6859691">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859694">&#34;&lt;t&gt;&lt;/&gt;&#34;</span><span class="op" id="6859702">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859705">&#34;&lt;t&gt;&lt;/t!&#34;</span><span class="op" id="6859714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6859717">&#34;&lt;t&gt;cdata]]&gt;&lt;/t&gt;&#34;</span><span class="op" id="6859734">,</span><br>
<span class="lineno"></span><span class="op" id="6859736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="6859739">func</span>&nbsp;<span class="ident" id="6859744">TestRawToken</span><span class="op" id="6859756">(</span><span class="ident" id="6859757">t</span>&nbsp;<span class="op" id="6859759">*</span><span class="ident" id="6859760">testing</span><span class="op" id="6859767">.</span><span class="ident" id="6859768">T</span><span class="op" id="6859769">)</span>&nbsp;<span class="op" id="6859771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6859774">d</span>&nbsp;<span class="op" id="6859776">:=</span>&nbsp;<span class="ident" id="6859779">NewDecoder</span><span class="op" id="6859789">(</span><span class="ident" id="6859790">strings</span><span class="op" id="6859797">.</span><span class="ident" id="6859798">NewReader</span><span class="op" id="6859807">(</span><span class="ident" id="6859808">testInput</span><span class="op" id="6859817">)</span><span class="op" id="6859818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6859821">d</span><span class="op" id="6859822">.</span><span class="ident" id="6859823">Entity</span>&nbsp;<span class="op" id="6859830">=</span>&nbsp;<span class="ident" id="6859832">testEntity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6859844">testRawToken</span><span class="op" id="6859856">(</span><span class="ident" id="6859857">t</span><span class="op" id="6859858">,</span>&nbsp;<span class="ident" id="6859860">d</span><span class="op" id="6859861">,</span>&nbsp;<span class="ident" id="6859863">testInput</span><span class="op" id="6859872">,</span>&nbsp;<span class="ident" id="6859874">rawTokens</span><span class="op" id="6859883">)</span><br>
<span class="lineno"></span><span class="op" id="6859885">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="6859888">const</span>&nbsp;<span class="ident" id="6859894">nonStrictInput</span>&nbsp;<span class="op" id="6859909">=</span>&nbsp;<span class="string" id="6859911">`<br>
<span class="lineno"></span>&lt;tag&gt;non&amp;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;unknown;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;#123&lt;/tag&gt;<br>
<span class="lineno">180</span>&lt;tag&gt;&amp;#zzz;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;なまえ3;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;lt-gt;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;0a;&lt;/tag&gt;<br>
<span class="lineno">185</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6860073">var</span>&nbsp;<span class="ident" id="6860077">nonStringEntity</span>&nbsp;<span class="op" id="6860093">=</span>&nbsp;<span class="keyword" id="6860095">map</span><span class="op" id="6860098">[</span><span class="builtintype" id="6860099">string</span><span class="op" id="6860105">]</span><span class="builtintype" id="6860106">string</span><span class="op" id="6860112">{</span><span class="string" id="6860113">&#34;&#34;</span><span class="op" id="6860115">:</span>&nbsp;<span class="string" id="6860117">&#34;oops!&#34;</span><span class="op" id="6860124">,</span>&nbsp;<span class="string" id="6860126">&#34;0a&#34;</span><span class="op" id="6860130">:</span>&nbsp;<span class="string" id="6860132">&#34;oops!&#34;</span><span class="op" id="6860139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6860142">var</span>&nbsp;<span class="ident" id="6860146">nonStrictTokens</span>&nbsp;<span class="op" id="6860162">=</span>&nbsp;<span class="op" id="6860164">[</span><span class="op" id="6860165">]</span><span class="ident" id="6860166">Token</span><span class="op" id="6860171">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860174">CharData</span><span class="op" id="6860182">(</span><span class="string" id="6860183">&#34;\n&#34;</span><span class="op" id="6860187">)</span><span class="op" id="6860188">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860191">StartElement</span><span class="op" id="6860203">{</span><span class="ident" id="6860204">Name</span><span class="op" id="6860208">{</span><span class="string" id="6860209">&#34;&#34;</span><span class="op" id="6860211">,</span>&nbsp;<span class="string" id="6860213">&#34;tag&#34;</span><span class="op" id="6860218">}</span><span class="op" id="6860219">,</span>&nbsp;<span class="op" id="6860221">[</span><span class="op" id="6860222">]</span><span class="ident" id="6860223">Attr</span><span class="op" id="6860227">{</span><span class="op" id="6860228">}</span><span class="op" id="6860229">}</span><span class="op" id="6860230">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860233">CharData</span><span class="op" id="6860241">(</span><span class="string" id="6860242">&#34;non&amp;entity&#34;</span><span class="op" id="6860254">)</span><span class="op" id="6860255">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860258">EndElement</span><span class="op" id="6860268">{</span><span class="ident" id="6860269">Name</span><span class="op" id="6860273">{</span><span class="string" id="6860274">&#34;&#34;</span><span class="op" id="6860276">,</span>&nbsp;<span class="string" id="6860278">&#34;tag&#34;</span><span class="op" id="6860283">}</span><span class="op" id="6860284">}</span><span class="op" id="6860285">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860288">CharData</span><span class="op" id="6860296">(</span><span class="string" id="6860297">&#34;\n&#34;</span><span class="op" id="6860301">)</span><span class="op" id="6860302">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860305">StartElement</span><span class="op" id="6860317">{</span><span class="ident" id="6860318">Name</span><span class="op" id="6860322">{</span><span class="string" id="6860323">&#34;&#34;</span><span class="op" id="6860325">,</span>&nbsp;<span class="string" id="6860327">&#34;tag&#34;</span><span class="op" id="6860332">}</span><span class="op" id="6860333">,</span>&nbsp;<span class="op" id="6860335">[</span><span class="op" id="6860336">]</span><span class="ident" id="6860337">Attr</span><span class="op" id="6860341">{</span><span class="op" id="6860342">}</span><span class="op" id="6860343">}</span><span class="op" id="6860344">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860347">CharData</span><span class="op" id="6860355">(</span><span class="string" id="6860356">&#34;&amp;unknown;entity&#34;</span><span class="op" id="6860373">)</span><span class="op" id="6860374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860377">EndElement</span><span class="op" id="6860387">{</span><span class="ident" id="6860388">Name</span><span class="op" id="6860392">{</span><span class="string" id="6860393">&#34;&#34;</span><span class="op" id="6860395">,</span>&nbsp;<span class="string" id="6860397">&#34;tag&#34;</span><span class="op" id="6860402">}</span><span class="op" id="6860403">}</span><span class="op" id="6860404">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860407">CharData</span><span class="op" id="6860415">(</span><span class="string" id="6860416">&#34;\n&#34;</span><span class="op" id="6860420">)</span><span class="op" id="6860421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860424">StartElement</span><span class="op" id="6860436">{</span><span class="ident" id="6860437">Name</span><span class="op" id="6860441">{</span><span class="string" id="6860442">&#34;&#34;</span><span class="op" id="6860444">,</span>&nbsp;<span class="string" id="6860446">&#34;tag&#34;</span><span class="op" id="6860451">}</span><span class="op" id="6860452">,</span>&nbsp;<span class="op" id="6860454">[</span><span class="op" id="6860455">]</span><span class="ident" id="6860456">Attr</span><span class="op" id="6860460">{</span><span class="op" id="6860461">}</span><span class="op" id="6860462">}</span><span class="op" id="6860463">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860466">CharData</span><span class="op" id="6860474">(</span><span class="string" id="6860475">&#34;&amp;#123&#34;</span><span class="op" id="6860482">)</span><span class="op" id="6860483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860486">EndElement</span><span class="op" id="6860496">{</span><span class="ident" id="6860497">Name</span><span class="op" id="6860501">{</span><span class="string" id="6860502">&#34;&#34;</span><span class="op" id="6860504">,</span>&nbsp;<span class="string" id="6860506">&#34;tag&#34;</span><span class="op" id="6860511">}</span><span class="op" id="6860512">}</span><span class="op" id="6860513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860516">CharData</span><span class="op" id="6860524">(</span><span class="string" id="6860525">&#34;\n&#34;</span><span class="op" id="6860529">)</span><span class="op" id="6860530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860533">StartElement</span><span class="op" id="6860545">{</span><span class="ident" id="6860546">Name</span><span class="op" id="6860550">{</span><span class="string" id="6860551">&#34;&#34;</span><span class="op" id="6860553">,</span>&nbsp;<span class="string" id="6860555">&#34;tag&#34;</span><span class="op" id="6860560">}</span><span class="op" id="6860561">,</span>&nbsp;<span class="op" id="6860563">[</span><span class="op" id="6860564">]</span><span class="ident" id="6860565">Attr</span><span class="op" id="6860569">{</span><span class="op" id="6860570">}</span><span class="op" id="6860571">}</span><span class="op" id="6860572">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860575">CharData</span><span class="op" id="6860583">(</span><span class="string" id="6860584">&#34;&amp;#zzz;&#34;</span><span class="op" id="6860592">)</span><span class="op" id="6860593">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860596">EndElement</span><span class="op" id="6860606">{</span><span class="ident" id="6860607">Name</span><span class="op" id="6860611">{</span><span class="string" id="6860612">&#34;&#34;</span><span class="op" id="6860614">,</span>&nbsp;<span class="string" id="6860616">&#34;tag&#34;</span><span class="op" id="6860621">}</span><span class="op" id="6860622">}</span><span class="op" id="6860623">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860626">CharData</span><span class="op" id="6860634">(</span><span class="string" id="6860635">&#34;\n&#34;</span><span class="op" id="6860639">)</span><span class="op" id="6860640">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860643">StartElement</span><span class="op" id="6860655">{</span><span class="ident" id="6860656">Name</span><span class="op" id="6860660">{</span><span class="string" id="6860661">&#34;&#34;</span><span class="op" id="6860663">,</span>&nbsp;<span class="string" id="6860665">&#34;tag&#34;</span><span class="op" id="6860670">}</span><span class="op" id="6860671">,</span>&nbsp;<span class="op" id="6860673">[</span><span class="op" id="6860674">]</span><span class="ident" id="6860675">Attr</span><span class="op" id="6860679">{</span><span class="op" id="6860680">}</span><span class="op" id="6860681">}</span><span class="op" id="6860682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860685">CharData</span><span class="op" id="6860693">(</span><span class="string" id="6860694">&#34;&amp;なまえ3;&#34;</span><span class="op" id="6860708">)</span><span class="op" id="6860709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860712">EndElement</span><span class="op" id="6860722">{</span><span class="ident" id="6860723">Name</span><span class="op" id="6860727">{</span><span class="string" id="6860728">&#34;&#34;</span><span class="op" id="6860730">,</span>&nbsp;<span class="string" id="6860732">&#34;tag&#34;</span><span class="op" id="6860737">}</span><span class="op" id="6860738">}</span><span class="op" id="6860739">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860742">CharData</span><span class="op" id="6860750">(</span><span class="string" id="6860751">&#34;\n&#34;</span><span class="op" id="6860755">)</span><span class="op" id="6860756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860759">StartElement</span><span class="op" id="6860771">{</span><span class="ident" id="6860772">Name</span><span class="op" id="6860776">{</span><span class="string" id="6860777">&#34;&#34;</span><span class="op" id="6860779">,</span>&nbsp;<span class="string" id="6860781">&#34;tag&#34;</span><span class="op" id="6860786">}</span><span class="op" id="6860787">,</span>&nbsp;<span class="op" id="6860789">[</span><span class="op" id="6860790">]</span><span class="ident" id="6860791">Attr</span><span class="op" id="6860795">{</span><span class="op" id="6860796">}</span><span class="op" id="6860797">}</span><span class="op" id="6860798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860801">CharData</span><span class="op" id="6860809">(</span><span class="string" id="6860810">&#34;&amp;lt-gt;&#34;</span><span class="op" id="6860819">)</span><span class="op" id="6860820">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860823">EndElement</span><span class="op" id="6860833">{</span><span class="ident" id="6860834">Name</span><span class="op" id="6860838">{</span><span class="string" id="6860839">&#34;&#34;</span><span class="op" id="6860841">,</span>&nbsp;<span class="string" id="6860843">&#34;tag&#34;</span><span class="op" id="6860848">}</span><span class="op" id="6860849">}</span><span class="op" id="6860850">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860853">CharData</span><span class="op" id="6860861">(</span><span class="string" id="6860862">&#34;\n&#34;</span><span class="op" id="6860866">)</span><span class="op" id="6860867">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860870">StartElement</span><span class="op" id="6860882">{</span><span class="ident" id="6860883">Name</span><span class="op" id="6860887">{</span><span class="string" id="6860888">&#34;&#34;</span><span class="op" id="6860890">,</span>&nbsp;<span class="string" id="6860892">&#34;tag&#34;</span><span class="op" id="6860897">}</span><span class="op" id="6860898">,</span>&nbsp;<span class="op" id="6860900">[</span><span class="op" id="6860901">]</span><span class="ident" id="6860902">Attr</span><span class="op" id="6860906">{</span><span class="op" id="6860907">}</span><span class="op" id="6860908">}</span><span class="op" id="6860909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860912">CharData</span><span class="op" id="6860920">(</span><span class="string" id="6860921">&#34;&amp;;&#34;</span><span class="op" id="6860925">)</span><span class="op" id="6860926">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860929">EndElement</span><span class="op" id="6860939">{</span><span class="ident" id="6860940">Name</span><span class="op" id="6860944">{</span><span class="string" id="6860945">&#34;&#34;</span><span class="op" id="6860947">,</span>&nbsp;<span class="string" id="6860949">&#34;tag&#34;</span><span class="op" id="6860954">}</span><span class="op" id="6860955">}</span><span class="op" id="6860956">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860959">CharData</span><span class="op" id="6860967">(</span><span class="string" id="6860968">&#34;\n&#34;</span><span class="op" id="6860972">)</span><span class="op" id="6860973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860976">StartElement</span><span class="op" id="6860988">{</span><span class="ident" id="6860989">Name</span><span class="op" id="6860993">{</span><span class="string" id="6860994">&#34;&#34;</span><span class="op" id="6860996">,</span>&nbsp;<span class="string" id="6860998">&#34;tag&#34;</span><span class="op" id="6861003">}</span><span class="op" id="6861004">,</span>&nbsp;<span class="op" id="6861006">[</span><span class="op" id="6861007">]</span><span class="ident" id="6861008">Attr</span><span class="op" id="6861012">{</span><span class="op" id="6861013">}</span><span class="op" id="6861014">}</span><span class="op" id="6861015">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861018">CharData</span><span class="op" id="6861026">(</span><span class="string" id="6861027">&#34;&amp;0a;&#34;</span><span class="op" id="6861033">)</span><span class="op" id="6861034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861037">EndElement</span><span class="op" id="6861047">{</span><span class="ident" id="6861048">Name</span><span class="op" id="6861052">{</span><span class="string" id="6861053">&#34;&#34;</span><span class="op" id="6861055">,</span>&nbsp;<span class="string" id="6861057">&#34;tag&#34;</span><span class="op" id="6861062">}</span><span class="op" id="6861063">}</span><span class="op" id="6861064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861067">CharData</span><span class="op" id="6861075">(</span><span class="string" id="6861076">&#34;\n&#34;</span><span class="op" id="6861080">)</span><span class="op" id="6861081">,</span><br>
<span class="lineno"></span><span class="op" id="6861083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="6861086">func</span>&nbsp;<span class="ident" id="6861091">TestNonStrictRawToken</span><span class="op" id="6861112">(</span><span class="ident" id="6861113">t</span>&nbsp;<span class="op" id="6861115">*</span><span class="ident" id="6861116">testing</span><span class="op" id="6861123">.</span><span class="ident" id="6861124">T</span><span class="op" id="6861125">)</span>&nbsp;<span class="op" id="6861127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861130">d</span>&nbsp;<span class="op" id="6861132">:=</span>&nbsp;<span class="ident" id="6861135">NewDecoder</span><span class="op" id="6861145">(</span><span class="ident" id="6861146">strings</span><span class="op" id="6861153">.</span><span class="ident" id="6861154">NewReader</span><span class="op" id="6861163">(</span><span class="ident" id="6861164">nonStrictInput</span><span class="op" id="6861178">)</span><span class="op" id="6861179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861182">d</span><span class="op" id="6861183">.</span><span class="ident" id="6861184">Strict</span>&nbsp;<span class="op" id="6861191">=</span>&nbsp;<span class="builtintype" id="6861193">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861200">testRawToken</span><span class="op" id="6861212">(</span><span class="ident" id="6861213">t</span><span class="op" id="6861214">,</span>&nbsp;<span class="ident" id="6861216">d</span><span class="op" id="6861217">,</span>&nbsp;<span class="ident" id="6861219">nonStrictInput</span><span class="op" id="6861233">,</span>&nbsp;<span class="ident" id="6861235">nonStrictTokens</span><span class="op" id="6861250">)</span><br>
<span class="lineno"></span><span class="op" id="6861252">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="6861255">type</span>&nbsp;<span class="ident" id="6861260">downCaser</span>&nbsp;<span class="keyword" id="6861270">struct</span>&nbsp;<span class="op" id="6861277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861280">t</span>&nbsp;<span class="op" id="6861282">*</span><span class="ident" id="6861283">testing</span><span class="op" id="6861290">.</span><span class="ident" id="6861291">T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861294">r</span>&nbsp;<span class="ident" id="6861296">io</span><span class="op" id="6861298">.</span><span class="ident" id="6861299">ByteReader</span><br>
<span class="lineno"></span><span class="op" id="6861310">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="6861313">func</span>&nbsp;<span class="op" id="6861318">(</span><span class="ident" id="6861319">d</span>&nbsp;<span class="op" id="6861321">*</span><span class="ident" id="6861322">downCaser</span><span class="op" id="6861331">)</span>&nbsp;<span class="ident" id="6861333">ReadByte</span><span class="op" id="6861341">(</span><span class="op" id="6861342">)</span>&nbsp;<span class="op" id="6861344">(</span><span class="ident" id="6861345">c</span>&nbsp;<span class="builtintype" id="6861347">byte</span><span class="op" id="6861351">,</span>&nbsp;<span class="ident" id="6861353">err</span>&nbsp;<span class="builtintype" id="6861357">error</span><span class="op" id="6861362">)</span>&nbsp;<span class="op" id="6861364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861367">c</span><span class="op" id="6861368">,</span>&nbsp;<span class="ident" id="6861370">err</span>&nbsp;<span class="op" id="6861374">=</span>&nbsp;<span class="ident" id="6861376">d</span><span class="op" id="6861377">.</span><span class="ident" id="6861378">r</span><span class="op" id="6861379">.</span><span class="ident" id="6861380">ReadByte</span><span class="op" id="6861388">(</span><span class="op" id="6861389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6861392">if</span>&nbsp;<span class="ident" id="6861395">c</span>&nbsp;<span class="op" id="6861397">&gt;=</span>&nbsp;<span class="string" id="6861400">&#39;A&#39;</span>&nbsp;<span class="op" id="6861404">&amp;&amp;</span>&nbsp;<span class="ident" id="6861407">c</span>&nbsp;<span class="op" id="6861409">&lt;=</span>&nbsp;<span class="string" id="6861412">&#39;Z&#39;</span>&nbsp;<span class="op" id="6861416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861420">c</span>&nbsp;<span class="op" id="6861422">+=</span>&nbsp;<span class="string" id="6861425">&#39;a&#39;</span>&nbsp;<span class="op" id="6861429">-</span>&nbsp;<span class="string" id="6861431">&#39;A&#39;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6861436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6861439">return</span><br>
<span class="lineno"></span><span class="op" id="6861446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6861449">func</span>&nbsp;<span class="op" id="6861454">(</span><span class="ident" id="6861455">d</span>&nbsp;<span class="op" id="6861457">*</span><span class="ident" id="6861458">downCaser</span><span class="op" id="6861467">)</span>&nbsp;<span class="ident" id="6861469">Read</span><span class="op" id="6861473">(</span><span class="ident" id="6861474">p</span>&nbsp;<span class="op" id="6861476">[</span><span class="op" id="6861477">]</span><span class="builtintype" id="6861478">byte</span><span class="op" id="6861482">)</span>&nbsp;<span class="op" id="6861484">(</span><span class="builtintype" id="6861485">int</span><span class="op" id="6861488">,</span>&nbsp;<span class="builtintype" id="6861490">error</span><span class="op" id="6861495">)</span>&nbsp;<span class="op" id="6861497">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861500">d</span><span class="op" id="6861501">.</span><span class="ident" id="6861502">t</span><span class="op" id="6861503">.</span><span class="ident" id="6861504">Fatalf</span><span class="op" id="6861510">(</span><span class="string" id="6861511">&#34;unexpected&nbsp;Read&nbsp;call&nbsp;on&nbsp;downCaser&nbsp;reader&#34;</span><span class="op" id="6861553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6861556">panic</span><span class="op" id="6861561">(</span><span class="string" id="6861562">&#34;unreachable&#34;</span><span class="op" id="6861575">)</span><br>
<span class="lineno"></span><span class="op" id="6861577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6861580">func</span>&nbsp;<span class="ident" id="6861585">TestRawTokenAltEncoding</span><span class="op" id="6861608">(</span><span class="ident" id="6861609">t</span>&nbsp;<span class="op" id="6861611">*</span><span class="ident" id="6861612">testing</span><span class="op" id="6861619">.</span><span class="ident" id="6861620">T</span><span class="op" id="6861621">)</span>&nbsp;<span class="op" id="6861623">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861626">d</span>&nbsp;<span class="op" id="6861628">:=</span>&nbsp;<span class="ident" id="6861631">NewDecoder</span><span class="op" id="6861641">(</span><span class="ident" id="6861642">strings</span><span class="op" id="6861649">.</span><span class="ident" id="6861650">NewReader</span><span class="op" id="6861659">(</span><span class="ident" id="6861660">testInputAltEncoding</span><span class="op" id="6861680">)</span><span class="op" id="6861681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861684">d</span><span class="op" id="6861685">.</span><span class="ident" id="6861686">CharsetReader</span>&nbsp;<span class="op" id="6861700">=</span>&nbsp;<span class="keyword" id="6861702">func</span><span class="op" id="6861706">(</span><span class="ident" id="6861707">charset</span>&nbsp;<span class="builtintype" id="6861715">string</span><span class="op" id="6861721">,</span>&nbsp;<span class="ident" id="6861723">input</span>&nbsp;<span class="ident" id="6861729">io</span><span class="op" id="6861731">.</span><span class="ident" id="6861732">Reader</span><span class="op" id="6861738">)</span>&nbsp;<span class="op" id="6861740">(</span><span class="ident" id="6861741">io</span><span class="op" id="6861743">.</span><span class="ident" id="6861744">Reader</span><span class="op" id="6861750">,</span>&nbsp;<span class="builtintype" id="6861752">error</span><span class="op" id="6861757">)</span>&nbsp;<span class="op" id="6861759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6861763">if</span>&nbsp;<span class="ident" id="6861766">charset</span>&nbsp;<span class="op" id="6861774">!=</span>&nbsp;<span class="string" id="6861777">&#34;x-testing-uppercase&#34;</span>&nbsp;<span class="op" id="6861799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861804">t</span><span class="op" id="6861805">.</span><span class="ident" id="6861806">Fatalf</span><span class="op" id="6861812">(</span><span class="string" id="6861813">&#34;unexpected&nbsp;charset&nbsp;%q&#34;</span><span class="op" id="6861836">,</span>&nbsp;<span class="ident" id="6861838">charset</span><span class="op" id="6861845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6861849">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6861853">return</span>&nbsp;<span class="op" id="6861860">&amp;</span><span class="ident" id="6861861">downCaser</span><span class="op" id="6861870">{</span><span class="ident" id="6861871">t</span><span class="op" id="6861872">,</span>&nbsp;<span class="ident" id="6861874">input</span><span class="op" id="6861879">.</span><span class="op" id="6861880">(</span><span class="ident" id="6861881">io</span><span class="op" id="6861883">.</span><span class="ident" id="6861884">ByteReader</span><span class="op" id="6861894">)</span><span class="op" id="6861895">}</span><span class="op" id="6861896">,</span>&nbsp;<span class="ident" id="6861898">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6861903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861906">testRawToken</span><span class="op" id="6861918">(</span><span class="ident" id="6861919">t</span><span class="op" id="6861920">,</span>&nbsp;<span class="ident" id="6861922">d</span><span class="op" id="6861923">,</span>&nbsp;<span class="ident" id="6861925">testInputAltEncoding</span><span class="op" id="6861945">,</span>&nbsp;<span class="ident" id="6861947">rawTokensAltEncoding</span><span class="op" id="6861967">)</span><br>
<span class="lineno"></span><span class="op" id="6861969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="6861972">func</span>&nbsp;<span class="ident" id="6861977">TestRawTokenAltEncodingNoConverter</span><span class="op" id="6862011">(</span><span class="ident" id="6862012">t</span>&nbsp;<span class="op" id="6862014">*</span><span class="ident" id="6862015">testing</span><span class="op" id="6862022">.</span><span class="ident" id="6862023">T</span><span class="op" id="6862024">)</span>&nbsp;<span class="op" id="6862026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862029">d</span>&nbsp;<span class="op" id="6862031">:=</span>&nbsp;<span class="ident" id="6862034">NewDecoder</span><span class="op" id="6862044">(</span><span class="ident" id="6862045">strings</span><span class="op" id="6862052">.</span><span class="ident" id="6862053">NewReader</span><span class="op" id="6862062">(</span><span class="ident" id="6862063">testInputAltEncoding</span><span class="op" id="6862083">)</span><span class="op" id="6862084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862087">token</span><span class="op" id="6862092">,</span>&nbsp;<span class="ident" id="6862094">err</span>&nbsp;<span class="op" id="6862098">:=</span>&nbsp;<span class="ident" id="6862101">d</span><span class="op" id="6862102">.</span><span class="ident" id="6862103">RawToken</span><span class="op" id="6862111">(</span><span class="op" id="6862112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6862115">if</span>&nbsp;<span class="ident" id="6862118">token</span>&nbsp;<span class="op" id="6862124">==</span>&nbsp;<span class="ident" id="6862127">nil</span>&nbsp;<span class="op" id="6862131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862135">t</span><span class="op" id="6862136">.</span><span class="ident" id="6862137">Fatalf</span><span class="op" id="6862143">(</span><span class="string" id="6862144">&#34;expected&nbsp;a&nbsp;token&nbsp;on&nbsp;first&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="6862185">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6862188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6862191">if</span>&nbsp;<span class="ident" id="6862194">err</span>&nbsp;<span class="op" id="6862198">!=</span>&nbsp;<span class="ident" id="6862201">nil</span>&nbsp;<span class="op" id="6862205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862209">t</span><span class="op" id="6862210">.</span><span class="ident" id="6862211">Fatal</span><span class="op" id="6862216">(</span><span class="ident" id="6862217">err</span><span class="op" id="6862220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6862223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862226">token</span><span class="op" id="6862231">,</span>&nbsp;<span class="ident" id="6862233">err</span>&nbsp;<span class="op" id="6862237">=</span>&nbsp;<span class="ident" id="6862239">d</span><span class="op" id="6862240">.</span><span class="ident" id="6862241">RawToken</span><span class="op" id="6862249">(</span><span class="op" id="6862250">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6862253">if</span>&nbsp;<span class="ident" id="6862256">token</span>&nbsp;<span class="op" id="6862262">!=</span>&nbsp;<span class="ident" id="6862265">nil</span>&nbsp;<span class="op" id="6862269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862273">t</span><span class="op" id="6862274">.</span><span class="ident" id="6862275">Errorf</span><span class="op" id="6862281">(</span><span class="string" id="6862282">&#34;expected&nbsp;a&nbsp;nil&nbsp;token;&nbsp;got&nbsp;%#v&#34;</span><span class="op" id="6862313">,</span>&nbsp;<span class="ident" id="6862315">token</span><span class="op" id="6862320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6862323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6862326">if</span>&nbsp;<span class="ident" id="6862329">err</span>&nbsp;<span class="op" id="6862333">==</span>&nbsp;<span class="ident" id="6862336">nil</span>&nbsp;<span class="op" id="6862340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862344">t</span><span class="op" id="6862345">.</span><span class="ident" id="6862346">Fatalf</span><span class="op" id="6862352">(</span><span class="string" id="6862353">&#34;expected&nbsp;an&nbsp;error&nbsp;on&nbsp;second&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="6862396">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6862399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6862402">const</span>&nbsp;<span class="ident" id="6862408">encoding</span>&nbsp;<span class="op" id="6862417">=</span>&nbsp;<span class="string" id="6862419">&#34;x-testing-uppercase&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6862442">if</span>&nbsp;<span class="op" id="6862445">!</span><span class="ident" id="6862446">strings</span><span class="op" id="6862453">.</span><span class="ident" id="6862454">Contains</span><span class="op" id="6862462">(</span><span class="ident" id="6862463">err</span><span class="op" id="6862466">.</span><span class="ident" id="6862467">Error</span><span class="op" id="6862472">(</span><span class="op" id="6862473">)</span><span class="op" id="6862474">,</span>&nbsp;<span class="ident" id="6862476">encoding</span><span class="op" id="6862484">)</span>&nbsp;<span class="op" id="6862486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862490">t</span><span class="op" id="6862491">.</span><span class="ident" id="6862492">Errorf</span><span class="op" id="6862498">(</span><span class="string" id="6862499">&#34;expected&nbsp;error&nbsp;to&nbsp;contain&nbsp;%q;&nbsp;got&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="6862544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862549">encoding</span><span class="op" id="6862557">,</span>&nbsp;<span class="ident" id="6862559">err</span><span class="op" id="6862562">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6862565">}</span><br>
<span class="lineno"></span><span class="op" id="6862567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6862570">func</span>&nbsp;<span class="ident" id="6862575">testRawToken</span><span class="op" id="6862587">(</span><span class="ident" id="6862588">t</span>&nbsp;<span class="op" id="6862590">*</span><span class="ident" id="6862591">testing</span><span class="op" id="6862598">.</span><span class="ident" id="6862599">T</span><span class="op" id="6862600">,</span>&nbsp;<span class="ident" id="6862602">d</span>&nbsp;<span class="op" id="6862604">*</span><span class="ident" id="6862605">Decoder</span><span class="op" id="6862612">,</span>&nbsp;<span class="ident" id="6862614">raw</span>&nbsp;<span class="builtintype" id="6862618">string</span><span class="op" id="6862624">,</span>&nbsp;<span class="ident" id="6862626">rawTokens</span>&nbsp;<span class="op" id="6862636">[</span><span class="op" id="6862637">]</span><span class="ident" id="6862638">Token</span><span class="op" id="6862643">)</span>&nbsp;<span class="op" id="6862645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862648">lastEnd</span>&nbsp;<span class="op" id="6862656">:=</span>&nbsp;<span class="ident" id="6862659">int64</span><span class="op" id="6862664">(</span><span class="num" id="6862665">0</span><span class="op" id="6862666">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6862669">for</span>&nbsp;<span class="ident" id="6862673">i</span><span class="op" id="6862674">,</span>&nbsp;<span class="ident" id="6862676">want</span>&nbsp;<span class="op" id="6862681">:=</span>&nbsp;<span class="keyword" id="6862684">range</span>&nbsp;<span class="ident" id="6862690">rawTokens</span>&nbsp;<span class="op" id="6862700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862704">start</span>&nbsp;<span class="op" id="6862710">:=</span>&nbsp;<span class="ident" id="6862713">d</span><span class="op" id="6862714">.</span><span class="ident" id="6862715">InputOffset</span><span class="op" id="6862726">(</span><span class="op" id="6862727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862731">have</span><span class="op" id="6862735">,</span>&nbsp;<span class="ident" id="6862737">err</span>&nbsp;<span class="op" id="6862741">:=</span>&nbsp;<span class="ident" id="6862744">d</span><span class="op" id="6862745">.</span><span class="ident" id="6862746">RawToken</span><span class="op" id="6862754">(</span><span class="op" id="6862755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862759">end</span>&nbsp;<span class="op" id="6862763">:=</span>&nbsp;<span class="ident" id="6862766">d</span><span class="op" id="6862767">.</span><span class="ident" id="6862768">InputOffset</span><span class="op" id="6862779">(</span><span class="op" id="6862780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6862784">if</span>&nbsp;<span class="ident" id="6862787">err</span>&nbsp;<span class="op" id="6862791">!=</span>&nbsp;<span class="ident" id="6862794">nil</span>&nbsp;<span class="op" id="6862798">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862803">t</span><span class="op" id="6862804">.</span><span class="ident" id="6862805">Fatalf</span><span class="op" id="6862811">(</span><span class="string" id="6862812">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="6862844">,</span>&nbsp;<span class="ident" id="6862846">i</span><span class="op" id="6862847">,</span>&nbsp;<span class="ident" id="6862849">err</span><span class="op" id="6862852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6862856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6862860">if</span>&nbsp;<span class="op" id="6862863">!</span><span class="ident" id="6862864">reflect</span><span class="op" id="6862871">.</span><span class="ident" id="6862872">DeepEqual</span><span class="op" id="6862881">(</span><span class="ident" id="6862882">have</span><span class="op" id="6862886">,</span>&nbsp;<span class="ident" id="6862888">want</span><span class="op" id="6862892">)</span>&nbsp;<span class="op" id="6862894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6862899">var</span>&nbsp;<span class="ident" id="6862903">shave</span><span class="op" id="6862908">,</span>&nbsp;<span class="ident" id="6862910">swant</span>&nbsp;<span class="builtintype" id="6862916">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6862926">if</span>&nbsp;<span class="ident" id="6862929">_</span><span class="op" id="6862930">,</span>&nbsp;<span class="ident" id="6862932">ok</span>&nbsp;<span class="op" id="6862935">:=</span>&nbsp;<span class="ident" id="6862938">have</span><span class="op" id="6862942">.</span><span class="op" id="6862943">(</span><span class="ident" id="6862944">CharData</span><span class="op" id="6862952">)</span><span class="op" id="6862953">;</span>&nbsp;<span class="ident" id="6862955">ok</span>&nbsp;<span class="op" id="6862958">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6862964">shave</span>&nbsp;<span class="op" id="6862970">=</span>&nbsp;<span class="ident" id="6862972">fmt</span><span class="op" id="6862975">.</span><span class="ident" id="6862976">Sprintf</span><span class="op" id="6862983">(</span><span class="string" id="6862984">&#34;CharData(%q)&#34;</span><span class="op" id="6862998">,</span>&nbsp;<span class="ident" id="6863000">have</span><span class="op" id="6863004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6863009">}</span>&nbsp;<span class="keyword" id="6863011">else</span>&nbsp;<span class="op" id="6863016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863022">shave</span>&nbsp;<span class="op" id="6863028">=</span>&nbsp;<span class="ident" id="6863030">fmt</span><span class="op" id="6863033">.</span><span class="ident" id="6863034">Sprintf</span><span class="op" id="6863041">(</span><span class="string" id="6863042">&#34;%#v&#34;</span><span class="op" id="6863047">,</span>&nbsp;<span class="ident" id="6863049">have</span><span class="op" id="6863053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6863058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6863063">if</span>&nbsp;<span class="ident" id="6863066">_</span><span class="op" id="6863067">,</span>&nbsp;<span class="ident" id="6863069">ok</span>&nbsp;<span class="op" id="6863072">:=</span>&nbsp;<span class="ident" id="6863075">want</span><span class="op" id="6863079">.</span><span class="op" id="6863080">(</span><span class="ident" id="6863081">CharData</span><span class="op" id="6863089">)</span><span class="op" id="6863090">;</span>&nbsp;<span class="ident" id="6863092">ok</span>&nbsp;<span class="op" id="6863095">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863101">swant</span>&nbsp;<span class="op" id="6863107">=</span>&nbsp;<span class="ident" id="6863109">fmt</span><span class="op" id="6863112">.</span><span class="ident" id="6863113">Sprintf</span><span class="op" id="6863120">(</span><span class="string" id="6863121">&#34;CharData(%q)&#34;</span><span class="op" id="6863135">,</span>&nbsp;<span class="ident" id="6863137">want</span><span class="op" id="6863141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6863146">}</span>&nbsp;<span class="keyword" id="6863148">else</span>&nbsp;<span class="op" id="6863153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863159">swant</span>&nbsp;<span class="op" id="6863165">=</span>&nbsp;<span class="ident" id="6863167">fmt</span><span class="op" id="6863170">.</span><span class="ident" id="6863171">Sprintf</span><span class="op" id="6863178">(</span><span class="string" id="6863179">&#34;%#v&#34;</span><span class="op" id="6863184">,</span>&nbsp;<span class="ident" id="6863186">want</span><span class="op" id="6863190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6863195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863200">t</span><span class="op" id="6863201">.</span><span class="ident" id="6863202">Errorf</span><span class="op" id="6863208">(</span><span class="string" id="6863209">&#34;token&nbsp;%d&nbsp;=&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="6863233">,</span>&nbsp;<span class="ident" id="6863235">i</span><span class="op" id="6863236">,</span>&nbsp;<span class="ident" id="6863238">shave</span><span class="op" id="6863243">,</span>&nbsp;<span class="ident" id="6863245">swant</span><span class="op" id="6863250">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6863254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6863259">//&nbsp;Check&nbsp;that&nbsp;InputOffset&nbsp;returned&nbsp;actual&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6863310">switch</span>&nbsp;<span class="op" id="6863317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6863321">case</span>&nbsp;<span class="ident" id="6863326">start</span>&nbsp;<span class="op" id="6863332">&lt;</span>&nbsp;<span class="ident" id="6863334">lastEnd</span><span class="op" id="6863341">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863346">t</span><span class="op" id="6863347">.</span><span class="ident" id="6863348">Errorf</span><span class="op" id="6863354">(</span><span class="string" id="6863355">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;before&nbsp;previous&nbsp;token&#34;</span><span class="op" id="6863415">,</span>&nbsp;<span class="ident" id="6863417">i</span><span class="op" id="6863418">,</span>&nbsp;<span class="ident" id="6863420">start</span><span class="op" id="6863425">,</span>&nbsp;<span class="ident" id="6863427">end</span><span class="op" id="6863430">,</span>&nbsp;<span class="ident" id="6863432">have</span><span class="op" id="6863436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6863440">case</span>&nbsp;<span class="ident" id="6863445">start</span>&nbsp;<span class="op" id="6863451">&gt;=</span>&nbsp;<span class="ident" id="6863454">end</span><span class="op" id="6863457">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6863462">//&nbsp;Special&nbsp;case:&nbsp;EndElement&nbsp;can&nbsp;be&nbsp;synthesized.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6863513">if</span>&nbsp;<span class="ident" id="6863516">start</span>&nbsp;<span class="op" id="6863522">==</span>&nbsp;<span class="ident" id="6863525">end</span>&nbsp;<span class="op" id="6863529">&amp;&amp;</span>&nbsp;<span class="ident" id="6863532">end</span>&nbsp;<span class="op" id="6863536">==</span>&nbsp;<span class="ident" id="6863539">lastEnd</span>&nbsp;<span class="op" id="6863547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6863553">break</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6863562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863567">t</span><span class="op" id="6863568">.</span><span class="ident" id="6863569">Errorf</span><span class="op" id="6863575">(</span><span class="string" id="6863576">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;empty&#34;</span><span class="op" id="6863620">,</span>&nbsp;<span class="ident" id="6863622">i</span><span class="op" id="6863623">,</span>&nbsp;<span class="ident" id="6863625">start</span><span class="op" id="6863630">,</span>&nbsp;<span class="ident" id="6863632">end</span><span class="op" id="6863635">,</span>&nbsp;<span class="ident" id="6863637">have</span><span class="op" id="6863641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6863645">case</span>&nbsp;<span class="ident" id="6863650">end</span>&nbsp;<span class="op" id="6863654">&gt;</span>&nbsp;<span class="ident" id="6863656">int64</span><span class="op" id="6863661">(</span><span class="builtinfunc" id="6863662">len</span><span class="op" id="6863665">(</span><span class="ident" id="6863666">raw</span><span class="op" id="6863669">)</span><span class="op" id="6863670">)</span><span class="op" id="6863671">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863676">t</span><span class="op" id="6863677">.</span><span class="ident" id="6863678">Errorf</span><span class="op" id="6863684">(</span><span class="string" id="6863685">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;extends&nbsp;beyond&nbsp;input&#34;</span><span class="op" id="6863741">,</span>&nbsp;<span class="ident" id="6863743">i</span><span class="op" id="6863744">,</span>&nbsp;<span class="ident" id="6863746">start</span><span class="op" id="6863751">,</span>&nbsp;<span class="ident" id="6863753">end</span><span class="op" id="6863756">,</span>&nbsp;<span class="ident" id="6863758">have</span><span class="op" id="6863762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6863766">default</span><span class="op" id="6863773">:</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863778">text</span>&nbsp;<span class="op" id="6863783">:=</span>&nbsp;<span class="ident" id="6863786">raw</span><span class="op" id="6863789">[</span><span class="ident" id="6863790">start</span><span class="op" id="6863795">:</span><span class="ident" id="6863796">end</span><span class="op" id="6863799">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6863804">if</span>&nbsp;<span class="ident" id="6863807">strings</span><span class="op" id="6863814">.</span><span class="ident" id="6863815">ContainsAny</span><span class="op" id="6863826">(</span><span class="ident" id="6863827">text</span><span class="op" id="6863831">,</span>&nbsp;<span class="string" id="6863833">&#34;&lt;&gt;&#34;</span><span class="op" id="6863837">)</span>&nbsp;<span class="op" id="6863839">&amp;&amp;</span>&nbsp;<span class="op" id="6863842">(</span><span class="op" id="6863843">!</span><span class="ident" id="6863844">strings</span><span class="op" id="6863851">.</span><span class="ident" id="6863852">HasPrefix</span><span class="op" id="6863861">(</span><span class="ident" id="6863862">text</span><span class="op" id="6863866">,</span>&nbsp;<span class="string" id="6863868">&#34;&lt;&#34;</span><span class="op" id="6863871">)</span>&nbsp;<span class="op" id="6863873">||</span>&nbsp;<span class="op" id="6863876">!</span><span class="ident" id="6863877">strings</span><span class="op" id="6863884">.</span><span class="ident" id="6863885">HasSuffix</span><span class="op" id="6863894">(</span><span class="ident" id="6863895">text</span><span class="op" id="6863899">,</span>&nbsp;<span class="string" id="6863901">&#34;&gt;&#34;</span><span class="op" id="6863904">)</span><span class="op" id="6863905">)</span>&nbsp;<span class="op" id="6863907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863913">t</span><span class="op" id="6863914">.</span><span class="ident" id="6863915">Errorf</span><span class="op" id="6863921">(</span><span class="string" id="6863922">&#34;token&nbsp;%d:&nbsp;misaligned&nbsp;raw&nbsp;token&nbsp;%#q&nbsp;for&nbsp;%T&#34;</span><span class="op" id="6863965">,</span>&nbsp;<span class="ident" id="6863967">i</span><span class="op" id="6863968">,</span>&nbsp;<span class="ident" id="6863970">text</span><span class="op" id="6863974">,</span>&nbsp;<span class="ident" id="6863976">have</span><span class="op" id="6863980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6863985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6863989">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6863993">lastEnd</span>&nbsp;<span class="op" id="6864001">=</span>&nbsp;<span class="ident" id="6864003">end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6864008">}</span><br>
<span class="lineno"></span><span class="op" id="6864010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6864013">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;(specifically&nbsp;!DOCTYPE)&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno">330</span><span class="comment" id="6864084">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives,&nbsp;noting&nbsp;that&nbsp;&lt;&nbsp;and&nbsp;&gt;&nbsp;do&nbsp;not&nbsp;change</span><br>
<span class="lineno"></span><span class="comment" id="6864152">//&nbsp;nesting&nbsp;depth&nbsp;if&nbsp;they&nbsp;are&nbsp;in&nbsp;single&nbsp;or&nbsp;double&nbsp;quotes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6864210">var</span>&nbsp;<span class="ident" id="6864214">nestedDirectivesInput</span>&nbsp;<span class="op" id="6864236">=</span>&nbsp;<span class="string" id="6864238">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno">335</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]&gt;<br>
<span class="lineno">340</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6864504">var</span>&nbsp;<span class="ident" id="6864508">nestedDirectivesTokens</span>&nbsp;<span class="op" id="6864531">=</span>&nbsp;<span class="op" id="6864533">[</span><span class="op" id="6864534">]</span><span class="ident" id="6864535">Token</span><span class="op" id="6864540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864543">CharData</span><span class="op" id="6864551">(</span><span class="string" id="6864552">&#34;\n&#34;</span><span class="op" id="6864556">)</span><span class="op" id="6864557">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864560">Directive</span><span class="op" id="6864569">(</span><span class="string" id="6864570">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="6864641">)</span><span class="op" id="6864642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864645">CharData</span><span class="op" id="6864653">(</span><span class="string" id="6864654">&#34;\n&#34;</span><span class="op" id="6864658">)</span><span class="op" id="6864659">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864662">Directive</span><span class="op" id="6864671">(</span><span class="string" id="6864672">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]`</span><span class="op" id="6864701">)</span><span class="op" id="6864702">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864705">CharData</span><span class="op" id="6864713">(</span><span class="string" id="6864714">&#34;\n&#34;</span><span class="op" id="6864718">)</span><span class="op" id="6864719">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864722">Directive</span><span class="op" id="6864731">(</span><span class="string" id="6864732">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]`</span><span class="op" id="6864761">)</span><span class="op" id="6864762">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864765">CharData</span><span class="op" id="6864773">(</span><span class="string" id="6864774">&#34;\n&#34;</span><span class="op" id="6864778">)</span><span class="op" id="6864779">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864782">Directive</span><span class="op" id="6864791">(</span><span class="string" id="6864792">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]`</span><span class="op" id="6864821">)</span><span class="op" id="6864822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864825">CharData</span><span class="op" id="6864833">(</span><span class="string" id="6864834">&#34;\n&#34;</span><span class="op" id="6864838">)</span><span class="op" id="6864839">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864842">Directive</span><span class="op" id="6864851">(</span><span class="string" id="6864852">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]`</span><span class="op" id="6864881">)</span><span class="op" id="6864882">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864885">CharData</span><span class="op" id="6864893">(</span><span class="string" id="6864894">&#34;\n&#34;</span><span class="op" id="6864898">)</span><span class="op" id="6864899">,</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864902">Directive</span><span class="op" id="6864911">(</span><span class="string" id="6864912">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]`</span><span class="op" id="6864942">)</span><span class="op" id="6864943">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864946">CharData</span><span class="op" id="6864954">(</span><span class="string" id="6864955">&#34;\n&#34;</span><span class="op" id="6864959">)</span><span class="op" id="6864960">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6864963">Directive</span><span class="op" id="6864972">(</span><span class="string" id="6864973">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]`</span><span class="op" id="6865003">)</span><span class="op" id="6865004">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865007">CharData</span><span class="op" id="6865015">(</span><span class="string" id="6865016">&#34;\n&#34;</span><span class="op" id="6865020">)</span><span class="op" id="6865021">,</span><br>
<span class="lineno"></span><span class="op" id="6865023">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="6865026">func</span>&nbsp;<span class="ident" id="6865031">TestNestedDirectives</span><span class="op" id="6865051">(</span><span class="ident" id="6865052">t</span>&nbsp;<span class="op" id="6865054">*</span><span class="ident" id="6865055">testing</span><span class="op" id="6865062">.</span><span class="ident" id="6865063">T</span><span class="op" id="6865064">)</span>&nbsp;<span class="op" id="6865066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865069">d</span>&nbsp;<span class="op" id="6865071">:=</span>&nbsp;<span class="ident" id="6865074">NewDecoder</span><span class="op" id="6865084">(</span><span class="ident" id="6865085">strings</span><span class="op" id="6865092">.</span><span class="ident" id="6865093">NewReader</span><span class="op" id="6865102">(</span><span class="ident" id="6865103">nestedDirectivesInput</span><span class="op" id="6865124">)</span><span class="op" id="6865125">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6865129">for</span>&nbsp;<span class="ident" id="6865133">i</span><span class="op" id="6865134">,</span>&nbsp;<span class="ident" id="6865136">want</span>&nbsp;<span class="op" id="6865141">:=</span>&nbsp;<span class="keyword" id="6865144">range</span>&nbsp;<span class="ident" id="6865150">nestedDirectivesTokens</span>&nbsp;<span class="op" id="6865173">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865177">have</span><span class="op" id="6865181">,</span>&nbsp;<span class="ident" id="6865183">err</span>&nbsp;<span class="op" id="6865187">:=</span>&nbsp;<span class="ident" id="6865190">d</span><span class="op" id="6865191">.</span><span class="ident" id="6865192">Token</span><span class="op" id="6865197">(</span><span class="op" id="6865198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6865202">if</span>&nbsp;<span class="ident" id="6865205">err</span>&nbsp;<span class="op" id="6865209">!=</span>&nbsp;<span class="ident" id="6865212">nil</span>&nbsp;<span class="op" id="6865216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865221">t</span><span class="op" id="6865222">.</span><span class="ident" id="6865223">Fatalf</span><span class="op" id="6865229">(</span><span class="string" id="6865230">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="6865262">,</span>&nbsp;<span class="ident" id="6865264">i</span><span class="op" id="6865265">,</span>&nbsp;<span class="ident" id="6865267">err</span><span class="op" id="6865270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6865274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6865278">if</span>&nbsp;<span class="op" id="6865281">!</span><span class="ident" id="6865282">reflect</span><span class="op" id="6865289">.</span><span class="ident" id="6865290">DeepEqual</span><span class="op" id="6865299">(</span><span class="ident" id="6865300">have</span><span class="op" id="6865304">,</span>&nbsp;<span class="ident" id="6865306">want</span><span class="op" id="6865310">)</span>&nbsp;<span class="op" id="6865312">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865317">t</span><span class="op" id="6865318">.</span><span class="ident" id="6865319">Errorf</span><span class="op" id="6865325">(</span><span class="string" id="6865326">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="6865351">,</span>&nbsp;<span class="ident" id="6865353">i</span><span class="op" id="6865354">,</span>&nbsp;<span class="ident" id="6865356">have</span><span class="op" id="6865360">,</span>&nbsp;<span class="ident" id="6865362">want</span><span class="op" id="6865366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6865370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6865373">}</span><br>
<span class="lineno"></span><span class="op" id="6865375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="keyword" id="6865378">func</span>&nbsp;<span class="ident" id="6865383">TestToken</span><span class="op" id="6865392">(</span><span class="ident" id="6865393">t</span>&nbsp;<span class="op" id="6865395">*</span><span class="ident" id="6865396">testing</span><span class="op" id="6865403">.</span><span class="ident" id="6865404">T</span><span class="op" id="6865405">)</span>&nbsp;<span class="op" id="6865407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865410">d</span>&nbsp;<span class="op" id="6865412">:=</span>&nbsp;<span class="ident" id="6865415">NewDecoder</span><span class="op" id="6865425">(</span><span class="ident" id="6865426">strings</span><span class="op" id="6865433">.</span><span class="ident" id="6865434">NewReader</span><span class="op" id="6865443">(</span><span class="ident" id="6865444">testInput</span><span class="op" id="6865453">)</span><span class="op" id="6865454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865457">d</span><span class="op" id="6865458">.</span><span class="ident" id="6865459">Entity</span>&nbsp;<span class="op" id="6865466">=</span>&nbsp;<span class="ident" id="6865468">testEntity</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6865481">for</span>&nbsp;<span class="ident" id="6865485">i</span><span class="op" id="6865486">,</span>&nbsp;<span class="ident" id="6865488">want</span>&nbsp;<span class="op" id="6865493">:=</span>&nbsp;<span class="keyword" id="6865496">range</span>&nbsp;<span class="ident" id="6865502">cookedTokens</span>&nbsp;<span class="op" id="6865515">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865519">have</span><span class="op" id="6865523">,</span>&nbsp;<span class="ident" id="6865525">err</span>&nbsp;<span class="op" id="6865529">:=</span>&nbsp;<span class="ident" id="6865532">d</span><span class="op" id="6865533">.</span><span class="ident" id="6865534">Token</span><span class="op" id="6865539">(</span><span class="op" id="6865540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6865544">if</span>&nbsp;<span class="ident" id="6865547">err</span>&nbsp;<span class="op" id="6865551">!=</span>&nbsp;<span class="ident" id="6865554">nil</span>&nbsp;<span class="op" id="6865558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865563">t</span><span class="op" id="6865564">.</span><span class="ident" id="6865565">Fatalf</span><span class="op" id="6865571">(</span><span class="string" id="6865572">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="6865604">,</span>&nbsp;<span class="ident" id="6865606">i</span><span class="op" id="6865607">,</span>&nbsp;<span class="ident" id="6865609">err</span><span class="op" id="6865612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6865616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6865620">if</span>&nbsp;<span class="op" id="6865623">!</span><span class="ident" id="6865624">reflect</span><span class="op" id="6865631">.</span><span class="ident" id="6865632">DeepEqual</span><span class="op" id="6865641">(</span><span class="ident" id="6865642">have</span><span class="op" id="6865646">,</span>&nbsp;<span class="ident" id="6865648">want</span><span class="op" id="6865652">)</span>&nbsp;<span class="op" id="6865654">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865659">t</span><span class="op" id="6865660">.</span><span class="ident" id="6865661">Errorf</span><span class="op" id="6865667">(</span><span class="string" id="6865668">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="6865693">,</span>&nbsp;<span class="ident" id="6865695">i</span><span class="op" id="6865696">,</span>&nbsp;<span class="ident" id="6865698">have</span><span class="op" id="6865702">,</span>&nbsp;<span class="ident" id="6865704">want</span><span class="op" id="6865708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6865712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6865715">}</span><br>
<span class="lineno"></span><span class="op" id="6865717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="keyword" id="6865720">func</span>&nbsp;<span class="ident" id="6865725">TestSyntax</span><span class="op" id="6865735">(</span><span class="ident" id="6865736">t</span>&nbsp;<span class="op" id="6865738">*</span><span class="ident" id="6865739">testing</span><span class="op" id="6865746">.</span><span class="ident" id="6865747">T</span><span class="op" id="6865748">)</span>&nbsp;<span class="op" id="6865750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6865753">for</span>&nbsp;<span class="ident" id="6865757">i</span>&nbsp;<span class="op" id="6865759">:=</span>&nbsp;<span class="keyword" id="6865762">range</span>&nbsp;<span class="ident" id="6865768">xmlInput</span>&nbsp;<span class="op" id="6865777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865781">d</span>&nbsp;<span class="op" id="6865783">:=</span>&nbsp;<span class="ident" id="6865786">NewDecoder</span><span class="op" id="6865796">(</span><span class="ident" id="6865797">strings</span><span class="op" id="6865804">.</span><span class="ident" id="6865805">NewReader</span><span class="op" id="6865814">(</span><span class="ident" id="6865815">xmlInput</span><span class="op" id="6865823">[</span><span class="ident" id="6865824">i</span><span class="op" id="6865825">]</span><span class="op" id="6865826">)</span><span class="op" id="6865827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6865831">var</span>&nbsp;<span class="ident" id="6865835">err</span>&nbsp;<span class="builtintype" id="6865839">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6865847">for</span>&nbsp;<span class="ident" id="6865851">_</span><span class="op" id="6865852">,</span>&nbsp;<span class="ident" id="6865854">err</span>&nbsp;<span class="op" id="6865858">=</span>&nbsp;<span class="ident" id="6865860">d</span><span class="op" id="6865861">.</span><span class="ident" id="6865862">Token</span><span class="op" id="6865867">(</span><span class="op" id="6865868">)</span><span class="op" id="6865869">;</span>&nbsp;<span class="ident" id="6865871">err</span>&nbsp;<span class="op" id="6865875">==</span>&nbsp;<span class="ident" id="6865878">nil</span><span class="op" id="6865881">;</span>&nbsp;<span class="ident" id="6865883">_</span><span class="op" id="6865884">,</span>&nbsp;<span class="ident" id="6865886">err</span>&nbsp;<span class="op" id="6865890">=</span>&nbsp;<span class="ident" id="6865892">d</span><span class="op" id="6865893">.</span><span class="ident" id="6865894">Token</span><span class="op" id="6865899">(</span><span class="op" id="6865900">)</span>&nbsp;<span class="op" id="6865902">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6865906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6865910">if</span>&nbsp;<span class="ident" id="6865913">_</span><span class="op" id="6865914">,</span>&nbsp;<span class="ident" id="6865916">ok</span>&nbsp;<span class="op" id="6865919">:=</span>&nbsp;<span class="ident" id="6865922">err</span><span class="op" id="6865925">.</span><span class="op" id="6865926">(</span><span class="op" id="6865927">*</span><span class="ident" id="6865928">SyntaxError</span><span class="op" id="6865939">)</span><span class="op" id="6865940">;</span>&nbsp;<span class="op" id="6865942">!</span><span class="ident" id="6865943">ok</span>&nbsp;<span class="op" id="6865946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6865951">t</span><span class="op" id="6865952">.</span><span class="ident" id="6865953">Fatalf</span><span class="op" id="6865959">(</span><span class="string" id="6865960">`xmlInput&nbsp;&#34;%s&#34;:&nbsp;expected&nbsp;SyntaxError&nbsp;not&nbsp;received`</span><span class="op" id="6866010">,</span>&nbsp;<span class="ident" id="6866012">xmlInput</span><span class="op" id="6866020">[</span><span class="ident" id="6866021">i</span><span class="op" id="6866022">]</span><span class="op" id="6866023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6866027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6866030">}</span><br>
<span class="lineno">400</span><span class="op" id="6866032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6866035">type</span>&nbsp;<span class="ident" id="6866040">allScalars</span>&nbsp;<span class="keyword" id="6866051">struct</span>&nbsp;<span class="op" id="6866058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866061">True1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6866071">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866077">True2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6866087">bool</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866093">False1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6866103">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866109">False2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6866119">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866125">Int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6866135">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866140">Int8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6866150">int8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866156">Int16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6866166">int16</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866173">Int32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6866183">int32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866190">Int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6866200">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866207">Uint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6866217">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866222">Uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6866232">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866239">Uint16</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6866249">uint16</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866257">Uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6866267">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866275">Uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6866285">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866293">Uintptr</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6866303">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866312">Float32</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6866322">float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866331">Float64</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6866341">float64</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866350">String</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6866360">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866368">PtrString</span>&nbsp;<span class="op" id="6866378">*</span><span class="builtintype" id="6866379">string</span><br>
<span class="lineno"></span><span class="op" id="6866386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6866389">var</span>&nbsp;<span class="ident" id="6866393">all</span>&nbsp;<span class="op" id="6866397">=</span>&nbsp;<span class="ident" id="6866399">allScalars</span><span class="op" id="6866409">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866412">True1</span><span class="op" id="6866417">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6866423">true</span><span class="op" id="6866427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866430">True2</span><span class="op" id="6866435">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6866441">true</span><span class="op" id="6866445">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866448">False1</span><span class="op" id="6866454">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6866459">false</span><span class="op" id="6866464">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866467">False2</span><span class="op" id="6866473">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6866478">false</span><span class="op" id="6866483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866486">Int</span><span class="op" id="6866489">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6866497">1</span><span class="op" id="6866498">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866501">Int8</span><span class="op" id="6866505">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6866512">-</span><span class="num" id="6866513">2</span><span class="op" id="6866514">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866517">Int16</span><span class="op" id="6866522">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6866528">3</span><span class="op" id="6866529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866532">Int32</span><span class="op" id="6866537">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6866543">-</span><span class="num" id="6866544">4</span><span class="op" id="6866545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866548">Int64</span><span class="op" id="6866553">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6866559">5</span><span class="op" id="6866560">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866563">Uint</span><span class="op" id="6866567">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6866574">6</span><span class="op" id="6866575">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866578">Uint8</span><span class="op" id="6866583">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6866589">7</span><span class="op" id="6866590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866593">Uint16</span><span class="op" id="6866599">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6866604">8</span><span class="op" id="6866605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866608">Uint32</span><span class="op" id="6866614">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6866619">9</span><span class="op" id="6866620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866623">Uint64</span><span class="op" id="6866629">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6866634">10</span><span class="op" id="6866636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866639">Uintptr</span><span class="op" id="6866646">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6866650">11</span><span class="op" id="6866652">,</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866655">Float32</span><span class="op" id="6866662">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6866666">13.0</span><span class="op" id="6866670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866673">Float64</span><span class="op" id="6866680">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6866684">14.0</span><span class="op" id="6866688">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866691">String</span><span class="op" id="6866697">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6866702">&#34;15&#34;</span><span class="op" id="6866706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6866709">PtrString</span><span class="op" id="6866718">:</span>&nbsp;<span class="op" id="6866720">&amp;</span><span class="ident" id="6866721">sixteen</span><span class="op" id="6866728">,</span><br>
<span class="lineno"></span><span class="op" id="6866730">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="6866733">var</span>&nbsp;<span class="ident" id="6866737">sixteen</span>&nbsp;<span class="op" id="6866745">=</span>&nbsp;<span class="string" id="6866747">&#34;16&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6866753">const</span>&nbsp;<span class="ident" id="6866759">testScalarsInput</span>&nbsp;<span class="op" id="6866776">=</span>&nbsp;<span class="string" id="6866778">`&lt;allscalars&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;True1&gt;true&lt;/True1&gt;<br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;True2&gt;1&lt;/True2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;False1&gt;false&lt;/False1&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;False2&gt;0&lt;/False2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int&gt;1&lt;/Int&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int8&gt;-2&lt;/Int8&gt;<br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int16&gt;3&lt;/Int16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int32&gt;-4&lt;/Int32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int64&gt;5&lt;/Int64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint&gt;6&lt;/Uint&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint8&gt;7&lt;/Uint8&gt;<br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint16&gt;8&lt;/Uint16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint32&gt;9&lt;/Uint32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint64&gt;10&lt;/Uint64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uintptr&gt;11&lt;/Uintptr&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float&gt;12.0&lt;/Float&gt;<br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float32&gt;13.0&lt;/Float32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float64&gt;14.0&lt;/Float64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;String&gt;15&lt;/String&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;PtrString&gt;16&lt;/PtrString&gt;<br>
<span class="lineno"></span>&lt;/allscalars&gt;`</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="keyword" id="6867214">func</span>&nbsp;<span class="ident" id="6867219">TestAllScalars</span><span class="op" id="6867233">(</span><span class="ident" id="6867234">t</span>&nbsp;<span class="op" id="6867236">*</span><span class="ident" id="6867237">testing</span><span class="op" id="6867244">.</span><span class="ident" id="6867245">T</span><span class="op" id="6867246">)</span>&nbsp;<span class="op" id="6867248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867251">var</span>&nbsp;<span class="ident" id="6867255">a</span>&nbsp;<span class="ident" id="6867257">allScalars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867269">err</span>&nbsp;<span class="op" id="6867273">:=</span>&nbsp;<span class="ident" id="6867276">Unmarshal</span><span class="op" id="6867285">(</span><span class="op" id="6867286">[</span><span class="op" id="6867287">]</span><span class="builtintype" id="6867288">byte</span><span class="op" id="6867292">(</span><span class="ident" id="6867293">testScalarsInput</span><span class="op" id="6867309">)</span><span class="op" id="6867310">,</span>&nbsp;<span class="op" id="6867312">&amp;</span><span class="ident" id="6867313">a</span><span class="op" id="6867314">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867318">if</span>&nbsp;<span class="ident" id="6867321">err</span>&nbsp;<span class="op" id="6867325">!=</span>&nbsp;<span class="ident" id="6867328">nil</span>&nbsp;<span class="op" id="6867332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867336">t</span><span class="op" id="6867337">.</span><span class="ident" id="6867338">Fatal</span><span class="op" id="6867343">(</span><span class="ident" id="6867344">err</span><span class="op" id="6867347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6867350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867353">if</span>&nbsp;<span class="op" id="6867356">!</span><span class="ident" id="6867357">reflect</span><span class="op" id="6867364">.</span><span class="ident" id="6867365">DeepEqual</span><span class="op" id="6867374">(</span><span class="ident" id="6867375">a</span><span class="op" id="6867376">,</span>&nbsp;<span class="ident" id="6867378">all</span><span class="op" id="6867381">)</span>&nbsp;<span class="op" id="6867383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867387">t</span><span class="op" id="6867388">.</span><span class="ident" id="6867389">Errorf</span><span class="op" id="6867395">(</span><span class="string" id="6867396">&#34;have&nbsp;%+v&nbsp;want&nbsp;%+v&#34;</span><span class="op" id="6867415">,</span>&nbsp;<span class="ident" id="6867417">a</span><span class="op" id="6867418">,</span>&nbsp;<span class="ident" id="6867420">all</span><span class="op" id="6867423">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6867426">}</span><br>
<span class="lineno"></span><span class="op" id="6867428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6867431">type</span>&nbsp;<span class="ident" id="6867436">item</span>&nbsp;<span class="keyword" id="6867441">struct</span>&nbsp;<span class="op" id="6867448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867451">Field_a</span>&nbsp;<span class="builtintype" id="6867459">string</span><br>
<span class="lineno">485</span><span class="op" id="6867466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6867469">func</span>&nbsp;<span class="ident" id="6867474">TestIssue569</span><span class="op" id="6867486">(</span><span class="ident" id="6867487">t</span>&nbsp;<span class="op" id="6867489">*</span><span class="ident" id="6867490">testing</span><span class="op" id="6867497">.</span><span class="ident" id="6867498">T</span><span class="op" id="6867499">)</span>&nbsp;<span class="op" id="6867501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867504">data</span>&nbsp;<span class="op" id="6867509">:=</span>&nbsp;<span class="string" id="6867512">`&lt;item&gt;&lt;Field_a&gt;abcd&lt;/Field_a&gt;&lt;/item&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867552">var</span>&nbsp;<span class="ident" id="6867556">i</span>&nbsp;<span class="ident" id="6867558">item</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867564">err</span>&nbsp;<span class="op" id="6867568">:=</span>&nbsp;<span class="ident" id="6867571">Unmarshal</span><span class="op" id="6867580">(</span><span class="op" id="6867581">[</span><span class="op" id="6867582">]</span><span class="builtintype" id="6867583">byte</span><span class="op" id="6867587">(</span><span class="ident" id="6867588">data</span><span class="op" id="6867592">)</span><span class="op" id="6867593">,</span>&nbsp;<span class="op" id="6867595">&amp;</span><span class="ident" id="6867596">i</span><span class="op" id="6867597">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867601">if</span>&nbsp;<span class="ident" id="6867604">err</span>&nbsp;<span class="op" id="6867608">!=</span>&nbsp;<span class="ident" id="6867611">nil</span>&nbsp;<span class="op" id="6867615">||</span>&nbsp;<span class="ident" id="6867618">i</span><span class="op" id="6867619">.</span><span class="ident" id="6867620">Field_a</span>&nbsp;<span class="op" id="6867628">!=</span>&nbsp;<span class="string" id="6867631">&#34;abcd&#34;</span>&nbsp;<span class="op" id="6867638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867642">t</span><span class="op" id="6867643">.</span><span class="ident" id="6867644">Fatal</span><span class="op" id="6867649">(</span><span class="string" id="6867650">&#34;Expecting&nbsp;abcd&#34;</span><span class="op" id="6867666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6867669">}</span><br>
<span class="lineno">495</span><span class="op" id="6867671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6867674">func</span>&nbsp;<span class="ident" id="6867679">TestUnquotedAttrs</span><span class="op" id="6867696">(</span><span class="ident" id="6867697">t</span>&nbsp;<span class="op" id="6867699">*</span><span class="ident" id="6867700">testing</span><span class="op" id="6867707">.</span><span class="ident" id="6867708">T</span><span class="op" id="6867709">)</span>&nbsp;<span class="op" id="6867711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867714">data</span>&nbsp;<span class="op" id="6867719">:=</span>&nbsp;<span class="string" id="6867722">&#34;&lt;tag&nbsp;attr=azAZ09:-_\t&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867748">d</span>&nbsp;<span class="op" id="6867750">:=</span>&nbsp;<span class="ident" id="6867753">NewDecoder</span><span class="op" id="6867763">(</span><span class="ident" id="6867764">strings</span><span class="op" id="6867771">.</span><span class="ident" id="6867772">NewReader</span><span class="op" id="6867781">(</span><span class="ident" id="6867782">data</span><span class="op" id="6867786">)</span><span class="op" id="6867787">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867790">d</span><span class="op" id="6867791">.</span><span class="ident" id="6867792">Strict</span>&nbsp;<span class="op" id="6867799">=</span>&nbsp;<span class="builtintype" id="6867801">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867808">token</span><span class="op" id="6867813">,</span>&nbsp;<span class="ident" id="6867815">err</span>&nbsp;<span class="op" id="6867819">:=</span>&nbsp;<span class="ident" id="6867822">d</span><span class="op" id="6867823">.</span><span class="ident" id="6867824">Token</span><span class="op" id="6867829">(</span><span class="op" id="6867830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867833">if</span>&nbsp;<span class="ident" id="6867836">_</span><span class="op" id="6867837">,</span>&nbsp;<span class="ident" id="6867839">ok</span>&nbsp;<span class="op" id="6867842">:=</span>&nbsp;<span class="ident" id="6867845">err</span><span class="op" id="6867848">.</span><span class="op" id="6867849">(</span><span class="op" id="6867850">*</span><span class="ident" id="6867851">SyntaxError</span><span class="op" id="6867862">)</span><span class="op" id="6867863">;</span>&nbsp;<span class="ident" id="6867865">ok</span>&nbsp;<span class="op" id="6867868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867872">t</span><span class="op" id="6867873">.</span><span class="ident" id="6867874">Errorf</span><span class="op" id="6867880">(</span><span class="string" id="6867881">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="6867903">,</span>&nbsp;<span class="ident" id="6867905">err</span><span class="op" id="6867908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6867911">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6867914">if</span>&nbsp;<span class="ident" id="6867917">token</span><span class="op" id="6867922">.</span><span class="op" id="6867923">(</span><span class="ident" id="6867924">StartElement</span><span class="op" id="6867936">)</span><span class="op" id="6867937">.</span><span class="ident" id="6867938">Name</span><span class="op" id="6867942">.</span><span class="ident" id="6867943">Local</span>&nbsp;<span class="op" id="6867949">!=</span>&nbsp;<span class="string" id="6867952">&#34;tag&#34;</span>&nbsp;<span class="op" id="6867958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6867962">t</span><span class="op" id="6867963">.</span><span class="ident" id="6867964">Errorf</span><span class="op" id="6867970">(</span><span class="string" id="6867971">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="6867996">,</span>&nbsp;<span class="ident" id="6867998">token</span><span class="op" id="6868003">.</span><span class="op" id="6868004">(</span><span class="ident" id="6868005">StartElement</span><span class="op" id="6868017">)</span><span class="op" id="6868018">.</span><span class="ident" id="6868019">Name</span><span class="op" id="6868023">.</span><span class="ident" id="6868024">Local</span><span class="op" id="6868029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868035">attr</span>&nbsp;<span class="op" id="6868040">:=</span>&nbsp;<span class="ident" id="6868043">token</span><span class="op" id="6868048">.</span><span class="op" id="6868049">(</span><span class="ident" id="6868050">StartElement</span><span class="op" id="6868062">)</span><span class="op" id="6868063">.</span><span class="ident" id="6868064">Attr</span><span class="op" id="6868068">[</span><span class="num" id="6868069">0</span><span class="op" id="6868070">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868073">if</span>&nbsp;<span class="ident" id="6868076">attr</span><span class="op" id="6868080">.</span><span class="ident" id="6868081">Value</span>&nbsp;<span class="op" id="6868087">!=</span>&nbsp;<span class="string" id="6868090">&#34;azAZ09:-_&#34;</span>&nbsp;<span class="op" id="6868102">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868106">t</span><span class="op" id="6868107">.</span><span class="ident" id="6868108">Errorf</span><span class="op" id="6868114">(</span><span class="string" id="6868115">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="6868147">,</span>&nbsp;<span class="ident" id="6868149">attr</span><span class="op" id="6868153">.</span><span class="ident" id="6868154">Value</span><span class="op" id="6868159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868165">if</span>&nbsp;<span class="ident" id="6868168">attr</span><span class="op" id="6868172">.</span><span class="ident" id="6868173">Name</span><span class="op" id="6868177">.</span><span class="ident" id="6868178">Local</span>&nbsp;<span class="op" id="6868184">!=</span>&nbsp;<span class="string" id="6868187">&#34;attr&#34;</span>&nbsp;<span class="op" id="6868194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868198">t</span><span class="op" id="6868199">.</span><span class="ident" id="6868200">Errorf</span><span class="op" id="6868206">(</span><span class="string" id="6868207">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="6868238">,</span>&nbsp;<span class="ident" id="6868240">attr</span><span class="op" id="6868244">.</span><span class="ident" id="6868245">Name</span><span class="op" id="6868249">.</span><span class="ident" id="6868250">Local</span><span class="op" id="6868255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868258">}</span><br>
<span class="lineno">515</span><span class="op" id="6868260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6868263">func</span>&nbsp;<span class="ident" id="6868268">TestValuelessAttrs</span><span class="op" id="6868286">(</span><span class="ident" id="6868287">t</span>&nbsp;<span class="op" id="6868289">*</span><span class="ident" id="6868290">testing</span><span class="op" id="6868297">.</span><span class="ident" id="6868298">T</span><span class="op" id="6868299">)</span>&nbsp;<span class="op" id="6868301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868304">tests</span>&nbsp;<span class="op" id="6868310">:=</span>&nbsp;<span class="op" id="6868313">[</span><span class="op" id="6868314">]</span><span class="op" id="6868315">[</span><span class="num" id="6868316">3</span><span class="op" id="6868317">]</span><span class="builtintype" id="6868318">string</span><span class="op" id="6868324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868328">{</span><span class="string" id="6868329">&#34;&lt;p&nbsp;nowrap&gt;&#34;</span><span class="op" id="6868341">,</span>&nbsp;<span class="string" id="6868343">&#34;p&#34;</span><span class="op" id="6868346">,</span>&nbsp;<span class="string" id="6868348">&#34;nowrap&#34;</span><span class="op" id="6868356">}</span><span class="op" id="6868357">,</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868361">{</span><span class="string" id="6868362">&#34;&lt;p&nbsp;nowrap&nbsp;&gt;&#34;</span><span class="op" id="6868375">,</span>&nbsp;<span class="string" id="6868377">&#34;p&#34;</span><span class="op" id="6868380">,</span>&nbsp;<span class="string" id="6868382">&#34;nowrap&#34;</span><span class="op" id="6868390">}</span><span class="op" id="6868391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868395">{</span><span class="string" id="6868396">&#34;&lt;input&nbsp;checked/&gt;&#34;</span><span class="op" id="6868414">,</span>&nbsp;<span class="string" id="6868416">&#34;input&#34;</span><span class="op" id="6868423">,</span>&nbsp;<span class="string" id="6868425">&#34;checked&#34;</span><span class="op" id="6868434">}</span><span class="op" id="6868435">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868439">{</span><span class="string" id="6868440">&#34;&lt;input&nbsp;checked&nbsp;/&gt;&#34;</span><span class="op" id="6868459">,</span>&nbsp;<span class="string" id="6868461">&#34;input&#34;</span><span class="op" id="6868468">,</span>&nbsp;<span class="string" id="6868470">&#34;checked&#34;</span><span class="op" id="6868479">}</span><span class="op" id="6868480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868486">for</span>&nbsp;<span class="ident" id="6868490">_</span><span class="op" id="6868491">,</span>&nbsp;<span class="ident" id="6868493">test</span>&nbsp;<span class="op" id="6868498">:=</span>&nbsp;<span class="keyword" id="6868501">range</span>&nbsp;<span class="ident" id="6868507">tests</span>&nbsp;<span class="op" id="6868513">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868517">d</span>&nbsp;<span class="op" id="6868519">:=</span>&nbsp;<span class="ident" id="6868522">NewDecoder</span><span class="op" id="6868532">(</span><span class="ident" id="6868533">strings</span><span class="op" id="6868540">.</span><span class="ident" id="6868541">NewReader</span><span class="op" id="6868550">(</span><span class="ident" id="6868551">test</span><span class="op" id="6868555">[</span><span class="num" id="6868556">0</span><span class="op" id="6868557">]</span><span class="op" id="6868558">)</span><span class="op" id="6868559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868563">d</span><span class="op" id="6868564">.</span><span class="ident" id="6868565">Strict</span>&nbsp;<span class="op" id="6868572">=</span>&nbsp;<span class="builtintype" id="6868574">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868582">token</span><span class="op" id="6868587">,</span>&nbsp;<span class="ident" id="6868589">err</span>&nbsp;<span class="op" id="6868593">:=</span>&nbsp;<span class="ident" id="6868596">d</span><span class="op" id="6868597">.</span><span class="ident" id="6868598">Token</span><span class="op" id="6868603">(</span><span class="op" id="6868604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868608">if</span>&nbsp;<span class="ident" id="6868611">_</span><span class="op" id="6868612">,</span>&nbsp;<span class="ident" id="6868614">ok</span>&nbsp;<span class="op" id="6868617">:=</span>&nbsp;<span class="ident" id="6868620">err</span><span class="op" id="6868623">.</span><span class="op" id="6868624">(</span><span class="op" id="6868625">*</span><span class="ident" id="6868626">SyntaxError</span><span class="op" id="6868637">)</span><span class="op" id="6868638">;</span>&nbsp;<span class="ident" id="6868640">ok</span>&nbsp;<span class="op" id="6868643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868648">t</span><span class="op" id="6868649">.</span><span class="ident" id="6868650">Errorf</span><span class="op" id="6868656">(</span><span class="string" id="6868657">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="6868679">,</span>&nbsp;<span class="ident" id="6868681">err</span><span class="op" id="6868684">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868692">if</span>&nbsp;<span class="ident" id="6868695">token</span><span class="op" id="6868700">.</span><span class="op" id="6868701">(</span><span class="ident" id="6868702">StartElement</span><span class="op" id="6868714">)</span><span class="op" id="6868715">.</span><span class="ident" id="6868716">Name</span><span class="op" id="6868720">.</span><span class="ident" id="6868721">Local</span>&nbsp;<span class="op" id="6868727">!=</span>&nbsp;<span class="ident" id="6868730">test</span><span class="op" id="6868734">[</span><span class="num" id="6868735">1</span><span class="op" id="6868736">]</span>&nbsp;<span class="op" id="6868738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868743">t</span><span class="op" id="6868744">.</span><span class="ident" id="6868745">Errorf</span><span class="op" id="6868751">(</span><span class="string" id="6868752">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="6868777">,</span>&nbsp;<span class="ident" id="6868779">token</span><span class="op" id="6868784">.</span><span class="op" id="6868785">(</span><span class="ident" id="6868786">StartElement</span><span class="op" id="6868798">)</span><span class="op" id="6868799">.</span><span class="ident" id="6868800">Name</span><span class="op" id="6868804">.</span><span class="ident" id="6868805">Local</span><span class="op" id="6868810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868818">attr</span>&nbsp;<span class="op" id="6868823">:=</span>&nbsp;<span class="ident" id="6868826">token</span><span class="op" id="6868831">.</span><span class="op" id="6868832">(</span><span class="ident" id="6868833">StartElement</span><span class="op" id="6868845">)</span><span class="op" id="6868846">.</span><span class="ident" id="6868847">Attr</span><span class="op" id="6868851">[</span><span class="num" id="6868852">0</span><span class="op" id="6868853">]</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868857">if</span>&nbsp;<span class="ident" id="6868860">attr</span><span class="op" id="6868864">.</span><span class="ident" id="6868865">Value</span>&nbsp;<span class="op" id="6868871">!=</span>&nbsp;<span class="ident" id="6868874">test</span><span class="op" id="6868878">[</span><span class="num" id="6868879">2</span><span class="op" id="6868880">]</span>&nbsp;<span class="op" id="6868882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868887">t</span><span class="op" id="6868888">.</span><span class="ident" id="6868889">Errorf</span><span class="op" id="6868895">(</span><span class="string" id="6868896">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="6868928">,</span>&nbsp;<span class="ident" id="6868930">attr</span><span class="op" id="6868934">.</span><span class="ident" id="6868935">Value</span><span class="op" id="6868940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6868944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6868948">if</span>&nbsp;<span class="ident" id="6868951">attr</span><span class="op" id="6868955">.</span><span class="ident" id="6868956">Name</span><span class="op" id="6868960">.</span><span class="ident" id="6868961">Local</span>&nbsp;<span class="op" id="6868967">!=</span>&nbsp;<span class="ident" id="6868970">test</span><span class="op" id="6868974">[</span><span class="num" id="6868975">2</span><span class="op" id="6868976">]</span>&nbsp;<span class="op" id="6868978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6868983">t</span><span class="op" id="6868984">.</span><span class="ident" id="6868985">Errorf</span><span class="op" id="6868991">(</span><span class="string" id="6868992">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="6869023">,</span>&nbsp;<span class="ident" id="6869025">attr</span><span class="op" id="6869029">.</span><span class="ident" id="6869030">Name</span><span class="op" id="6869034">.</span><span class="ident" id="6869035">Local</span><span class="op" id="6869040">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6869044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6869047">}</span><br>
<span class="lineno"></span><span class="op" id="6869049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6869052">func</span>&nbsp;<span class="ident" id="6869057">TestCopyTokenCharData</span><span class="op" id="6869078">(</span><span class="ident" id="6869079">t</span>&nbsp;<span class="op" id="6869081">*</span><span class="ident" id="6869082">testing</span><span class="op" id="6869089">.</span><span class="ident" id="6869090">T</span><span class="op" id="6869091">)</span>&nbsp;<span class="op" id="6869093">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869096">data</span>&nbsp;<span class="op" id="6869101">:=</span>&nbsp;<span class="op" id="6869104">[</span><span class="op" id="6869105">]</span><span class="builtintype" id="6869106">byte</span><span class="op" id="6869110">(</span><span class="string" id="6869111">&#34;same&nbsp;data&#34;</span><span class="op" id="6869122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869125">var</span>&nbsp;<span class="ident" id="6869129">tok1</span>&nbsp;<span class="ident" id="6869134">Token</span>&nbsp;<span class="op" id="6869140">=</span>&nbsp;<span class="ident" id="6869142">CharData</span><span class="op" id="6869150">(</span><span class="ident" id="6869151">data</span><span class="op" id="6869155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869158">tok2</span>&nbsp;<span class="op" id="6869163">:=</span>&nbsp;<span class="ident" id="6869166">CopyToken</span><span class="op" id="6869175">(</span><span class="ident" id="6869176">tok1</span><span class="op" id="6869180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869183">if</span>&nbsp;<span class="op" id="6869186">!</span><span class="ident" id="6869187">reflect</span><span class="op" id="6869194">.</span><span class="ident" id="6869195">DeepEqual</span><span class="op" id="6869204">(</span><span class="ident" id="6869205">tok1</span><span class="op" id="6869209">,</span>&nbsp;<span class="ident" id="6869211">tok2</span><span class="op" id="6869215">)</span>&nbsp;<span class="op" id="6869217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869221">t</span><span class="op" id="6869222">.</span><span class="ident" id="6869223">Error</span><span class="op" id="6869228">(</span><span class="string" id="6869229">&#34;CopyToken(CharData)&nbsp;!=&nbsp;CharData&#34;</span><span class="op" id="6869262">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6869265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869268">data</span><span class="op" id="6869272">[</span><span class="num" id="6869273">1</span><span class="op" id="6869274">]</span>&nbsp;<span class="op" id="6869276">=</span>&nbsp;<span class="string" id="6869278">&#39;o&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869283">if</span>&nbsp;<span class="ident" id="6869286">reflect</span><span class="op" id="6869293">.</span><span class="ident" id="6869294">DeepEqual</span><span class="op" id="6869303">(</span><span class="ident" id="6869304">tok1</span><span class="op" id="6869308">,</span>&nbsp;<span class="ident" id="6869310">tok2</span><span class="op" id="6869314">)</span>&nbsp;<span class="op" id="6869316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869320">t</span><span class="op" id="6869321">.</span><span class="ident" id="6869322">Error</span><span class="op" id="6869327">(</span><span class="string" id="6869328">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="6869367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6869370">}</span><br>
<span class="lineno">555</span><span class="op" id="6869372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6869375">func</span>&nbsp;<span class="ident" id="6869380">TestCopyTokenStartElement</span><span class="op" id="6869405">(</span><span class="ident" id="6869406">t</span>&nbsp;<span class="op" id="6869408">*</span><span class="ident" id="6869409">testing</span><span class="op" id="6869416">.</span><span class="ident" id="6869417">T</span><span class="op" id="6869418">)</span>&nbsp;<span class="op" id="6869420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869423">elt</span>&nbsp;<span class="op" id="6869427">:=</span>&nbsp;<span class="ident" id="6869430">StartElement</span><span class="op" id="6869442">{</span><span class="ident" id="6869443">Name</span><span class="op" id="6869447">{</span><span class="string" id="6869448">&#34;&#34;</span><span class="op" id="6869450">,</span>&nbsp;<span class="string" id="6869452">&#34;hello&#34;</span><span class="op" id="6869459">}</span><span class="op" id="6869460">,</span>&nbsp;<span class="op" id="6869462">[</span><span class="op" id="6869463">]</span><span class="ident" id="6869464">Attr</span><span class="op" id="6869468">{</span><span class="op" id="6869469">{</span><span class="ident" id="6869470">Name</span><span class="op" id="6869474">{</span><span class="string" id="6869475">&#34;&#34;</span><span class="op" id="6869477">,</span>&nbsp;<span class="string" id="6869479">&#34;lang&#34;</span><span class="op" id="6869485">}</span><span class="op" id="6869486">,</span>&nbsp;<span class="string" id="6869488">&#34;en&#34;</span><span class="op" id="6869492">}</span><span class="op" id="6869493">}</span><span class="op" id="6869494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869497">var</span>&nbsp;<span class="ident" id="6869501">tok1</span>&nbsp;<span class="ident" id="6869506">Token</span>&nbsp;<span class="op" id="6869512">=</span>&nbsp;<span class="ident" id="6869514">elt</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869519">tok2</span>&nbsp;<span class="op" id="6869524">:=</span>&nbsp;<span class="ident" id="6869527">CopyToken</span><span class="op" id="6869536">(</span><span class="ident" id="6869537">tok1</span><span class="op" id="6869541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869544">if</span>&nbsp;<span class="ident" id="6869547">tok1</span><span class="op" id="6869551">.</span><span class="op" id="6869552">(</span><span class="ident" id="6869553">StartElement</span><span class="op" id="6869565">)</span><span class="op" id="6869566">.</span><span class="ident" id="6869567">Attr</span><span class="op" id="6869571">[</span><span class="num" id="6869572">0</span><span class="op" id="6869573">]</span><span class="op" id="6869574">.</span><span class="ident" id="6869575">Value</span>&nbsp;<span class="op" id="6869581">!=</span>&nbsp;<span class="string" id="6869584">&#34;en&#34;</span>&nbsp;<span class="op" id="6869589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869593">t</span><span class="op" id="6869594">.</span><span class="ident" id="6869595">Error</span><span class="op" id="6869600">(</span><span class="string" id="6869601">&#34;CopyToken&nbsp;overwrote&nbsp;Attr[0]&#34;</span><span class="op" id="6869630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6869633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869636">if</span>&nbsp;<span class="op" id="6869639">!</span><span class="ident" id="6869640">reflect</span><span class="op" id="6869647">.</span><span class="ident" id="6869648">DeepEqual</span><span class="op" id="6869657">(</span><span class="ident" id="6869658">tok1</span><span class="op" id="6869662">,</span>&nbsp;<span class="ident" id="6869664">tok2</span><span class="op" id="6869668">)</span>&nbsp;<span class="op" id="6869670">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869674">t</span><span class="op" id="6869675">.</span><span class="ident" id="6869676">Error</span><span class="op" id="6869681">(</span><span class="string" id="6869682">&#34;CopyToken(StartElement)&nbsp;!=&nbsp;StartElement&#34;</span><span class="op" id="6869723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6869726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869729">tok1</span><span class="op" id="6869733">.</span><span class="op" id="6869734">(</span><span class="ident" id="6869735">StartElement</span><span class="op" id="6869747">)</span><span class="op" id="6869748">.</span><span class="ident" id="6869749">Attr</span><span class="op" id="6869753">[</span><span class="num" id="6869754">0</span><span class="op" id="6869755">]</span>&nbsp;<span class="op" id="6869757">=</span>&nbsp;<span class="ident" id="6869759">Attr</span><span class="op" id="6869763">{</span><span class="ident" id="6869764">Name</span><span class="op" id="6869768">{</span><span class="string" id="6869769">&#34;&#34;</span><span class="op" id="6869771">,</span>&nbsp;<span class="string" id="6869773">&#34;lang&#34;</span><span class="op" id="6869779">}</span><span class="op" id="6869780">,</span>&nbsp;<span class="string" id="6869782">&#34;de&#34;</span><span class="op" id="6869786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6869789">if</span>&nbsp;<span class="ident" id="6869792">reflect</span><span class="op" id="6869799">.</span><span class="ident" id="6869800">DeepEqual</span><span class="op" id="6869809">(</span><span class="ident" id="6869810">tok1</span><span class="op" id="6869814">,</span>&nbsp;<span class="ident" id="6869816">tok2</span><span class="op" id="6869820">)</span>&nbsp;<span class="op" id="6869822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869826">t</span><span class="op" id="6869827">.</span><span class="ident" id="6869828">Error</span><span class="op" id="6869833">(</span><span class="string" id="6869834">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="6869873">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6869876">}</span><br>
<span class="lineno"></span><span class="op" id="6869878">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6869881">func</span>&nbsp;<span class="ident" id="6869886">TestSyntaxErrorLineNum</span><span class="op" id="6869908">(</span><span class="ident" id="6869909">t</span>&nbsp;<span class="op" id="6869911">*</span><span class="ident" id="6869912">testing</span><span class="op" id="6869919">.</span><span class="ident" id="6869920">T</span><span class="op" id="6869921">)</span>&nbsp;<span class="op" id="6869923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869926">testInput</span>&nbsp;<span class="op" id="6869936">:=</span>&nbsp;<span class="string" id="6869939">&#34;&lt;P&gt;Foo&lt;P&gt;\n\n&lt;P&gt;Bar&lt;/&gt;\n&#34;</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6869967">d</span>&nbsp;<span class="op" id="6869969">:=</span>&nbsp;<span class="ident" id="6869972">NewDecoder</span><span class="op" id="6869982">(</span><span class="ident" id="6869983">strings</span><span class="op" id="6869990">.</span><span class="ident" id="6869991">NewReader</span><span class="op" id="6870000">(</span><span class="ident" id="6870001">testInput</span><span class="op" id="6870010">)</span><span class="op" id="6870011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6870014">var</span>&nbsp;<span class="ident" id="6870018">err</span>&nbsp;<span class="builtintype" id="6870022">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6870029">for</span>&nbsp;<span class="ident" id="6870033">_</span><span class="op" id="6870034">,</span>&nbsp;<span class="ident" id="6870036">err</span>&nbsp;<span class="op" id="6870040">=</span>&nbsp;<span class="ident" id="6870042">d</span><span class="op" id="6870043">.</span><span class="ident" id="6870044">Token</span><span class="op" id="6870049">(</span><span class="op" id="6870050">)</span><span class="op" id="6870051">;</span>&nbsp;<span class="ident" id="6870053">err</span>&nbsp;<span class="op" id="6870057">==</span>&nbsp;<span class="ident" id="6870060">nil</span><span class="op" id="6870063">;</span>&nbsp;<span class="ident" id="6870065">_</span><span class="op" id="6870066">,</span>&nbsp;<span class="ident" id="6870068">err</span>&nbsp;<span class="op" id="6870072">=</span>&nbsp;<span class="ident" id="6870074">d</span><span class="op" id="6870075">.</span><span class="ident" id="6870076">Token</span><span class="op" id="6870081">(</span><span class="op" id="6870082">)</span>&nbsp;<span class="op" id="6870084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870090">synerr</span><span class="op" id="6870096">,</span>&nbsp;<span class="ident" id="6870098">ok</span>&nbsp;<span class="op" id="6870101">:=</span>&nbsp;<span class="ident" id="6870104">err</span><span class="op" id="6870107">.</span><span class="op" id="6870108">(</span><span class="op" id="6870109">*</span><span class="ident" id="6870110">SyntaxError</span><span class="op" id="6870121">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6870124">if</span>&nbsp;<span class="op" id="6870127">!</span><span class="ident" id="6870128">ok</span>&nbsp;<span class="op" id="6870131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870135">t</span><span class="op" id="6870136">.</span><span class="ident" id="6870137">Error</span><span class="op" id="6870142">(</span><span class="string" id="6870143">&#34;Expected&nbsp;SyntaxError.&#34;</span><span class="op" id="6870166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6870172">if</span>&nbsp;<span class="ident" id="6870175">synerr</span><span class="op" id="6870181">.</span><span class="ident" id="6870182">Line</span>&nbsp;<span class="op" id="6870187">!=</span>&nbsp;<span class="num" id="6870190">3</span>&nbsp;<span class="op" id="6870192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870196">t</span><span class="op" id="6870197">.</span><span class="ident" id="6870198">Error</span><span class="op" id="6870203">(</span><span class="string" id="6870204">&#34;SyntaxError&nbsp;didn&#39;t&nbsp;have&nbsp;correct&nbsp;line&nbsp;number.&#34;</span><span class="op" id="6870250">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870253">}</span><br>
<span class="lineno"></span><span class="op" id="6870255">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6870258">func</span>&nbsp;<span class="ident" id="6870263">TestTrailingRawToken</span><span class="op" id="6870283">(</span><span class="ident" id="6870284">t</span>&nbsp;<span class="op" id="6870286">*</span><span class="ident" id="6870287">testing</span><span class="op" id="6870294">.</span><span class="ident" id="6870295">T</span><span class="op" id="6870296">)</span>&nbsp;<span class="op" id="6870298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870301">input</span>&nbsp;<span class="op" id="6870307">:=</span>&nbsp;<span class="string" id="6870310">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870327">d</span>&nbsp;<span class="op" id="6870329">:=</span>&nbsp;<span class="ident" id="6870332">NewDecoder</span><span class="op" id="6870342">(</span><span class="ident" id="6870343">strings</span><span class="op" id="6870350">.</span><span class="ident" id="6870351">NewReader</span><span class="op" id="6870360">(</span><span class="ident" id="6870361">input</span><span class="op" id="6870366">)</span><span class="op" id="6870367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6870370">var</span>&nbsp;<span class="ident" id="6870374">err</span>&nbsp;<span class="builtintype" id="6870378">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6870385">for</span>&nbsp;<span class="ident" id="6870389">_</span><span class="op" id="6870390">,</span>&nbsp;<span class="ident" id="6870392">err</span>&nbsp;<span class="op" id="6870396">=</span>&nbsp;<span class="ident" id="6870398">d</span><span class="op" id="6870399">.</span><span class="ident" id="6870400">RawToken</span><span class="op" id="6870408">(</span><span class="op" id="6870409">)</span><span class="op" id="6870410">;</span>&nbsp;<span class="ident" id="6870412">err</span>&nbsp;<span class="op" id="6870416">==</span>&nbsp;<span class="ident" id="6870419">nil</span><span class="op" id="6870422">;</span>&nbsp;<span class="ident" id="6870424">_</span><span class="op" id="6870425">,</span>&nbsp;<span class="ident" id="6870427">err</span>&nbsp;<span class="op" id="6870431">=</span>&nbsp;<span class="ident" id="6870433">d</span><span class="op" id="6870434">.</span><span class="ident" id="6870435">RawToken</span><span class="op" id="6870443">(</span><span class="op" id="6870444">)</span>&nbsp;<span class="op" id="6870446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6870452">if</span>&nbsp;<span class="ident" id="6870455">err</span>&nbsp;<span class="op" id="6870459">!=</span>&nbsp;<span class="ident" id="6870462">io</span><span class="op" id="6870464">.</span><span class="ident" id="6870465">EOF</span>&nbsp;<span class="op" id="6870469">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870473">t</span><span class="op" id="6870474">.</span><span class="ident" id="6870475">Fatalf</span><span class="op" id="6870481">(</span><span class="string" id="6870482">&#34;d.RawToken()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="6870520">,</span>&nbsp;<span class="ident" id="6870522">err</span><span class="op" id="6870525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870528">}</span><br>
<span class="lineno"></span><span class="op" id="6870530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6870533">func</span>&nbsp;<span class="ident" id="6870538">TestTrailingToken</span><span class="op" id="6870555">(</span><span class="ident" id="6870556">t</span>&nbsp;<span class="op" id="6870558">*</span><span class="ident" id="6870559">testing</span><span class="op" id="6870566">.</span><span class="ident" id="6870567">T</span><span class="op" id="6870568">)</span>&nbsp;<span class="op" id="6870570">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870573">input</span>&nbsp;<span class="op" id="6870579">:=</span>&nbsp;<span class="string" id="6870582">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870599">d</span>&nbsp;<span class="op" id="6870601">:=</span>&nbsp;<span class="ident" id="6870604">NewDecoder</span><span class="op" id="6870614">(</span><span class="ident" id="6870615">strings</span><span class="op" id="6870622">.</span><span class="ident" id="6870623">NewReader</span><span class="op" id="6870632">(</span><span class="ident" id="6870633">input</span><span class="op" id="6870638">)</span><span class="op" id="6870639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6870642">var</span>&nbsp;<span class="ident" id="6870646">err</span>&nbsp;<span class="builtintype" id="6870650">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6870657">for</span>&nbsp;<span class="ident" id="6870661">_</span><span class="op" id="6870662">,</span>&nbsp;<span class="ident" id="6870664">err</span>&nbsp;<span class="op" id="6870668">=</span>&nbsp;<span class="ident" id="6870670">d</span><span class="op" id="6870671">.</span><span class="ident" id="6870672">Token</span><span class="op" id="6870677">(</span><span class="op" id="6870678">)</span><span class="op" id="6870679">;</span>&nbsp;<span class="ident" id="6870681">err</span>&nbsp;<span class="op" id="6870685">==</span>&nbsp;<span class="ident" id="6870688">nil</span><span class="op" id="6870691">;</span>&nbsp;<span class="ident" id="6870693">_</span><span class="op" id="6870694">,</span>&nbsp;<span class="ident" id="6870696">err</span>&nbsp;<span class="op" id="6870700">=</span>&nbsp;<span class="ident" id="6870702">d</span><span class="op" id="6870703">.</span><span class="ident" id="6870704">Token</span><span class="op" id="6870709">(</span><span class="op" id="6870710">)</span>&nbsp;<span class="op" id="6870712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870715">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6870718">if</span>&nbsp;<span class="ident" id="6870721">err</span>&nbsp;<span class="op" id="6870725">!=</span>&nbsp;<span class="ident" id="6870728">io</span><span class="op" id="6870730">.</span><span class="ident" id="6870731">EOF</span>&nbsp;<span class="op" id="6870735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870739">t</span><span class="op" id="6870740">.</span><span class="ident" id="6870741">Fatalf</span><span class="op" id="6870747">(</span><span class="string" id="6870748">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="6870783">,</span>&nbsp;<span class="ident" id="6870785">err</span><span class="op" id="6870788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6870791">}</span><br>
<span class="lineno"></span><span class="op" id="6870793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span><span class="keyword" id="6870796">func</span>&nbsp;<span class="ident" id="6870801">TestEntityInsideCDATA</span><span class="op" id="6870822">(</span><span class="ident" id="6870823">t</span>&nbsp;<span class="op" id="6870825">*</span><span class="ident" id="6870826">testing</span><span class="op" id="6870833">.</span><span class="ident" id="6870834">T</span><span class="op" id="6870835">)</span>&nbsp;<span class="op" id="6870837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870840">input</span>&nbsp;<span class="op" id="6870846">:=</span>&nbsp;<span class="string" id="6870849">`&lt;test&gt;&lt;![CDATA[&nbsp;&amp;val=foo&nbsp;]]&gt;&lt;/test&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6870888">d</span>&nbsp;<span class="op" id="6870890">:=</span>&nbsp;<span class="ident" id="6870893">NewDecoder</span><span class="op" id="6870903">(</span><span class="ident" id="6870904">strings</span><span class="op" id="6870911">.</span><span class="ident" id="6870912">NewReader</span><span class="op" id="6870921">(</span><span class="ident" id="6870922">input</span><span class="op" id="6870927">)</span><span class="op" id="6870928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6870931">var</span>&nbsp;<span class="ident" id="6870935">err</span>&nbsp;<span class="builtintype" id="6870939">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6870946">for</span>&nbsp;<span class="ident" id="6870950">_</span><span class="op" id="6870951">,</span>&nbsp;<span class="ident" id="6870953">err</span>&nbsp;<span class="op" id="6870957">=</span>&nbsp;<span class="ident" id="6870959">d</span><span class="op" id="6870960">.</span><span class="ident" id="6870961">Token</span><span class="op" id="6870966">(</span><span class="op" id="6870967">)</span><span class="op" id="6870968">;</span>&nbsp;<span class="ident" id="6870970">err</span>&nbsp;<span class="op" id="6870974">==</span>&nbsp;<span class="ident" id="6870977">nil</span><span class="op" id="6870980">;</span>&nbsp;<span class="ident" id="6870982">_</span><span class="op" id="6870983">,</span>&nbsp;<span class="ident" id="6870985">err</span>&nbsp;<span class="op" id="6870989">=</span>&nbsp;<span class="ident" id="6870991">d</span><span class="op" id="6870992">.</span><span class="ident" id="6870993">Token</span><span class="op" id="6870998">(</span><span class="op" id="6870999">)</span>&nbsp;<span class="op" id="6871001">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6871004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6871007">if</span>&nbsp;<span class="ident" id="6871010">err</span>&nbsp;<span class="op" id="6871014">!=</span>&nbsp;<span class="ident" id="6871017">io</span><span class="op" id="6871019">.</span><span class="ident" id="6871020">EOF</span>&nbsp;<span class="op" id="6871024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6871028">t</span><span class="op" id="6871029">.</span><span class="ident" id="6871030">Fatalf</span><span class="op" id="6871036">(</span><span class="string" id="6871037">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="6871072">,</span>&nbsp;<span class="ident" id="6871074">err</span><span class="op" id="6871077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6871080">}</span><br>
<span class="lineno"></span><span class="op" id="6871082">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span><span class="keyword" id="6871085">var</span>&nbsp;<span class="ident" id="6871089">characterTests</span>&nbsp;<span class="op" id="6871104">=</span>&nbsp;<span class="op" id="6871106">[</span><span class="op" id="6871107">]</span><span class="keyword" id="6871108">struct</span>&nbsp;<span class="op" id="6871115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6871118">in</span>&nbsp;&nbsp;<span class="builtintype" id="6871122">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6871130">err</span>&nbsp;<span class="builtintype" id="6871134">string</span><br>
<span class="lineno"></span><span class="op" id="6871141">}</span><span class="op" id="6871142">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6871145">{</span><span class="string" id="6871146">&#34;\x12&lt;doc/&gt;&#34;</span><span class="op" id="6871158">,</span>&nbsp;<span class="string" id="6871160">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0012&#34;</span><span class="op" id="6871191">}</span><span class="op" id="6871192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6871195">{</span><span class="string" id="6871196">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;\x0b&lt;doc/&gt;&#34;</span><span class="op" id="6871231">,</span>&nbsp;<span class="string" id="6871233">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+000B&#34;</span><span class="op" id="6871264">}</span><span class="op" id="6871265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6871268">{</span><span class="string" id="6871269">&#34;\xef\xbf\xbe&lt;doc/&gt;&#34;</span><span class="op" id="6871289">,</span>&nbsp;<span class="string" id="6871291">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+FFFE&#34;</span><span class="op" id="6871322">}</span><span class="op" id="6871323">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6871326">{</span><span class="string" id="6871327">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&gt;\r\n&lt;hiya/&gt;\x07&lt;toots/&gt;&lt;/doc&gt;&#34;</span><span class="op" id="6871386">,</span>&nbsp;<span class="string" id="6871388">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0007&#34;</span><span class="op" id="6871419">}</span><span class="op" id="6871420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6871423">{</span><span class="string" id="6871424">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&nbsp;\x12=&#39;value&#39;&gt;what&#39;s&nbsp;up&lt;/doc&gt;&#34;</span><span class="op" id="6871482">,</span>&nbsp;<span class="string" id="6871484">&#34;expected&nbsp;attribute&nbsp;name&nbsp;in&nbsp;element&#34;</span><span class="op" id="6871520">}</span><span class="op" id="6871521">,</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6871524">{</span><span class="string" id="6871525">&#34;&lt;doc&gt;&amp;abc\x01;&lt;/doc&gt;&#34;</span><span class="op" id="6871547">,</span>&nbsp;<span class="string" id="6871549">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;abc&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="6871595">}</span><span class="op" id="6871596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6871599">{</span><span class="string" id="6871600">&#34;&lt;doc&gt;&amp;\x01;&lt;/doc&gt;&#34;</span><span class="op" id="6871619">,</span>&nbsp;<span class="string" id="6871621">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="6871664">}</span><span class="op" id="6871665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6871668">{</span><span class="string" id="6871669">&#34;&lt;doc&gt;&amp;\xef\xbf\xbe;&lt;/doc&gt;&#34;</span><span class="op" id="6871696">,</span>&nbsp;<span class="string" id="6871698">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;\uFFFE;&#34;</span><span class="op" id="6871733">}</span><span class="op" id="6871734">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6871737">{</span><span class="string" id="6871738">&#34;&lt;doc&gt;&amp;hello;&lt;/doc&gt;&#34;</span><span class="op" id="6871758">,</span>&nbsp;<span class="string" id="6871760">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;hello;&#34;</span><span class="op" id="6871794">}</span><span class="op" id="6871795">,</span><br>
<span class="lineno"></span><span class="op" id="6871797">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="keyword" id="6871800">func</span>&nbsp;<span class="ident" id="6871805">TestDisallowedCharacters</span><span class="op" id="6871829">(</span><span class="ident" id="6871830">t</span>&nbsp;<span class="op" id="6871832">*</span><span class="ident" id="6871833">testing</span><span class="op" id="6871840">.</span><span class="ident" id="6871841">T</span><span class="op" id="6871842">)</span>&nbsp;<span class="op" id="6871844">{</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6871848">for</span>&nbsp;<span class="ident" id="6871852">i</span><span class="op" id="6871853">,</span>&nbsp;<span class="ident" id="6871855">tt</span>&nbsp;<span class="op" id="6871858">:=</span>&nbsp;<span class="keyword" id="6871861">range</span>&nbsp;<span class="ident" id="6871867">characterTests</span>&nbsp;<span class="op" id="6871882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6871886">d</span>&nbsp;<span class="op" id="6871888">:=</span>&nbsp;<span class="ident" id="6871891">NewDecoder</span><span class="op" id="6871901">(</span><span class="ident" id="6871902">strings</span><span class="op" id="6871909">.</span><span class="ident" id="6871910">NewReader</span><span class="op" id="6871919">(</span><span class="ident" id="6871920">tt</span><span class="op" id="6871922">.</span><span class="ident" id="6871923">in</span><span class="op" id="6871925">)</span><span class="op" id="6871926">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6871930">var</span>&nbsp;<span class="ident" id="6871934">err</span>&nbsp;<span class="builtintype" id="6871938">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6871947">for</span>&nbsp;<span class="ident" id="6871951">err</span>&nbsp;<span class="op" id="6871955">==</span>&nbsp;<span class="ident" id="6871958">nil</span>&nbsp;<span class="op" id="6871962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6871967">_</span><span class="op" id="6871968">,</span>&nbsp;<span class="ident" id="6871970">err</span>&nbsp;<span class="op" id="6871974">=</span>&nbsp;<span class="ident" id="6871976">d</span><span class="op" id="6871977">.</span><span class="ident" id="6871978">Token</span><span class="op" id="6871983">(</span><span class="op" id="6871984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6871988">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6871992">synerr</span><span class="op" id="6871998">,</span>&nbsp;<span class="ident" id="6872000">ok</span>&nbsp;<span class="op" id="6872003">:=</span>&nbsp;<span class="ident" id="6872006">err</span><span class="op" id="6872009">.</span><span class="op" id="6872010">(</span><span class="op" id="6872011">*</span><span class="ident" id="6872012">SyntaxError</span><span class="op" id="6872023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6872027">if</span>&nbsp;<span class="op" id="6872030">!</span><span class="ident" id="6872031">ok</span>&nbsp;<span class="op" id="6872034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872039">t</span><span class="op" id="6872040">.</span><span class="ident" id="6872041">Fatalf</span><span class="op" id="6872047">(</span><span class="string" id="6872048">&#34;input&nbsp;%d&nbsp;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;*SyntaxError&#34;</span><span class="op" id="6872098">,</span>&nbsp;<span class="ident" id="6872100">i</span><span class="op" id="6872101">,</span>&nbsp;<span class="ident" id="6872103">err</span><span class="op" id="6872106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6872114">if</span>&nbsp;<span class="ident" id="6872117">synerr</span><span class="op" id="6872123">.</span><span class="ident" id="6872124">Msg</span>&nbsp;<span class="op" id="6872128">!=</span>&nbsp;<span class="ident" id="6872131">tt</span><span class="op" id="6872133">.</span><span class="ident" id="6872134">err</span>&nbsp;<span class="op" id="6872138">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872143">t</span><span class="op" id="6872144">.</span><span class="ident" id="6872145">Fatalf</span><span class="op" id="6872151">(</span><span class="string" id="6872152">&#34;input&nbsp;%d&nbsp;synerr.Msg&nbsp;wrong:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6872196">,</span>&nbsp;<span class="ident" id="6872198">i</span><span class="op" id="6872199">,</span>&nbsp;<span class="ident" id="6872201">tt</span><span class="op" id="6872203">.</span><span class="ident" id="6872204">err</span><span class="op" id="6872207">,</span>&nbsp;<span class="ident" id="6872209">synerr</span><span class="op" id="6872215">.</span><span class="ident" id="6872216">Msg</span><span class="op" id="6872219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872226">}</span><br>
<span class="lineno"></span><span class="op" id="6872228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">655</span><span class="keyword" id="6872231">type</span>&nbsp;<span class="ident" id="6872236">procInstEncodingTest</span>&nbsp;<span class="keyword" id="6872257">struct</span>&nbsp;<span class="op" id="6872264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872267">expect</span><span class="op" id="6872273">,</span>&nbsp;<span class="ident" id="6872275">got</span>&nbsp;<span class="builtintype" id="6872279">string</span><br>
<span class="lineno"></span><span class="op" id="6872286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6872289">var</span>&nbsp;<span class="ident" id="6872293">procInstTests</span>&nbsp;<span class="op" id="6872307">=</span>&nbsp;<span class="op" id="6872309">[</span><span class="op" id="6872310">]</span><span class="keyword" id="6872311">struct</span>&nbsp;<span class="op" id="6872318">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872321">input</span><span class="op" id="6872326">,</span>&nbsp;<span class="ident" id="6872328">expect</span>&nbsp;<span class="builtintype" id="6872335">string</span><br>
<span class="lineno"></span><span class="op" id="6872342">}</span><span class="op" id="6872343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872346">{</span><span class="string" id="6872347">`version=&#34;1.0&#34;&nbsp;encoding=&#34;utf-8&#34;`</span><span class="op" id="6872379">,</span>&nbsp;<span class="string" id="6872381">&#34;utf-8&#34;</span><span class="op" id="6872388">}</span><span class="op" id="6872389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872392">{</span><span class="string" id="6872393">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;`</span><span class="op" id="6872425">,</span>&nbsp;<span class="string" id="6872427">&#34;utf-8&#34;</span><span class="op" id="6872434">}</span><span class="op" id="6872435">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872438">{</span><span class="string" id="6872439">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;&nbsp;`</span><span class="op" id="6872472">,</span>&nbsp;<span class="string" id="6872474">&#34;utf-8&#34;</span><span class="op" id="6872481">}</span><span class="op" id="6872482">,</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872485">{</span><span class="string" id="6872486">`version=&#34;1.0&#34;&nbsp;encoding=utf-8`</span><span class="op" id="6872516">,</span>&nbsp;<span class="string" id="6872518">&#34;&#34;</span><span class="op" id="6872520">}</span><span class="op" id="6872521">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872524">{</span><span class="string" id="6872525">`encoding=&#34;FOO&#34;&nbsp;`</span><span class="op" id="6872542">,</span>&nbsp;<span class="string" id="6872544">&#34;FOO&#34;</span><span class="op" id="6872549">}</span><span class="op" id="6872550">,</span><br>
<span class="lineno"></span><span class="op" id="6872552">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6872555">func</span>&nbsp;<span class="ident" id="6872560">TestProcInstEncoding</span><span class="op" id="6872580">(</span><span class="ident" id="6872581">t</span>&nbsp;<span class="op" id="6872583">*</span><span class="ident" id="6872584">testing</span><span class="op" id="6872591">.</span><span class="ident" id="6872592">T</span><span class="op" id="6872593">)</span>&nbsp;<span class="op" id="6872595">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6872598">for</span>&nbsp;<span class="ident" id="6872602">_</span><span class="op" id="6872603">,</span>&nbsp;<span class="ident" id="6872605">test</span>&nbsp;<span class="op" id="6872610">:=</span>&nbsp;<span class="keyword" id="6872613">range</span>&nbsp;<span class="ident" id="6872619">procInstTests</span>&nbsp;<span class="op" id="6872633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872637">got</span>&nbsp;<span class="op" id="6872641">:=</span>&nbsp;<span class="ident" id="6872644">procInstEncoding</span><span class="op" id="6872660">(</span><span class="ident" id="6872661">test</span><span class="op" id="6872665">.</span><span class="ident" id="6872666">input</span><span class="op" id="6872671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6872675">if</span>&nbsp;<span class="ident" id="6872678">got</span>&nbsp;<span class="op" id="6872682">!=</span>&nbsp;<span class="ident" id="6872685">test</span><span class="op" id="6872689">.</span><span class="ident" id="6872690">expect</span>&nbsp;<span class="op" id="6872697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6872702">t</span><span class="op" id="6872703">.</span><span class="ident" id="6872704">Errorf</span><span class="op" id="6872710">(</span><span class="string" id="6872711">&#34;procInstEncoding(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6872747">,</span>&nbsp;<span class="ident" id="6872749">test</span><span class="op" id="6872753">.</span><span class="ident" id="6872754">input</span><span class="op" id="6872759">,</span>&nbsp;<span class="ident" id="6872761">got</span><span class="op" id="6872764">,</span>&nbsp;<span class="ident" id="6872766">test</span><span class="op" id="6872770">.</span><span class="ident" id="6872771">expect</span><span class="op" id="6872777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872781">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6872784">}</span><br>
<span class="lineno"></span><span class="op" id="6872786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6872789">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;with&nbsp;comments&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno"></span><span class="comment" id="6872850">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives.</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="6872885">var</span>&nbsp;<span class="ident" id="6872889">directivesWithCommentsInput</span>&nbsp;<span class="op" id="6872917">=</span>&nbsp;<span class="string" id="6872919">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!--&nbsp;a&nbsp;comment&nbsp;--&gt;&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&lt;!----&gt;&nbsp;&lt;!--&gt;--&gt;&nbsp;&lt;!---&gt;--&gt;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno">685</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6873155">var</span>&nbsp;<span class="ident" id="6873159">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="6873188">=</span>&nbsp;<span class="op" id="6873190">[</span><span class="op" id="6873191">]</span><span class="ident" id="6873192">Token</span><span class="op" id="6873197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873200">CharData</span><span class="op" id="6873208">(</span><span class="string" id="6873209">&#34;\n&#34;</span><span class="op" id="6873213">)</span><span class="op" id="6873214">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873217">Directive</span><span class="op" id="6873226">(</span><span class="string" id="6873227">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="6873298">)</span><span class="op" id="6873299">,</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873302">CharData</span><span class="op" id="6873310">(</span><span class="string" id="6873311">&#34;\n&#34;</span><span class="op" id="6873315">)</span><span class="op" id="6873316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873319">Directive</span><span class="op" id="6873328">(</span><span class="string" id="6873329">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="6873362">)</span><span class="op" id="6873363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873366">CharData</span><span class="op" id="6873374">(</span><span class="string" id="6873375">&#34;\n&#34;</span><span class="op" id="6873379">)</span><span class="op" id="6873380">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873383">Directive</span><span class="op" id="6873392">(</span><span class="string" id="6873393">`DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&nbsp;&nbsp;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="6873438">)</span><span class="op" id="6873439">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873442">CharData</span><span class="op" id="6873450">(</span><span class="string" id="6873451">&#34;\n&#34;</span><span class="op" id="6873455">)</span><span class="op" id="6873456">,</span><br>
<span class="lineno">695</span><span class="op" id="6873458">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6873461">func</span>&nbsp;<span class="ident" id="6873466">TestDirectivesWithComments</span><span class="op" id="6873492">(</span><span class="ident" id="6873493">t</span>&nbsp;<span class="op" id="6873495">*</span><span class="ident" id="6873496">testing</span><span class="op" id="6873503">.</span><span class="ident" id="6873504">T</span><span class="op" id="6873505">)</span>&nbsp;<span class="op" id="6873507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873510">d</span>&nbsp;<span class="op" id="6873512">:=</span>&nbsp;<span class="ident" id="6873515">NewDecoder</span><span class="op" id="6873525">(</span><span class="ident" id="6873526">strings</span><span class="op" id="6873533">.</span><span class="ident" id="6873534">NewReader</span><span class="op" id="6873543">(</span><span class="ident" id="6873544">directivesWithCommentsInput</span><span class="op" id="6873571">)</span><span class="op" id="6873572">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873576">for</span>&nbsp;<span class="ident" id="6873580">i</span><span class="op" id="6873581">,</span>&nbsp;<span class="ident" id="6873583">want</span>&nbsp;<span class="op" id="6873588">:=</span>&nbsp;<span class="keyword" id="6873591">range</span>&nbsp;<span class="ident" id="6873597">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="6873626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873630">have</span><span class="op" id="6873634">,</span>&nbsp;<span class="ident" id="6873636">err</span>&nbsp;<span class="op" id="6873640">:=</span>&nbsp;<span class="ident" id="6873643">d</span><span class="op" id="6873644">.</span><span class="ident" id="6873645">Token</span><span class="op" id="6873650">(</span><span class="op" id="6873651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873655">if</span>&nbsp;<span class="ident" id="6873658">err</span>&nbsp;<span class="op" id="6873662">!=</span>&nbsp;<span class="ident" id="6873665">nil</span>&nbsp;<span class="op" id="6873669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873674">t</span><span class="op" id="6873675">.</span><span class="ident" id="6873676">Fatalf</span><span class="op" id="6873682">(</span><span class="string" id="6873683">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="6873715">,</span>&nbsp;<span class="ident" id="6873717">i</span><span class="op" id="6873718">,</span>&nbsp;<span class="ident" id="6873720">err</span><span class="op" id="6873723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6873727">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6873731">if</span>&nbsp;<span class="op" id="6873734">!</span><span class="ident" id="6873735">reflect</span><span class="op" id="6873742">.</span><span class="ident" id="6873743">DeepEqual</span><span class="op" id="6873752">(</span><span class="ident" id="6873753">have</span><span class="op" id="6873757">,</span>&nbsp;<span class="ident" id="6873759">want</span><span class="op" id="6873763">)</span>&nbsp;<span class="op" id="6873765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6873770">t</span><span class="op" id="6873771">.</span><span class="ident" id="6873772">Errorf</span><span class="op" id="6873778">(</span><span class="string" id="6873779">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="6873804">,</span>&nbsp;<span class="ident" id="6873806">i</span><span class="op" id="6873807">,</span>&nbsp;<span class="ident" id="6873809">have</span><span class="op" id="6873813">,</span>&nbsp;<span class="ident" id="6873815">want</span><span class="op" id="6873819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6873823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6873826">}</span><br>
<span class="lineno"></span><span class="op" id="6873828">}</span><br>
<span class="lineno">710</span><br>
<span class="lineno"></span><span class="comment" id="6873831">//&nbsp;Writer&nbsp;whose&nbsp;Write&nbsp;method&nbsp;always&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="6873885">type</span>&nbsp;<span class="ident" id="6873890">errWriter</span>&nbsp;<span class="keyword" id="6873900">struct</span><span class="op" id="6873906">{</span><span class="op" id="6873907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6873910">func</span>&nbsp;<span class="op" id="6873915">(</span><span class="ident" id="6873916">errWriter</span><span class="op" id="6873925">)</span>&nbsp;<span class="ident" id="6873927">Write</span><span class="op" id="6873932">(</span><span class="ident" id="6873933">p</span>&nbsp;<span class="op" id="6873935">[</span><span class="op" id="6873936">]</span><span class="builtintype" id="6873937">byte</span><span class="op" id="6873941">)</span>&nbsp;<span class="op" id="6873943">(</span><span class="ident" id="6873944">n</span>&nbsp;<span class="builtintype" id="6873946">int</span><span class="op" id="6873949">,</span>&nbsp;<span class="ident" id="6873951">err</span>&nbsp;<span class="builtintype" id="6873955">error</span><span class="op" id="6873960">)</span>&nbsp;<span class="op" id="6873962">{</span>&nbsp;<span class="keyword" id="6873964">return</span>&nbsp;<span class="num" id="6873971">0</span><span class="op" id="6873972">,</span>&nbsp;<span class="ident" id="6873974">fmt</span><span class="op" id="6873977">.</span><span class="ident" id="6873978">Errorf</span><span class="op" id="6873984">(</span><span class="string" id="6873985">&#34;unwritable&#34;</span><span class="op" id="6873997">)</span>&nbsp;<span class="op" id="6873999">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="6874002">func</span>&nbsp;<span class="ident" id="6874007">TestEscapeTextIOErrors</span><span class="op" id="6874029">(</span><span class="ident" id="6874030">t</span>&nbsp;<span class="op" id="6874032">*</span><span class="ident" id="6874033">testing</span><span class="op" id="6874040">.</span><span class="ident" id="6874041">T</span><span class="op" id="6874042">)</span>&nbsp;<span class="op" id="6874044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874047">expectErr</span>&nbsp;<span class="op" id="6874057">:=</span>&nbsp;<span class="string" id="6874060">&#34;unwritable&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874074">err</span>&nbsp;<span class="op" id="6874078">:=</span>&nbsp;<span class="ident" id="6874081">EscapeText</span><span class="op" id="6874091">(</span><span class="ident" id="6874092">errWriter</span><span class="op" id="6874101">{</span><span class="op" id="6874102">}</span><span class="op" id="6874103">,</span>&nbsp;<span class="op" id="6874105">[</span><span class="op" id="6874106">]</span><span class="builtintype" id="6874107">byte</span><span class="op" id="6874111">{</span><span class="string" id="6874112">&#39;A&#39;</span><span class="op" id="6874115">}</span><span class="op" id="6874116">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874120">if</span>&nbsp;<span class="ident" id="6874123">err</span>&nbsp;<span class="op" id="6874127">==</span>&nbsp;<span class="ident" id="6874130">nil</span>&nbsp;<span class="op" id="6874134">||</span>&nbsp;<span class="ident" id="6874137">err</span><span class="op" id="6874140">.</span><span class="ident" id="6874141">Error</span><span class="op" id="6874146">(</span><span class="op" id="6874147">)</span>&nbsp;<span class="op" id="6874149">!=</span>&nbsp;<span class="ident" id="6874152">expectErr</span>&nbsp;<span class="op" id="6874162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874166">t</span><span class="op" id="6874167">.</span><span class="ident" id="6874168">Errorf</span><span class="op" id="6874174">(</span><span class="string" id="6874175">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6874193">,</span>&nbsp;<span class="ident" id="6874195">err</span><span class="op" id="6874198">,</span>&nbsp;<span class="ident" id="6874200">expectErr</span><span class="op" id="6874209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6874212">}</span><br>
<span class="lineno"></span><span class="op" id="6874214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="keyword" id="6874217">func</span>&nbsp;<span class="ident" id="6874222">TestEscapeTextInvalidChar</span><span class="op" id="6874247">(</span><span class="ident" id="6874248">t</span>&nbsp;<span class="op" id="6874250">*</span><span class="ident" id="6874251">testing</span><span class="op" id="6874258">.</span><span class="ident" id="6874259">T</span><span class="op" id="6874260">)</span>&nbsp;<span class="op" id="6874262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874265">input</span>&nbsp;<span class="op" id="6874271">:=</span>&nbsp;<span class="op" id="6874274">[</span><span class="op" id="6874275">]</span><span class="builtintype" id="6874276">byte</span><span class="op" id="6874280">(</span><span class="string" id="6874281">&#34;A&nbsp;\x00&nbsp;terminated&nbsp;string.&#34;</span><span class="op" id="6874308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874311">expected</span>&nbsp;<span class="op" id="6874320">:=</span>&nbsp;<span class="string" id="6874323">&#34;A&nbsp;\uFFFD&nbsp;terminated&nbsp;string.&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874355">buff</span>&nbsp;<span class="op" id="6874360">:=</span>&nbsp;<span class="builtinfunc" id="6874363">new</span><span class="op" id="6874366">(</span><span class="ident" id="6874367">bytes</span><span class="op" id="6874372">.</span><span class="ident" id="6874373">Buffer</span><span class="op" id="6874379">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874382">if</span>&nbsp;<span class="ident" id="6874385">err</span>&nbsp;<span class="op" id="6874389">:=</span>&nbsp;<span class="ident" id="6874392">EscapeText</span><span class="op" id="6874402">(</span><span class="ident" id="6874403">buff</span><span class="op" id="6874407">,</span>&nbsp;<span class="ident" id="6874409">input</span><span class="op" id="6874414">)</span><span class="op" id="6874415">;</span>&nbsp;<span class="ident" id="6874417">err</span>&nbsp;<span class="op" id="6874421">!=</span>&nbsp;<span class="ident" id="6874424">nil</span>&nbsp;<span class="op" id="6874428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874432">t</span><span class="op" id="6874433">.</span><span class="ident" id="6874434">Fatalf</span><span class="op" id="6874440">(</span><span class="string" id="6874441">&#34;have&nbsp;%v,&nbsp;want&nbsp;nil&#34;</span><span class="op" id="6874460">,</span>&nbsp;<span class="ident" id="6874462">err</span><span class="op" id="6874465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6874468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874471">text</span>&nbsp;<span class="op" id="6874476">:=</span>&nbsp;<span class="ident" id="6874479">buff</span><span class="op" id="6874483">.</span><span class="ident" id="6874484">String</span><span class="op" id="6874490">(</span><span class="op" id="6874491">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874495">if</span>&nbsp;<span class="ident" id="6874498">text</span>&nbsp;<span class="op" id="6874503">!=</span>&nbsp;<span class="ident" id="6874506">expected</span>&nbsp;<span class="op" id="6874515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874519">t</span><span class="op" id="6874520">.</span><span class="ident" id="6874521">Errorf</span><span class="op" id="6874527">(</span><span class="string" id="6874528">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6874546">,</span>&nbsp;<span class="ident" id="6874548">text</span><span class="op" id="6874552">,</span>&nbsp;<span class="ident" id="6874554">expected</span><span class="op" id="6874562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6874565">}</span><br>
<span class="lineno"></span><span class="op" id="6874567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">740</span><span class="keyword" id="6874570">func</span>&nbsp;<span class="ident" id="6874575">TestIssue5880</span><span class="op" id="6874588">(</span><span class="ident" id="6874589">t</span>&nbsp;<span class="op" id="6874591">*</span><span class="ident" id="6874592">testing</span><span class="op" id="6874599">.</span><span class="ident" id="6874600">T</span><span class="op" id="6874601">)</span>&nbsp;<span class="op" id="6874603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874606">type</span>&nbsp;<span class="ident" id="6874611">T</span>&nbsp;<span class="op" id="6874613">[</span><span class="op" id="6874614">]</span><span class="builtintype" id="6874615">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874621">data</span><span class="op" id="6874625">,</span>&nbsp;<span class="ident" id="6874627">err</span>&nbsp;<span class="op" id="6874631">:=</span>&nbsp;<span class="ident" id="6874634">Marshal</span><span class="op" id="6874641">(</span><span class="ident" id="6874642">T</span><span class="op" id="6874643">{</span><span class="num" id="6874644">192</span><span class="op" id="6874647">,</span>&nbsp;<span class="num" id="6874649">168</span><span class="op" id="6874652">,</span>&nbsp;<span class="num" id="6874654">0</span><span class="op" id="6874655">,</span>&nbsp;<span class="num" id="6874657">1</span><span class="op" id="6874658">}</span><span class="op" id="6874659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874662">if</span>&nbsp;<span class="ident" id="6874665">err</span>&nbsp;<span class="op" id="6874669">!=</span>&nbsp;<span class="ident" id="6874672">nil</span>&nbsp;<span class="op" id="6874676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874680">t</span><span class="op" id="6874681">.</span><span class="ident" id="6874682">Errorf</span><span class="op" id="6874688">(</span><span class="string" id="6874689">&#34;Marshal&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="6874708">,</span>&nbsp;<span class="ident" id="6874710">err</span><span class="op" id="6874713">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6874716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6874719">if</span>&nbsp;<span class="op" id="6874722">!</span><span class="ident" id="6874723">utf8</span><span class="op" id="6874727">.</span><span class="ident" id="6874728">Valid</span><span class="op" id="6874733">(</span><span class="ident" id="6874734">data</span><span class="op" id="6874738">)</span>&nbsp;<span class="op" id="6874740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6874744">t</span><span class="op" id="6874745">.</span><span class="ident" id="6874746">Errorf</span><span class="op" id="6874752">(</span><span class="string" id="6874753">&#34;Marshal&nbsp;generated&nbsp;invalid&nbsp;UTF-8:&nbsp;%x&#34;</span><span class="op" id="6874790">,</span>&nbsp;<span class="ident" id="6874792">data</span><span class="op" id="6874796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6874799">}</span><br>
<span class="lineno"></span><span class="op" id="6874801">}</span>
</div>
</body>
</html>
