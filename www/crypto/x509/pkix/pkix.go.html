<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4248527">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4248582">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4248636">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4248687">//&nbsp;Package&nbsp;pkix&nbsp;contains&nbsp;shared,&nbsp;low&nbsp;level&nbsp;structures&nbsp;used&nbsp;for&nbsp;ASN.1&nbsp;parsing</span><br>
<span class="lineno"></span><span class="comment" id="4248764">//&nbsp;and&nbsp;serialization&nbsp;of&nbsp;X.509&nbsp;certificates,&nbsp;CRL&nbsp;and&nbsp;OCSP.</span><br>
<span class="lineno"></span><span class="keyword" id="4248822">package</span>&nbsp;<span class="ident" id="4248830">pkix</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4248836">import</span>&nbsp;<span class="op" id="4248843">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4248846">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4248863">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4248875">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4248882">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="4248885">//&nbsp;AlgorithmIdentifier&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4248965">//&nbsp;5280,&nbsp;section&nbsp;4.1.1.2.</span><br>
<span class="lineno"></span><span class="keyword" id="4248991">type</span>&nbsp;<span class="ident" id="4248996">AlgorithmIdentifier</span>&nbsp;<span class="keyword" id="4249016">struct</span>&nbsp;<span class="op" id="4249023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4249026">Algorithm</span>&nbsp;&nbsp;<span class="ident" id="4249037">asn1</span><span class="op" id="4249041">.</span><span class="ident" id="4249042">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4249060">Parameters</span>&nbsp;<span class="ident" id="4249071">asn1</span><span class="op" id="4249075">.</span><span class="ident" id="4249076">RawValue</span>&nbsp;<span class="string" id="4249085">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">20</span><span class="op" id="4249103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4249106">type</span>&nbsp;<span class="ident" id="4249111">RDNSequence</span>&nbsp;<span class="op" id="4249123">[</span><span class="op" id="4249124">]</span><span class="ident" id="4249125">RelativeDistinguishedNameSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4249155">type</span>&nbsp;<span class="ident" id="4249160">RelativeDistinguishedNameSET</span>&nbsp;<span class="op" id="4249189">[</span><span class="op" id="4249190">]</span><span class="ident" id="4249191">AttributeTypeAndValue</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="4249214">//&nbsp;AttributeTypeAndValue&nbsp;mirrors&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4249287">//&nbsp;http://tools.ietf.org/html/rfc5280#section-4.1.2.4</span><br>
<span class="lineno"></span><span class="keyword" id="4249341">type</span>&nbsp;<span class="ident" id="4249346">AttributeTypeAndValue</span>&nbsp;<span class="keyword" id="4249368">struct</span>&nbsp;<span class="op" id="4249375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4249378">Type</span>&nbsp;&nbsp;<span class="ident" id="4249384">asn1</span><span class="op" id="4249388">.</span><span class="ident" id="4249389">ObjectIdentifier</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4249407">Value</span>&nbsp;<span class="keyword" id="4249413">interface</span><span class="op" id="4249422">{</span><span class="op" id="4249423">}</span><br>
<span class="lineno"></span><span class="op" id="4249425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4249428">//&nbsp;AttributeTypeAndValueSET&nbsp;represents&nbsp;a&nbsp;set&nbsp;of&nbsp;ASN.1&nbsp;sequences&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4249495">//&nbsp;AttributeTypeAndValue&nbsp;sequences&nbsp;from&nbsp;RFC&nbsp;2986&nbsp;(PKCS&nbsp;#10).</span><br>
<span class="lineno">35</span><span class="keyword" id="4249556">type</span>&nbsp;<span class="ident" id="4249561">AttributeTypeAndValueSET</span>&nbsp;<span class="keyword" id="4249586">struct</span>&nbsp;<span class="op" id="4249593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4249596">Type</span>&nbsp;&nbsp;<span class="ident" id="4249602">asn1</span><span class="op" id="4249606">.</span><span class="ident" id="4249607">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4249625">Value</span>&nbsp;<span class="op" id="4249631">[</span><span class="op" id="4249632">]</span><span class="op" id="4249633">[</span><span class="op" id="4249634">]</span><span class="ident" id="4249635">AttributeTypeAndValue</span>&nbsp;<span class="string" id="4249657">`asn1:&#34;set&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4249670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4249673">//&nbsp;Extension&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4249743">//&nbsp;5280,&nbsp;section&nbsp;4.2.</span><br>
<span class="lineno"></span><span class="keyword" id="4249765">type</span>&nbsp;<span class="ident" id="4249770">Extension</span>&nbsp;<span class="keyword" id="4249780">struct</span>&nbsp;<span class="op" id="4249787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4249790">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249799">asn1</span><span class="op" id="4249803">.</span><span class="ident" id="4249804">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4249822">Critical</span>&nbsp;<span class="builtintype" id="4249831">bool</span>&nbsp;<span class="string" id="4249836">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4249855">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4249864">[</span><span class="op" id="4249865">]</span><span class="builtintype" id="4249866">byte</span><br>
<span class="lineno"></span><span class="op" id="4249871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4249874">//&nbsp;Name&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;distinguished&nbsp;name.&nbsp;This&nbsp;only&nbsp;includes&nbsp;the&nbsp;common</span><br>
<span class="lineno"></span><span class="comment" id="4249952">//&nbsp;elements&nbsp;of&nbsp;a&nbsp;DN.&nbsp;&nbsp;Additional&nbsp;elements&nbsp;in&nbsp;the&nbsp;name&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno">50</span><span class="keyword" id="4250019">type</span>&nbsp;<span class="ident" id="4250024">Name</span>&nbsp;<span class="keyword" id="4250029">struct</span>&nbsp;<span class="op" id="4250036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250039">Country</span><span class="op" id="4250046">,</span>&nbsp;<span class="ident" id="4250048">Organization</span><span class="op" id="4250060">,</span>&nbsp;<span class="ident" id="4250062">OrganizationalUnit</span>&nbsp;<span class="op" id="4250081">[</span><span class="op" id="4250082">]</span><span class="builtintype" id="4250083">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250091">Locality</span><span class="op" id="4250099">,</span>&nbsp;<span class="ident" id="4250101">Province</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4250133">[</span><span class="op" id="4250134">]</span><span class="builtintype" id="4250135">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250143">StreetAddress</span><span class="op" id="4250156">,</span>&nbsp;<span class="ident" id="4250158">PostalCode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4250185">[</span><span class="op" id="4250186">]</span><span class="builtintype" id="4250187">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250195">SerialNumber</span><span class="op" id="4250207">,</span>&nbsp;<span class="ident" id="4250209">CommonName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4250237">string</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250246">Names</span>&nbsp;<span class="op" id="4250252">[</span><span class="op" id="4250253">]</span><span class="ident" id="4250254">AttributeTypeAndValue</span><br>
<span class="lineno"></span><span class="op" id="4250276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4250279">func</span>&nbsp;<span class="op" id="4250284">(</span><span class="ident" id="4250285">n</span>&nbsp;<span class="op" id="4250287">*</span><span class="ident" id="4250288">Name</span><span class="op" id="4250292">)</span>&nbsp;<span class="ident" id="4250294">FillFromRDNSequence</span><span class="op" id="4250313">(</span><span class="ident" id="4250314">rdns</span>&nbsp;<span class="op" id="4250319">*</span><span class="ident" id="4250320">RDNSequence</span><span class="op" id="4250331">)</span>&nbsp;<span class="op" id="4250333">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4250336">for</span>&nbsp;<span class="ident" id="4250340">_</span><span class="op" id="4250341">,</span>&nbsp;<span class="ident" id="4250343">rdn</span>&nbsp;<span class="op" id="4250347">:=</span>&nbsp;<span class="keyword" id="4250350">range</span>&nbsp;<span class="op" id="4250356">*</span><span class="ident" id="4250357">rdns</span>&nbsp;<span class="op" id="4250362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4250366">if</span>&nbsp;<span class="builtinfunc" id="4250369">len</span><span class="op" id="4250372">(</span><span class="ident" id="4250373">rdn</span><span class="op" id="4250376">)</span>&nbsp;<span class="op" id="4250378">==</span>&nbsp;<span class="num" id="4250381">0</span>&nbsp;<span class="op" id="4250383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4250388">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4250399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250403">atv</span>&nbsp;<span class="op" id="4250407">:=</span>&nbsp;<span class="ident" id="4250410">rdn</span><span class="op" id="4250413">[</span><span class="num" id="4250414">0</span><span class="op" id="4250415">]</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250419">n</span><span class="op" id="4250420">.</span><span class="ident" id="4250421">Names</span>&nbsp;<span class="op" id="4250427">=</span>&nbsp;<span class="builtinfunc" id="4250429">append</span><span class="op" id="4250435">(</span><span class="ident" id="4250436">n</span><span class="op" id="4250437">.</span><span class="ident" id="4250438">Names</span><span class="op" id="4250443">,</span>&nbsp;<span class="ident" id="4250445">atv</span><span class="op" id="4250448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250452">value</span><span class="op" id="4250457">,</span>&nbsp;<span class="ident" id="4250459">ok</span>&nbsp;<span class="op" id="4250462">:=</span>&nbsp;<span class="ident" id="4250465">atv</span><span class="op" id="4250468">.</span><span class="ident" id="4250469">Value</span><span class="op" id="4250474">.</span><span class="op" id="4250475">(</span><span class="builtintype" id="4250476">string</span><span class="op" id="4250482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4250486">if</span>&nbsp;<span class="op" id="4250489">!</span><span class="ident" id="4250490">ok</span>&nbsp;<span class="op" id="4250493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4250498">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4250509">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250514">t</span>&nbsp;<span class="op" id="4250516">:=</span>&nbsp;<span class="ident" id="4250519">atv</span><span class="op" id="4250522">.</span><span class="ident" id="4250523">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4250530">if</span>&nbsp;<span class="builtinfunc" id="4250533">len</span><span class="op" id="4250536">(</span><span class="ident" id="4250537">t</span><span class="op" id="4250538">)</span>&nbsp;<span class="op" id="4250540">==</span>&nbsp;<span class="num" id="4250543">4</span>&nbsp;<span class="op" id="4250545">&amp;&amp;</span>&nbsp;<span class="ident" id="4250548">t</span><span class="op" id="4250549">[</span><span class="num" id="4250550">0</span><span class="op" id="4250551">]</span>&nbsp;<span class="op" id="4250553">==</span>&nbsp;<span class="num" id="4250556">2</span>&nbsp;<span class="op" id="4250558">&amp;&amp;</span>&nbsp;<span class="ident" id="4250561">t</span><span class="op" id="4250562">[</span><span class="num" id="4250563">1</span><span class="op" id="4250564">]</span>&nbsp;<span class="op" id="4250566">==</span>&nbsp;<span class="num" id="4250569">5</span>&nbsp;<span class="op" id="4250571">&amp;&amp;</span>&nbsp;<span class="ident" id="4250574">t</span><span class="op" id="4250575">[</span><span class="num" id="4250576">2</span><span class="op" id="4250577">]</span>&nbsp;<span class="op" id="4250579">==</span>&nbsp;<span class="num" id="4250582">4</span>&nbsp;<span class="op" id="4250584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4250589">switch</span>&nbsp;<span class="ident" id="4250596">t</span><span class="op" id="4250597">[</span><span class="num" id="4250598">3</span><span class="op" id="4250599">]</span>&nbsp;<span class="op" id="4250601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4250606">case</span>&nbsp;<span class="num" id="4250611">3</span><span class="op" id="4250612">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250618">n</span><span class="op" id="4250619">.</span><span class="ident" id="4250620">CommonName</span>&nbsp;<span class="op" id="4250631">=</span>&nbsp;<span class="ident" id="4250633">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4250642">case</span>&nbsp;<span class="num" id="4250647">5</span><span class="op" id="4250648">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250654">n</span><span class="op" id="4250655">.</span><span class="ident" id="4250656">SerialNumber</span>&nbsp;<span class="op" id="4250669">=</span>&nbsp;<span class="ident" id="4250671">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4250680">case</span>&nbsp;<span class="num" id="4250685">6</span><span class="op" id="4250686">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250692">n</span><span class="op" id="4250693">.</span><span class="ident" id="4250694">Country</span>&nbsp;<span class="op" id="4250702">=</span>&nbsp;<span class="builtinfunc" id="4250704">append</span><span class="op" id="4250710">(</span><span class="ident" id="4250711">n</span><span class="op" id="4250712">.</span><span class="ident" id="4250713">Country</span><span class="op" id="4250720">,</span>&nbsp;<span class="ident" id="4250722">value</span><span class="op" id="4250727">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4250732">case</span>&nbsp;<span class="num" id="4250737">7</span><span class="op" id="4250738">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250744">n</span><span class="op" id="4250745">.</span><span class="ident" id="4250746">Locality</span>&nbsp;<span class="op" id="4250755">=</span>&nbsp;<span class="builtinfunc" id="4250757">append</span><span class="op" id="4250763">(</span><span class="ident" id="4250764">n</span><span class="op" id="4250765">.</span><span class="ident" id="4250766">Locality</span><span class="op" id="4250774">,</span>&nbsp;<span class="ident" id="4250776">value</span><span class="op" id="4250781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4250786">case</span>&nbsp;<span class="num" id="4250791">8</span><span class="op" id="4250792">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250798">n</span><span class="op" id="4250799">.</span><span class="ident" id="4250800">Province</span>&nbsp;<span class="op" id="4250809">=</span>&nbsp;<span class="builtinfunc" id="4250811">append</span><span class="op" id="4250817">(</span><span class="ident" id="4250818">n</span><span class="op" id="4250819">.</span><span class="ident" id="4250820">Province</span><span class="op" id="4250828">,</span>&nbsp;<span class="ident" id="4250830">value</span><span class="op" id="4250835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4250840">case</span>&nbsp;<span class="num" id="4250845">9</span><span class="op" id="4250846">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250852">n</span><span class="op" id="4250853">.</span><span class="ident" id="4250854">StreetAddress</span>&nbsp;<span class="op" id="4250868">=</span>&nbsp;<span class="builtinfunc" id="4250870">append</span><span class="op" id="4250876">(</span><span class="ident" id="4250877">n</span><span class="op" id="4250878">.</span><span class="ident" id="4250879">StreetAddress</span><span class="op" id="4250892">,</span>&nbsp;<span class="ident" id="4250894">value</span><span class="op" id="4250899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4250904">case</span>&nbsp;<span class="num" id="4250909">10</span><span class="op" id="4250911">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250917">n</span><span class="op" id="4250918">.</span><span class="ident" id="4250919">Organization</span>&nbsp;<span class="op" id="4250932">=</span>&nbsp;<span class="builtinfunc" id="4250934">append</span><span class="op" id="4250940">(</span><span class="ident" id="4250941">n</span><span class="op" id="4250942">.</span><span class="ident" id="4250943">Organization</span><span class="op" id="4250955">,</span>&nbsp;<span class="ident" id="4250957">value</span><span class="op" id="4250962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4250967">case</span>&nbsp;<span class="num" id="4250972">11</span><span class="op" id="4250974">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250980">n</span><span class="op" id="4250981">.</span><span class="ident" id="4250982">OrganizationalUnit</span>&nbsp;<span class="op" id="4251001">=</span>&nbsp;<span class="builtinfunc" id="4251003">append</span><span class="op" id="4251009">(</span><span class="ident" id="4251010">n</span><span class="op" id="4251011">.</span><span class="ident" id="4251012">OrganizationalUnit</span><span class="op" id="4251030">,</span>&nbsp;<span class="ident" id="4251032">value</span><span class="op" id="4251037">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4251042">case</span>&nbsp;<span class="num" id="4251047">17</span><span class="op" id="4251049">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251055">n</span><span class="op" id="4251056">.</span><span class="ident" id="4251057">PostalCode</span>&nbsp;<span class="op" id="4251068">=</span>&nbsp;<span class="builtinfunc" id="4251070">append</span><span class="op" id="4251076">(</span><span class="ident" id="4251077">n</span><span class="op" id="4251078">.</span><span class="ident" id="4251079">PostalCode</span><span class="op" id="4251089">,</span>&nbsp;<span class="ident" id="4251091">value</span><span class="op" id="4251096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4251101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4251105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4251108">}</span><br>
<span class="lineno">95</span><span class="op" id="4251110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4251113">var</span>&nbsp;<span class="op" id="4251117">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251120">oidCountry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4251142">=</span>&nbsp;<span class="op" id="4251144">[</span><span class="op" id="4251145">]</span><span class="builtintype" id="4251146">int</span><span class="op" id="4251149">{</span><span class="num" id="4251150">2</span><span class="op" id="4251151">,</span>&nbsp;<span class="num" id="4251153">5</span><span class="op" id="4251154">,</span>&nbsp;<span class="num" id="4251156">4</span><span class="op" id="4251157">,</span>&nbsp;<span class="num" id="4251159">6</span><span class="op" id="4251160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251163">oidOrganization</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4251185">=</span>&nbsp;<span class="op" id="4251187">[</span><span class="op" id="4251188">]</span><span class="builtintype" id="4251189">int</span><span class="op" id="4251192">{</span><span class="num" id="4251193">2</span><span class="op" id="4251194">,</span>&nbsp;<span class="num" id="4251196">5</span><span class="op" id="4251197">,</span>&nbsp;<span class="num" id="4251199">4</span><span class="op" id="4251200">,</span>&nbsp;<span class="num" id="4251202">10</span><span class="op" id="4251204">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251207">oidOrganizationalUnit</span>&nbsp;<span class="op" id="4251229">=</span>&nbsp;<span class="op" id="4251231">[</span><span class="op" id="4251232">]</span><span class="builtintype" id="4251233">int</span><span class="op" id="4251236">{</span><span class="num" id="4251237">2</span><span class="op" id="4251238">,</span>&nbsp;<span class="num" id="4251240">5</span><span class="op" id="4251241">,</span>&nbsp;<span class="num" id="4251243">4</span><span class="op" id="4251244">,</span>&nbsp;<span class="num" id="4251246">11</span><span class="op" id="4251248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251251">oidCommonName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4251273">=</span>&nbsp;<span class="op" id="4251275">[</span><span class="op" id="4251276">]</span><span class="builtintype" id="4251277">int</span><span class="op" id="4251280">{</span><span class="num" id="4251281">2</span><span class="op" id="4251282">,</span>&nbsp;<span class="num" id="4251284">5</span><span class="op" id="4251285">,</span>&nbsp;<span class="num" id="4251287">4</span><span class="op" id="4251288">,</span>&nbsp;<span class="num" id="4251290">3</span><span class="op" id="4251291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251294">oidSerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4251316">=</span>&nbsp;<span class="op" id="4251318">[</span><span class="op" id="4251319">]</span><span class="builtintype" id="4251320">int</span><span class="op" id="4251323">{</span><span class="num" id="4251324">2</span><span class="op" id="4251325">,</span>&nbsp;<span class="num" id="4251327">5</span><span class="op" id="4251328">,</span>&nbsp;<span class="num" id="4251330">4</span><span class="op" id="4251331">,</span>&nbsp;<span class="num" id="4251333">5</span><span class="op" id="4251334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251337">oidLocality</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4251359">=</span>&nbsp;<span class="op" id="4251361">[</span><span class="op" id="4251362">]</span><span class="builtintype" id="4251363">int</span><span class="op" id="4251366">{</span><span class="num" id="4251367">2</span><span class="op" id="4251368">,</span>&nbsp;<span class="num" id="4251370">5</span><span class="op" id="4251371">,</span>&nbsp;<span class="num" id="4251373">4</span><span class="op" id="4251374">,</span>&nbsp;<span class="num" id="4251376">7</span><span class="op" id="4251377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251380">oidProvince</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4251402">=</span>&nbsp;<span class="op" id="4251404">[</span><span class="op" id="4251405">]</span><span class="builtintype" id="4251406">int</span><span class="op" id="4251409">{</span><span class="num" id="4251410">2</span><span class="op" id="4251411">,</span>&nbsp;<span class="num" id="4251413">5</span><span class="op" id="4251414">,</span>&nbsp;<span class="num" id="4251416">4</span><span class="op" id="4251417">,</span>&nbsp;<span class="num" id="4251419">8</span><span class="op" id="4251420">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251423">oidStreetAddress</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4251445">=</span>&nbsp;<span class="op" id="4251447">[</span><span class="op" id="4251448">]</span><span class="builtintype" id="4251449">int</span><span class="op" id="4251452">{</span><span class="num" id="4251453">2</span><span class="op" id="4251454">,</span>&nbsp;<span class="num" id="4251456">5</span><span class="op" id="4251457">,</span>&nbsp;<span class="num" id="4251459">4</span><span class="op" id="4251460">,</span>&nbsp;<span class="num" id="4251462">9</span><span class="op" id="4251463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251466">oidPostalCode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4251488">=</span>&nbsp;<span class="op" id="4251490">[</span><span class="op" id="4251491">]</span><span class="builtintype" id="4251492">int</span><span class="op" id="4251495">{</span><span class="num" id="4251496">2</span><span class="op" id="4251497">,</span>&nbsp;<span class="num" id="4251499">5</span><span class="op" id="4251500">,</span>&nbsp;<span class="num" id="4251502">4</span><span class="op" id="4251503">,</span>&nbsp;<span class="num" id="4251505">17</span><span class="op" id="4251507">}</span><br>
<span class="lineno"></span><span class="op" id="4251509">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4251512">//&nbsp;appendRDNs&nbsp;appends&nbsp;a&nbsp;relativeDistinguishedNameSET&nbsp;to&nbsp;the&nbsp;given&nbsp;RDNSequence</span><br>
<span class="lineno">110</span><span class="comment" id="4251590">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;value.&nbsp;The&nbsp;relativeDistinguishedNameSET&nbsp;contains&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4251665">//&nbsp;attributeTypeAndValue&nbsp;for&nbsp;each&nbsp;of&nbsp;the&nbsp;given&nbsp;values.&nbsp;See&nbsp;RFC&nbsp;5280,&nbsp;A.1,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4251743">//&nbsp;search&nbsp;for&nbsp;AttributeTypeAndValue.</span><br>
<span class="lineno"></span><span class="keyword" id="4251780">func</span>&nbsp;<span class="ident" id="4251785">appendRDNs</span><span class="op" id="4251795">(</span><span class="ident" id="4251796">in</span>&nbsp;<span class="ident" id="4251799">RDNSequence</span><span class="op" id="4251810">,</span>&nbsp;<span class="ident" id="4251812">values</span>&nbsp;<span class="op" id="4251819">[</span><span class="op" id="4251820">]</span><span class="builtintype" id="4251821">string</span><span class="op" id="4251827">,</span>&nbsp;<span class="ident" id="4251829">oid</span>&nbsp;<span class="ident" id="4251833">asn1</span><span class="op" id="4251837">.</span><span class="ident" id="4251838">ObjectIdentifier</span><span class="op" id="4251854">)</span>&nbsp;<span class="ident" id="4251856">RDNSequence</span>&nbsp;<span class="op" id="4251868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4251871">if</span>&nbsp;<span class="builtinfunc" id="4251874">len</span><span class="op" id="4251877">(</span><span class="ident" id="4251878">values</span><span class="op" id="4251884">)</span>&nbsp;<span class="op" id="4251886">==</span>&nbsp;<span class="num" id="4251889">0</span>&nbsp;<span class="op" id="4251891">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4251895">return</span>&nbsp;<span class="ident" id="4251902">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4251906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251910">s</span>&nbsp;<span class="op" id="4251912">:=</span>&nbsp;<span class="builtinfunc" id="4251915">make</span><span class="op" id="4251919">(</span><span class="op" id="4251920">[</span><span class="op" id="4251921">]</span><span class="ident" id="4251922">AttributeTypeAndValue</span><span class="op" id="4251943">,</span>&nbsp;<span class="builtinfunc" id="4251945">len</span><span class="op" id="4251948">(</span><span class="ident" id="4251949">values</span><span class="op" id="4251955">)</span><span class="op" id="4251956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4251959">for</span>&nbsp;<span class="ident" id="4251963">i</span><span class="op" id="4251964">,</span>&nbsp;<span class="ident" id="4251966">value</span>&nbsp;<span class="op" id="4251972">:=</span>&nbsp;<span class="keyword" id="4251975">range</span>&nbsp;<span class="ident" id="4251981">values</span>&nbsp;<span class="op" id="4251988">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251992">s</span><span class="op" id="4251993">[</span><span class="ident" id="4251994">i</span><span class="op" id="4251995">]</span><span class="op" id="4251996">.</span><span class="ident" id="4251997">Type</span>&nbsp;<span class="op" id="4252002">=</span>&nbsp;<span class="ident" id="4252004">oid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4252010">s</span><span class="op" id="4252011">[</span><span class="ident" id="4252012">i</span><span class="op" id="4252013">]</span><span class="op" id="4252014">.</span><span class="ident" id="4252015">Value</span>&nbsp;<span class="op" id="4252021">=</span>&nbsp;<span class="ident" id="4252023">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4252030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4252034">return</span>&nbsp;<span class="builtinfunc" id="4252041">append</span><span class="op" id="4252047">(</span><span class="ident" id="4252048">in</span><span class="op" id="4252050">,</span>&nbsp;<span class="ident" id="4252052">s</span><span class="op" id="4252053">)</span><br>
<span class="lineno">125</span><span class="op" id="4252055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4252058">func</span>&nbsp;<span class="op" id="4252063">(</span><span class="ident" id="4252064">n</span>&nbsp;<span class="ident" id="4252066">Name</span><span class="op" id="4252070">)</span>&nbsp;<span class="ident" id="4252072">ToRDNSequence</span><span class="op" id="4252085">(</span><span class="op" id="4252086">)</span>&nbsp;<span class="op" id="4252088">(</span><span class="ident" id="4252089">ret</span>&nbsp;<span class="ident" id="4252093">RDNSequence</span><span class="op" id="4252104">)</span>&nbsp;<span class="op" id="4252106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4252109">ret</span>&nbsp;<span class="op" id="4252113">=</span>&nbsp;<span class="ident" id="4252115">appendRDNs</span><span class="op" id="4252125">(</span><span class="ident" id="4252126">ret</span><span class="op" id="4252129">,</span>&nbsp;<span class="ident" id="4252131">n</span><span class="op" id="4252132">.</span><span class="ident" id="4252133">Country</span><span class="op" id="4252140">,</span>&nbsp;<span class="ident" id="4252142">oidCountry</span><span class="op" id="4252152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4252155">ret</span>&nbsp;<span class="op" id="4252159">=</span>&nbsp;<span class="ident" id="4252161">appendRDNs</span><span class="op" id="4252171">(</span><span class="ident" id="4252172">ret</span><span class="op" id="4252175">,</span>&nbsp;<span class="ident" id="4252177">n</span><span class="op" id="4252178">.</span><span class="ident" id="4252179">Organization</span><span class="op" id="4252191">,</span>&nbsp;<span class="ident" id="4252193">oidOrganization</span><span class="op" id="4252208">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4252211">ret</span>&nbsp;<span class="op" id="4252215">=</span>&nbsp;<span class="ident" id="4252217">appendRDNs</span><span class="op" id="4252227">(</span><span class="ident" id="4252228">ret</span><span class="op" id="4252231">,</span>&nbsp;<span class="ident" id="4252233">n</span><span class="op" id="4252234">.</span><span class="ident" id="4252235">OrganizationalUnit</span><span class="op" id="4252253">,</span>&nbsp;<span class="ident" id="4252255">oidOrganizationalUnit</span><span class="op" id="4252276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4252279">ret</span>&nbsp;<span class="op" id="4252283">=</span>&nbsp;<span class="ident" id="4252285">appendRDNs</span><span class="op" id="4252295">(</span><span class="ident" id="4252296">ret</span><span class="op" id="4252299">,</span>&nbsp;<span class="ident" id="4252301">n</span><span class="op" id="4252302">.</span><span class="ident" id="4252303">Locality</span><span class="op" id="4252311">,</span>&nbsp;<span class="ident" id="4252313">oidLocality</span><span class="op" id="4252324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4252327">ret</span>&nbsp;<span class="op" id="4252331">=</span>&nbsp;<span class="ident" id="4252333">appendRDNs</span><span class="op" id="4252343">(</span><span class="ident" id="4252344">ret</span><span class="op" id="4252347">,</span>&nbsp;<span class="ident" id="4252349">n</span><span class="op" id="4252350">.</span><span class="ident" id="4252351">Province</span><span class="op" id="4252359">,</span>&nbsp;<span class="ident" id="4252361">oidProvince</span><span class="op" id="4252372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4252375">ret</span>&nbsp;<span class="op" id="4252379">=</span>&nbsp;<span class="ident" id="4252381">appendRDNs</span><span class="op" id="4252391">(</span><span class="ident" id="4252392">ret</span><span class="op" id="4252395">,</span>&nbsp;<span class="ident" id="4252397">n</span><span class="op" id="4252398">.</span><span class="ident" id="4252399">StreetAddress</span><span class="op" id="4252412">,</span>&nbsp;<span class="ident" id="4252414">oidStreetAddress</span><span class="op" id="4252430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4252433">ret</span>&nbsp;<span class="op" id="4252437">=</span>&nbsp;<span class="ident" id="4252439">appendRDNs</span><span class="op" id="4252449">(</span><span class="ident" id="4252450">ret</span><span class="op" id="4252453">,</span>&nbsp;<span class="ident" id="4252455">n</span><span class="op" id="4252456">.</span><span class="ident" id="4252457">PostalCode</span><span class="op" id="4252467">,</span>&nbsp;<span class="ident" id="4252469">oidPostalCode</span><span class="op" id="4252482">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4252485">if</span>&nbsp;<span class="builtinfunc" id="4252488">len</span><span class="op" id="4252491">(</span><span class="ident" id="4252492">n</span><span class="op" id="4252493">.</span><span class="ident" id="4252494">CommonName</span><span class="op" id="4252504">)</span>&nbsp;<span class="op" id="4252506">&gt;</span>&nbsp;<span class="num" id="4252508">0</span>&nbsp;<span class="op" id="4252510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4252514">ret</span>&nbsp;<span class="op" id="4252518">=</span>&nbsp;<span class="ident" id="4252520">appendRDNs</span><span class="op" id="4252530">(</span><span class="ident" id="4252531">ret</span><span class="op" id="4252534">,</span>&nbsp;<span class="op" id="4252536">[</span><span class="op" id="4252537">]</span><span class="builtintype" id="4252538">string</span><span class="op" id="4252544">{</span><span class="ident" id="4252545">n</span><span class="op" id="4252546">.</span><span class="ident" id="4252547">CommonName</span><span class="op" id="4252557">}</span><span class="op" id="4252558">,</span>&nbsp;<span class="ident" id="4252560">oidCommonName</span><span class="op" id="4252573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4252576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4252579">if</span>&nbsp;<span class="builtinfunc" id="4252582">len</span><span class="op" id="4252585">(</span><span class="ident" id="4252586">n</span><span class="op" id="4252587">.</span><span class="ident" id="4252588">SerialNumber</span><span class="op" id="4252600">)</span>&nbsp;<span class="op" id="4252602">&gt;</span>&nbsp;<span class="num" id="4252604">0</span>&nbsp;<span class="op" id="4252606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4252610">ret</span>&nbsp;<span class="op" id="4252614">=</span>&nbsp;<span class="ident" id="4252616">appendRDNs</span><span class="op" id="4252626">(</span><span class="ident" id="4252627">ret</span><span class="op" id="4252630">,</span>&nbsp;<span class="op" id="4252632">[</span><span class="op" id="4252633">]</span><span class="builtintype" id="4252634">string</span><span class="op" id="4252640">{</span><span class="ident" id="4252641">n</span><span class="op" id="4252642">.</span><span class="ident" id="4252643">SerialNumber</span><span class="op" id="4252655">}</span><span class="op" id="4252656">,</span>&nbsp;<span class="ident" id="4252658">oidSerialNumber</span><span class="op" id="4252673">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4252676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4252680">return</span>&nbsp;<span class="ident" id="4252687">ret</span><br>
<span class="lineno"></span><span class="op" id="4252691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="comment" id="4252694">//&nbsp;CertificateList&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4252770">//&nbsp;5280,&nbsp;section&nbsp;5.1.&nbsp;Use&nbsp;Certificate.CheckCRLSignature&nbsp;to&nbsp;verify&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4252840">//&nbsp;signature.</span><br>
<span class="lineno"></span><span class="keyword" id="4252854">type</span>&nbsp;<span class="ident" id="4252859">CertificateList</span>&nbsp;<span class="keyword" id="4252875">struct</span>&nbsp;<span class="op" id="4252882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4252885">TBSCertList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252904">TBSCertificateList</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4252924">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4252943">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4252964">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252983">asn1</span><span class="op" id="4252987">.</span><span class="ident" id="4252988">BitString</span><br>
<span class="lineno"></span><span class="op" id="4252998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4253001">//&nbsp;HasExpired&nbsp;reports&nbsp;whether&nbsp;now&nbsp;is&nbsp;past&nbsp;the&nbsp;expiry&nbsp;time&nbsp;of&nbsp;certList.</span><br>
<span class="lineno">155</span><span class="keyword" id="4253072">func</span>&nbsp;<span class="op" id="4253077">(</span><span class="ident" id="4253078">certList</span>&nbsp;<span class="op" id="4253087">*</span><span class="ident" id="4253088">CertificateList</span><span class="op" id="4253103">)</span>&nbsp;<span class="ident" id="4253105">HasExpired</span><span class="op" id="4253115">(</span><span class="ident" id="4253116">now</span>&nbsp;<span class="ident" id="4253120">time</span><span class="op" id="4253124">.</span><span class="ident" id="4253125">Time</span><span class="op" id="4253129">)</span>&nbsp;<span class="builtintype" id="4253131">bool</span>&nbsp;<span class="op" id="4253136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4253139">return</span>&nbsp;<span class="ident" id="4253146">now</span><span class="op" id="4253149">.</span><span class="ident" id="4253150">After</span><span class="op" id="4253155">(</span><span class="ident" id="4253156">certList</span><span class="op" id="4253164">.</span><span class="ident" id="4253165">TBSCertList</span><span class="op" id="4253176">.</span><span class="ident" id="4253177">NextUpdate</span><span class="op" id="4253187">)</span><br>
<span class="lineno"></span><span class="op" id="4253189">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4253192">//&nbsp;TBSCertificateList&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno">160</span><span class="comment" id="4253271">//&nbsp;5280,&nbsp;section&nbsp;5.1.</span><br>
<span class="lineno"></span><span class="keyword" id="4253293">type</span>&nbsp;<span class="ident" id="4253298">TBSCertificateList</span>&nbsp;<span class="keyword" id="4253317">struct</span>&nbsp;<span class="op" id="4253324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4253327">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253347">asn1</span><span class="op" id="4253351">.</span><span class="ident" id="4253352">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4253364">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4253384">int</span>&nbsp;<span class="string" id="4253388">`asn1:&#34;optional,default:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4253417">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253437">AlgorithmIdentifier</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4253458">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253478">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4253491">ThisUpdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253511">time</span><span class="op" id="4253515">.</span><span class="ident" id="4253516">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4253522">NextUpdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253542">time</span><span class="op" id="4253546">.</span><span class="ident" id="4253547">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4253563">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4253582">RevokedCertificates</span>&nbsp;<span class="op" id="4253602">[</span><span class="op" id="4253603">]</span><span class="ident" id="4253604">RevokedCertificate</span>&nbsp;<span class="string" id="4253623">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4253642">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4253662">[</span><span class="op" id="4253663">]</span><span class="ident" id="4253664">Extension</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4253683">`asn1:&#34;tag:0,optional,explicit&#34;`</span><br>
<span class="lineno">170</span><span class="op" id="4253716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4253719">//&nbsp;RevokedCertificate&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4253798">//&nbsp;5280,&nbsp;section&nbsp;5.1.</span><br>
<span class="lineno"></span><span class="keyword" id="4253820">type</span>&nbsp;<span class="ident" id="4253825">RevokedCertificate</span>&nbsp;<span class="keyword" id="4253844">struct</span>&nbsp;<span class="op" id="4253851">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4253854">SerialNumber</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4253869">*</span><span class="ident" id="4253870">big</span><span class="op" id="4253873">.</span><span class="ident" id="4253874">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4253879">RevocationTime</span>&nbsp;<span class="ident" id="4253894">time</span><span class="op" id="4253898">.</span><span class="ident" id="4253899">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4253905">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4253920">[</span><span class="op" id="4253921">]</span><span class="ident" id="4253922">Extension</span>&nbsp;<span class="string" id="4253932">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4253950">}</span>
</div>
</body>
</html>
