<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7221046">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7221101">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7221155">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7221206">package</span>&nbsp;<span class="ident" id="7221214">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7221219">import</span>&nbsp;<span class="op" id="7221226">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7221229">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7221238">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7221247">&#34;compress/bzip2&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7221265">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7221275">_</span>&nbsp;<span class="string" id="7221277">&#34;crypto/md5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7221291">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7221306">&#34;crypto/sha1&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7221321">_</span>&nbsp;<span class="string" id="7221323">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7221340">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7221356">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7221368">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7221374">&#34;strconv&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7221385">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7221396">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7221406">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7221409">func</span>&nbsp;<span class="ident" id="7221414">TestEMSAPSS</span><span class="op" id="7221425">(</span><span class="ident" id="7221426">t</span>&nbsp;<span class="op" id="7221428">*</span><span class="ident" id="7221429"><a href="/crypto/rsa/pss_test.go.html#7221396">testing</a></span><span class="op" id="7221436">.</span><span class="ident" id="7221437">T</span><span class="op" id="7221438">)</span>&nbsp;<span class="op" id="7221440">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7221443">//&nbsp;Test&nbsp;vector&nbsp;in&nbsp;file&nbsp;pss-int.txt&nbsp;from:&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7221546">msg</span>&nbsp;<span class="op" id="7221550">:=</span>&nbsp;<span class="op" id="7221553">[</span><span class="op" id="7221554">]</span><span class="builtintype" id="7221555">byte</span><span class="op" id="7221559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7221563">0x85</span><span class="op" id="7221567">,</span>&nbsp;<span class="num" id="7221569">0x9e</span><span class="op" id="7221573">,</span>&nbsp;<span class="num" id="7221575">0xef</span><span class="op" id="7221579">,</span>&nbsp;<span class="num" id="7221581">0x2f</span><span class="op" id="7221585">,</span>&nbsp;<span class="num" id="7221587">0xd7</span><span class="op" id="7221591">,</span>&nbsp;<span class="num" id="7221593">0x8a</span><span class="op" id="7221597">,</span>&nbsp;<span class="num" id="7221599">0xca</span><span class="op" id="7221603">,</span>&nbsp;<span class="num" id="7221605">0x00</span><span class="op" id="7221609">,</span>&nbsp;<span class="num" id="7221611">0x30</span><span class="op" id="7221615">,</span>&nbsp;<span class="num" id="7221617">0x8b</span><span class="op" id="7221621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7221625">0xdc</span><span class="op" id="7221629">,</span>&nbsp;<span class="num" id="7221631">0x47</span><span class="op" id="7221635">,</span>&nbsp;<span class="num" id="7221637">0x11</span><span class="op" id="7221641">,</span>&nbsp;<span class="num" id="7221643">0x93</span><span class="op" id="7221647">,</span>&nbsp;<span class="num" id="7221649">0xbf</span><span class="op" id="7221653">,</span>&nbsp;<span class="num" id="7221655">0x55</span><span class="op" id="7221659">,</span>&nbsp;<span class="num" id="7221661">0xbf</span><span class="op" id="7221665">,</span>&nbsp;<span class="num" id="7221667">0x9d</span><span class="op" id="7221671">,</span>&nbsp;<span class="num" id="7221673">0x78</span><span class="op" id="7221677">,</span>&nbsp;<span class="num" id="7221679">0xdb</span><span class="op" id="7221683">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7221687">0x8f</span><span class="op" id="7221691">,</span>&nbsp;<span class="num" id="7221693">0x8a</span><span class="op" id="7221697">,</span>&nbsp;<span class="num" id="7221699">0x67</span><span class="op" id="7221703">,</span>&nbsp;<span class="num" id="7221705">0x2b</span><span class="op" id="7221709">,</span>&nbsp;<span class="num" id="7221711">0x48</span><span class="op" id="7221715">,</span>&nbsp;<span class="num" id="7221717">0x46</span><span class="op" id="7221721">,</span>&nbsp;<span class="num" id="7221723">0x34</span><span class="op" id="7221727">,</span>&nbsp;<span class="num" id="7221729">0xf3</span><span class="op" id="7221733">,</span>&nbsp;<span class="num" id="7221735">0xc9</span><span class="op" id="7221739">,</span>&nbsp;<span class="num" id="7221741">0xc2</span><span class="op" id="7221745">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7221749">0x6e</span><span class="op" id="7221753">,</span>&nbsp;<span class="num" id="7221755">0x64</span><span class="op" id="7221759">,</span>&nbsp;<span class="num" id="7221761">0x78</span><span class="op" id="7221765">,</span>&nbsp;<span class="num" id="7221767">0xae</span><span class="op" id="7221771">,</span>&nbsp;<span class="num" id="7221773">0x10</span><span class="op" id="7221777">,</span>&nbsp;<span class="num" id="7221779">0x26</span><span class="op" id="7221783">,</span>&nbsp;<span class="num" id="7221785">0x0f</span><span class="op" id="7221789">,</span>&nbsp;<span class="num" id="7221791">0xe0</span><span class="op" id="7221795">,</span>&nbsp;<span class="num" id="7221797">0xdd</span><span class="op" id="7221801">,</span>&nbsp;<span class="num" id="7221803">0x8c</span><span class="op" id="7221807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7221811">0x08</span><span class="op" id="7221815">,</span>&nbsp;<span class="num" id="7221817">0x2e</span><span class="op" id="7221821">,</span>&nbsp;<span class="num" id="7221823">0x53</span><span class="op" id="7221827">,</span>&nbsp;<span class="num" id="7221829">0xa5</span><span class="op" id="7221833">,</span>&nbsp;<span class="num" id="7221835">0x29</span><span class="op" id="7221839">,</span>&nbsp;<span class="num" id="7221841">0x3a</span><span class="op" id="7221845">,</span>&nbsp;<span class="num" id="7221847">0xf2</span><span class="op" id="7221851">,</span>&nbsp;<span class="num" id="7221853">0x17</span><span class="op" id="7221857">,</span>&nbsp;<span class="num" id="7221859">0x3c</span><span class="op" id="7221863">,</span>&nbsp;<span class="num" id="7221865">0xd5</span><span class="op" id="7221869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7221873">0x0c</span><span class="op" id="7221877">,</span>&nbsp;<span class="num" id="7221879">0x6d</span><span class="op" id="7221883">,</span>&nbsp;<span class="num" id="7221885">0x5d</span><span class="op" id="7221889">,</span>&nbsp;<span class="num" id="7221891">0x35</span><span class="op" id="7221895">,</span>&nbsp;<span class="num" id="7221897">0x4f</span><span class="op" id="7221901">,</span>&nbsp;<span class="num" id="7221903">0xeb</span><span class="op" id="7221907">,</span>&nbsp;<span class="num" id="7221909">0xf7</span><span class="op" id="7221913">,</span>&nbsp;<span class="num" id="7221915">0x8b</span><span class="op" id="7221919">,</span>&nbsp;<span class="num" id="7221921">0x26</span><span class="op" id="7221925">,</span>&nbsp;<span class="num" id="7221927">0x02</span><span class="op" id="7221931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7221935">0x1c</span><span class="op" id="7221939">,</span>&nbsp;<span class="num" id="7221941">0x25</span><span class="op" id="7221945">,</span>&nbsp;<span class="num" id="7221947">0xc0</span><span class="op" id="7221951">,</span>&nbsp;<span class="num" id="7221953">0x27</span><span class="op" id="7221957">,</span>&nbsp;<span class="num" id="7221959">0x12</span><span class="op" id="7221963">,</span>&nbsp;<span class="num" id="7221965">0xe7</span><span class="op" id="7221969">,</span>&nbsp;<span class="num" id="7221971">0x8c</span><span class="op" id="7221975">,</span>&nbsp;<span class="num" id="7221977">0xd4</span><span class="op" id="7221981">,</span>&nbsp;<span class="num" id="7221983">0x69</span><span class="op" id="7221987">,</span>&nbsp;<span class="num" id="7221989">0x4c</span><span class="op" id="7221993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7221997">0x9f</span><span class="op" id="7222001">,</span>&nbsp;<span class="num" id="7222003">0x46</span><span class="op" id="7222007">,</span>&nbsp;<span class="num" id="7222009">0x97</span><span class="op" id="7222013">,</span>&nbsp;<span class="num" id="7222015">0x77</span><span class="op" id="7222019">,</span>&nbsp;<span class="num" id="7222021">0xe4</span><span class="op" id="7222025">,</span>&nbsp;<span class="num" id="7222027">0x51</span><span class="op" id="7222031">,</span>&nbsp;<span class="num" id="7222033">0xe7</span><span class="op" id="7222037">,</span>&nbsp;<span class="num" id="7222039">0xf8</span><span class="op" id="7222043">,</span>&nbsp;<span class="num" id="7222045">0xe9</span><span class="op" id="7222049">,</span>&nbsp;<span class="num" id="7222051">0xe0</span><span class="op" id="7222055">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7222059">0x4c</span><span class="op" id="7222063">,</span>&nbsp;<span class="num" id="7222065">0xd3</span><span class="op" id="7222069">,</span>&nbsp;<span class="num" id="7222071">0x73</span><span class="op" id="7222075">,</span>&nbsp;<span class="num" id="7222077">0x9c</span><span class="op" id="7222081">,</span>&nbsp;<span class="num" id="7222083">0x6b</span><span class="op" id="7222087">,</span>&nbsp;<span class="num" id="7222089">0xbf</span><span class="op" id="7222093">,</span>&nbsp;<span class="num" id="7222095">0xed</span><span class="op" id="7222099">,</span>&nbsp;<span class="num" id="7222101">0xae</span><span class="op" id="7222105">,</span>&nbsp;<span class="num" id="7222107">0x48</span><span class="op" id="7222111">,</span>&nbsp;<span class="num" id="7222113">0x7f</span><span class="op" id="7222117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7222121">0xb5</span><span class="op" id="7222125">,</span>&nbsp;<span class="num" id="7222127">0x56</span><span class="op" id="7222131">,</span>&nbsp;<span class="num" id="7222133">0x44</span><span class="op" id="7222137">,</span>&nbsp;<span class="num" id="7222139">0xe9</span><span class="op" id="7222143">,</span>&nbsp;<span class="num" id="7222145">0xca</span><span class="op" id="7222149">,</span>&nbsp;<span class="num" id="7222151">0x74</span><span class="op" id="7222155">,</span>&nbsp;<span class="num" id="7222157">0xff</span><span class="op" id="7222161">,</span>&nbsp;<span class="num" id="7222163">0x77</span><span class="op" id="7222167">,</span>&nbsp;<span class="num" id="7222169">0xa5</span><span class="op" id="7222173">,</span>&nbsp;<span class="num" id="7222175">0x3c</span><span class="op" id="7222179">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7222183">0xb7</span><span class="op" id="7222187">,</span>&nbsp;<span class="num" id="7222189">0x29</span><span class="op" id="7222193">,</span>&nbsp;<span class="num" id="7222195">0x80</span><span class="op" id="7222199">,</span>&nbsp;<span class="num" id="7222201">0x2f</span><span class="op" id="7222205">,</span>&nbsp;<span class="num" id="7222207">0x6e</span><span class="op" id="7222211">,</span>&nbsp;<span class="num" id="7222213">0xd4</span><span class="op" id="7222217">,</span>&nbsp;<span class="num" id="7222219">0xa5</span><span class="op" id="7222223">,</span>&nbsp;<span class="num" id="7222225">0xff</span><span class="op" id="7222229">,</span>&nbsp;<span class="num" id="7222231">0xa8</span><span class="op" id="7222235">,</span>&nbsp;<span class="num" id="7222237">0xba</span><span class="op" id="7222241">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7222245">0x15</span><span class="op" id="7222249">,</span>&nbsp;<span class="num" id="7222251">0x98</span><span class="op" id="7222255">,</span>&nbsp;<span class="num" id="7222257">0x90</span><span class="op" id="7222261">,</span>&nbsp;<span class="num" id="7222263">0xfc</span><span class="op" id="7222267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7222270">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7222273">salt</span>&nbsp;<span class="op" id="7222278">:=</span>&nbsp;<span class="op" id="7222281">[</span><span class="op" id="7222282">]</span><span class="builtintype" id="7222283">byte</span><span class="op" id="7222287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7222291">0xe3</span><span class="op" id="7222295">,</span>&nbsp;<span class="num" id="7222297">0xb5</span><span class="op" id="7222301">,</span>&nbsp;<span class="num" id="7222303">0xd5</span><span class="op" id="7222307">,</span>&nbsp;<span class="num" id="7222309">0xd0</span><span class="op" id="7222313">,</span>&nbsp;<span class="num" id="7222315">0x02</span><span class="op" id="7222319">,</span>&nbsp;<span class="num" id="7222321">0xc1</span><span class="op" id="7222325">,</span>&nbsp;<span class="num" id="7222327">0xbc</span><span class="op" id="7222331">,</span>&nbsp;<span class="num" id="7222333">0xe5</span><span class="op" id="7222337">,</span>&nbsp;<span class="num" id="7222339">0x0c</span><span class="op" id="7222343">,</span>&nbsp;<span class="num" id="7222345">0x2b</span><span class="op" id="7222349">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7222353">0x65</span><span class="op" id="7222357">,</span>&nbsp;<span class="num" id="7222359">0xef</span><span class="op" id="7222363">,</span>&nbsp;<span class="num" id="7222365">0x88</span><span class="op" id="7222369">,</span>&nbsp;<span class="num" id="7222371">0xa1</span><span class="op" id="7222375">,</span>&nbsp;<span class="num" id="7222377">0x88</span><span class="op" id="7222381">,</span>&nbsp;<span class="num" id="7222383">0xd8</span><span class="op" id="7222387">,</span>&nbsp;<span class="num" id="7222389">0x3b</span><span class="op" id="7222393">,</span>&nbsp;<span class="num" id="7222395">0xce</span><span class="op" id="7222399">,</span>&nbsp;<span class="num" id="7222401">0x7e</span><span class="op" id="7222405">,</span>&nbsp;<span class="num" id="7222407">0x61</span><span class="op" id="7222411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7222414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7222417">expected</span>&nbsp;<span class="op" id="7222426">:=</span>&nbsp;<span class="op" id="7222429">[</span><span class="op" id="7222430">]</span><span class="builtintype" id="7222431">byte</span><span class="op" id="7222435">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7222439">0x66</span><span class="op" id="7222443">,</span>&nbsp;<span class="num" id="7222445">0xe4</span><span class="op" id="7222449">,</span>&nbsp;<span class="num" id="7222451">0x67</span><span class="op" id="7222455">,</span>&nbsp;<span class="num" id="7222457">0x2e</span><span class="op" id="7222461">,</span>&nbsp;<span class="num" id="7222463">0x83</span><span class="op" id="7222467">,</span>&nbsp;<span class="num" id="7222469">0x6a</span><span class="op" id="7222473">,</span>&nbsp;<span class="num" id="7222475">0xd1</span><span class="op" id="7222479">,</span>&nbsp;<span class="num" id="7222481">0x21</span><span class="op" id="7222485">,</span>&nbsp;<span class="num" id="7222487">0xba</span><span class="op" id="7222491">,</span>&nbsp;<span class="num" id="7222493">0x24</span><span class="op" id="7222497">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7222501">0x4b</span><span class="op" id="7222505">,</span>&nbsp;<span class="num" id="7222507">0xed</span><span class="op" id="7222511">,</span>&nbsp;<span class="num" id="7222513">0x65</span><span class="op" id="7222517">,</span>&nbsp;<span class="num" id="7222519">0x76</span><span class="op" id="7222523">,</span>&nbsp;<span class="num" id="7222525">0xb8</span><span class="op" id="7222529">,</span>&nbsp;<span class="num" id="7222531">0x67</span><span class="op" id="7222535">,</span>&nbsp;<span class="num" id="7222537">0xd9</span><span class="op" id="7222541">,</span>&nbsp;<span class="num" id="7222543">0xa4</span><span class="op" id="7222547">,</span>&nbsp;<span class="num" id="7222549">0x47</span><span class="op" id="7222553">,</span>&nbsp;<span class="num" id="7222555">0xc2</span><span class="op" id="7222559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7222563">0x8a</span><span class="op" id="7222567">,</span>&nbsp;<span class="num" id="7222569">0x6e</span><span class="op" id="7222573">,</span>&nbsp;<span class="num" id="7222575">0x66</span><span class="op" id="7222579">,</span>&nbsp;<span class="num" id="7222581">0xa5</span><span class="op" id="7222585">,</span>&nbsp;<span class="num" id="7222587">0xb8</span><span class="op" id="7222591">,</span>&nbsp;<span class="num" id="7222593">0x7d</span><span class="op" id="7222597">,</span>&nbsp;<span class="num" id="7222599">0xee</span><span class="op" id="7222603">,</span>&nbsp;<span class="num" id="7222605">0x7f</span><span class="op" id="7222609">,</span>&nbsp;<span class="num" id="7222611">0xbc</span><span class="op" id="7222615">,</span>&nbsp;<span class="num" id="7222617">0x7e</span><span class="op" id="7222621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7222625">0x65</span><span class="op" id="7222629">,</span>&nbsp;<span class="num" id="7222631">0xaf</span><span class="op" id="7222635">,</span>&nbsp;<span class="num" id="7222637">0x50</span><span class="op" id="7222641">,</span>&nbsp;<span class="num" id="7222643">0x57</span><span class="op" id="7222647">,</span>&nbsp;<span class="num" id="7222649">0xf8</span><span class="op" id="7222653">,</span>&nbsp;<span class="num" id="7222655">0x6f</span><span class="op" id="7222659">,</span>&nbsp;<span class="num" id="7222661">0xae</span><span class="op" id="7222665">,</span>&nbsp;<span class="num" id="7222667">0x89</span><span class="op" id="7222671">,</span>&nbsp;<span class="num" id="7222673">0x84</span><span class="op" id="7222677">,</span>&nbsp;<span class="num" id="7222679">0xd9</span><span class="op" id="7222683">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7222687">0xba</span><span class="op" id="7222691">,</span>&nbsp;<span class="num" id="7222693">0x7f</span><span class="op" id="7222697">,</span>&nbsp;<span class="num" id="7222699">0x96</span><span class="op" id="7222703">,</span>&nbsp;<span class="num" id="7222705">0x9a</span><span class="op" id="7222709">,</span>&nbsp;<span class="num" id="7222711">0xd6</span><span class="op" id="7222715">,</span>&nbsp;<span class="num" id="7222717">0xfe</span><span class="op" id="7222721">,</span>&nbsp;<span class="num" id="7222723">0x02</span><span class="op" id="7222727">,</span>&nbsp;<span class="num" id="7222729">0xa4</span><span class="op" id="7222733">,</span>&nbsp;<span class="num" id="7222735">0xd7</span><span class="op" id="7222739">,</span>&nbsp;<span class="num" id="7222741">0x5f</span><span class="op" id="7222745">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7222749">0x74</span><span class="op" id="7222753">,</span>&nbsp;<span class="num" id="7222755">0x45</span><span class="op" id="7222759">,</span>&nbsp;<span class="num" id="7222761">0xfe</span><span class="op" id="7222765">,</span>&nbsp;<span class="num" id="7222767">0xfd</span><span class="op" id="7222771">,</span>&nbsp;<span class="num" id="7222773">0xd8</span><span class="op" id="7222777">,</span>&nbsp;<span class="num" id="7222779">0x5b</span><span class="op" id="7222783">,</span>&nbsp;<span class="num" id="7222785">0x6d</span><span class="op" id="7222789">,</span>&nbsp;<span class="num" id="7222791">0x3a</span><span class="op" id="7222795">,</span>&nbsp;<span class="num" id="7222797">0x47</span><span class="op" id="7222801">,</span>&nbsp;<span class="num" id="7222803">0x7c</span><span class="op" id="7222807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7222811">0x28</span><span class="op" id="7222815">,</span>&nbsp;<span class="num" id="7222817">0xd2</span><span class="op" id="7222821">,</span>&nbsp;<span class="num" id="7222823">0x4b</span><span class="op" id="7222827">,</span>&nbsp;<span class="num" id="7222829">0xa1</span><span class="op" id="7222833">,</span>&nbsp;<span class="num" id="7222835">0xe3</span><span class="op" id="7222839">,</span>&nbsp;<span class="num" id="7222841">0x75</span><span class="op" id="7222845">,</span>&nbsp;<span class="num" id="7222847">0x6f</span><span class="op" id="7222851">,</span>&nbsp;<span class="num" id="7222853">0x79</span><span class="op" id="7222857">,</span>&nbsp;<span class="num" id="7222859">0x2d</span><span class="op" id="7222863">,</span>&nbsp;<span class="num" id="7222865">0xd1</span><span class="op" id="7222869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7222873">0xdc</span><span class="op" id="7222877">,</span>&nbsp;<span class="num" id="7222879">0xe8</span><span class="op" id="7222883">,</span>&nbsp;<span class="num" id="7222885">0xca</span><span class="op" id="7222889">,</span>&nbsp;<span class="num" id="7222891">0x94</span><span class="op" id="7222895">,</span>&nbsp;<span class="num" id="7222897">0x44</span><span class="op" id="7222901">,</span>&nbsp;<span class="num" id="7222903">0x0e</span><span class="op" id="7222907">,</span>&nbsp;<span class="num" id="7222909">0xcb</span><span class="op" id="7222913">,</span>&nbsp;<span class="num" id="7222915">0x52</span><span class="op" id="7222919">,</span>&nbsp;<span class="num" id="7222921">0x79</span><span class="op" id="7222925">,</span>&nbsp;<span class="num" id="7222927">0xec</span><span class="op" id="7222931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7222935">0xd3</span><span class="op" id="7222939">,</span>&nbsp;<span class="num" id="7222941">0x18</span><span class="op" id="7222945">,</span>&nbsp;<span class="num" id="7222947">0x3a</span><span class="op" id="7222951">,</span>&nbsp;<span class="num" id="7222953">0x31</span><span class="op" id="7222957">,</span>&nbsp;<span class="num" id="7222959">0x1f</span><span class="op" id="7222963">,</span>&nbsp;<span class="num" id="7222965">0xc8</span><span class="op" id="7222969">,</span>&nbsp;<span class="num" id="7222971">0x96</span><span class="op" id="7222975">,</span>&nbsp;<span class="num" id="7222977">0xda</span><span class="op" id="7222981">,</span>&nbsp;<span class="num" id="7222983">0x1c</span><span class="op" id="7222987">,</span>&nbsp;<span class="num" id="7222989">0xb3</span><span class="op" id="7222993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7222997">0x93</span><span class="op" id="7223001">,</span>&nbsp;<span class="num" id="7223003">0x11</span><span class="op" id="7223007">,</span>&nbsp;<span class="num" id="7223009">0xaf</span><span class="op" id="7223013">,</span>&nbsp;<span class="num" id="7223015">0x37</span><span class="op" id="7223019">,</span>&nbsp;<span class="num" id="7223021">0xea</span><span class="op" id="7223025">,</span>&nbsp;<span class="num" id="7223027">0x4a</span><span class="op" id="7223031">,</span>&nbsp;<span class="num" id="7223033">0x75</span><span class="op" id="7223037">,</span>&nbsp;<span class="num" id="7223039">0xe2</span><span class="op" id="7223043">,</span>&nbsp;<span class="num" id="7223045">0x4b</span><span class="op" id="7223049">,</span>&nbsp;<span class="num" id="7223051">0xdb</span><span class="op" id="7223055">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7223059">0xfd</span><span class="op" id="7223063">,</span>&nbsp;<span class="num" id="7223065">0x5c</span><span class="op" id="7223069">,</span>&nbsp;<span class="num" id="7223071">0x1d</span><span class="op" id="7223075">,</span>&nbsp;<span class="num" id="7223077">0xa0</span><span class="op" id="7223081">,</span>&nbsp;<span class="num" id="7223083">0xde</span><span class="op" id="7223087">,</span>&nbsp;<span class="num" id="7223089">0x7c</span><span class="op" id="7223093">,</span>&nbsp;<span class="num" id="7223095">0xec</span><span class="op" id="7223099">,</span>&nbsp;<span class="num" id="7223101">0xdf</span><span class="op" id="7223105">,</span>&nbsp;<span class="num" id="7223107">0x1a</span><span class="op" id="7223111">,</span>&nbsp;<span class="num" id="7223113">0x89</span><span class="op" id="7223117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7223121">0x6f</span><span class="op" id="7223125">,</span>&nbsp;<span class="num" id="7223127">0x9d</span><span class="op" id="7223131">,</span>&nbsp;<span class="num" id="7223133">0x8b</span><span class="op" id="7223137">,</span>&nbsp;<span class="num" id="7223139">0xc8</span><span class="op" id="7223143">,</span>&nbsp;<span class="num" id="7223145">0x16</span><span class="op" id="7223149">,</span>&nbsp;<span class="num" id="7223151">0xd9</span><span class="op" id="7223155">,</span>&nbsp;<span class="num" id="7223157">0x7c</span><span class="op" id="7223161">,</span>&nbsp;<span class="num" id="7223163">0xd7</span><span class="op" id="7223167">,</span>&nbsp;<span class="num" id="7223169">0xa2</span><span class="op" id="7223173">,</span>&nbsp;<span class="num" id="7223175">0xc4</span><span class="op" id="7223179">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7223183">0x3b</span><span class="op" id="7223187">,</span>&nbsp;<span class="num" id="7223189">0xad</span><span class="op" id="7223193">,</span>&nbsp;<span class="num" id="7223195">0x54</span><span class="op" id="7223199">,</span>&nbsp;<span class="num" id="7223201">0x6f</span><span class="op" id="7223205">,</span>&nbsp;<span class="num" id="7223207">0xbe</span><span class="op" id="7223211">,</span>&nbsp;<span class="num" id="7223213">0x8c</span><span class="op" id="7223217">,</span>&nbsp;<span class="num" id="7223219">0xfe</span><span class="op" id="7223223">,</span>&nbsp;<span class="num" id="7223225">0xbc</span><span class="op" id="7223229">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7223232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223236">hash</span>&nbsp;<span class="op" id="7223241">:=</span>&nbsp;<span class="ident" id="7223244"><a href="/crypto/rsa/pss_test.go.html#7221306">sha1</a></span><span class="op" id="7223248">.</span><span class="ident" id="7223249">New</span><span class="op" id="7223252">(</span><span class="op" id="7223253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223256"><a href="/crypto/rsa/pss_test.go.html#7223236">hash</a></span><span class="op" id="7223260">.</span><span class="ident" id="7223261">Write</span><span class="op" id="7223266">(</span><span class="ident" id="7223267"><a href="/crypto/rsa/pss_test.go.html#7221546">msg</a></span><span class="op" id="7223270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223273">hashed</span>&nbsp;<span class="op" id="7223280">:=</span>&nbsp;<span class="ident" id="7223283"><a href="/crypto/rsa/pss_test.go.html#7223236">hash</a></span><span class="op" id="7223287">.</span><span class="ident" id="7223288">Sum</span><span class="op" id="7223291">(</span><span class="ident" id="7223292">nil</span><span class="op" id="7223295">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223299">encoded</span><span class="op" id="7223306">,</span>&nbsp;<span class="ident" id="7223308">err</span>&nbsp;<span class="op" id="7223312">:=</span>&nbsp;<span class="ident" id="7223315"><a href="/crypto/rsa/pss.go.html#4405375">emsaPSSEncode</a></span><span class="op" id="7223328">(</span><span class="ident" id="7223329"><a href="/crypto/rsa/pss_test.go.html#7223273">hashed</a></span><span class="op" id="7223335">,</span>&nbsp;<span class="num" id="7223337">1023</span><span class="op" id="7223341">,</span>&nbsp;<span class="ident" id="7223343"><a href="/crypto/rsa/pss_test.go.html#7222273">salt</a></span><span class="op" id="7223347">,</span>&nbsp;<span class="ident" id="7223349"><a href="/crypto/rsa/pss_test.go.html#7221306">sha1</a></span><span class="op" id="7223353">.</span><span class="ident" id="7223354">New</span><span class="op" id="7223357">(</span><span class="op" id="7223358">)</span><span class="op" id="7223359">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7223362">if</span>&nbsp;<span class="ident" id="7223365"><a href="/crypto/rsa/pss_test.go.html#7223308">err</a></span>&nbsp;<span class="op" id="7223369">!=</span>&nbsp;<span class="ident" id="7223372">nil</span>&nbsp;<span class="op" id="7223376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223380"><a href="/crypto/rsa/pss_test.go.html#7221426">t</a></span><span class="op" id="7223381">.</span><span class="ident" id="7223382">Errorf</span><span class="op" id="7223388">(</span><span class="string" id="7223389">&#34;Error&nbsp;from&nbsp;emsaPSSEncode:&nbsp;%s\n&#34;</span><span class="op" id="7223421">,</span>&nbsp;<span class="ident" id="7223423"><a href="/crypto/rsa/pss_test.go.html#7223308">err</a></span><span class="op" id="7223426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7223429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7223432">if</span>&nbsp;<span class="op" id="7223435">!</span><span class="ident" id="7223436"><a href="/crypto/rsa/pss_test.go.html#7221238">bytes</a></span><span class="op" id="7223441">.</span><span class="ident" id="7223442">Equal</span><span class="op" id="7223447">(</span><span class="ident" id="7223448"><a href="/crypto/rsa/pss_test.go.html#7223299">encoded</a></span><span class="op" id="7223455">,</span>&nbsp;<span class="ident" id="7223457"><a href="/crypto/rsa/pss_test.go.html#7222417">expected</a></span><span class="op" id="7223465">)</span>&nbsp;<span class="op" id="7223467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223471"><a href="/crypto/rsa/pss_test.go.html#7221426">t</a></span><span class="op" id="7223472">.</span><span class="ident" id="7223473">Errorf</span><span class="op" id="7223479">(</span><span class="string" id="7223480">&#34;Bad&nbsp;encoding.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="7223511">,</span>&nbsp;<span class="ident" id="7223513"><a href="/crypto/rsa/pss_test.go.html#7223299">encoded</a></span><span class="op" id="7223520">,</span>&nbsp;<span class="ident" id="7223522"><a href="/crypto/rsa/pss_test.go.html#7222417">expected</a></span><span class="op" id="7223530">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7223533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7223537">if</span>&nbsp;<span class="ident" id="7223540"><a href="/crypto/rsa/pss_test.go.html#7223308">err</a></span>&nbsp;<span class="op" id="7223544">=</span>&nbsp;<span class="ident" id="7223546"><a href="/crypto/rsa/pss.go.html#4407275">emsaPSSVerify</a></span><span class="op" id="7223559">(</span><span class="ident" id="7223560"><a href="/crypto/rsa/pss_test.go.html#7223273">hashed</a></span><span class="op" id="7223566">,</span>&nbsp;<span class="ident" id="7223568"><a href="/crypto/rsa/pss_test.go.html#7223299">encoded</a></span><span class="op" id="7223575">,</span>&nbsp;<span class="num" id="7223577">1023</span><span class="op" id="7223581">,</span>&nbsp;<span class="builtinfunc" id="7223583">len</span><span class="op" id="7223586">(</span><span class="ident" id="7223587"><a href="/crypto/rsa/pss_test.go.html#7222273">salt</a></span><span class="op" id="7223591">)</span><span class="op" id="7223592">,</span>&nbsp;<span class="ident" id="7223594"><a href="/crypto/rsa/pss_test.go.html#7221306">sha1</a></span><span class="op" id="7223598">.</span><span class="ident" id="7223599">New</span><span class="op" id="7223602">(</span><span class="op" id="7223603">)</span><span class="op" id="7223604">)</span><span class="op" id="7223605">;</span>&nbsp;<span class="ident" id="7223607"><a href="/crypto/rsa/pss_test.go.html#7223308">err</a></span>&nbsp;<span class="op" id="7223611">!=</span>&nbsp;<span class="ident" id="7223614">nil</span>&nbsp;<span class="op" id="7223618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223622"><a href="/crypto/rsa/pss_test.go.html#7221426">t</a></span><span class="op" id="7223623">.</span><span class="ident" id="7223624">Errorf</span><span class="op" id="7223630">(</span><span class="string" id="7223631">&#34;Bad&nbsp;verification:&nbsp;%s&#34;</span><span class="op" id="7223653">,</span>&nbsp;<span class="ident" id="7223655"><a href="/crypto/rsa/pss_test.go.html#7223308">err</a></span><span class="op" id="7223658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7223661">}</span><br>
<span class="lineno">75</span><span class="op" id="7223663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7223666">//&nbsp;TestPSSGolden&nbsp;tests&nbsp;all&nbsp;the&nbsp;test&nbsp;vectors&nbsp;in&nbsp;pss-vect.txt&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="7223731">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span><span class="keyword" id="7223795">func</span>&nbsp;<span class="ident" id="7223800">TestPSSGolden</span><span class="op" id="7223813">(</span><span class="ident" id="7223814">t</span>&nbsp;<span class="op" id="7223816">*</span><span class="ident" id="7223817"><a href="/crypto/rsa/pss_test.go.html#7221396">testing</a></span><span class="op" id="7223824">.</span><span class="ident" id="7223825">T</span><span class="op" id="7223826">)</span>&nbsp;<span class="op" id="7223828">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223831">inFile</span><span class="op" id="7223837">,</span>&nbsp;<span class="ident" id="7223839">err</span>&nbsp;<span class="op" id="7223843">:=</span>&nbsp;<span class="ident" id="7223846"><a href="/crypto/rsa/pss_test.go.html#7221368">os</a></span><span class="op" id="7223848">.</span><span class="ident" id="7223849">Open</span><span class="op" id="7223853">(</span><span class="string" id="7223854">&#34;testdata/pss-vect.txt.bz2&#34;</span><span class="op" id="7223881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7223884">if</span>&nbsp;<span class="ident" id="7223887"><a href="/crypto/rsa/pss_test.go.html#7223839">err</a></span>&nbsp;<span class="op" id="7223891">!=</span>&nbsp;<span class="ident" id="7223894">nil</span>&nbsp;<span class="op" id="7223898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7223902"><a href="/crypto/rsa/pss_test.go.html#7223814">t</a></span><span class="op" id="7223903">.</span><span class="ident" id="7223904">Fatalf</span><span class="op" id="7223910">(</span><span class="string" id="7223911">&#34;Failed&nbsp;to&nbsp;open&nbsp;input&nbsp;file:&nbsp;%s&#34;</span><span class="op" id="7223942">,</span>&nbsp;<span class="ident" id="7223944"><a href="/crypto/rsa/pss_test.go.html#7223839">err</a></span><span class="op" id="7223947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7223950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7223953">defer</span>&nbsp;<span class="ident" id="7223959"><a href="/crypto/rsa/pss_test.go.html#7223831">inFile</a></span><span class="op" id="7223965">.</span><span class="ident" id="7223966">Close</span><span class="op" id="7223971">(</span><span class="op" id="7223972">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7223976">//&nbsp;The&nbsp;pss-vect.txt&nbsp;file&nbsp;contains&nbsp;RSA&nbsp;keys&nbsp;and&nbsp;then&nbsp;a&nbsp;series&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7224041">//&nbsp;signatures.&nbsp;A&nbsp;goroutine&nbsp;is&nbsp;used&nbsp;to&nbsp;preprocess&nbsp;the&nbsp;input&nbsp;by&nbsp;merging</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7224112">//&nbsp;lines,&nbsp;removing&nbsp;spaces&nbsp;in&nbsp;hex&nbsp;values&nbsp;and&nbsp;identifying&nbsp;the&nbsp;start&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7224182">//&nbsp;new&nbsp;keys&nbsp;and&nbsp;signature&nbsp;blocks.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7224217">const</span>&nbsp;<span class="ident" id="7224223">newKeyMarker</span>&nbsp;<span class="op" id="7224236">=</span>&nbsp;<span class="string" id="7224238">&#34;START&nbsp;NEW&nbsp;KEY&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7224255">const</span>&nbsp;<span class="ident" id="7224261">newSignatureMarker</span>&nbsp;<span class="op" id="7224280">=</span>&nbsp;<span class="string" id="7224282">&#34;START&nbsp;NEW&nbsp;SIGNATURE&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224306">values</span>&nbsp;<span class="op" id="7224313">:=</span>&nbsp;<span class="builtinfunc" id="7224316">make</span><span class="op" id="7224320">(</span><span class="keyword" id="7224321">chan</span>&nbsp;<span class="builtintype" id="7224326">string</span><span class="op" id="7224332">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7224336">go</span>&nbsp;<span class="keyword" id="7224339">func</span><span class="op" id="7224343">(</span><span class="op" id="7224344">)</span>&nbsp;<span class="op" id="7224346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7224350">defer</span>&nbsp;<span class="builtinfunc" id="7224356">close</span><span class="op" id="7224361">(</span><span class="ident" id="7224362"><a href="/crypto/rsa/pss_test.go.html#7224306">values</a></span><span class="op" id="7224368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224372">scanner</span>&nbsp;<span class="op" id="7224380">:=</span>&nbsp;<span class="ident" id="7224383"><a href="/crypto/rsa/pss_test.go.html#7221229">bufio</a></span><span class="op" id="7224388">.</span><span class="ident" id="7224389">NewScanner</span><span class="op" id="7224399">(</span><span class="ident" id="7224400"><a href="/crypto/rsa/pss_test.go.html#7221247">bzip2</a></span><span class="op" id="7224405">.</span><span class="ident" id="7224406">NewReader</span><span class="op" id="7224415">(</span><span class="ident" id="7224416"><a href="/crypto/rsa/pss_test.go.html#7223831">inFile</a></span><span class="op" id="7224422">)</span><span class="op" id="7224423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7224427">var</span>&nbsp;<span class="ident" id="7224431">partialValue</span>&nbsp;<span class="builtintype" id="7224444">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224453">lastWasValue</span>&nbsp;<span class="op" id="7224466">:=</span>&nbsp;<span class="ident" id="7224469">true</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7224477">for</span>&nbsp;<span class="ident" id="7224481"><a href="/crypto/rsa/pss_test.go.html#7224372">scanner</a></span><span class="op" id="7224488">.</span><span class="ident" id="7224489">Scan</span><span class="op" id="7224493">(</span><span class="op" id="7224494">)</span>&nbsp;<span class="op" id="7224496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224501">line</span>&nbsp;<span class="op" id="7224506">:=</span>&nbsp;<span class="ident" id="7224509"><a href="/crypto/rsa/pss_test.go.html#7224372">scanner</a></span><span class="op" id="7224516">.</span><span class="ident" id="7224517">Text</span><span class="op" id="7224521">(</span><span class="op" id="7224522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7224527">switch</span>&nbsp;<span class="op" id="7224534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7224539">case</span>&nbsp;<span class="builtinfunc" id="7224544">len</span><span class="op" id="7224547">(</span><span class="ident" id="7224548"><a href="/crypto/rsa/pss_test.go.html#7224501">line</a></span><span class="op" id="7224552">)</span>&nbsp;<span class="op" id="7224554">==</span>&nbsp;<span class="num" id="7224557">0</span><span class="op" id="7224558">:</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7224564">if</span>&nbsp;<span class="builtinfunc" id="7224567">len</span><span class="op" id="7224570">(</span><span class="ident" id="7224571"><a href="/crypto/rsa/pss_test.go.html#7224431">partialValue</a></span><span class="op" id="7224583">)</span>&nbsp;<span class="op" id="7224585">&gt;</span>&nbsp;<span class="num" id="7224587">0</span>&nbsp;<span class="op" id="7224589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224596"><a href="/crypto/rsa/pss_test.go.html#7224306">values</a></span>&nbsp;<span class="op" id="7224603">&lt;-</span>&nbsp;<span class="ident" id="7224606"><a href="/crypto/rsa/pss_test.go.html#7221385">strings</a></span><span class="op" id="7224613">.</span><span class="ident" id="7224614">Replace</span><span class="op" id="7224621">(</span><span class="ident" id="7224622"><a href="/crypto/rsa/pss_test.go.html#7224431">partialValue</a></span><span class="op" id="7224634">,</span>&nbsp;<span class="string" id="7224636">&#34;&nbsp;&#34;</span><span class="op" id="7224639">,</span>&nbsp;<span class="string" id="7224641">&#34;&#34;</span><span class="op" id="7224643">,</span>&nbsp;<span class="op" id="7224645">-</span><span class="num" id="7224646">1</span><span class="op" id="7224647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224654"><a href="/crypto/rsa/pss_test.go.html#7224431">partialValue</a></span>&nbsp;<span class="op" id="7224667">=</span>&nbsp;<span class="string" id="7224669">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224677"><a href="/crypto/rsa/pss_test.go.html#7224453">lastWasValue</a></span>&nbsp;<span class="op" id="7224690">=</span>&nbsp;<span class="ident" id="7224692">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7224701">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7224707">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7224719">case</span>&nbsp;<span class="ident" id="7224724"><a href="/crypto/rsa/pss_test.go.html#7221385">strings</a></span><span class="op" id="7224731">.</span><span class="ident" id="7224732">HasPrefix</span><span class="op" id="7224741">(</span><span class="ident" id="7224742"><a href="/crypto/rsa/pss_test.go.html#7224501">line</a></span><span class="op" id="7224746">,</span>&nbsp;<span class="string" id="7224748">&#34;#&nbsp;======&#34;</span><span class="op" id="7224758">)</span>&nbsp;<span class="op" id="7224760">&amp;&amp;</span>&nbsp;<span class="ident" id="7224763"><a href="/crypto/rsa/pss_test.go.html#7224453">lastWasValue</a></span><span class="op" id="7224775">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224781"><a href="/crypto/rsa/pss_test.go.html#7224306">values</a></span>&nbsp;<span class="op" id="7224788">&lt;-</span>&nbsp;<span class="ident" id="7224791"><a href="/crypto/rsa/pss_test.go.html#7224223">newKeyMarker</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224808"><a href="/crypto/rsa/pss_test.go.html#7224453">lastWasValue</a></span>&nbsp;<span class="op" id="7224821">=</span>&nbsp;<span class="ident" id="7224823">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7224832">case</span>&nbsp;<span class="ident" id="7224837"><a href="/crypto/rsa/pss_test.go.html#7221385">strings</a></span><span class="op" id="7224844">.</span><span class="ident" id="7224845">HasPrefix</span><span class="op" id="7224854">(</span><span class="ident" id="7224855"><a href="/crypto/rsa/pss_test.go.html#7224501">line</a></span><span class="op" id="7224859">,</span>&nbsp;<span class="string" id="7224861">&#34;#&nbsp;------&#34;</span><span class="op" id="7224871">)</span>&nbsp;<span class="op" id="7224873">&amp;&amp;</span>&nbsp;<span class="ident" id="7224876"><a href="/crypto/rsa/pss_test.go.html#7224453">lastWasValue</a></span><span class="op" id="7224888">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224894"><a href="/crypto/rsa/pss_test.go.html#7224306">values</a></span>&nbsp;<span class="op" id="7224901">&lt;-</span>&nbsp;<span class="ident" id="7224904"><a href="/crypto/rsa/pss_test.go.html#7224261">newSignatureMarker</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7224927"><a href="/crypto/rsa/pss_test.go.html#7224453">lastWasValue</a></span>&nbsp;<span class="op" id="7224940">=</span>&nbsp;<span class="ident" id="7224942">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7224951">case</span>&nbsp;<span class="ident" id="7224956"><a href="/crypto/rsa/pss_test.go.html#7221385">strings</a></span><span class="op" id="7224963">.</span><span class="ident" id="7224964">HasPrefix</span><span class="op" id="7224973">(</span><span class="ident" id="7224974"><a href="/crypto/rsa/pss_test.go.html#7224501">line</a></span><span class="op" id="7224978">,</span>&nbsp;<span class="string" id="7224980">&#34;#&#34;</span><span class="op" id="7224983">)</span><span class="op" id="7224984">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7224990">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7225002">default</span><span class="op" id="7225009">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225015"><a href="/crypto/rsa/pss_test.go.html#7224431">partialValue</a></span>&nbsp;<span class="op" id="7225028">+=</span>&nbsp;<span class="ident" id="7225031"><a href="/crypto/rsa/pss_test.go.html#7224501">line</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7225039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7225043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7225047">if</span>&nbsp;<span class="ident" id="7225050">err</span>&nbsp;<span class="op" id="7225054">:=</span>&nbsp;<span class="ident" id="7225057"><a href="/crypto/rsa/pss_test.go.html#7224372">scanner</a></span><span class="op" id="7225064">.</span><span class="ident" id="7225065">Err</span><span class="op" id="7225068">(</span><span class="op" id="7225069">)</span><span class="op" id="7225070">;</span>&nbsp;<span class="ident" id="7225072"><a href="/crypto/rsa/pss_test.go.html#7225050">err</a></span>&nbsp;<span class="op" id="7225076">!=</span>&nbsp;<span class="ident" id="7225079">nil</span>&nbsp;<span class="op" id="7225083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7225088">panic</span><span class="op" id="7225093">(</span><span class="ident" id="7225094"><a href="/crypto/rsa/pss_test.go.html#7225050">err</a></span><span class="op" id="7225097">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7225101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7225104">}</span><span class="op" id="7225105">(</span><span class="op" id="7225106">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7225110">var</span>&nbsp;<span class="ident" id="7225114">key</span>&nbsp;<span class="op" id="7225118">*</span><span class="ident" id="7225119"><a href="/crypto/rsa/rsa.go.html#4413952">PublicKey</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7225130">var</span>&nbsp;<span class="ident" id="7225134">hashed</span>&nbsp;<span class="op" id="7225141">[</span><span class="op" id="7225142">]</span><span class="builtintype" id="7225143">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225149">hash</span>&nbsp;<span class="op" id="7225154">:=</span>&nbsp;<span class="ident" id="7225157"><a href="/crypto/rsa/pss_test.go.html#7221265">crypto</a></span><span class="op" id="7225163">.</span><span class="ident" id="7225164">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225170">h</span>&nbsp;<span class="op" id="7225172">:=</span>&nbsp;<span class="ident" id="7225175"><a href="/crypto/rsa/pss_test.go.html#7225149">hash</a></span><span class="op" id="7225179">.</span><span class="ident" id="7225180">New</span><span class="op" id="7225183">(</span><span class="op" id="7225184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225187">opts</span>&nbsp;<span class="op" id="7225192">:=</span>&nbsp;<span class="op" id="7225195">&amp;</span><span class="ident" id="7225196"><a href="/crypto/rsa/pss.go.html#4411008">PSSOptions</a></span><span class="op" id="7225206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225210">SaltLength</span><span class="op" id="7225220">:</span>&nbsp;<span class="ident" id="7225222"><a href="/crypto/rsa/pss.go.html#4410897">PSSSaltLengthEqualsHash</a></span><span class="op" id="7225245">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7225248">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7225252">for</span>&nbsp;<span class="ident" id="7225256">marker</span>&nbsp;<span class="op" id="7225263">:=</span>&nbsp;<span class="keyword" id="7225266">range</span>&nbsp;<span class="ident" id="7225272"><a href="/crypto/rsa/pss_test.go.html#7224306">values</a></span>&nbsp;<span class="op" id="7225279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7225283">switch</span>&nbsp;<span class="ident" id="7225290"><a href="/crypto/rsa/pss_test.go.html#7225256">marker</a></span>&nbsp;<span class="op" id="7225297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7225301">case</span>&nbsp;<span class="ident" id="7225306"><a href="/crypto/rsa/pss_test.go.html#7224223">newKeyMarker</a></span><span class="op" id="7225318">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225323"><a href="/crypto/rsa/pss_test.go.html#7225114">key</a></span>&nbsp;<span class="op" id="7225327">=</span>&nbsp;<span class="builtinfunc" id="7225329">new</span><span class="op" id="7225332">(</span><span class="ident" id="7225333"><a href="/crypto/rsa/rsa.go.html#4413952">PublicKey</a></span><span class="op" id="7225342">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225347">nHex</span><span class="op" id="7225351">,</span>&nbsp;<span class="ident" id="7225353">ok</span>&nbsp;<span class="op" id="7225356">:=</span>&nbsp;<span class="op" id="7225359">&lt;-</span><span class="ident" id="7225361"><a href="/crypto/rsa/pss_test.go.html#7224306">values</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7225371">if</span>&nbsp;<span class="op" id="7225374">!</span><span class="ident" id="7225375"><a href="/crypto/rsa/pss_test.go.html#7225353">ok</a></span>&nbsp;<span class="op" id="7225378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7225384">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7225396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225401"><a href="/crypto/rsa/pss_test.go.html#7225114">key</a></span><span class="op" id="7225404">.</span><span class="ident" id="7225405">N</span>&nbsp;<span class="op" id="7225407">=</span>&nbsp;<span class="ident" id="7225409"><a href="/crypto/rsa/pss_test.go.html#7227801">bigFromHex</a></span><span class="op" id="7225419">(</span><span class="ident" id="7225420"><a href="/crypto/rsa/pss_test.go.html#7225347">nHex</a></span><span class="op" id="7225424">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225429"><a href="/crypto/rsa/pss_test.go.html#7225114">key</a></span><span class="op" id="7225432">.</span><span class="ident" id="7225433">E</span>&nbsp;<span class="op" id="7225435">=</span>&nbsp;<span class="ident" id="7225437"><a href="/crypto/rsa/pss_test.go.html#7227935">intFromHex</a></span><span class="op" id="7225447">(</span><span class="op" id="7225448">&lt;-</span><span class="ident" id="7225450"><a href="/crypto/rsa/pss_test.go.html#7224306">values</a></span><span class="op" id="7225456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7225461">//&nbsp;We&nbsp;don&#39;t&nbsp;care&nbsp;for&nbsp;d,&nbsp;p,&nbsp;q,&nbsp;dP,&nbsp;dQ&nbsp;or&nbsp;qInv.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7225510">for</span>&nbsp;<span class="ident" id="7225514">i</span>&nbsp;<span class="op" id="7225516">:=</span>&nbsp;<span class="num" id="7225519">0</span><span class="op" id="7225520">;</span>&nbsp;<span class="ident" id="7225522"><a href="/crypto/rsa/pss_test.go.html#7225514">i</a></span>&nbsp;<span class="op" id="7225524">&lt;</span>&nbsp;<span class="num" id="7225526">6</span><span class="op" id="7225527">;</span>&nbsp;<span class="ident" id="7225529"><a href="/crypto/rsa/pss_test.go.html#7225514">i</a></span><span class="op" id="7225530">++</span>&nbsp;<span class="op" id="7225533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7225539">&lt;-</span><span class="ident" id="7225541"><a href="/crypto/rsa/pss_test.go.html#7224306">values</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7225551">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7225555">case</span>&nbsp;<span class="ident" id="7225560"><a href="/crypto/rsa/pss_test.go.html#7224261">newSignatureMarker</a></span><span class="op" id="7225578">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225583">msg</span>&nbsp;<span class="op" id="7225587">:=</span>&nbsp;<span class="ident" id="7225590"><a href="/crypto/rsa/pss_test.go.html#7228061">fromHex</a></span><span class="op" id="7225597">(</span><span class="op" id="7225598">&lt;-</span><span class="ident" id="7225600"><a href="/crypto/rsa/pss_test.go.html#7224306">values</a></span><span class="op" id="7225606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7225611">&lt;-</span><span class="ident" id="7225613"><a href="/crypto/rsa/pss_test.go.html#7224306">values</a></span>&nbsp;<span class="comment" id="7225620">//&nbsp;skip&nbsp;salt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225636">sig</span>&nbsp;<span class="op" id="7225640">:=</span>&nbsp;<span class="ident" id="7225643"><a href="/crypto/rsa/pss_test.go.html#7228061">fromHex</a></span><span class="op" id="7225650">(</span><span class="op" id="7225651">&lt;-</span><span class="ident" id="7225653"><a href="/crypto/rsa/pss_test.go.html#7224306">values</a></span><span class="op" id="7225659">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225665"><a href="/crypto/rsa/pss_test.go.html#7225170">h</a></span><span class="op" id="7225666">.</span><span class="ident" id="7225667">Reset</span><span class="op" id="7225672">(</span><span class="op" id="7225673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225678"><a href="/crypto/rsa/pss_test.go.html#7225170">h</a></span><span class="op" id="7225679">.</span><span class="ident" id="7225680">Write</span><span class="op" id="7225685">(</span><span class="ident" id="7225686"><a href="/crypto/rsa/pss_test.go.html#7225583">msg</a></span><span class="op" id="7225689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225694"><a href="/crypto/rsa/pss_test.go.html#7225134">hashed</a></span>&nbsp;<span class="op" id="7225701">=</span>&nbsp;<span class="ident" id="7225703"><a href="/crypto/rsa/pss_test.go.html#7225170">h</a></span><span class="op" id="7225704">.</span><span class="ident" id="7225705">Sum</span><span class="op" id="7225708">(</span><span class="ident" id="7225709"><a href="/crypto/rsa/pss_test.go.html#7225134">hashed</a></span><span class="op" id="7225715">[</span><span class="op" id="7225716">:</span><span class="num" id="7225717">0</span><span class="op" id="7225718">]</span><span class="op" id="7225719">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7225725">if</span>&nbsp;<span class="ident" id="7225728">err</span>&nbsp;<span class="op" id="7225732">:=</span>&nbsp;<span class="ident" id="7225735"><a href="/crypto/rsa/pss.go.html#4412732">VerifyPSS</a></span><span class="op" id="7225744">(</span><span class="ident" id="7225745"><a href="/crypto/rsa/pss_test.go.html#7225114">key</a></span><span class="op" id="7225748">,</span>&nbsp;<span class="ident" id="7225750"><a href="/crypto/rsa/pss_test.go.html#7225149">hash</a></span><span class="op" id="7225754">,</span>&nbsp;<span class="ident" id="7225756"><a href="/crypto/rsa/pss_test.go.html#7225134">hashed</a></span><span class="op" id="7225762">,</span>&nbsp;<span class="ident" id="7225764"><a href="/crypto/rsa/pss_test.go.html#7225636">sig</a></span><span class="op" id="7225767">,</span>&nbsp;<span class="ident" id="7225769"><a href="/crypto/rsa/pss_test.go.html#7225187">opts</a></span><span class="op" id="7225773">)</span><span class="op" id="7225774">;</span>&nbsp;<span class="ident" id="7225776"><a href="/crypto/rsa/pss_test.go.html#7225728">err</a></span>&nbsp;<span class="op" id="7225780">!=</span>&nbsp;<span class="ident" id="7225783">nil</span>&nbsp;<span class="op" id="7225787">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225793"><a href="/crypto/rsa/pss_test.go.html#7223814">t</a></span><span class="op" id="7225794">.</span><span class="ident" id="7225795">Error</span><span class="op" id="7225800">(</span><span class="ident" id="7225801"><a href="/crypto/rsa/pss_test.go.html#7225728">err</a></span><span class="op" id="7225804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7225809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7225813">default</span><span class="op" id="7225820">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7225825"><a href="/crypto/rsa/pss_test.go.html#7223814">t</a></span><span class="op" id="7225826">.</span><span class="ident" id="7225827">Fatalf</span><span class="op" id="7225833">(</span><span class="string" id="7225834">&#34;unknown&nbsp;marker:&nbsp;&#34;</span>&nbsp;<span class="op" id="7225853">+</span>&nbsp;<span class="ident" id="7225855"><a href="/crypto/rsa/pss_test.go.html#7225256">marker</a></span><span class="op" id="7225861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7225865">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7225868">}</span><br>
<span class="lineno"></span><span class="op" id="7225870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7225873">//&nbsp;TestPSSOpenSSL&nbsp;ensures&nbsp;that&nbsp;we&nbsp;can&nbsp;verify&nbsp;a&nbsp;PSS&nbsp;signature&nbsp;from&nbsp;OpenSSL&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="7225952">//&nbsp;the&nbsp;default&nbsp;options.&nbsp;OpenSSL&nbsp;sets&nbsp;the&nbsp;salt&nbsp;length&nbsp;to&nbsp;be&nbsp;maximal.</span><br>
<span class="lineno">170</span><span class="keyword" id="7226020">func</span>&nbsp;<span class="ident" id="7226025">TestPSSOpenSSL</span><span class="op" id="7226039">(</span><span class="ident" id="7226040">t</span>&nbsp;<span class="op" id="7226042">*</span><span class="ident" id="7226043"><a href="/crypto/rsa/pss_test.go.html#7221396">testing</a></span><span class="op" id="7226050">.</span><span class="ident" id="7226051">T</span><span class="op" id="7226052">)</span>&nbsp;<span class="op" id="7226054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226057">hash</span>&nbsp;<span class="op" id="7226062">:=</span>&nbsp;<span class="ident" id="7226065"><a href="/crypto/rsa/pss_test.go.html#7221265">crypto</a></span><span class="op" id="7226071">.</span><span class="ident" id="7226072">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226080">h</span>&nbsp;<span class="op" id="7226082">:=</span>&nbsp;<span class="ident" id="7226085"><a href="/crypto/rsa/pss_test.go.html#7226057">hash</a></span><span class="op" id="7226089">.</span><span class="ident" id="7226090">New</span><span class="op" id="7226093">(</span><span class="op" id="7226094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226097"><a href="/crypto/rsa/pss_test.go.html#7226080">h</a></span><span class="op" id="7226098">.</span><span class="ident" id="7226099">Write</span><span class="op" id="7226104">(</span><span class="op" id="7226105">[</span><span class="op" id="7226106">]</span><span class="builtintype" id="7226107">byte</span><span class="op" id="7226111">(</span><span class="string" id="7226112">&#34;testing&#34;</span><span class="op" id="7226121">)</span><span class="op" id="7226122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226125">hashed</span>&nbsp;<span class="op" id="7226132">:=</span>&nbsp;<span class="ident" id="7226135"><a href="/crypto/rsa/pss_test.go.html#7226080">h</a></span><span class="op" id="7226136">.</span><span class="ident" id="7226137">Sum</span><span class="op" id="7226140">(</span><span class="ident" id="7226141">nil</span><span class="op" id="7226144">)</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7226148">//&nbsp;Generated&nbsp;with&nbsp;`echo&nbsp;-n&nbsp;testing&nbsp;|&nbsp;openssl&nbsp;dgst&nbsp;-sign&nbsp;key.pem&nbsp;-sigopt&nbsp;rsa_padding_mode:pss&nbsp;-sha256&nbsp;&gt;&nbsp;sig`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226257">sig</span>&nbsp;<span class="op" id="7226261">:=</span>&nbsp;<span class="op" id="7226264">[</span><span class="op" id="7226265">]</span><span class="builtintype" id="7226266">byte</span><span class="op" id="7226270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7226274">0x95</span><span class="op" id="7226278">,</span>&nbsp;<span class="num" id="7226280">0x59</span><span class="op" id="7226284">,</span>&nbsp;<span class="num" id="7226286">0x6f</span><span class="op" id="7226290">,</span>&nbsp;<span class="num" id="7226292">0xd3</span><span class="op" id="7226296">,</span>&nbsp;<span class="num" id="7226298">0x10</span><span class="op" id="7226302">,</span>&nbsp;<span class="num" id="7226304">0xa2</span><span class="op" id="7226308">,</span>&nbsp;<span class="num" id="7226310">0xe7</span><span class="op" id="7226314">,</span>&nbsp;<span class="num" id="7226316">0xa2</span><span class="op" id="7226320">,</span>&nbsp;<span class="num" id="7226322">0x92</span><span class="op" id="7226326">,</span>&nbsp;<span class="num" id="7226328">0x9d</span><span class="op" id="7226332">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7226336">0x4a</span><span class="op" id="7226340">,</span>&nbsp;<span class="num" id="7226342">0x07</span><span class="op" id="7226346">,</span>&nbsp;<span class="num" id="7226348">0x2e</span><span class="op" id="7226352">,</span>&nbsp;<span class="num" id="7226354">0x2b</span><span class="op" id="7226358">,</span>&nbsp;<span class="num" id="7226360">0x27</span><span class="op" id="7226364">,</span>&nbsp;<span class="num" id="7226366">0xcc</span><span class="op" id="7226370">,</span>&nbsp;<span class="num" id="7226372">0x06</span><span class="op" id="7226376">,</span>&nbsp;<span class="num" id="7226378">0xc2</span><span class="op" id="7226382">,</span>&nbsp;<span class="num" id="7226384">0x87</span><span class="op" id="7226388">,</span>&nbsp;<span class="num" id="7226390">0x2c</span><span class="op" id="7226394">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7226398">0x52</span><span class="op" id="7226402">,</span>&nbsp;<span class="num" id="7226404">0xf0</span><span class="op" id="7226408">,</span>&nbsp;<span class="num" id="7226410">0x4a</span><span class="op" id="7226414">,</span>&nbsp;<span class="num" id="7226416">0xcc</span><span class="op" id="7226420">,</span>&nbsp;<span class="num" id="7226422">0x05</span><span class="op" id="7226426">,</span>&nbsp;<span class="num" id="7226428">0x94</span><span class="op" id="7226432">,</span>&nbsp;<span class="num" id="7226434">0xf2</span><span class="op" id="7226438">,</span>&nbsp;<span class="num" id="7226440">0xc3</span><span class="op" id="7226444">,</span>&nbsp;<span class="num" id="7226446">0x2e</span><span class="op" id="7226450">,</span>&nbsp;<span class="num" id="7226452">0x20</span><span class="op" id="7226456">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7226460">0xd7</span><span class="op" id="7226464">,</span>&nbsp;<span class="num" id="7226466">0x3e</span><span class="op" id="7226470">,</span>&nbsp;<span class="num" id="7226472">0x66</span><span class="op" id="7226476">,</span>&nbsp;<span class="num" id="7226478">0x62</span><span class="op" id="7226482">,</span>&nbsp;<span class="num" id="7226484">0xb5</span><span class="op" id="7226488">,</span>&nbsp;<span class="num" id="7226490">0x95</span><span class="op" id="7226494">,</span>&nbsp;<span class="num" id="7226496">0x2b</span><span class="op" id="7226500">,</span>&nbsp;<span class="num" id="7226502">0xa3</span><span class="op" id="7226506">,</span>&nbsp;<span class="num" id="7226508">0x93</span><span class="op" id="7226512">,</span>&nbsp;<span class="num" id="7226514">0x9a</span><span class="op" id="7226518">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7226522">0x66</span><span class="op" id="7226526">,</span>&nbsp;<span class="num" id="7226528">0x64</span><span class="op" id="7226532">,</span>&nbsp;<span class="num" id="7226534">0x25</span><span class="op" id="7226538">,</span>&nbsp;<span class="num" id="7226540">0xe0</span><span class="op" id="7226544">,</span>&nbsp;<span class="num" id="7226546">0x74</span><span class="op" id="7226550">,</span>&nbsp;<span class="num" id="7226552">0x66</span><span class="op" id="7226556">,</span>&nbsp;<span class="num" id="7226558">0x8c</span><span class="op" id="7226562">,</span>&nbsp;<span class="num" id="7226564">0x3e</span><span class="op" id="7226568">,</span>&nbsp;<span class="num" id="7226570">0x92</span><span class="op" id="7226574">,</span>&nbsp;<span class="num" id="7226576">0xeb</span><span class="op" id="7226580">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7226584">0xc6</span><span class="op" id="7226588">,</span>&nbsp;<span class="num" id="7226590">0xe6</span><span class="op" id="7226594">,</span>&nbsp;<span class="num" id="7226596">0xc0</span><span class="op" id="7226600">,</span>&nbsp;<span class="num" id="7226602">0x44</span><span class="op" id="7226606">,</span>&nbsp;<span class="num" id="7226608">0xf3</span><span class="op" id="7226612">,</span>&nbsp;<span class="num" id="7226614">0xb4</span><span class="op" id="7226618">,</span>&nbsp;<span class="num" id="7226620">0xb4</span><span class="op" id="7226624">,</span>&nbsp;<span class="num" id="7226626">0x2e</span><span class="op" id="7226630">,</span>&nbsp;<span class="num" id="7226632">0x8c</span><span class="op" id="7226636">,</span>&nbsp;<span class="num" id="7226638">0x66</span><span class="op" id="7226642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7226646">0x0a</span><span class="op" id="7226650">,</span>&nbsp;<span class="num" id="7226652">0x37</span><span class="op" id="7226656">,</span>&nbsp;<span class="num" id="7226658">0x9c</span><span class="op" id="7226662">,</span>&nbsp;<span class="num" id="7226664">0x69</span><span class="op" id="7226668">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7226671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7226675">if</span>&nbsp;<span class="ident" id="7226678">err</span>&nbsp;<span class="op" id="7226682">:=</span>&nbsp;<span class="ident" id="7226685"><a href="/crypto/rsa/pss.go.html#4412732">VerifyPSS</a></span><span class="op" id="7226694">(</span><span class="op" id="7226695">&amp;</span><span class="ident" id="7226696"><a href="/crypto/rsa/pkcs1v15_test.go.html#7220411">rsaPrivateKey</a></span><span class="op" id="7226709">.</span><span class="ident" id="7226710">PublicKey</span><span class="op" id="7226719">,</span>&nbsp;<span class="ident" id="7226721"><a href="/crypto/rsa/pss_test.go.html#7226057">hash</a></span><span class="op" id="7226725">,</span>&nbsp;<span class="ident" id="7226727"><a href="/crypto/rsa/pss_test.go.html#7226125">hashed</a></span><span class="op" id="7226733">,</span>&nbsp;<span class="ident" id="7226735"><a href="/crypto/rsa/pss_test.go.html#7226257">sig</a></span><span class="op" id="7226738">,</span>&nbsp;<span class="ident" id="7226740">nil</span><span class="op" id="7226743">)</span><span class="op" id="7226744">;</span>&nbsp;<span class="ident" id="7226746"><a href="/crypto/rsa/pss_test.go.html#7226678">err</a></span>&nbsp;<span class="op" id="7226750">!=</span>&nbsp;<span class="ident" id="7226753">nil</span>&nbsp;<span class="op" id="7226757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226761"><a href="/crypto/rsa/pss_test.go.html#7226040">t</a></span><span class="op" id="7226762">.</span><span class="ident" id="7226763">Error</span><span class="op" id="7226768">(</span><span class="ident" id="7226769"><a href="/crypto/rsa/pss_test.go.html#7226678">err</a></span><span class="op" id="7226772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7226775">}</span><br>
<span class="lineno">190</span><span class="op" id="7226777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7226780">func</span>&nbsp;<span class="ident" id="7226785">TestPSSSigning</span><span class="op" id="7226799">(</span><span class="ident" id="7226800">t</span>&nbsp;<span class="op" id="7226802">*</span><span class="ident" id="7226803"><a href="/crypto/rsa/pss_test.go.html#7221396">testing</a></span><span class="op" id="7226810">.</span><span class="ident" id="7226811">T</span><span class="op" id="7226812">)</span>&nbsp;<span class="op" id="7226814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7226817">var</span>&nbsp;<span class="ident" id="7226821">saltLengthCombinations</span>&nbsp;<span class="op" id="7226844">=</span>&nbsp;<span class="op" id="7226846">[</span><span class="op" id="7226847">]</span><span class="keyword" id="7226848">struct</span>&nbsp;<span class="op" id="7226855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226859">signSaltLength</span><span class="op" id="7226873">,</span>&nbsp;<span class="ident" id="7226875">verifySaltLength</span>&nbsp;<span class="builtintype" id="7226892">int</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7226898">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7226931">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7226937">}</span><span class="op" id="7226938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7226942">{</span><span class="ident" id="7226943"><a href="/crypto/rsa/pss.go.html#4410764">PSSSaltLengthAuto</a></span><span class="op" id="7226960">,</span>&nbsp;<span class="ident" id="7226962"><a href="/crypto/rsa/pss.go.html#4410764">PSSSaltLengthAuto</a></span><span class="op" id="7226979">,</span>&nbsp;<span class="ident" id="7226981">true</span><span class="op" id="7226985">}</span><span class="op" id="7226986">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7226990">{</span><span class="ident" id="7226991"><a href="/crypto/rsa/pss.go.html#4410897">PSSSaltLengthEqualsHash</a></span><span class="op" id="7227014">,</span>&nbsp;<span class="ident" id="7227016"><a href="/crypto/rsa/pss.go.html#4410764">PSSSaltLengthAuto</a></span><span class="op" id="7227033">,</span>&nbsp;<span class="ident" id="7227035">true</span><span class="op" id="7227039">}</span><span class="op" id="7227040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7227044">{</span><span class="ident" id="7227045"><a href="/crypto/rsa/pss.go.html#4410897">PSSSaltLengthEqualsHash</a></span><span class="op" id="7227068">,</span>&nbsp;<span class="ident" id="7227070"><a href="/crypto/rsa/pss.go.html#4410897">PSSSaltLengthEqualsHash</a></span><span class="op" id="7227093">,</span>&nbsp;<span class="ident" id="7227095">true</span><span class="op" id="7227099">}</span><span class="op" id="7227100">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7227104">{</span><span class="ident" id="7227105"><a href="/crypto/rsa/pss.go.html#4410897">PSSSaltLengthEqualsHash</a></span><span class="op" id="7227128">,</span>&nbsp;<span class="num" id="7227130">8</span><span class="op" id="7227131">,</span>&nbsp;<span class="ident" id="7227133">false</span><span class="op" id="7227138">}</span><span class="op" id="7227139">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7227143">{</span><span class="ident" id="7227144"><a href="/crypto/rsa/pss.go.html#4410764">PSSSaltLengthAuto</a></span><span class="op" id="7227161">,</span>&nbsp;<span class="ident" id="7227163"><a href="/crypto/rsa/pss.go.html#4410897">PSSSaltLengthEqualsHash</a></span><span class="op" id="7227186">,</span>&nbsp;<span class="ident" id="7227188">false</span><span class="op" id="7227193">}</span><span class="op" id="7227194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7227198">{</span><span class="num" id="7227199">8</span><span class="op" id="7227200">,</span>&nbsp;<span class="num" id="7227202">8</span><span class="op" id="7227203">,</span>&nbsp;<span class="ident" id="7227205">true</span><span class="op" id="7227209">}</span><span class="op" id="7227210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7227213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227217">hash</span>&nbsp;<span class="op" id="7227222">:=</span>&nbsp;<span class="ident" id="7227225"><a href="/crypto/rsa/pss_test.go.html#7221265">crypto</a></span><span class="op" id="7227231">.</span><span class="ident" id="7227232">MD5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227237">h</span>&nbsp;<span class="op" id="7227239">:=</span>&nbsp;<span class="ident" id="7227242"><a href="/crypto/rsa/pss_test.go.html#7227217">hash</a></span><span class="op" id="7227246">.</span><span class="ident" id="7227247">New</span><span class="op" id="7227250">(</span><span class="op" id="7227251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227254"><a href="/crypto/rsa/pss_test.go.html#7227237">h</a></span><span class="op" id="7227255">.</span><span class="ident" id="7227256">Write</span><span class="op" id="7227261">(</span><span class="op" id="7227262">[</span><span class="op" id="7227263">]</span><span class="builtintype" id="7227264">byte</span><span class="op" id="7227268">(</span><span class="string" id="7227269">&#34;testing&#34;</span><span class="op" id="7227278">)</span><span class="op" id="7227279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227282">hashed</span>&nbsp;<span class="op" id="7227289">:=</span>&nbsp;<span class="ident" id="7227292"><a href="/crypto/rsa/pss_test.go.html#7227237">h</a></span><span class="op" id="7227293">.</span><span class="ident" id="7227294">Sum</span><span class="op" id="7227297">(</span><span class="ident" id="7227298">nil</span><span class="op" id="7227301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7227304">var</span>&nbsp;<span class="ident" id="7227308">opts</span>&nbsp;<span class="ident" id="7227313"><a href="/crypto/rsa/pss.go.html#4411008">PSSOptions</a></span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7227326">for</span>&nbsp;<span class="ident" id="7227330">i</span><span class="op" id="7227331">,</span>&nbsp;<span class="ident" id="7227333">test</span>&nbsp;<span class="op" id="7227338">:=</span>&nbsp;<span class="keyword" id="7227341">range</span>&nbsp;<span class="ident" id="7227347"><a href="/crypto/rsa/pss_test.go.html#7226821">saltLengthCombinations</a></span>&nbsp;<span class="op" id="7227370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227374"><a href="/crypto/rsa/pss_test.go.html#7227308">opts</a></span><span class="op" id="7227378">.</span><span class="ident" id="7227379">SaltLength</span>&nbsp;<span class="op" id="7227390">=</span>&nbsp;<span class="ident" id="7227392"><a href="/crypto/rsa/pss_test.go.html#7227333">test</a></span><span class="op" id="7227396">.</span><span class="ident" id="7227397">signSaltLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227414">sig</span><span class="op" id="7227417">,</span>&nbsp;<span class="ident" id="7227419">err</span>&nbsp;<span class="op" id="7227423">:=</span>&nbsp;<span class="ident" id="7227426"><a href="/crypto/rsa/pss.go.html#4411928">SignPSS</a></span><span class="op" id="7227433">(</span><span class="ident" id="7227434"><a href="/crypto/rsa/pss_test.go.html#7221291">rand</a></span><span class="op" id="7227438">.</span><span class="ident" id="7227439">Reader</span><span class="op" id="7227445">,</span>&nbsp;<span class="ident" id="7227447"><a href="/crypto/rsa/pkcs1v15_test.go.html#7220411">rsaPrivateKey</a></span><span class="op" id="7227460">,</span>&nbsp;<span class="ident" id="7227462"><a href="/crypto/rsa/pss_test.go.html#7227217">hash</a></span><span class="op" id="7227466">,</span>&nbsp;<span class="ident" id="7227468"><a href="/crypto/rsa/pss_test.go.html#7227282">hashed</a></span><span class="op" id="7227474">,</span>&nbsp;<span class="op" id="7227476">&amp;</span><span class="ident" id="7227477"><a href="/crypto/rsa/pss_test.go.html#7227308">opts</a></span><span class="op" id="7227481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7227485">if</span>&nbsp;<span class="ident" id="7227488"><a href="/crypto/rsa/pss_test.go.html#7227419">err</a></span>&nbsp;<span class="op" id="7227492">!=</span>&nbsp;<span class="ident" id="7227495">nil</span>&nbsp;<span class="op" id="7227499">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227504"><a href="/crypto/rsa/pss_test.go.html#7226800">t</a></span><span class="op" id="7227505">.</span><span class="ident" id="7227506">Errorf</span><span class="op" id="7227512">(</span><span class="string" id="7227513">&#34;#%d:&nbsp;error&nbsp;while&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="7227543">,</span>&nbsp;<span class="ident" id="7227545"><a href="/crypto/rsa/pss_test.go.html#7227330">i</a></span><span class="op" id="7227546">,</span>&nbsp;<span class="ident" id="7227548"><a href="/crypto/rsa/pss_test.go.html#7227419">err</a></span><span class="op" id="7227551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7227556">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7227567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227572"><a href="/crypto/rsa/pss_test.go.html#7227308">opts</a></span><span class="op" id="7227576">.</span><span class="ident" id="7227577">SaltLength</span>&nbsp;<span class="op" id="7227588">=</span>&nbsp;<span class="ident" id="7227590"><a href="/crypto/rsa/pss_test.go.html#7227333">test</a></span><span class="op" id="7227594">.</span><span class="ident" id="7227595">verifySaltLength</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227614"><a href="/crypto/rsa/pss_test.go.html#7227419">err</a></span>&nbsp;<span class="op" id="7227618">=</span>&nbsp;<span class="ident" id="7227620"><a href="/crypto/rsa/pss.go.html#4412732">VerifyPSS</a></span><span class="op" id="7227629">(</span><span class="op" id="7227630">&amp;</span><span class="ident" id="7227631"><a href="/crypto/rsa/pkcs1v15_test.go.html#7220411">rsaPrivateKey</a></span><span class="op" id="7227644">.</span><span class="ident" id="7227645">PublicKey</span><span class="op" id="7227654">,</span>&nbsp;<span class="ident" id="7227656"><a href="/crypto/rsa/pss_test.go.html#7227217">hash</a></span><span class="op" id="7227660">,</span>&nbsp;<span class="ident" id="7227662"><a href="/crypto/rsa/pss_test.go.html#7227282">hashed</a></span><span class="op" id="7227668">,</span>&nbsp;<span class="ident" id="7227670"><a href="/crypto/rsa/pss_test.go.html#7227414">sig</a></span><span class="op" id="7227673">,</span>&nbsp;<span class="op" id="7227675">&amp;</span><span class="ident" id="7227676"><a href="/crypto/rsa/pss_test.go.html#7227308">opts</a></span><span class="op" id="7227680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7227684">if</span>&nbsp;<span class="op" id="7227687">(</span><span class="ident" id="7227688"><a href="/crypto/rsa/pss_test.go.html#7227419">err</a></span>&nbsp;<span class="op" id="7227692">==</span>&nbsp;<span class="ident" id="7227695">nil</span><span class="op" id="7227698">)</span>&nbsp;<span class="op" id="7227700">!=</span>&nbsp;<span class="ident" id="7227703"><a href="/crypto/rsa/pss_test.go.html#7227333">test</a></span><span class="op" id="7227707">.</span><span class="ident" id="7227708">good</span>&nbsp;<span class="op" id="7227713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227718"><a href="/crypto/rsa/pss_test.go.html#7226800">t</a></span><span class="op" id="7227719">.</span><span class="ident" id="7227720">Errorf</span><span class="op" id="7227726">(</span><span class="string" id="7227727">&#34;#%d:&nbsp;bad&nbsp;result,&nbsp;wanted:&nbsp;%t,&nbsp;got:&nbsp;%s&#34;</span><span class="op" id="7227765">,</span>&nbsp;<span class="ident" id="7227767"><a href="/crypto/rsa/pss_test.go.html#7227330">i</a></span><span class="op" id="7227768">,</span>&nbsp;<span class="ident" id="7227770"><a href="/crypto/rsa/pss_test.go.html#7227333">test</a></span><span class="op" id="7227774">.</span><span class="ident" id="7227775">good</span><span class="op" id="7227779">,</span>&nbsp;<span class="ident" id="7227781"><a href="/crypto/rsa/pss_test.go.html#7227419">err</a></span><span class="op" id="7227784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7227788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7227791">}</span><br>
<span class="lineno">225</span><span class="op" id="7227793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7227796">func</span>&nbsp;<span class="ident" id="7227801">bigFromHex</span><span class="op" id="7227811">(</span><span class="ident" id="7227812">hex</span>&nbsp;<span class="builtintype" id="7227816">string</span><span class="op" id="7227822">)</span>&nbsp;<span class="op" id="7227824">*</span><span class="ident" id="7227825"><a href="/crypto/rsa/pss_test.go.html#7221356">big</a></span><span class="op" id="7227828">.</span><span class="ident" id="7227829">Int</span>&nbsp;<span class="op" id="7227833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227836">n</span><span class="op" id="7227837">,</span>&nbsp;<span class="ident" id="7227839">ok</span>&nbsp;<span class="op" id="7227842">:=</span>&nbsp;<span class="builtinfunc" id="7227845">new</span><span class="op" id="7227848">(</span><span class="ident" id="7227849"><a href="/crypto/rsa/pss_test.go.html#7221356">big</a></span><span class="op" id="7227852">.</span><span class="ident" id="7227853">Int</span><span class="op" id="7227856">)</span><span class="op" id="7227857">.</span><span class="ident" id="7227858">SetString</span><span class="op" id="7227867">(</span><span class="ident" id="7227868"><a href="/crypto/rsa/pss_test.go.html#7227812">hex</a></span><span class="op" id="7227871">,</span>&nbsp;<span class="num" id="7227873">16</span><span class="op" id="7227875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7227878">if</span>&nbsp;<span class="op" id="7227881">!</span><span class="ident" id="7227882"><a href="/crypto/rsa/pss_test.go.html#7227839">ok</a></span>&nbsp;<span class="op" id="7227885">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7227889">panic</span><span class="op" id="7227894">(</span><span class="string" id="7227895">&#34;bad&nbsp;hex:&nbsp;&#34;</span>&nbsp;<span class="op" id="7227907">+</span>&nbsp;<span class="ident" id="7227909"><a href="/crypto/rsa/pss_test.go.html#7227812">hex</a></span><span class="op" id="7227912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7227915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7227918">return</span>&nbsp;<span class="ident" id="7227925"><a href="/crypto/rsa/pss_test.go.html#7227836">n</a></span><br>
<span class="lineno"></span><span class="op" id="7227927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="7227930">func</span>&nbsp;<span class="ident" id="7227935">intFromHex</span><span class="op" id="7227945">(</span><span class="ident" id="7227946">hex</span>&nbsp;<span class="builtintype" id="7227950">string</span><span class="op" id="7227956">)</span>&nbsp;<span class="builtintype" id="7227958">int</span>&nbsp;<span class="op" id="7227962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7227965">i</span><span class="op" id="7227966">,</span>&nbsp;<span class="ident" id="7227968">err</span>&nbsp;<span class="op" id="7227972">:=</span>&nbsp;<span class="ident" id="7227975"><a href="/crypto/rsa/pss_test.go.html#7221374">strconv</a></span><span class="op" id="7227982">.</span><span class="ident" id="7227983">ParseInt</span><span class="op" id="7227991">(</span><span class="ident" id="7227992"><a href="/crypto/rsa/pss_test.go.html#7227946">hex</a></span><span class="op" id="7227995">,</span>&nbsp;<span class="num" id="7227997">16</span><span class="op" id="7227999">,</span>&nbsp;<span class="num" id="7228001">32</span><span class="op" id="7228003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7228006">if</span>&nbsp;<span class="ident" id="7228009"><a href="/crypto/rsa/pss_test.go.html#7227968">err</a></span>&nbsp;<span class="op" id="7228013">!=</span>&nbsp;<span class="ident" id="7228016">nil</span>&nbsp;<span class="op" id="7228020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7228024">panic</span><span class="op" id="7228029">(</span><span class="ident" id="7228030"><a href="/crypto/rsa/pss_test.go.html#7227968">err</a></span><span class="op" id="7228033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7228036">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7228039">return</span>&nbsp;<span class="builtintype" id="7228046">int</span><span class="op" id="7228049">(</span><span class="ident" id="7228050"><a href="/crypto/rsa/pss_test.go.html#7227965">i</a></span><span class="op" id="7228051">)</span><br>
<span class="lineno"></span><span class="op" id="7228053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7228056">func</span>&nbsp;<span class="ident" id="7228061">fromHex</span><span class="op" id="7228068">(</span><span class="ident" id="7228069">hexStr</span>&nbsp;<span class="builtintype" id="7228076">string</span><span class="op" id="7228082">)</span>&nbsp;<span class="op" id="7228084">[</span><span class="op" id="7228085">]</span><span class="builtintype" id="7228086">byte</span>&nbsp;<span class="op" id="7228091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7228094">s</span><span class="op" id="7228095">,</span>&nbsp;<span class="ident" id="7228097">err</span>&nbsp;<span class="op" id="7228101">:=</span>&nbsp;<span class="ident" id="7228104"><a href="/crypto/rsa/pss_test.go.html#7221340">hex</a></span><span class="op" id="7228107">.</span><span class="ident" id="7228108">DecodeString</span><span class="op" id="7228120">(</span><span class="ident" id="7228121"><a href="/crypto/rsa/pss_test.go.html#7228069">hexStr</a></span><span class="op" id="7228127">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7228130">if</span>&nbsp;<span class="ident" id="7228133"><a href="/crypto/rsa/pss_test.go.html#7228097">err</a></span>&nbsp;<span class="op" id="7228137">!=</span>&nbsp;<span class="ident" id="7228140">nil</span>&nbsp;<span class="op" id="7228144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7228148">panic</span><span class="op" id="7228153">(</span><span class="ident" id="7228154"><a href="/crypto/rsa/pss_test.go.html#7228097">err</a></span><span class="op" id="7228157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7228160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7228163">return</span>&nbsp;<span class="ident" id="7228170"><a href="/crypto/rsa/pss_test.go.html#7228094">s</a></span><br>
<span class="lineno"></span><span class="op" id="7228172">}</span>
</div>
</body>
</html>
