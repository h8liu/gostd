<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html" class="current">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7789240">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7789295">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7789349">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7789400">package</span>&nbsp;<span class="ident" id="7789408">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7789413">import</span>&nbsp;<span class="op" id="7789420">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7789423">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7789436">&#34;reflect&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7789447">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7789458">&#34;testing/quick&#34;</span><br>
<span class="lineno"></span><span class="op" id="7789474">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7789477">var</span>&nbsp;<span class="ident" id="7789481">tests</span>&nbsp;<span class="op" id="7789487">=</span>&nbsp;<span class="op" id="7789489">[</span><span class="op" id="7789490">]</span><span class="keyword" id="7789491">interface</span><span class="op" id="7789500">{</span><span class="op" id="7789501">}</span><span class="op" id="7789502">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7789505">&amp;</span><span class="ident" id="7789506">clientHelloMsg</span><span class="op" id="7789520">{</span><span class="op" id="7789521">}</span><span class="op" id="7789522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7789525">&amp;</span><span class="ident" id="7789526">serverHelloMsg</span><span class="op" id="7789540">{</span><span class="op" id="7789541">}</span><span class="op" id="7789542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7789545">&amp;</span><span class="ident" id="7789546">finishedMsg</span><span class="op" id="7789557">{</span><span class="op" id="7789558">}</span><span class="op" id="7789559">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7789563">&amp;</span><span class="ident" id="7789564">certificateMsg</span><span class="op" id="7789578">{</span><span class="op" id="7789579">}</span><span class="op" id="7789580">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7789583">&amp;</span><span class="ident" id="7789584">certificateRequestMsg</span><span class="op" id="7789605">{</span><span class="op" id="7789606">}</span><span class="op" id="7789607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7789610">&amp;</span><span class="ident" id="7789611">certificateVerifyMsg</span><span class="op" id="7789631">{</span><span class="op" id="7789632">}</span><span class="op" id="7789633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7789636">&amp;</span><span class="ident" id="7789637">certificateStatusMsg</span><span class="op" id="7789657">{</span><span class="op" id="7789658">}</span><span class="op" id="7789659">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7789662">&amp;</span><span class="ident" id="7789663">clientKeyExchangeMsg</span><span class="op" id="7789683">{</span><span class="op" id="7789684">}</span><span class="op" id="7789685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7789688">&amp;</span><span class="ident" id="7789689">nextProtoMsg</span><span class="op" id="7789701">{</span><span class="op" id="7789702">}</span><span class="op" id="7789703">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7789706">&amp;</span><span class="ident" id="7789707">newSessionTicketMsg</span><span class="op" id="7789726">{</span><span class="op" id="7789727">}</span><span class="op" id="7789728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7789731">&amp;</span><span class="ident" id="7789732">sessionState</span><span class="op" id="7789744">{</span><span class="op" id="7789745">}</span><span class="op" id="7789746">,</span><br>
<span class="lineno"></span><span class="op" id="7789748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7789751">type</span>&nbsp;<span class="ident" id="7789756">testMessage</span>&nbsp;<span class="keyword" id="7789768">interface</span>&nbsp;<span class="op" id="7789778">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7789781">marshal</span><span class="op" id="7789788">(</span><span class="op" id="7789789">)</span>&nbsp;<span class="op" id="7789791">[</span><span class="op" id="7789792">]</span><span class="builtintype" id="7789793">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7789799">unmarshal</span><span class="op" id="7789808">(</span><span class="op" id="7789809">[</span><span class="op" id="7789810">]</span><span class="builtintype" id="7789811">byte</span><span class="op" id="7789815">)</span>&nbsp;<span class="builtintype" id="7789817">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7789823">equal</span><span class="op" id="7789828">(</span><span class="keyword" id="7789829">interface</span><span class="op" id="7789838">{</span><span class="op" id="7789839">}</span><span class="op" id="7789840">)</span>&nbsp;<span class="builtintype" id="7789842">bool</span><br>
<span class="lineno"></span><span class="op" id="7789847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="7789850">func</span>&nbsp;<span class="ident" id="7789855">TestMarshalUnmarshal</span><span class="op" id="7789875">(</span><span class="ident" id="7789876">t</span>&nbsp;<span class="op" id="7789878">*</span><span class="ident" id="7789879">testing</span><span class="op" id="7789886">.</span><span class="ident" id="7789887">T</span><span class="op" id="7789888">)</span>&nbsp;<span class="op" id="7789890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7789893">rand</span>&nbsp;<span class="op" id="7789898">:=</span>&nbsp;<span class="ident" id="7789901">rand</span><span class="op" id="7789905">.</span><span class="ident" id="7789906">New</span><span class="op" id="7789909">(</span><span class="ident" id="7789910">rand</span><span class="op" id="7789914">.</span><span class="ident" id="7789915">NewSource</span><span class="op" id="7789924">(</span><span class="num" id="7789925">0</span><span class="op" id="7789926">)</span><span class="op" id="7789927">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7789931">for</span>&nbsp;<span class="ident" id="7789935">i</span><span class="op" id="7789936">,</span>&nbsp;<span class="ident" id="7789938">iface</span>&nbsp;<span class="op" id="7789944">:=</span>&nbsp;<span class="keyword" id="7789947">range</span>&nbsp;<span class="ident" id="7789953">tests</span>&nbsp;<span class="op" id="7789959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7789963">ty</span>&nbsp;<span class="op" id="7789966">:=</span>&nbsp;<span class="ident" id="7789969">reflect</span><span class="op" id="7789976">.</span><span class="ident" id="7789977">ValueOf</span><span class="op" id="7789984">(</span><span class="ident" id="7789985">iface</span><span class="op" id="7789990">)</span><span class="op" id="7789991">.</span><span class="ident" id="7789992">Type</span><span class="op" id="7789996">(</span><span class="op" id="7789997">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790002">n</span>&nbsp;<span class="op" id="7790004">:=</span>&nbsp;<span class="num" id="7790007">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7790013">if</span>&nbsp;<span class="ident" id="7790016">testing</span><span class="op" id="7790023">.</span><span class="ident" id="7790024">Short</span><span class="op" id="7790029">(</span><span class="op" id="7790030">)</span>&nbsp;<span class="op" id="7790032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790037">n</span>&nbsp;<span class="op" id="7790039">=</span>&nbsp;<span class="num" id="7790041">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7790045">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7790049">for</span>&nbsp;<span class="ident" id="7790053">j</span>&nbsp;<span class="op" id="7790055">:=</span>&nbsp;<span class="num" id="7790058">0</span><span class="op" id="7790059">;</span>&nbsp;<span class="ident" id="7790061">j</span>&nbsp;<span class="op" id="7790063">&lt;</span>&nbsp;<span class="ident" id="7790065">n</span><span class="op" id="7790066">;</span>&nbsp;<span class="ident" id="7790068">j</span><span class="op" id="7790069">++</span>&nbsp;<span class="op" id="7790072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790077">v</span><span class="op" id="7790078">,</span>&nbsp;<span class="ident" id="7790080">ok</span>&nbsp;<span class="op" id="7790083">:=</span>&nbsp;<span class="ident" id="7790086">quick</span><span class="op" id="7790091">.</span><span class="ident" id="7790092">Value</span><span class="op" id="7790097">(</span><span class="ident" id="7790098">ty</span><span class="op" id="7790100">,</span>&nbsp;<span class="ident" id="7790102">rand</span><span class="op" id="7790106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7790111">if</span>&nbsp;<span class="op" id="7790114">!</span><span class="ident" id="7790115">ok</span>&nbsp;<span class="op" id="7790118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790124">t</span><span class="op" id="7790125">.</span><span class="ident" id="7790126">Errorf</span><span class="op" id="7790132">(</span><span class="string" id="7790133">&#34;#%d:&nbsp;failed&nbsp;to&nbsp;create&nbsp;value&#34;</span><span class="op" id="7790162">,</span>&nbsp;<span class="ident" id="7790164">i</span><span class="op" id="7790165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7790171">break</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7790180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790186">m1</span>&nbsp;<span class="op" id="7790189">:=</span>&nbsp;<span class="ident" id="7790192">v</span><span class="op" id="7790193">.</span><span class="ident" id="7790194">Interface</span><span class="op" id="7790203">(</span><span class="op" id="7790204">)</span><span class="op" id="7790205">.</span><span class="op" id="7790206">(</span><span class="ident" id="7790207">testMessage</span><span class="op" id="7790218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790223">marshaled</span>&nbsp;<span class="op" id="7790233">:=</span>&nbsp;<span class="ident" id="7790236">m1</span><span class="op" id="7790238">.</span><span class="ident" id="7790239">marshal</span><span class="op" id="7790246">(</span><span class="op" id="7790247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790252">m2</span>&nbsp;<span class="op" id="7790255">:=</span>&nbsp;<span class="ident" id="7790258">iface</span><span class="op" id="7790263">.</span><span class="op" id="7790264">(</span><span class="ident" id="7790265">testMessage</span><span class="op" id="7790276">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7790281">if</span>&nbsp;<span class="op" id="7790284">!</span><span class="ident" id="7790285">m2</span><span class="op" id="7790287">.</span><span class="ident" id="7790288">unmarshal</span><span class="op" id="7790297">(</span><span class="ident" id="7790298">marshaled</span><span class="op" id="7790307">)</span>&nbsp;<span class="op" id="7790309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790315">t</span><span class="op" id="7790316">.</span><span class="ident" id="7790317">Errorf</span><span class="op" id="7790323">(</span><span class="string" id="7790324">&#34;#%d&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;%#v&nbsp;%x&#34;</span><span class="op" id="7790356">,</span>&nbsp;<span class="ident" id="7790358">i</span><span class="op" id="7790359">,</span>&nbsp;<span class="ident" id="7790361">m1</span><span class="op" id="7790363">,</span>&nbsp;<span class="ident" id="7790365">marshaled</span><span class="op" id="7790374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7790380">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7790389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790394">m2</span><span class="op" id="7790396">.</span><span class="ident" id="7790397">marshal</span><span class="op" id="7790404">(</span><span class="op" id="7790405">)</span>&nbsp;<span class="comment" id="7790407">//&nbsp;to&nbsp;fill&nbsp;any&nbsp;marshal&nbsp;cache&nbsp;in&nbsp;the&nbsp;message</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7790455">if</span>&nbsp;<span class="op" id="7790458">!</span><span class="ident" id="7790459">m1</span><span class="op" id="7790461">.</span><span class="ident" id="7790462">equal</span><span class="op" id="7790467">(</span><span class="ident" id="7790468">m2</span><span class="op" id="7790470">)</span>&nbsp;<span class="op" id="7790472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790478">t</span><span class="op" id="7790479">.</span><span class="ident" id="7790480">Errorf</span><span class="op" id="7790486">(</span><span class="string" id="7790487">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&nbsp;%x&#34;</span><span class="op" id="7790512">,</span>&nbsp;<span class="ident" id="7790514">i</span><span class="op" id="7790515">,</span>&nbsp;<span class="ident" id="7790517">m2</span><span class="op" id="7790519">,</span>&nbsp;<span class="ident" id="7790521">m1</span><span class="op" id="7790523">,</span>&nbsp;<span class="ident" id="7790525">marshaled</span><span class="op" id="7790534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7790540">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7790549">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7790555">if</span>&nbsp;<span class="ident" id="7790558">i</span>&nbsp;<span class="op" id="7790560">&gt;=</span>&nbsp;<span class="num" id="7790563">3</span>&nbsp;<span class="op" id="7790565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7790571">//&nbsp;The&nbsp;first&nbsp;three&nbsp;message&nbsp;types&nbsp;(ClientHello,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7790622">//&nbsp;ServerHello&nbsp;and&nbsp;Finished)&nbsp;are&nbsp;allowed&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7790670">//&nbsp;have&nbsp;parsable&nbsp;prefixes&nbsp;because&nbsp;the&nbsp;extension</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7790722">//&nbsp;data&nbsp;is&nbsp;optional&nbsp;and&nbsp;the&nbsp;length&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7790768">//&nbsp;Finished&nbsp;varies&nbsp;across&nbsp;versions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7790808">for</span>&nbsp;<span class="ident" id="7790812">j</span>&nbsp;<span class="op" id="7790814">:=</span>&nbsp;<span class="num" id="7790817">0</span><span class="op" id="7790818">;</span>&nbsp;<span class="ident" id="7790820">j</span>&nbsp;<span class="op" id="7790822">&lt;</span>&nbsp;<span class="builtinfunc" id="7790824">len</span><span class="op" id="7790827">(</span><span class="ident" id="7790828">marshaled</span><span class="op" id="7790837">)</span><span class="op" id="7790838">;</span>&nbsp;<span class="ident" id="7790840">j</span><span class="op" id="7790841">++</span>&nbsp;<span class="op" id="7790844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7790851">if</span>&nbsp;<span class="ident" id="7790854">m2</span><span class="op" id="7790856">.</span><span class="ident" id="7790857">unmarshal</span><span class="op" id="7790866">(</span><span class="ident" id="7790867">marshaled</span><span class="op" id="7790876">[</span><span class="num" id="7790877">0</span><span class="op" id="7790878">:</span><span class="ident" id="7790879">j</span><span class="op" id="7790880">]</span><span class="op" id="7790881">)</span>&nbsp;<span class="op" id="7790883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790891">t</span><span class="op" id="7790892">.</span><span class="ident" id="7790893">Errorf</span><span class="op" id="7790899">(</span><span class="string" id="7790900">&#34;#%d&nbsp;unmarshaled&nbsp;a&nbsp;prefix&nbsp;of&nbsp;length&nbsp;%d&nbsp;of&nbsp;%#v&#34;</span><span class="op" id="7790946">,</span>&nbsp;<span class="ident" id="7790948">i</span><span class="op" id="7790949">,</span>&nbsp;<span class="ident" id="7790951">j</span><span class="op" id="7790952">,</span>&nbsp;<span class="ident" id="7790954">m1</span><span class="op" id="7790956">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7790964">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7790975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7790981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7790986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7790990">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7790993">}</span><br>
<span class="lineno"></span><span class="op" id="7790995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7790998">func</span>&nbsp;<span class="ident" id="7791003">TestFuzz</span><span class="op" id="7791011">(</span><span class="ident" id="7791012">t</span>&nbsp;<span class="op" id="7791014">*</span><span class="ident" id="7791015">testing</span><span class="op" id="7791022">.</span><span class="ident" id="7791023">T</span><span class="op" id="7791024">)</span>&nbsp;<span class="op" id="7791026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791029">rand</span>&nbsp;<span class="op" id="7791034">:=</span>&nbsp;<span class="ident" id="7791037">rand</span><span class="op" id="7791041">.</span><span class="ident" id="7791042">New</span><span class="op" id="7791045">(</span><span class="ident" id="7791046">rand</span><span class="op" id="7791050">.</span><span class="ident" id="7791051">NewSource</span><span class="op" id="7791060">(</span><span class="num" id="7791061">0</span><span class="op" id="7791062">)</span><span class="op" id="7791063">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7791066">for</span>&nbsp;<span class="ident" id="7791070">_</span><span class="op" id="7791071">,</span>&nbsp;<span class="ident" id="7791073">iface</span>&nbsp;<span class="op" id="7791079">:=</span>&nbsp;<span class="keyword" id="7791082">range</span>&nbsp;<span class="ident" id="7791088">tests</span>&nbsp;<span class="op" id="7791094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791098">m</span>&nbsp;<span class="op" id="7791100">:=</span>&nbsp;<span class="ident" id="7791103">iface</span><span class="op" id="7791108">.</span><span class="op" id="7791109">(</span><span class="ident" id="7791110">testMessage</span><span class="op" id="7791121">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7791126">for</span>&nbsp;<span class="ident" id="7791130">j</span>&nbsp;<span class="op" id="7791132">:=</span>&nbsp;<span class="num" id="7791135">0</span><span class="op" id="7791136">;</span>&nbsp;<span class="ident" id="7791138">j</span>&nbsp;<span class="op" id="7791140">&lt;</span>&nbsp;<span class="num" id="7791142">1000</span><span class="op" id="7791146">;</span>&nbsp;<span class="ident" id="7791148">j</span><span class="op" id="7791149">++</span>&nbsp;<span class="op" id="7791152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7791157">len</span>&nbsp;<span class="op" id="7791161">:=</span>&nbsp;<span class="ident" id="7791164">rand</span><span class="op" id="7791168">.</span><span class="ident" id="7791169">Intn</span><span class="op" id="7791173">(</span><span class="num" id="7791174">100</span><span class="op" id="7791177">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791182">bytes</span>&nbsp;<span class="op" id="7791188">:=</span>&nbsp;<span class="ident" id="7791191">randomBytes</span><span class="op" id="7791202">(</span><span class="builtinfunc" id="7791203">len</span><span class="op" id="7791206">,</span>&nbsp;<span class="ident" id="7791208">rand</span><span class="op" id="7791212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7791217">//&nbsp;This&nbsp;just&nbsp;looks&nbsp;for&nbsp;crashes&nbsp;due&nbsp;to&nbsp;bounds&nbsp;errors&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791277">m</span><span class="op" id="7791278">.</span><span class="ident" id="7791279">unmarshal</span><span class="op" id="7791288">(</span><span class="ident" id="7791289">bytes</span><span class="op" id="7791294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7791298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7791301">}</span><br>
<span class="lineno">95</span><span class="op" id="7791303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7791306">func</span>&nbsp;<span class="ident" id="7791311">randomBytes</span><span class="op" id="7791322">(</span><span class="ident" id="7791323">n</span>&nbsp;<span class="builtintype" id="7791325">int</span><span class="op" id="7791328">,</span>&nbsp;<span class="ident" id="7791330">rand</span>&nbsp;<span class="op" id="7791335">*</span><span class="ident" id="7791336">rand</span><span class="op" id="7791340">.</span><span class="ident" id="7791341">Rand</span><span class="op" id="7791345">)</span>&nbsp;<span class="op" id="7791347">[</span><span class="op" id="7791348">]</span><span class="builtintype" id="7791349">byte</span>&nbsp;<span class="op" id="7791354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791357">r</span>&nbsp;<span class="op" id="7791359">:=</span>&nbsp;<span class="builtinfunc" id="7791362">make</span><span class="op" id="7791366">(</span><span class="op" id="7791367">[</span><span class="op" id="7791368">]</span><span class="builtintype" id="7791369">byte</span><span class="op" id="7791373">,</span>&nbsp;<span class="ident" id="7791375">n</span><span class="op" id="7791376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7791379">for</span>&nbsp;<span class="ident" id="7791383">i</span>&nbsp;<span class="op" id="7791385">:=</span>&nbsp;<span class="num" id="7791388">0</span><span class="op" id="7791389">;</span>&nbsp;<span class="ident" id="7791391">i</span>&nbsp;<span class="op" id="7791393">&lt;</span>&nbsp;<span class="ident" id="7791395">n</span><span class="op" id="7791396">;</span>&nbsp;<span class="ident" id="7791398">i</span><span class="op" id="7791399">++</span>&nbsp;<span class="op" id="7791402">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791406">r</span><span class="op" id="7791407">[</span><span class="ident" id="7791408">i</span><span class="op" id="7791409">]</span>&nbsp;<span class="op" id="7791411">=</span>&nbsp;<span class="builtintype" id="7791413">byte</span><span class="op" id="7791417">(</span><span class="ident" id="7791418">rand</span><span class="op" id="7791422">.</span><span class="ident" id="7791423">Int31</span><span class="op" id="7791428">(</span><span class="op" id="7791429">)</span><span class="op" id="7791430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7791433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7791436">return</span>&nbsp;<span class="ident" id="7791443">r</span><br>
<span class="lineno"></span><span class="op" id="7791445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="7791448">func</span>&nbsp;<span class="ident" id="7791453">randomString</span><span class="op" id="7791465">(</span><span class="ident" id="7791466">n</span>&nbsp;<span class="builtintype" id="7791468">int</span><span class="op" id="7791471">,</span>&nbsp;<span class="ident" id="7791473">rand</span>&nbsp;<span class="op" id="7791478">*</span><span class="ident" id="7791479">rand</span><span class="op" id="7791483">.</span><span class="ident" id="7791484">Rand</span><span class="op" id="7791488">)</span>&nbsp;<span class="builtintype" id="7791490">string</span>&nbsp;<span class="op" id="7791497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791500">b</span>&nbsp;<span class="op" id="7791502">:=</span>&nbsp;<span class="ident" id="7791505">randomBytes</span><span class="op" id="7791516">(</span><span class="ident" id="7791517">n</span><span class="op" id="7791518">,</span>&nbsp;<span class="ident" id="7791520">rand</span><span class="op" id="7791524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7791527">return</span>&nbsp;<span class="builtintype" id="7791534">string</span><span class="op" id="7791540">(</span><span class="ident" id="7791541">b</span><span class="op" id="7791542">)</span><br>
<span class="lineno"></span><span class="op" id="7791544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="7791547">func</span>&nbsp;<span class="op" id="7791552">(</span><span class="op" id="7791553">*</span><span class="ident" id="7791554">clientHelloMsg</span><span class="op" id="7791568">)</span>&nbsp;<span class="ident" id="7791570">Generate</span><span class="op" id="7791578">(</span><span class="ident" id="7791579">rand</span>&nbsp;<span class="op" id="7791584">*</span><span class="ident" id="7791585">rand</span><span class="op" id="7791589">.</span><span class="ident" id="7791590">Rand</span><span class="op" id="7791594">,</span>&nbsp;<span class="ident" id="7791596">size</span>&nbsp;<span class="builtintype" id="7791601">int</span><span class="op" id="7791604">)</span>&nbsp;<span class="ident" id="7791606">reflect</span><span class="op" id="7791613">.</span><span class="ident" id="7791614">Value</span>&nbsp;<span class="op" id="7791620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791623">m</span>&nbsp;<span class="op" id="7791625">:=</span>&nbsp;<span class="op" id="7791628">&amp;</span><span class="ident" id="7791629">clientHelloMsg</span><span class="op" id="7791643">{</span><span class="op" id="7791644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791647">m</span><span class="op" id="7791648">.</span><span class="ident" id="7791649">vers</span>&nbsp;<span class="op" id="7791654">=</span>&nbsp;<span class="builtintype" id="7791656">uint16</span><span class="op" id="7791662">(</span><span class="ident" id="7791663">rand</span><span class="op" id="7791667">.</span><span class="ident" id="7791668">Intn</span><span class="op" id="7791672">(</span><span class="num" id="7791673">65536</span><span class="op" id="7791678">)</span><span class="op" id="7791679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791682">m</span><span class="op" id="7791683">.</span><span class="ident" id="7791684">random</span>&nbsp;<span class="op" id="7791691">=</span>&nbsp;<span class="ident" id="7791693">randomBytes</span><span class="op" id="7791704">(</span><span class="num" id="7791705">32</span><span class="op" id="7791707">,</span>&nbsp;<span class="ident" id="7791709">rand</span><span class="op" id="7791713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791716">m</span><span class="op" id="7791717">.</span><span class="ident" id="7791718">sessionId</span>&nbsp;<span class="op" id="7791728">=</span>&nbsp;<span class="ident" id="7791730">randomBytes</span><span class="op" id="7791741">(</span><span class="ident" id="7791742">rand</span><span class="op" id="7791746">.</span><span class="ident" id="7791747">Intn</span><span class="op" id="7791751">(</span><span class="num" id="7791752">32</span><span class="op" id="7791754">)</span><span class="op" id="7791755">,</span>&nbsp;<span class="ident" id="7791757">rand</span><span class="op" id="7791761">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791764">m</span><span class="op" id="7791765">.</span><span class="ident" id="7791766">cipherSuites</span>&nbsp;<span class="op" id="7791779">=</span>&nbsp;<span class="builtinfunc" id="7791781">make</span><span class="op" id="7791785">(</span><span class="op" id="7791786">[</span><span class="op" id="7791787">]</span><span class="builtintype" id="7791788">uint16</span><span class="op" id="7791794">,</span>&nbsp;<span class="ident" id="7791796">rand</span><span class="op" id="7791800">.</span><span class="ident" id="7791801">Intn</span><span class="op" id="7791805">(</span><span class="num" id="7791806">63</span><span class="op" id="7791808">)</span><span class="op" id="7791809">+</span><span class="num" id="7791810">1</span><span class="op" id="7791811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7791814">for</span>&nbsp;<span class="ident" id="7791818">i</span>&nbsp;<span class="op" id="7791820">:=</span>&nbsp;<span class="num" id="7791823">0</span><span class="op" id="7791824">;</span>&nbsp;<span class="ident" id="7791826">i</span>&nbsp;<span class="op" id="7791828">&lt;</span>&nbsp;<span class="builtinfunc" id="7791830">len</span><span class="op" id="7791833">(</span><span class="ident" id="7791834">m</span><span class="op" id="7791835">.</span><span class="ident" id="7791836">cipherSuites</span><span class="op" id="7791848">)</span><span class="op" id="7791849">;</span>&nbsp;<span class="ident" id="7791851">i</span><span class="op" id="7791852">++</span>&nbsp;<span class="op" id="7791855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791859">m</span><span class="op" id="7791860">.</span><span class="ident" id="7791861">cipherSuites</span><span class="op" id="7791873">[</span><span class="ident" id="7791874">i</span><span class="op" id="7791875">]</span>&nbsp;<span class="op" id="7791877">=</span>&nbsp;<span class="builtintype" id="7791879">uint16</span><span class="op" id="7791885">(</span><span class="ident" id="7791886">rand</span><span class="op" id="7791890">.</span><span class="ident" id="7791891">Int31</span><span class="op" id="7791896">(</span><span class="op" id="7791897">)</span><span class="op" id="7791898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7791901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791904">m</span><span class="op" id="7791905">.</span><span class="ident" id="7791906">compressionMethods</span>&nbsp;<span class="op" id="7791925">=</span>&nbsp;<span class="ident" id="7791927">randomBytes</span><span class="op" id="7791938">(</span><span class="ident" id="7791939">rand</span><span class="op" id="7791943">.</span><span class="ident" id="7791944">Intn</span><span class="op" id="7791948">(</span><span class="num" id="7791949">63</span><span class="op" id="7791951">)</span><span class="op" id="7791952">+</span><span class="num" id="7791953">1</span><span class="op" id="7791954">,</span>&nbsp;<span class="ident" id="7791956">rand</span><span class="op" id="7791960">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7791963">if</span>&nbsp;<span class="ident" id="7791966">rand</span><span class="op" id="7791970">.</span><span class="ident" id="7791971">Intn</span><span class="op" id="7791975">(</span><span class="num" id="7791976">10</span><span class="op" id="7791978">)</span>&nbsp;<span class="op" id="7791980">&gt;</span>&nbsp;<span class="num" id="7791982">5</span>&nbsp;<span class="op" id="7791984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791988">m</span><span class="op" id="7791989">.</span><span class="ident" id="7791990">nextProtoNeg</span>&nbsp;<span class="op" id="7792003">=</span>&nbsp;<span class="builtintype" id="7792005">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7792011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7792014">if</span>&nbsp;<span class="ident" id="7792017">rand</span><span class="op" id="7792021">.</span><span class="ident" id="7792022">Intn</span><span class="op" id="7792026">(</span><span class="num" id="7792027">10</span><span class="op" id="7792029">)</span>&nbsp;<span class="op" id="7792031">&gt;</span>&nbsp;<span class="num" id="7792033">5</span>&nbsp;<span class="op" id="7792035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792039">m</span><span class="op" id="7792040">.</span><span class="ident" id="7792041">serverName</span>&nbsp;<span class="op" id="7792052">=</span>&nbsp;<span class="ident" id="7792054">randomString</span><span class="op" id="7792066">(</span><span class="ident" id="7792067">rand</span><span class="op" id="7792071">.</span><span class="ident" id="7792072">Intn</span><span class="op" id="7792076">(</span><span class="num" id="7792077">255</span><span class="op" id="7792080">)</span><span class="op" id="7792081">,</span>&nbsp;<span class="ident" id="7792083">rand</span><span class="op" id="7792087">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7792090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792093">m</span><span class="op" id="7792094">.</span><span class="ident" id="7792095">ocspStapling</span>&nbsp;<span class="op" id="7792108">=</span>&nbsp;<span class="ident" id="7792110">rand</span><span class="op" id="7792114">.</span><span class="ident" id="7792115">Intn</span><span class="op" id="7792119">(</span><span class="num" id="7792120">10</span><span class="op" id="7792122">)</span>&nbsp;<span class="op" id="7792124">&gt;</span>&nbsp;<span class="num" id="7792126">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792129">m</span><span class="op" id="7792130">.</span><span class="ident" id="7792131">supportedPoints</span>&nbsp;<span class="op" id="7792147">=</span>&nbsp;<span class="ident" id="7792149">randomBytes</span><span class="op" id="7792160">(</span><span class="ident" id="7792161">rand</span><span class="op" id="7792165">.</span><span class="ident" id="7792166">Intn</span><span class="op" id="7792170">(</span><span class="num" id="7792171">5</span><span class="op" id="7792172">)</span><span class="op" id="7792173">+</span><span class="num" id="7792174">1</span><span class="op" id="7792175">,</span>&nbsp;<span class="ident" id="7792177">rand</span><span class="op" id="7792181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792184">m</span><span class="op" id="7792185">.</span><span class="ident" id="7792186">supportedCurves</span>&nbsp;<span class="op" id="7792202">=</span>&nbsp;<span class="builtinfunc" id="7792204">make</span><span class="op" id="7792208">(</span><span class="op" id="7792209">[</span><span class="op" id="7792210">]</span><span class="ident" id="7792211">CurveID</span><span class="op" id="7792218">,</span>&nbsp;<span class="ident" id="7792220">rand</span><span class="op" id="7792224">.</span><span class="ident" id="7792225">Intn</span><span class="op" id="7792229">(</span><span class="num" id="7792230">5</span><span class="op" id="7792231">)</span><span class="op" id="7792232">+</span><span class="num" id="7792233">1</span><span class="op" id="7792234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7792237">for</span>&nbsp;<span class="ident" id="7792241">i</span>&nbsp;<span class="op" id="7792243">:=</span>&nbsp;<span class="keyword" id="7792246">range</span>&nbsp;<span class="ident" id="7792252">m</span><span class="op" id="7792253">.</span><span class="ident" id="7792254">supportedCurves</span>&nbsp;<span class="op" id="7792270">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792274">m</span><span class="op" id="7792275">.</span><span class="ident" id="7792276">supportedCurves</span><span class="op" id="7792291">[</span><span class="ident" id="7792292">i</span><span class="op" id="7792293">]</span>&nbsp;<span class="op" id="7792295">=</span>&nbsp;<span class="ident" id="7792297">CurveID</span><span class="op" id="7792304">(</span><span class="ident" id="7792305">rand</span><span class="op" id="7792309">.</span><span class="ident" id="7792310">Intn</span><span class="op" id="7792314">(</span><span class="num" id="7792315">30000</span><span class="op" id="7792320">)</span><span class="op" id="7792321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7792324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7792327">if</span>&nbsp;<span class="ident" id="7792330">rand</span><span class="op" id="7792334">.</span><span class="ident" id="7792335">Intn</span><span class="op" id="7792339">(</span><span class="num" id="7792340">10</span><span class="op" id="7792342">)</span>&nbsp;<span class="op" id="7792344">&gt;</span>&nbsp;<span class="num" id="7792346">5</span>&nbsp;<span class="op" id="7792348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792352">m</span><span class="op" id="7792353">.</span><span class="ident" id="7792354">ticketSupported</span>&nbsp;<span class="op" id="7792370">=</span>&nbsp;<span class="builtintype" id="7792372">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7792379">if</span>&nbsp;<span class="ident" id="7792382">rand</span><span class="op" id="7792386">.</span><span class="ident" id="7792387">Intn</span><span class="op" id="7792391">(</span><span class="num" id="7792392">10</span><span class="op" id="7792394">)</span>&nbsp;<span class="op" id="7792396">&gt;</span>&nbsp;<span class="num" id="7792398">5</span>&nbsp;<span class="op" id="7792400">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792405">m</span><span class="op" id="7792406">.</span><span class="ident" id="7792407">sessionTicket</span>&nbsp;<span class="op" id="7792421">=</span>&nbsp;<span class="ident" id="7792423">randomBytes</span><span class="op" id="7792434">(</span><span class="ident" id="7792435">rand</span><span class="op" id="7792439">.</span><span class="ident" id="7792440">Intn</span><span class="op" id="7792444">(</span><span class="num" id="7792445">300</span><span class="op" id="7792448">)</span><span class="op" id="7792449">,</span>&nbsp;<span class="ident" id="7792451">rand</span><span class="op" id="7792455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7792459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7792462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7792465">if</span>&nbsp;<span class="ident" id="7792468">rand</span><span class="op" id="7792472">.</span><span class="ident" id="7792473">Intn</span><span class="op" id="7792477">(</span><span class="num" id="7792478">10</span><span class="op" id="7792480">)</span>&nbsp;<span class="op" id="7792482">&gt;</span>&nbsp;<span class="num" id="7792484">5</span>&nbsp;<span class="op" id="7792486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792490">m</span><span class="op" id="7792491">.</span><span class="ident" id="7792492">signatureAndHashes</span>&nbsp;<span class="op" id="7792511">=</span>&nbsp;<span class="ident" id="7792513">supportedSKXSignatureAlgorithms</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7792546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792549">m</span><span class="op" id="7792550">.</span><span class="ident" id="7792551">alpnProtocols</span>&nbsp;<span class="op" id="7792565">=</span>&nbsp;<span class="builtinfunc" id="7792567">make</span><span class="op" id="7792571">(</span><span class="op" id="7792572">[</span><span class="op" id="7792573">]</span><span class="builtintype" id="7792574">string</span><span class="op" id="7792580">,</span>&nbsp;<span class="ident" id="7792582">rand</span><span class="op" id="7792586">.</span><span class="ident" id="7792587">Intn</span><span class="op" id="7792591">(</span><span class="num" id="7792592">5</span><span class="op" id="7792593">)</span><span class="op" id="7792594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7792597">for</span>&nbsp;<span class="ident" id="7792601">i</span>&nbsp;<span class="op" id="7792603">:=</span>&nbsp;<span class="keyword" id="7792606">range</span>&nbsp;<span class="ident" id="7792612">m</span><span class="op" id="7792613">.</span><span class="ident" id="7792614">alpnProtocols</span>&nbsp;<span class="op" id="7792628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792632">m</span><span class="op" id="7792633">.</span><span class="ident" id="7792634">alpnProtocols</span><span class="op" id="7792647">[</span><span class="ident" id="7792648">i</span><span class="op" id="7792649">]</span>&nbsp;<span class="op" id="7792651">=</span>&nbsp;<span class="ident" id="7792653">randomString</span><span class="op" id="7792665">(</span><span class="ident" id="7792666">rand</span><span class="op" id="7792670">.</span><span class="ident" id="7792671">Intn</span><span class="op" id="7792675">(</span><span class="num" id="7792676">20</span><span class="op" id="7792678">)</span><span class="op" id="7792679">+</span><span class="num" id="7792680">1</span><span class="op" id="7792681">,</span>&nbsp;<span class="ident" id="7792683">rand</span><span class="op" id="7792687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7792690">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7792694">return</span>&nbsp;<span class="ident" id="7792701">reflect</span><span class="op" id="7792708">.</span><span class="ident" id="7792709">ValueOf</span><span class="op" id="7792716">(</span><span class="ident" id="7792717">m</span><span class="op" id="7792718">)</span><br>
<span class="lineno"></span><span class="op" id="7792720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7792723">func</span>&nbsp;<span class="op" id="7792728">(</span><span class="op" id="7792729">*</span><span class="ident" id="7792730">serverHelloMsg</span><span class="op" id="7792744">)</span>&nbsp;<span class="ident" id="7792746">Generate</span><span class="op" id="7792754">(</span><span class="ident" id="7792755">rand</span>&nbsp;<span class="op" id="7792760">*</span><span class="ident" id="7792761">rand</span><span class="op" id="7792765">.</span><span class="ident" id="7792766">Rand</span><span class="op" id="7792770">,</span>&nbsp;<span class="ident" id="7792772">size</span>&nbsp;<span class="builtintype" id="7792777">int</span><span class="op" id="7792780">)</span>&nbsp;<span class="ident" id="7792782">reflect</span><span class="op" id="7792789">.</span><span class="ident" id="7792790">Value</span>&nbsp;<span class="op" id="7792796">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792799">m</span>&nbsp;<span class="op" id="7792801">:=</span>&nbsp;<span class="op" id="7792804">&amp;</span><span class="ident" id="7792805">serverHelloMsg</span><span class="op" id="7792819">{</span><span class="op" id="7792820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792823">m</span><span class="op" id="7792824">.</span><span class="ident" id="7792825">vers</span>&nbsp;<span class="op" id="7792830">=</span>&nbsp;<span class="builtintype" id="7792832">uint16</span><span class="op" id="7792838">(</span><span class="ident" id="7792839">rand</span><span class="op" id="7792843">.</span><span class="ident" id="7792844">Intn</span><span class="op" id="7792848">(</span><span class="num" id="7792849">65536</span><span class="op" id="7792854">)</span><span class="op" id="7792855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792858">m</span><span class="op" id="7792859">.</span><span class="ident" id="7792860">random</span>&nbsp;<span class="op" id="7792867">=</span>&nbsp;<span class="ident" id="7792869">randomBytes</span><span class="op" id="7792880">(</span><span class="num" id="7792881">32</span><span class="op" id="7792883">,</span>&nbsp;<span class="ident" id="7792885">rand</span><span class="op" id="7792889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792892">m</span><span class="op" id="7792893">.</span><span class="ident" id="7792894">sessionId</span>&nbsp;<span class="op" id="7792904">=</span>&nbsp;<span class="ident" id="7792906">randomBytes</span><span class="op" id="7792917">(</span><span class="ident" id="7792918">rand</span><span class="op" id="7792922">.</span><span class="ident" id="7792923">Intn</span><span class="op" id="7792927">(</span><span class="num" id="7792928">32</span><span class="op" id="7792930">)</span><span class="op" id="7792931">,</span>&nbsp;<span class="ident" id="7792933">rand</span><span class="op" id="7792937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792940">m</span><span class="op" id="7792941">.</span><span class="ident" id="7792942">cipherSuite</span>&nbsp;<span class="op" id="7792954">=</span>&nbsp;<span class="builtintype" id="7792956">uint16</span><span class="op" id="7792962">(</span><span class="ident" id="7792963">rand</span><span class="op" id="7792967">.</span><span class="ident" id="7792968">Int31</span><span class="op" id="7792973">(</span><span class="op" id="7792974">)</span><span class="op" id="7792975">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792978">m</span><span class="op" id="7792979">.</span><span class="ident" id="7792980">compressionMethod</span>&nbsp;<span class="op" id="7792998">=</span>&nbsp;<span class="builtintype" id="7793000">uint8</span><span class="op" id="7793005">(</span><span class="ident" id="7793006">rand</span><span class="op" id="7793010">.</span><span class="ident" id="7793011">Intn</span><span class="op" id="7793015">(</span><span class="num" id="7793016">256</span><span class="op" id="7793019">)</span><span class="op" id="7793020">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7793024">if</span>&nbsp;<span class="ident" id="7793027">rand</span><span class="op" id="7793031">.</span><span class="ident" id="7793032">Intn</span><span class="op" id="7793036">(</span><span class="num" id="7793037">10</span><span class="op" id="7793039">)</span>&nbsp;<span class="op" id="7793041">&gt;</span>&nbsp;<span class="num" id="7793043">5</span>&nbsp;<span class="op" id="7793045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793049">m</span><span class="op" id="7793050">.</span><span class="ident" id="7793051">nextProtoNeg</span>&nbsp;<span class="op" id="7793064">=</span>&nbsp;<span class="builtintype" id="7793066">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793074">n</span>&nbsp;<span class="op" id="7793076">:=</span>&nbsp;<span class="ident" id="7793079">rand</span><span class="op" id="7793083">.</span><span class="ident" id="7793084">Intn</span><span class="op" id="7793088">(</span><span class="num" id="7793089">10</span><span class="op" id="7793091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793095">m</span><span class="op" id="7793096">.</span><span class="ident" id="7793097">nextProtos</span>&nbsp;<span class="op" id="7793108">=</span>&nbsp;<span class="builtinfunc" id="7793110">make</span><span class="op" id="7793114">(</span><span class="op" id="7793115">[</span><span class="op" id="7793116">]</span><span class="builtintype" id="7793117">string</span><span class="op" id="7793123">,</span>&nbsp;<span class="ident" id="7793125">n</span><span class="op" id="7793126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7793130">for</span>&nbsp;<span class="ident" id="7793134">i</span>&nbsp;<span class="op" id="7793136">:=</span>&nbsp;<span class="num" id="7793139">0</span><span class="op" id="7793140">;</span>&nbsp;<span class="ident" id="7793142">i</span>&nbsp;<span class="op" id="7793144">&lt;</span>&nbsp;<span class="ident" id="7793146">n</span><span class="op" id="7793147">;</span>&nbsp;<span class="ident" id="7793149">i</span><span class="op" id="7793150">++</span>&nbsp;<span class="op" id="7793153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793158">m</span><span class="op" id="7793159">.</span><span class="ident" id="7793160">nextProtos</span><span class="op" id="7793170">[</span><span class="ident" id="7793171">i</span><span class="op" id="7793172">]</span>&nbsp;<span class="op" id="7793174">=</span>&nbsp;<span class="ident" id="7793176">randomString</span><span class="op" id="7793188">(</span><span class="num" id="7793189">20</span><span class="op" id="7793191">,</span>&nbsp;<span class="ident" id="7793193">rand</span><span class="op" id="7793197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7793201">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7793204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7793208">if</span>&nbsp;<span class="ident" id="7793211">rand</span><span class="op" id="7793215">.</span><span class="ident" id="7793216">Intn</span><span class="op" id="7793220">(</span><span class="num" id="7793221">10</span><span class="op" id="7793223">)</span>&nbsp;<span class="op" id="7793225">&gt;</span>&nbsp;<span class="num" id="7793227">5</span>&nbsp;<span class="op" id="7793229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793233">m</span><span class="op" id="7793234">.</span><span class="ident" id="7793235">ocspStapling</span>&nbsp;<span class="op" id="7793248">=</span>&nbsp;<span class="builtintype" id="7793250">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7793256">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7793259">if</span>&nbsp;<span class="ident" id="7793262">rand</span><span class="op" id="7793266">.</span><span class="ident" id="7793267">Intn</span><span class="op" id="7793271">(</span><span class="num" id="7793272">10</span><span class="op" id="7793274">)</span>&nbsp;<span class="op" id="7793276">&gt;</span>&nbsp;<span class="num" id="7793278">5</span>&nbsp;<span class="op" id="7793280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793284">m</span><span class="op" id="7793285">.</span><span class="ident" id="7793286">ticketSupported</span>&nbsp;<span class="op" id="7793302">=</span>&nbsp;<span class="builtintype" id="7793304">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7793310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793313">m</span><span class="op" id="7793314">.</span><span class="ident" id="7793315">alpnProtocol</span>&nbsp;<span class="op" id="7793328">=</span>&nbsp;<span class="ident" id="7793330">randomString</span><span class="op" id="7793342">(</span><span class="ident" id="7793343">rand</span><span class="op" id="7793347">.</span><span class="ident" id="7793348">Intn</span><span class="op" id="7793352">(</span><span class="num" id="7793353">32</span><span class="op" id="7793355">)</span><span class="op" id="7793356">+</span><span class="num" id="7793357">1</span><span class="op" id="7793358">,</span>&nbsp;<span class="ident" id="7793360">rand</span><span class="op" id="7793364">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7793368">return</span>&nbsp;<span class="ident" id="7793375">reflect</span><span class="op" id="7793382">.</span><span class="ident" id="7793383">ValueOf</span><span class="op" id="7793390">(</span><span class="ident" id="7793391">m</span><span class="op" id="7793392">)</span><br>
<span class="lineno"></span><span class="op" id="7793394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7793397">func</span>&nbsp;<span class="op" id="7793402">(</span><span class="op" id="7793403">*</span><span class="ident" id="7793404">certificateMsg</span><span class="op" id="7793418">)</span>&nbsp;<span class="ident" id="7793420">Generate</span><span class="op" id="7793428">(</span><span class="ident" id="7793429">rand</span>&nbsp;<span class="op" id="7793434">*</span><span class="ident" id="7793435">rand</span><span class="op" id="7793439">.</span><span class="ident" id="7793440">Rand</span><span class="op" id="7793444">,</span>&nbsp;<span class="ident" id="7793446">size</span>&nbsp;<span class="builtintype" id="7793451">int</span><span class="op" id="7793454">)</span>&nbsp;<span class="ident" id="7793456">reflect</span><span class="op" id="7793463">.</span><span class="ident" id="7793464">Value</span>&nbsp;<span class="op" id="7793470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793473">m</span>&nbsp;<span class="op" id="7793475">:=</span>&nbsp;<span class="op" id="7793478">&amp;</span><span class="ident" id="7793479">certificateMsg</span><span class="op" id="7793493">{</span><span class="op" id="7793494">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793497">numCerts</span>&nbsp;<span class="op" id="7793506">:=</span>&nbsp;<span class="ident" id="7793509">rand</span><span class="op" id="7793513">.</span><span class="ident" id="7793514">Intn</span><span class="op" id="7793518">(</span><span class="num" id="7793519">20</span><span class="op" id="7793521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793524">m</span><span class="op" id="7793525">.</span><span class="ident" id="7793526">certificates</span>&nbsp;<span class="op" id="7793539">=</span>&nbsp;<span class="builtinfunc" id="7793541">make</span><span class="op" id="7793545">(</span><span class="op" id="7793546">[</span><span class="op" id="7793547">]</span><span class="op" id="7793548">[</span><span class="op" id="7793549">]</span><span class="builtintype" id="7793550">byte</span><span class="op" id="7793554">,</span>&nbsp;<span class="ident" id="7793556">numCerts</span><span class="op" id="7793564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7793567">for</span>&nbsp;<span class="ident" id="7793571">i</span>&nbsp;<span class="op" id="7793573">:=</span>&nbsp;<span class="num" id="7793576">0</span><span class="op" id="7793577">;</span>&nbsp;<span class="ident" id="7793579">i</span>&nbsp;<span class="op" id="7793581">&lt;</span>&nbsp;<span class="ident" id="7793583">numCerts</span><span class="op" id="7793591">;</span>&nbsp;<span class="ident" id="7793593">i</span><span class="op" id="7793594">++</span>&nbsp;<span class="op" id="7793597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793601">m</span><span class="op" id="7793602">.</span><span class="ident" id="7793603">certificates</span><span class="op" id="7793615">[</span><span class="ident" id="7793616">i</span><span class="op" id="7793617">]</span>&nbsp;<span class="op" id="7793619">=</span>&nbsp;<span class="ident" id="7793621">randomBytes</span><span class="op" id="7793632">(</span><span class="ident" id="7793633">rand</span><span class="op" id="7793637">.</span><span class="ident" id="7793638">Intn</span><span class="op" id="7793642">(</span><span class="num" id="7793643">10</span><span class="op" id="7793645">)</span><span class="op" id="7793646">+</span><span class="num" id="7793647">1</span><span class="op" id="7793648">,</span>&nbsp;<span class="ident" id="7793650">rand</span><span class="op" id="7793654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7793657">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7793660">return</span>&nbsp;<span class="ident" id="7793667">reflect</span><span class="op" id="7793674">.</span><span class="ident" id="7793675">ValueOf</span><span class="op" id="7793682">(</span><span class="ident" id="7793683">m</span><span class="op" id="7793684">)</span><br>
<span class="lineno"></span><span class="op" id="7793686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7793689">func</span>&nbsp;<span class="op" id="7793694">(</span><span class="op" id="7793695">*</span><span class="ident" id="7793696">certificateRequestMsg</span><span class="op" id="7793717">)</span>&nbsp;<span class="ident" id="7793719">Generate</span><span class="op" id="7793727">(</span><span class="ident" id="7793728">rand</span>&nbsp;<span class="op" id="7793733">*</span><span class="ident" id="7793734">rand</span><span class="op" id="7793738">.</span><span class="ident" id="7793739">Rand</span><span class="op" id="7793743">,</span>&nbsp;<span class="ident" id="7793745">size</span>&nbsp;<span class="builtintype" id="7793750">int</span><span class="op" id="7793753">)</span>&nbsp;<span class="ident" id="7793755">reflect</span><span class="op" id="7793762">.</span><span class="ident" id="7793763">Value</span>&nbsp;<span class="op" id="7793769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793772">m</span>&nbsp;<span class="op" id="7793774">:=</span>&nbsp;<span class="op" id="7793777">&amp;</span><span class="ident" id="7793778">certificateRequestMsg</span><span class="op" id="7793799">{</span><span class="op" id="7793800">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793803">m</span><span class="op" id="7793804">.</span><span class="ident" id="7793805">certificateTypes</span>&nbsp;<span class="op" id="7793822">=</span>&nbsp;<span class="ident" id="7793824">randomBytes</span><span class="op" id="7793835">(</span><span class="ident" id="7793836">rand</span><span class="op" id="7793840">.</span><span class="ident" id="7793841">Intn</span><span class="op" id="7793845">(</span><span class="num" id="7793846">5</span><span class="op" id="7793847">)</span><span class="op" id="7793848">+</span><span class="num" id="7793849">1</span><span class="op" id="7793850">,</span>&nbsp;<span class="ident" id="7793852">rand</span><span class="op" id="7793856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793859">numCAs</span>&nbsp;<span class="op" id="7793866">:=</span>&nbsp;<span class="ident" id="7793869">rand</span><span class="op" id="7793873">.</span><span class="ident" id="7793874">Intn</span><span class="op" id="7793878">(</span><span class="num" id="7793879">100</span><span class="op" id="7793882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793885">m</span><span class="op" id="7793886">.</span><span class="ident" id="7793887">certificateAuthorities</span>&nbsp;<span class="op" id="7793910">=</span>&nbsp;<span class="builtinfunc" id="7793912">make</span><span class="op" id="7793916">(</span><span class="op" id="7793917">[</span><span class="op" id="7793918">]</span><span class="op" id="7793919">[</span><span class="op" id="7793920">]</span><span class="builtintype" id="7793921">byte</span><span class="op" id="7793925">,</span>&nbsp;<span class="ident" id="7793927">numCAs</span><span class="op" id="7793933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7793936">for</span>&nbsp;<span class="ident" id="7793940">i</span>&nbsp;<span class="op" id="7793942">:=</span>&nbsp;<span class="num" id="7793945">0</span><span class="op" id="7793946">;</span>&nbsp;<span class="ident" id="7793948">i</span>&nbsp;<span class="op" id="7793950">&lt;</span>&nbsp;<span class="ident" id="7793952">numCAs</span><span class="op" id="7793958">;</span>&nbsp;<span class="ident" id="7793960">i</span><span class="op" id="7793961">++</span>&nbsp;<span class="op" id="7793964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793968">m</span><span class="op" id="7793969">.</span><span class="ident" id="7793970">certificateAuthorities</span><span class="op" id="7793992">[</span><span class="ident" id="7793993">i</span><span class="op" id="7793994">]</span>&nbsp;<span class="op" id="7793996">=</span>&nbsp;<span class="ident" id="7793998">randomBytes</span><span class="op" id="7794009">(</span><span class="ident" id="7794010">rand</span><span class="op" id="7794014">.</span><span class="ident" id="7794015">Intn</span><span class="op" id="7794019">(</span><span class="num" id="7794020">15</span><span class="op" id="7794022">)</span><span class="op" id="7794023">+</span><span class="num" id="7794024">1</span><span class="op" id="7794025">,</span>&nbsp;<span class="ident" id="7794027">rand</span><span class="op" id="7794031">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7794034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7794037">return</span>&nbsp;<span class="ident" id="7794044">reflect</span><span class="op" id="7794051">.</span><span class="ident" id="7794052">ValueOf</span><span class="op" id="7794059">(</span><span class="ident" id="7794060">m</span><span class="op" id="7794061">)</span><br>
<span class="lineno"></span><span class="op" id="7794063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7794066">func</span>&nbsp;<span class="op" id="7794071">(</span><span class="op" id="7794072">*</span><span class="ident" id="7794073">certificateVerifyMsg</span><span class="op" id="7794093">)</span>&nbsp;<span class="ident" id="7794095">Generate</span><span class="op" id="7794103">(</span><span class="ident" id="7794104">rand</span>&nbsp;<span class="op" id="7794109">*</span><span class="ident" id="7794110">rand</span><span class="op" id="7794114">.</span><span class="ident" id="7794115">Rand</span><span class="op" id="7794119">,</span>&nbsp;<span class="ident" id="7794121">size</span>&nbsp;<span class="builtintype" id="7794126">int</span><span class="op" id="7794129">)</span>&nbsp;<span class="ident" id="7794131">reflect</span><span class="op" id="7794138">.</span><span class="ident" id="7794139">Value</span>&nbsp;<span class="op" id="7794145">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7794148">m</span>&nbsp;<span class="op" id="7794150">:=</span>&nbsp;<span class="op" id="7794153">&amp;</span><span class="ident" id="7794154">certificateVerifyMsg</span><span class="op" id="7794174">{</span><span class="op" id="7794175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7794178">m</span><span class="op" id="7794179">.</span><span class="ident" id="7794180">signature</span>&nbsp;<span class="op" id="7794190">=</span>&nbsp;<span class="ident" id="7794192">randomBytes</span><span class="op" id="7794203">(</span><span class="ident" id="7794204">rand</span><span class="op" id="7794208">.</span><span class="ident" id="7794209">Intn</span><span class="op" id="7794213">(</span><span class="num" id="7794214">15</span><span class="op" id="7794216">)</span><span class="op" id="7794217">+</span><span class="num" id="7794218">1</span><span class="op" id="7794219">,</span>&nbsp;<span class="ident" id="7794221">rand</span><span class="op" id="7794225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7794228">return</span>&nbsp;<span class="ident" id="7794235">reflect</span><span class="op" id="7794242">.</span><span class="ident" id="7794243">ValueOf</span><span class="op" id="7794250">(</span><span class="ident" id="7794251">m</span><span class="op" id="7794252">)</span><br>
<span class="lineno"></span><span class="op" id="7794254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="keyword" id="7794257">func</span>&nbsp;<span class="op" id="7794262">(</span><span class="op" id="7794263">*</span><span class="ident" id="7794264">certificateStatusMsg</span><span class="op" id="7794284">)</span>&nbsp;<span class="ident" id="7794286">Generate</span><span class="op" id="7794294">(</span><span class="ident" id="7794295">rand</span>&nbsp;<span class="op" id="7794300">*</span><span class="ident" id="7794301">rand</span><span class="op" id="7794305">.</span><span class="ident" id="7794306">Rand</span><span class="op" id="7794310">,</span>&nbsp;<span class="ident" id="7794312">size</span>&nbsp;<span class="builtintype" id="7794317">int</span><span class="op" id="7794320">)</span>&nbsp;<span class="ident" id="7794322">reflect</span><span class="op" id="7794329">.</span><span class="ident" id="7794330">Value</span>&nbsp;<span class="op" id="7794336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7794339">m</span>&nbsp;<span class="op" id="7794341">:=</span>&nbsp;<span class="op" id="7794344">&amp;</span><span class="ident" id="7794345">certificateStatusMsg</span><span class="op" id="7794365">{</span><span class="op" id="7794366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7794369">if</span>&nbsp;<span class="ident" id="7794372">rand</span><span class="op" id="7794376">.</span><span class="ident" id="7794377">Intn</span><span class="op" id="7794381">(</span><span class="num" id="7794382">10</span><span class="op" id="7794384">)</span>&nbsp;<span class="op" id="7794386">&gt;</span>&nbsp;<span class="num" id="7794388">5</span>&nbsp;<span class="op" id="7794390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7794394">m</span><span class="op" id="7794395">.</span><span class="ident" id="7794396">statusType</span>&nbsp;<span class="op" id="7794407">=</span>&nbsp;<span class="ident" id="7794409">statusTypeOCSP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7794426">m</span><span class="op" id="7794427">.</span><span class="ident" id="7794428">response</span>&nbsp;<span class="op" id="7794437">=</span>&nbsp;<span class="ident" id="7794439">randomBytes</span><span class="op" id="7794450">(</span><span class="ident" id="7794451">rand</span><span class="op" id="7794455">.</span><span class="ident" id="7794456">Intn</span><span class="op" id="7794460">(</span><span class="num" id="7794461">10</span><span class="op" id="7794463">)</span><span class="op" id="7794464">+</span><span class="num" id="7794465">1</span><span class="op" id="7794466">,</span>&nbsp;<span class="ident" id="7794468">rand</span><span class="op" id="7794472">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7794475">}</span>&nbsp;<span class="keyword" id="7794477">else</span>&nbsp;<span class="op" id="7794482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7794486">m</span><span class="op" id="7794487">.</span><span class="ident" id="7794488">statusType</span>&nbsp;<span class="op" id="7794499">=</span>&nbsp;<span class="num" id="7794501">42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7794505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7794508">return</span>&nbsp;<span class="ident" id="7794515">reflect</span><span class="op" id="7794522">.</span><span class="ident" id="7794523">ValueOf</span><span class="op" id="7794530">(</span><span class="ident" id="7794531">m</span><span class="op" id="7794532">)</span><br>
<span class="lineno"></span><span class="op" id="7794534">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="7794537">func</span>&nbsp;<span class="op" id="7794542">(</span><span class="op" id="7794543">*</span><span class="ident" id="7794544">clientKeyExchangeMsg</span><span class="op" id="7794564">)</span>&nbsp;<span class="ident" id="7794566">Generate</span><span class="op" id="7794574">(</span><span class="ident" id="7794575">rand</span>&nbsp;<span class="op" id="7794580">*</span><span class="ident" id="7794581">rand</span><span class="op" id="7794585">.</span><span class="ident" id="7794586">Rand</span><span class="op" id="7794590">,</span>&nbsp;<span class="ident" id="7794592">size</span>&nbsp;<span class="builtintype" id="7794597">int</span><span class="op" id="7794600">)</span>&nbsp;<span class="ident" id="7794602">reflect</span><span class="op" id="7794609">.</span><span class="ident" id="7794610">Value</span>&nbsp;<span class="op" id="7794616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7794619">m</span>&nbsp;<span class="op" id="7794621">:=</span>&nbsp;<span class="op" id="7794624">&amp;</span><span class="ident" id="7794625">clientKeyExchangeMsg</span><span class="op" id="7794645">{</span><span class="op" id="7794646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7794649">m</span><span class="op" id="7794650">.</span><span class="ident" id="7794651">ciphertext</span>&nbsp;<span class="op" id="7794662">=</span>&nbsp;<span class="ident" id="7794664">randomBytes</span><span class="op" id="7794675">(</span><span class="ident" id="7794676">rand</span><span class="op" id="7794680">.</span><span class="ident" id="7794681">Intn</span><span class="op" id="7794685">(</span><span class="num" id="7794686">1000</span><span class="op" id="7794690">)</span><span class="op" id="7794691">+</span><span class="num" id="7794692">1</span><span class="op" id="7794693">,</span>&nbsp;<span class="ident" id="7794695">rand</span><span class="op" id="7794699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7794702">return</span>&nbsp;<span class="ident" id="7794709">reflect</span><span class="op" id="7794716">.</span><span class="ident" id="7794717">ValueOf</span><span class="op" id="7794724">(</span><span class="ident" id="7794725">m</span><span class="op" id="7794726">)</span><br>
<span class="lineno">220</span><span class="op" id="7794728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7794731">func</span>&nbsp;<span class="op" id="7794736">(</span><span class="op" id="7794737">*</span><span class="ident" id="7794738">finishedMsg</span><span class="op" id="7794749">)</span>&nbsp;<span class="ident" id="7794751">Generate</span><span class="op" id="7794759">(</span><span class="ident" id="7794760">rand</span>&nbsp;<span class="op" id="7794765">*</span><span class="ident" id="7794766">rand</span><span class="op" id="7794770">.</span><span class="ident" id="7794771">Rand</span><span class="op" id="7794775">,</span>&nbsp;<span class="ident" id="7794777">size</span>&nbsp;<span class="builtintype" id="7794782">int</span><span class="op" id="7794785">)</span>&nbsp;<span class="ident" id="7794787">reflect</span><span class="op" id="7794794">.</span><span class="ident" id="7794795">Value</span>&nbsp;<span class="op" id="7794801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7794804">m</span>&nbsp;<span class="op" id="7794806">:=</span>&nbsp;<span class="op" id="7794809">&amp;</span><span class="ident" id="7794810">finishedMsg</span><span class="op" id="7794821">{</span><span class="op" id="7794822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7794825">m</span><span class="op" id="7794826">.</span><span class="ident" id="7794827">verifyData</span>&nbsp;<span class="op" id="7794838">=</span>&nbsp;<span class="ident" id="7794840">randomBytes</span><span class="op" id="7794851">(</span><span class="num" id="7794852">12</span><span class="op" id="7794854">,</span>&nbsp;<span class="ident" id="7794856">rand</span><span class="op" id="7794860">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7794863">return</span>&nbsp;<span class="ident" id="7794870">reflect</span><span class="op" id="7794877">.</span><span class="ident" id="7794878">ValueOf</span><span class="op" id="7794885">(</span><span class="ident" id="7794886">m</span><span class="op" id="7794887">)</span><br>
<span class="lineno"></span><span class="op" id="7794889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7794892">func</span>&nbsp;<span class="op" id="7794897">(</span><span class="op" id="7794898">*</span><span class="ident" id="7794899">nextProtoMsg</span><span class="op" id="7794911">)</span>&nbsp;<span class="ident" id="7794913">Generate</span><span class="op" id="7794921">(</span><span class="ident" id="7794922">rand</span>&nbsp;<span class="op" id="7794927">*</span><span class="ident" id="7794928">rand</span><span class="op" id="7794932">.</span><span class="ident" id="7794933">Rand</span><span class="op" id="7794937">,</span>&nbsp;<span class="ident" id="7794939">size</span>&nbsp;<span class="builtintype" id="7794944">int</span><span class="op" id="7794947">)</span>&nbsp;<span class="ident" id="7794949">reflect</span><span class="op" id="7794956">.</span><span class="ident" id="7794957">Value</span>&nbsp;<span class="op" id="7794963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7794966">m</span>&nbsp;<span class="op" id="7794968">:=</span>&nbsp;<span class="op" id="7794971">&amp;</span><span class="ident" id="7794972">nextProtoMsg</span><span class="op" id="7794984">{</span><span class="op" id="7794985">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7794988">m</span><span class="op" id="7794989">.</span><span class="ident" id="7794990">proto</span>&nbsp;<span class="op" id="7794996">=</span>&nbsp;<span class="ident" id="7794998">randomString</span><span class="op" id="7795010">(</span><span class="ident" id="7795011">rand</span><span class="op" id="7795015">.</span><span class="ident" id="7795016">Intn</span><span class="op" id="7795020">(</span><span class="num" id="7795021">255</span><span class="op" id="7795024">)</span><span class="op" id="7795025">,</span>&nbsp;<span class="ident" id="7795027">rand</span><span class="op" id="7795031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7795034">return</span>&nbsp;<span class="ident" id="7795041">reflect</span><span class="op" id="7795048">.</span><span class="ident" id="7795049">ValueOf</span><span class="op" id="7795056">(</span><span class="ident" id="7795057">m</span><span class="op" id="7795058">)</span><br>
<span class="lineno"></span><span class="op" id="7795060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7795063">func</span>&nbsp;<span class="op" id="7795068">(</span><span class="op" id="7795069">*</span><span class="ident" id="7795070">newSessionTicketMsg</span><span class="op" id="7795089">)</span>&nbsp;<span class="ident" id="7795091">Generate</span><span class="op" id="7795099">(</span><span class="ident" id="7795100">rand</span>&nbsp;<span class="op" id="7795105">*</span><span class="ident" id="7795106">rand</span><span class="op" id="7795110">.</span><span class="ident" id="7795111">Rand</span><span class="op" id="7795115">,</span>&nbsp;<span class="ident" id="7795117">size</span>&nbsp;<span class="builtintype" id="7795122">int</span><span class="op" id="7795125">)</span>&nbsp;<span class="ident" id="7795127">reflect</span><span class="op" id="7795134">.</span><span class="ident" id="7795135">Value</span>&nbsp;<span class="op" id="7795141">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7795144">m</span>&nbsp;<span class="op" id="7795146">:=</span>&nbsp;<span class="op" id="7795149">&amp;</span><span class="ident" id="7795150">newSessionTicketMsg</span><span class="op" id="7795169">{</span><span class="op" id="7795170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7795173">m</span><span class="op" id="7795174">.</span><span class="ident" id="7795175">ticket</span>&nbsp;<span class="op" id="7795182">=</span>&nbsp;<span class="ident" id="7795184">randomBytes</span><span class="op" id="7795195">(</span><span class="ident" id="7795196">rand</span><span class="op" id="7795200">.</span><span class="ident" id="7795201">Intn</span><span class="op" id="7795205">(</span><span class="num" id="7795206">4</span><span class="op" id="7795207">)</span><span class="op" id="7795208">,</span>&nbsp;<span class="ident" id="7795210">rand</span><span class="op" id="7795214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7795217">return</span>&nbsp;<span class="ident" id="7795224">reflect</span><span class="op" id="7795231">.</span><span class="ident" id="7795232">ValueOf</span><span class="op" id="7795239">(</span><span class="ident" id="7795240">m</span><span class="op" id="7795241">)</span><br>
<span class="lineno"></span><span class="op" id="7795243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="7795246">func</span>&nbsp;<span class="op" id="7795251">(</span><span class="op" id="7795252">*</span><span class="ident" id="7795253">sessionState</span><span class="op" id="7795265">)</span>&nbsp;<span class="ident" id="7795267">Generate</span><span class="op" id="7795275">(</span><span class="ident" id="7795276">rand</span>&nbsp;<span class="op" id="7795281">*</span><span class="ident" id="7795282">rand</span><span class="op" id="7795286">.</span><span class="ident" id="7795287">Rand</span><span class="op" id="7795291">,</span>&nbsp;<span class="ident" id="7795293">size</span>&nbsp;<span class="builtintype" id="7795298">int</span><span class="op" id="7795301">)</span>&nbsp;<span class="ident" id="7795303">reflect</span><span class="op" id="7795310">.</span><span class="ident" id="7795311">Value</span>&nbsp;<span class="op" id="7795317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7795320">s</span>&nbsp;<span class="op" id="7795322">:=</span>&nbsp;<span class="op" id="7795325">&amp;</span><span class="ident" id="7795326">sessionState</span><span class="op" id="7795338">{</span><span class="op" id="7795339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7795342">s</span><span class="op" id="7795343">.</span><span class="ident" id="7795344">vers</span>&nbsp;<span class="op" id="7795349">=</span>&nbsp;<span class="builtintype" id="7795351">uint16</span><span class="op" id="7795357">(</span><span class="ident" id="7795358">rand</span><span class="op" id="7795362">.</span><span class="ident" id="7795363">Intn</span><span class="op" id="7795367">(</span><span class="num" id="7795368">10000</span><span class="op" id="7795373">)</span><span class="op" id="7795374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7795377">s</span><span class="op" id="7795378">.</span><span class="ident" id="7795379">cipherSuite</span>&nbsp;<span class="op" id="7795391">=</span>&nbsp;<span class="builtintype" id="7795393">uint16</span><span class="op" id="7795399">(</span><span class="ident" id="7795400">rand</span><span class="op" id="7795404">.</span><span class="ident" id="7795405">Intn</span><span class="op" id="7795409">(</span><span class="num" id="7795410">10000</span><span class="op" id="7795415">)</span><span class="op" id="7795416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7795419">s</span><span class="op" id="7795420">.</span><span class="ident" id="7795421">masterSecret</span>&nbsp;<span class="op" id="7795434">=</span>&nbsp;<span class="ident" id="7795436">randomBytes</span><span class="op" id="7795447">(</span><span class="ident" id="7795448">rand</span><span class="op" id="7795452">.</span><span class="ident" id="7795453">Intn</span><span class="op" id="7795457">(</span><span class="num" id="7795458">100</span><span class="op" id="7795461">)</span><span class="op" id="7795462">,</span>&nbsp;<span class="ident" id="7795464">rand</span><span class="op" id="7795468">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7795471">numCerts</span>&nbsp;<span class="op" id="7795480">:=</span>&nbsp;<span class="ident" id="7795483">rand</span><span class="op" id="7795487">.</span><span class="ident" id="7795488">Intn</span><span class="op" id="7795492">(</span><span class="num" id="7795493">20</span><span class="op" id="7795495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7795498">s</span><span class="op" id="7795499">.</span><span class="ident" id="7795500">certificates</span>&nbsp;<span class="op" id="7795513">=</span>&nbsp;<span class="builtinfunc" id="7795515">make</span><span class="op" id="7795519">(</span><span class="op" id="7795520">[</span><span class="op" id="7795521">]</span><span class="op" id="7795522">[</span><span class="op" id="7795523">]</span><span class="builtintype" id="7795524">byte</span><span class="op" id="7795528">,</span>&nbsp;<span class="ident" id="7795530">numCerts</span><span class="op" id="7795538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7795541">for</span>&nbsp;<span class="ident" id="7795545">i</span>&nbsp;<span class="op" id="7795547">:=</span>&nbsp;<span class="num" id="7795550">0</span><span class="op" id="7795551">;</span>&nbsp;<span class="ident" id="7795553">i</span>&nbsp;<span class="op" id="7795555">&lt;</span>&nbsp;<span class="ident" id="7795557">numCerts</span><span class="op" id="7795565">;</span>&nbsp;<span class="ident" id="7795567">i</span><span class="op" id="7795568">++</span>&nbsp;<span class="op" id="7795571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7795575">s</span><span class="op" id="7795576">.</span><span class="ident" id="7795577">certificates</span><span class="op" id="7795589">[</span><span class="ident" id="7795590">i</span><span class="op" id="7795591">]</span>&nbsp;<span class="op" id="7795593">=</span>&nbsp;<span class="ident" id="7795595">randomBytes</span><span class="op" id="7795606">(</span><span class="ident" id="7795607">rand</span><span class="op" id="7795611">.</span><span class="ident" id="7795612">Intn</span><span class="op" id="7795616">(</span><span class="num" id="7795617">10</span><span class="op" id="7795619">)</span><span class="op" id="7795620">+</span><span class="num" id="7795621">1</span><span class="op" id="7795622">,</span>&nbsp;<span class="ident" id="7795624">rand</span><span class="op" id="7795628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7795631">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7795634">return</span>&nbsp;<span class="ident" id="7795641">reflect</span><span class="op" id="7795648">.</span><span class="ident" id="7795649">ValueOf</span><span class="op" id="7795656">(</span><span class="ident" id="7795657">s</span><span class="op" id="7795658">)</span><br>
<span class="lineno"></span><span class="op" id="7795660">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
