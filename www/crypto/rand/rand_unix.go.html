<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3787216">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3787272">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3787326">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3787377">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;plan9&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3787453">//&nbsp;Unix&nbsp;cryptographically&nbsp;secure&nbsp;pseudorandom&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="3787506">//&nbsp;generator.</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="3787521">package</span>&nbsp;<span class="ident" id="3787529">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3787535">import</span>&nbsp;<span class="op" id="3787542">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3787545">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3787554">&#34;crypto/aes&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3787568">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3787585">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3787591">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3787597">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3787608">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3787616">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3787623">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3787626">const</span>&nbsp;<span class="ident" id="3787632">urandomDevice</span>&nbsp;<span class="op" id="3787646">=</span>&nbsp;<span class="string" id="3787648">&#34;/dev/urandom&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3787664">//&nbsp;Easy&nbsp;implementation:&nbsp;read&nbsp;from&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><span class="comment" id="3787712">//&nbsp;This&nbsp;is&nbsp;sufficient&nbsp;on&nbsp;Linux,&nbsp;OS&nbsp;X,&nbsp;and&nbsp;FreeBSD.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3787764">func</span>&nbsp;<span class="ident" id="3787769">init</span><span class="op" id="3787773">(</span><span class="op" id="3787774">)</span>&nbsp;<span class="op" id="3787776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3787779">if</span>&nbsp;<span class="ident" id="3787782">runtime</span><span class="op" id="3787789">.</span><span class="ident" id="3787790">GOOS</span>&nbsp;<span class="op" id="3787795">==</span>&nbsp;<span class="string" id="3787798">&#34;plan9&#34;</span>&nbsp;<span class="op" id="3787806">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3787810">Reader</span>&nbsp;<span class="op" id="3787817">=</span>&nbsp;<span class="ident" id="3787819">newReader</span><span class="op" id="3787828">(</span><span class="ident" id="3787829">nil</span><span class="op" id="3787832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3787835">}</span>&nbsp;<span class="keyword" id="3787837">else</span>&nbsp;<span class="op" id="3787842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3787846">Reader</span>&nbsp;<span class="op" id="3787853">=</span>&nbsp;<span class="op" id="3787855">&amp;</span><span class="ident" id="3787856">devReader</span><span class="op" id="3787865">{</span><span class="ident" id="3787866">name</span><span class="op" id="3787870">:</span>&nbsp;<span class="ident" id="3787872">urandomDevice</span><span class="op" id="3787885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3787888">}</span><br>
<span class="lineno"></span><span class="op" id="3787890">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="3787893">//&nbsp;A&nbsp;devReader&nbsp;satisfies&nbsp;reads&nbsp;by&nbsp;reading&nbsp;the&nbsp;file&nbsp;named&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3787956">type</span>&nbsp;<span class="ident" id="3787961">devReader</span>&nbsp;<span class="keyword" id="3787971">struct</span>&nbsp;<span class="op" id="3787978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3787981">name</span>&nbsp;<span class="builtintype" id="3787986">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3787994">f</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3787999">io</span><span class="op" id="3788001">.</span><span class="ident" id="3788002">Reader</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3788010">mu</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3788015">sync</span><span class="op" id="3788019">.</span><span class="ident" id="3788020">Mutex</span><br>
<span class="lineno"></span><span class="op" id="3788026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3788029">//&nbsp;altGetRandom&nbsp;if&nbsp;non-nil&nbsp;specifies&nbsp;an&nbsp;OS-specific&nbsp;function&nbsp;to&nbsp;get</span><br>
<span class="lineno"></span><span class="comment" id="3788097">//&nbsp;urandom-style&nbsp;randomness.</span><br>
<span class="lineno">45</span><span class="keyword" id="3788126">var</span>&nbsp;<span class="ident" id="3788130">altGetRandom</span>&nbsp;<span class="keyword" id="3788143">func</span><span class="op" id="3788147">(</span><span class="op" id="3788148">[</span><span class="op" id="3788149">]</span><span class="builtintype" id="3788150">byte</span><span class="op" id="3788154">)</span>&nbsp;<span class="op" id="3788156">(</span><span class="ident" id="3788157">ok</span>&nbsp;<span class="builtintype" id="3788160">bool</span><span class="op" id="3788164">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3788167">func</span>&nbsp;<span class="op" id="3788172">(</span><span class="ident" id="3788173">r</span>&nbsp;<span class="op" id="3788175">*</span><span class="ident" id="3788176">devReader</span><span class="op" id="3788185">)</span>&nbsp;<span class="ident" id="3788187">Read</span><span class="op" id="3788191">(</span><span class="ident" id="3788192">b</span>&nbsp;<span class="op" id="3788194">[</span><span class="op" id="3788195">]</span><span class="builtintype" id="3788196">byte</span><span class="op" id="3788200">)</span>&nbsp;<span class="op" id="3788202">(</span><span class="ident" id="3788203">n</span>&nbsp;<span class="builtintype" id="3788205">int</span><span class="op" id="3788208">,</span>&nbsp;<span class="ident" id="3788210">err</span>&nbsp;<span class="builtintype" id="3788214">error</span><span class="op" id="3788219">)</span>&nbsp;<span class="op" id="3788221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3788224">if</span>&nbsp;<span class="ident" id="3788227">altGetRandom</span>&nbsp;<span class="op" id="3788240">!=</span>&nbsp;<span class="ident" id="3788243">nil</span>&nbsp;<span class="op" id="3788247">&amp;&amp;</span>&nbsp;<span class="ident" id="3788250">r</span><span class="op" id="3788251">.</span><span class="ident" id="3788252">name</span>&nbsp;<span class="op" id="3788257">==</span>&nbsp;<span class="ident" id="3788260">urandomDevice</span>&nbsp;<span class="op" id="3788274">&amp;&amp;</span>&nbsp;<span class="ident" id="3788277">altGetRandom</span><span class="op" id="3788289">(</span><span class="ident" id="3788290">b</span><span class="op" id="3788291">)</span>&nbsp;<span class="op" id="3788293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3788297">return</span>&nbsp;<span class="builtinfunc" id="3788304">len</span><span class="op" id="3788307">(</span><span class="ident" id="3788308">b</span><span class="op" id="3788309">)</span><span class="op" id="3788310">,</span>&nbsp;<span class="ident" id="3788312">nil</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3788317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3788320">r</span><span class="op" id="3788321">.</span><span class="ident" id="3788322">mu</span><span class="op" id="3788324">.</span><span class="ident" id="3788325">Lock</span><span class="op" id="3788329">(</span><span class="op" id="3788330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3788333">defer</span>&nbsp;<span class="ident" id="3788339">r</span><span class="op" id="3788340">.</span><span class="ident" id="3788341">mu</span><span class="op" id="3788343">.</span><span class="ident" id="3788344">Unlock</span><span class="op" id="3788350">(</span><span class="op" id="3788351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3788354">if</span>&nbsp;<span class="ident" id="3788357">r</span><span class="op" id="3788358">.</span><span class="ident" id="3788359">f</span>&nbsp;<span class="op" id="3788361">==</span>&nbsp;<span class="ident" id="3788364">nil</span>&nbsp;<span class="op" id="3788368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3788372">f</span><span class="op" id="3788373">,</span>&nbsp;<span class="ident" id="3788375">err</span>&nbsp;<span class="op" id="3788379">:=</span>&nbsp;<span class="ident" id="3788382">os</span><span class="op" id="3788384">.</span><span class="ident" id="3788385">Open</span><span class="op" id="3788389">(</span><span class="ident" id="3788390">r</span><span class="op" id="3788391">.</span><span class="ident" id="3788392">name</span><span class="op" id="3788396">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3788400">if</span>&nbsp;<span class="ident" id="3788403">f</span>&nbsp;<span class="op" id="3788405">==</span>&nbsp;<span class="ident" id="3788408">nil</span>&nbsp;<span class="op" id="3788412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3788417">return</span>&nbsp;<span class="num" id="3788424">0</span><span class="op" id="3788425">,</span>&nbsp;<span class="ident" id="3788427">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3788433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3788437">if</span>&nbsp;<span class="ident" id="3788440">runtime</span><span class="op" id="3788447">.</span><span class="ident" id="3788448">GOOS</span>&nbsp;<span class="op" id="3788453">==</span>&nbsp;<span class="string" id="3788456">&#34;plan9&#34;</span>&nbsp;<span class="op" id="3788464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3788469">r</span><span class="op" id="3788470">.</span><span class="ident" id="3788471">f</span>&nbsp;<span class="op" id="3788473">=</span>&nbsp;<span class="ident" id="3788475">f</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3788479">}</span>&nbsp;<span class="keyword" id="3788481">else</span>&nbsp;<span class="op" id="3788486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3788491">r</span><span class="op" id="3788492">.</span><span class="ident" id="3788493">f</span>&nbsp;<span class="op" id="3788495">=</span>&nbsp;<span class="ident" id="3788497">bufio</span><span class="op" id="3788502">.</span><span class="ident" id="3788503">NewReader</span><span class="op" id="3788512">(</span><span class="ident" id="3788513">f</span><span class="op" id="3788514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3788518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3788521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3788524">return</span>&nbsp;<span class="ident" id="3788531">r</span><span class="op" id="3788532">.</span><span class="ident" id="3788533">f</span><span class="op" id="3788534">.</span><span class="ident" id="3788535">Read</span><span class="op" id="3788539">(</span><span class="ident" id="3788540">b</span><span class="op" id="3788541">)</span><br>
<span class="lineno">65</span><span class="op" id="3788543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3788546">//&nbsp;Alternate&nbsp;pseudo-random&nbsp;implementation&nbsp;for&nbsp;use&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="3788599">//&nbsp;systems&nbsp;without&nbsp;a&nbsp;reliable&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="3788644">//&nbsp;newReader&nbsp;returns&nbsp;a&nbsp;new&nbsp;pseudorandom&nbsp;generator&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3788699">//&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;entropy.&nbsp;&nbsp;If&nbsp;entropy&nbsp;==&nbsp;nil,</span><br>
<span class="lineno"></span><span class="comment" id="3788760">//&nbsp;the&nbsp;generator&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;the&nbsp;system&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3788819">//&nbsp;random&nbsp;number&nbsp;generator,&nbsp;typically&nbsp;/dev/random.</span><br>
<span class="lineno"></span><span class="comment" id="3788870">//&nbsp;The&nbsp;Read&nbsp;method&nbsp;on&nbsp;the&nbsp;returned&nbsp;reader&nbsp;always&nbsp;returns</span><br>
<span class="lineno">75</span><span class="comment" id="3788927">//&nbsp;the&nbsp;full&nbsp;amount&nbsp;asked&nbsp;for,&nbsp;or&nbsp;else&nbsp;it&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3788986">//</span><br>
<span class="lineno"></span><span class="comment" id="3788989">//&nbsp;The&nbsp;generator&nbsp;uses&nbsp;the&nbsp;X9.31&nbsp;algorithm&nbsp;with&nbsp;AES-128,</span><br>
<span class="lineno"></span><span class="comment" id="3789045">//&nbsp;reseeding&nbsp;after&nbsp;every&nbsp;1&nbsp;MB&nbsp;of&nbsp;generated&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3789094">func</span>&nbsp;<span class="ident" id="3789099">newReader</span><span class="op" id="3789108">(</span><span class="ident" id="3789109">entropy</span>&nbsp;<span class="ident" id="3789117">io</span><span class="op" id="3789119">.</span><span class="ident" id="3789120">Reader</span><span class="op" id="3789126">)</span>&nbsp;<span class="ident" id="3789128">io</span><span class="op" id="3789130">.</span><span class="ident" id="3789131">Reader</span>&nbsp;<span class="op" id="3789138">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3789141">if</span>&nbsp;<span class="ident" id="3789144">entropy</span>&nbsp;<span class="op" id="3789152">==</span>&nbsp;<span class="ident" id="3789155">nil</span>&nbsp;<span class="op" id="3789159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789163">entropy</span>&nbsp;<span class="op" id="3789171">=</span>&nbsp;<span class="op" id="3789173">&amp;</span><span class="ident" id="3789174">devReader</span><span class="op" id="3789183">{</span><span class="ident" id="3789184">name</span><span class="op" id="3789188">:</span>&nbsp;<span class="string" id="3789190">&#34;/dev/random&#34;</span><span class="op" id="3789203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3789206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3789209">return</span>&nbsp;<span class="op" id="3789216">&amp;</span><span class="ident" id="3789217">reader</span><span class="op" id="3789223">{</span><span class="ident" id="3789224">entropy</span><span class="op" id="3789231">:</span>&nbsp;<span class="ident" id="3789233">entropy</span><span class="op" id="3789240">}</span><br>
<span class="lineno"></span><span class="op" id="3789242">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="3789245">type</span>&nbsp;<span class="ident" id="3789250">reader</span>&nbsp;<span class="keyword" id="3789257">struct</span>&nbsp;<span class="op" id="3789264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789267">mu</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3789288">sync</span><span class="op" id="3789292">.</span><span class="ident" id="3789293">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789300">budget</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3789321">int</span>&nbsp;<span class="comment" id="3789325">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;that&nbsp;can&nbsp;be&nbsp;generated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789367">cipher</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3789388">cipher</span><span class="op" id="3789394">.</span><span class="ident" id="3789395">Block</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789402">entropy</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3789423">io</span><span class="op" id="3789425">.</span><span class="ident" id="3789426">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789434">time</span><span class="op" id="3789438">,</span>&nbsp;<span class="ident" id="3789440">seed</span><span class="op" id="3789444">,</span>&nbsp;<span class="ident" id="3789446">dst</span><span class="op" id="3789449">,</span>&nbsp;<span class="ident" id="3789451">key</span>&nbsp;<span class="op" id="3789455">[</span><span class="ident" id="3789456">aes</span><span class="op" id="3789459">.</span><span class="ident" id="3789460">BlockSize</span><span class="op" id="3789469">]</span><span class="builtintype" id="3789470">byte</span><br>
<span class="lineno"></span><span class="op" id="3789475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3789478">func</span>&nbsp;<span class="op" id="3789483">(</span><span class="ident" id="3789484">r</span>&nbsp;<span class="op" id="3789486">*</span><span class="ident" id="3789487">reader</span><span class="op" id="3789493">)</span>&nbsp;<span class="ident" id="3789495">Read</span><span class="op" id="3789499">(</span><span class="ident" id="3789500">b</span>&nbsp;<span class="op" id="3789502">[</span><span class="op" id="3789503">]</span><span class="builtintype" id="3789504">byte</span><span class="op" id="3789508">)</span>&nbsp;<span class="op" id="3789510">(</span><span class="ident" id="3789511">n</span>&nbsp;<span class="builtintype" id="3789513">int</span><span class="op" id="3789516">,</span>&nbsp;<span class="ident" id="3789518">err</span>&nbsp;<span class="builtintype" id="3789522">error</span><span class="op" id="3789527">)</span>&nbsp;<span class="op" id="3789529">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789532">r</span><span class="op" id="3789533">.</span><span class="ident" id="3789534">mu</span><span class="op" id="3789536">.</span><span class="ident" id="3789537">Lock</span><span class="op" id="3789541">(</span><span class="op" id="3789542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3789545">defer</span>&nbsp;<span class="ident" id="3789551">r</span><span class="op" id="3789552">.</span><span class="ident" id="3789553">mu</span><span class="op" id="3789555">.</span><span class="ident" id="3789556">Unlock</span><span class="op" id="3789562">(</span><span class="op" id="3789563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789566">n</span>&nbsp;<span class="op" id="3789568">=</span>&nbsp;<span class="builtinfunc" id="3789570">len</span><span class="op" id="3789573">(</span><span class="ident" id="3789574">b</span><span class="op" id="3789575">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3789579">for</span>&nbsp;<span class="builtinfunc" id="3789583">len</span><span class="op" id="3789586">(</span><span class="ident" id="3789587">b</span><span class="op" id="3789588">)</span>&nbsp;<span class="op" id="3789590">&gt;</span>&nbsp;<span class="num" id="3789592">0</span>&nbsp;<span class="op" id="3789594">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3789598">if</span>&nbsp;<span class="ident" id="3789601">r</span><span class="op" id="3789602">.</span><span class="ident" id="3789603">budget</span>&nbsp;<span class="op" id="3789610">==</span>&nbsp;<span class="num" id="3789613">0</span>&nbsp;<span class="op" id="3789615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789620">_</span><span class="op" id="3789621">,</span>&nbsp;<span class="ident" id="3789623">err</span>&nbsp;<span class="op" id="3789627">:=</span>&nbsp;<span class="ident" id="3789630">io</span><span class="op" id="3789632">.</span><span class="ident" id="3789633">ReadFull</span><span class="op" id="3789641">(</span><span class="ident" id="3789642">r</span><span class="op" id="3789643">.</span><span class="ident" id="3789644">entropy</span><span class="op" id="3789651">,</span>&nbsp;<span class="ident" id="3789653">r</span><span class="op" id="3789654">.</span><span class="ident" id="3789655">seed</span><span class="op" id="3789659">[</span><span class="num" id="3789660">0</span><span class="op" id="3789661">:</span><span class="op" id="3789662">]</span><span class="op" id="3789663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3789668">if</span>&nbsp;<span class="ident" id="3789671">err</span>&nbsp;<span class="op" id="3789675">!=</span>&nbsp;<span class="ident" id="3789678">nil</span>&nbsp;<span class="op" id="3789682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3789688">return</span>&nbsp;<span class="ident" id="3789695">n</span>&nbsp;<span class="op" id="3789697">-</span>&nbsp;<span class="builtinfunc" id="3789699">len</span><span class="op" id="3789702">(</span><span class="ident" id="3789703">b</span><span class="op" id="3789704">)</span><span class="op" id="3789705">,</span>&nbsp;<span class="ident" id="3789707">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3789714">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789719">_</span><span class="op" id="3789720">,</span>&nbsp;<span class="ident" id="3789722">err</span>&nbsp;<span class="op" id="3789726">=</span>&nbsp;<span class="ident" id="3789728">io</span><span class="op" id="3789730">.</span><span class="ident" id="3789731">ReadFull</span><span class="op" id="3789739">(</span><span class="ident" id="3789740">r</span><span class="op" id="3789741">.</span><span class="ident" id="3789742">entropy</span><span class="op" id="3789749">,</span>&nbsp;<span class="ident" id="3789751">r</span><span class="op" id="3789752">.</span><span class="ident" id="3789753">key</span><span class="op" id="3789756">[</span><span class="num" id="3789757">0</span><span class="op" id="3789758">:</span><span class="op" id="3789759">]</span><span class="op" id="3789760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3789765">if</span>&nbsp;<span class="ident" id="3789768">err</span>&nbsp;<span class="op" id="3789772">!=</span>&nbsp;<span class="ident" id="3789775">nil</span>&nbsp;<span class="op" id="3789779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3789785">return</span>&nbsp;<span class="ident" id="3789792">n</span>&nbsp;<span class="op" id="3789794">-</span>&nbsp;<span class="builtinfunc" id="3789796">len</span><span class="op" id="3789799">(</span><span class="ident" id="3789800">b</span><span class="op" id="3789801">)</span><span class="op" id="3789802">,</span>&nbsp;<span class="ident" id="3789804">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3789811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789816">r</span><span class="op" id="3789817">.</span><span class="ident" id="3789818">cipher</span><span class="op" id="3789824">,</span>&nbsp;<span class="ident" id="3789826">err</span>&nbsp;<span class="op" id="3789830">=</span>&nbsp;<span class="ident" id="3789832">aes</span><span class="op" id="3789835">.</span><span class="ident" id="3789836">NewCipher</span><span class="op" id="3789845">(</span><span class="ident" id="3789846">r</span><span class="op" id="3789847">.</span><span class="ident" id="3789848">key</span><span class="op" id="3789851">[</span><span class="num" id="3789852">0</span><span class="op" id="3789853">:</span><span class="op" id="3789854">]</span><span class="op" id="3789855">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3789860">if</span>&nbsp;<span class="ident" id="3789863">err</span>&nbsp;<span class="op" id="3789867">!=</span>&nbsp;<span class="ident" id="3789870">nil</span>&nbsp;<span class="op" id="3789874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3789880">return</span>&nbsp;<span class="ident" id="3789887">n</span>&nbsp;<span class="op" id="3789889">-</span>&nbsp;<span class="builtinfunc" id="3789891">len</span><span class="op" id="3789894">(</span><span class="ident" id="3789895">b</span><span class="op" id="3789896">)</span><span class="op" id="3789897">,</span>&nbsp;<span class="ident" id="3789899">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3789906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789911">r</span><span class="op" id="3789912">.</span><span class="ident" id="3789913">budget</span>&nbsp;<span class="op" id="3789920">=</span>&nbsp;<span class="num" id="3789922">1</span>&nbsp;<span class="op" id="3789924">&lt;&lt;</span>&nbsp;<span class="num" id="3789927">20</span>&nbsp;<span class="comment" id="3789930">//&nbsp;reseed&nbsp;after&nbsp;generating&nbsp;1MB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3789963">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789967">r</span><span class="op" id="3789968">.</span><span class="ident" id="3789969">budget</span>&nbsp;<span class="op" id="3789976">-=</span>&nbsp;<span class="ident" id="3789979">aes</span><span class="op" id="3789982">.</span><span class="ident" id="3789983">BlockSize</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3789996">//&nbsp;ANSI&nbsp;X9.31&nbsp;(==&nbsp;X9.17)&nbsp;algorithm,&nbsp;but&nbsp;using&nbsp;AES&nbsp;in&nbsp;place&nbsp;of&nbsp;3DES.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3790066">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3790071">//&nbsp;single&nbsp;block:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3790090">//&nbsp;t&nbsp;=&nbsp;encrypt(time)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3790113">//&nbsp;dst&nbsp;=&nbsp;encrypt(t^seed)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3790140">//&nbsp;seed&nbsp;=&nbsp;encrypt(t^dst)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790167">ns</span>&nbsp;<span class="op" id="3790170">:=</span>&nbsp;<span class="ident" id="3790173">time</span><span class="op" id="3790177">.</span><span class="ident" id="3790178">Now</span><span class="op" id="3790181">(</span><span class="op" id="3790182">)</span><span class="op" id="3790183">.</span><span class="ident" id="3790184">UnixNano</span><span class="op" id="3790192">(</span><span class="op" id="3790193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790197">r</span><span class="op" id="3790198">.</span><span class="ident" id="3790199">time</span><span class="op" id="3790203">[</span><span class="num" id="3790204">0</span><span class="op" id="3790205">]</span>&nbsp;<span class="op" id="3790207">=</span>&nbsp;<span class="builtintype" id="3790209">byte</span><span class="op" id="3790213">(</span><span class="ident" id="3790214">ns</span>&nbsp;<span class="op" id="3790217">&gt;&gt;</span>&nbsp;<span class="num" id="3790220">56</span><span class="op" id="3790222">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790226">r</span><span class="op" id="3790227">.</span><span class="ident" id="3790228">time</span><span class="op" id="3790232">[</span><span class="num" id="3790233">1</span><span class="op" id="3790234">]</span>&nbsp;<span class="op" id="3790236">=</span>&nbsp;<span class="builtintype" id="3790238">byte</span><span class="op" id="3790242">(</span><span class="ident" id="3790243">ns</span>&nbsp;<span class="op" id="3790246">&gt;&gt;</span>&nbsp;<span class="num" id="3790249">48</span><span class="op" id="3790251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790255">r</span><span class="op" id="3790256">.</span><span class="ident" id="3790257">time</span><span class="op" id="3790261">[</span><span class="num" id="3790262">2</span><span class="op" id="3790263">]</span>&nbsp;<span class="op" id="3790265">=</span>&nbsp;<span class="builtintype" id="3790267">byte</span><span class="op" id="3790271">(</span><span class="ident" id="3790272">ns</span>&nbsp;<span class="op" id="3790275">&gt;&gt;</span>&nbsp;<span class="num" id="3790278">40</span><span class="op" id="3790280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790284">r</span><span class="op" id="3790285">.</span><span class="ident" id="3790286">time</span><span class="op" id="3790290">[</span><span class="num" id="3790291">3</span><span class="op" id="3790292">]</span>&nbsp;<span class="op" id="3790294">=</span>&nbsp;<span class="builtintype" id="3790296">byte</span><span class="op" id="3790300">(</span><span class="ident" id="3790301">ns</span>&nbsp;<span class="op" id="3790304">&gt;&gt;</span>&nbsp;<span class="num" id="3790307">32</span><span class="op" id="3790309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790313">r</span><span class="op" id="3790314">.</span><span class="ident" id="3790315">time</span><span class="op" id="3790319">[</span><span class="num" id="3790320">4</span><span class="op" id="3790321">]</span>&nbsp;<span class="op" id="3790323">=</span>&nbsp;<span class="builtintype" id="3790325">byte</span><span class="op" id="3790329">(</span><span class="ident" id="3790330">ns</span>&nbsp;<span class="op" id="3790333">&gt;&gt;</span>&nbsp;<span class="num" id="3790336">24</span><span class="op" id="3790338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790342">r</span><span class="op" id="3790343">.</span><span class="ident" id="3790344">time</span><span class="op" id="3790348">[</span><span class="num" id="3790349">5</span><span class="op" id="3790350">]</span>&nbsp;<span class="op" id="3790352">=</span>&nbsp;<span class="builtintype" id="3790354">byte</span><span class="op" id="3790358">(</span><span class="ident" id="3790359">ns</span>&nbsp;<span class="op" id="3790362">&gt;&gt;</span>&nbsp;<span class="num" id="3790365">16</span><span class="op" id="3790367">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790371">r</span><span class="op" id="3790372">.</span><span class="ident" id="3790373">time</span><span class="op" id="3790377">[</span><span class="num" id="3790378">6</span><span class="op" id="3790379">]</span>&nbsp;<span class="op" id="3790381">=</span>&nbsp;<span class="builtintype" id="3790383">byte</span><span class="op" id="3790387">(</span><span class="ident" id="3790388">ns</span>&nbsp;<span class="op" id="3790391">&gt;&gt;</span>&nbsp;<span class="num" id="3790394">8</span><span class="op" id="3790395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790399">r</span><span class="op" id="3790400">.</span><span class="ident" id="3790401">time</span><span class="op" id="3790405">[</span><span class="num" id="3790406">7</span><span class="op" id="3790407">]</span>&nbsp;<span class="op" id="3790409">=</span>&nbsp;<span class="builtintype" id="3790411">byte</span><span class="op" id="3790415">(</span><span class="ident" id="3790416">ns</span><span class="op" id="3790418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790422">r</span><span class="op" id="3790423">.</span><span class="ident" id="3790424">cipher</span><span class="op" id="3790430">.</span><span class="ident" id="3790431">Encrypt</span><span class="op" id="3790438">(</span><span class="ident" id="3790439">r</span><span class="op" id="3790440">.</span><span class="ident" id="3790441">time</span><span class="op" id="3790445">[</span><span class="num" id="3790446">0</span><span class="op" id="3790447">:</span><span class="op" id="3790448">]</span><span class="op" id="3790449">,</span>&nbsp;<span class="ident" id="3790451">r</span><span class="op" id="3790452">.</span><span class="ident" id="3790453">time</span><span class="op" id="3790457">[</span><span class="num" id="3790458">0</span><span class="op" id="3790459">:</span><span class="op" id="3790460">]</span><span class="op" id="3790461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3790465">for</span>&nbsp;<span class="ident" id="3790469">i</span>&nbsp;<span class="op" id="3790471">:=</span>&nbsp;<span class="num" id="3790474">0</span><span class="op" id="3790475">;</span>&nbsp;<span class="ident" id="3790477">i</span>&nbsp;<span class="op" id="3790479">&lt;</span>&nbsp;<span class="ident" id="3790481">aes</span><span class="op" id="3790484">.</span><span class="ident" id="3790485">BlockSize</span><span class="op" id="3790494">;</span>&nbsp;<span class="ident" id="3790496">i</span><span class="op" id="3790497">++</span>&nbsp;<span class="op" id="3790500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790505">r</span><span class="op" id="3790506">.</span><span class="ident" id="3790507">dst</span><span class="op" id="3790510">[</span><span class="ident" id="3790511">i</span><span class="op" id="3790512">]</span>&nbsp;<span class="op" id="3790514">=</span>&nbsp;<span class="ident" id="3790516">r</span><span class="op" id="3790517">.</span><span class="ident" id="3790518">time</span><span class="op" id="3790522">[</span><span class="ident" id="3790523">i</span><span class="op" id="3790524">]</span>&nbsp;<span class="op" id="3790526">^</span>&nbsp;<span class="ident" id="3790528">r</span><span class="op" id="3790529">.</span><span class="ident" id="3790530">seed</span><span class="op" id="3790534">[</span><span class="ident" id="3790535">i</span><span class="op" id="3790536">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3790540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790544">r</span><span class="op" id="3790545">.</span><span class="ident" id="3790546">cipher</span><span class="op" id="3790552">.</span><span class="ident" id="3790553">Encrypt</span><span class="op" id="3790560">(</span><span class="ident" id="3790561">r</span><span class="op" id="3790562">.</span><span class="ident" id="3790563">dst</span><span class="op" id="3790566">[</span><span class="num" id="3790567">0</span><span class="op" id="3790568">:</span><span class="op" id="3790569">]</span><span class="op" id="3790570">,</span>&nbsp;<span class="ident" id="3790572">r</span><span class="op" id="3790573">.</span><span class="ident" id="3790574">dst</span><span class="op" id="3790577">[</span><span class="num" id="3790578">0</span><span class="op" id="3790579">:</span><span class="op" id="3790580">]</span><span class="op" id="3790581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3790585">for</span>&nbsp;<span class="ident" id="3790589">i</span>&nbsp;<span class="op" id="3790591">:=</span>&nbsp;<span class="num" id="3790594">0</span><span class="op" id="3790595">;</span>&nbsp;<span class="ident" id="3790597">i</span>&nbsp;<span class="op" id="3790599">&lt;</span>&nbsp;<span class="ident" id="3790601">aes</span><span class="op" id="3790604">.</span><span class="ident" id="3790605">BlockSize</span><span class="op" id="3790614">;</span>&nbsp;<span class="ident" id="3790616">i</span><span class="op" id="3790617">++</span>&nbsp;<span class="op" id="3790620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790625">r</span><span class="op" id="3790626">.</span><span class="ident" id="3790627">seed</span><span class="op" id="3790631">[</span><span class="ident" id="3790632">i</span><span class="op" id="3790633">]</span>&nbsp;<span class="op" id="3790635">=</span>&nbsp;<span class="ident" id="3790637">r</span><span class="op" id="3790638">.</span><span class="ident" id="3790639">time</span><span class="op" id="3790643">[</span><span class="ident" id="3790644">i</span><span class="op" id="3790645">]</span>&nbsp;<span class="op" id="3790647">^</span>&nbsp;<span class="ident" id="3790649">r</span><span class="op" id="3790650">.</span><span class="ident" id="3790651">dst</span><span class="op" id="3790654">[</span><span class="ident" id="3790655">i</span><span class="op" id="3790656">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3790660">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790664">r</span><span class="op" id="3790665">.</span><span class="ident" id="3790666">cipher</span><span class="op" id="3790672">.</span><span class="ident" id="3790673">Encrypt</span><span class="op" id="3790680">(</span><span class="ident" id="3790681">r</span><span class="op" id="3790682">.</span><span class="ident" id="3790683">seed</span><span class="op" id="3790687">[</span><span class="num" id="3790688">0</span><span class="op" id="3790689">:</span><span class="op" id="3790690">]</span><span class="op" id="3790691">,</span>&nbsp;<span class="ident" id="3790693">r</span><span class="op" id="3790694">.</span><span class="ident" id="3790695">seed</span><span class="op" id="3790699">[</span><span class="num" id="3790700">0</span><span class="op" id="3790701">:</span><span class="op" id="3790702">]</span><span class="op" id="3790703">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790708">m</span>&nbsp;<span class="op" id="3790710">:=</span>&nbsp;<span class="builtinfunc" id="3790713">copy</span><span class="op" id="3790717">(</span><span class="ident" id="3790718">b</span><span class="op" id="3790719">,</span>&nbsp;<span class="ident" id="3790721">r</span><span class="op" id="3790722">.</span><span class="ident" id="3790723">dst</span><span class="op" id="3790726">[</span><span class="num" id="3790727">0</span><span class="op" id="3790728">:</span><span class="op" id="3790729">]</span><span class="op" id="3790730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790734">b</span>&nbsp;<span class="op" id="3790736">=</span>&nbsp;<span class="ident" id="3790738">b</span><span class="op" id="3790739">[</span><span class="ident" id="3790740">m</span><span class="op" id="3790741">:</span><span class="op" id="3790742">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3790745">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3790749">return</span>&nbsp;<span class="ident" id="3790756">n</span><span class="op" id="3790757">,</span>&nbsp;<span class="ident" id="3790759">nil</span><br>
<span class="lineno"></span><span class="op" id="3790763">}</span>
</div>
</body>
</html>
