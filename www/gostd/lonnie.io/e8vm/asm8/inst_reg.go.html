<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="5096665">package</span>&nbsp;<span class="ident" id="5096673">asm8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5096679">import</span>&nbsp;<span class="op" id="5096686">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5096689">&#34;strconv&#34;</span><br>
<span class="lineno">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5096701">&#34;lonnie.io/e8vm/lex8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5096723">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5096726">var</span>&nbsp;<span class="op" id="5096730">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5096733">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096754">opShiftMap</span>&nbsp;<span class="op" id="5096765">=</span>&nbsp;<span class="keyword" id="5096767">map</span><span class="op" id="5096770">[</span><span class="builtintype" id="5096771">string</span><span class="op" id="5096777">]</span><span class="builtintype" id="5096778">uint32</span><span class="op" id="5096784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5096788">&#34;sll&#34;</span><span class="op" id="5096793">:</span>&nbsp;<span class="num" id="5096795">0</span><span class="op" id="5096796">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5096800">&#34;srl&#34;</span><span class="op" id="5096805">:</span>&nbsp;<span class="num" id="5096807">1</span><span class="op" id="5096808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5096812">&#34;sra&#34;</span><span class="op" id="5096817">:</span>&nbsp;<span class="num" id="5096819">2</span><span class="op" id="5096820">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5096823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5096827">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096846">opReg3Map</span>&nbsp;<span class="op" id="5096856">=</span>&nbsp;<span class="keyword" id="5096858">map</span><span class="op" id="5096861">[</span><span class="builtintype" id="5096862">string</span><span class="op" id="5096868">]</span><span class="builtintype" id="5096869">uint32</span><span class="op" id="5096875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5096879">&#34;sllv&#34;</span><span class="op" id="5096885">:</span>&nbsp;<span class="num" id="5096887">3</span><span class="op" id="5096888">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5096892">&#34;srlv&#34;</span><span class="op" id="5096898">:</span>&nbsp;<span class="num" id="5096900">4</span><span class="op" id="5096901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5096905">&#34;srla&#34;</span><span class="op" id="5096911">:</span>&nbsp;<span class="num" id="5096913">5</span><span class="op" id="5096914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5096918">&#34;add&#34;</span><span class="op" id="5096923">:</span>&nbsp;&nbsp;<span class="num" id="5096926">6</span><span class="op" id="5096927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5096931">&#34;sub&#34;</span><span class="op" id="5096936">:</span>&nbsp;&nbsp;<span class="num" id="5096939">7</span><span class="op" id="5096940">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5096944">&#34;and&#34;</span><span class="op" id="5096949">:</span>&nbsp;&nbsp;<span class="num" id="5096952">8</span><span class="op" id="5096953">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5096957">&#34;or&#34;</span><span class="op" id="5096961">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="5096965">9</span><span class="op" id="5096966">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5096970">&#34;xor&#34;</span><span class="op" id="5096975">:</span>&nbsp;&nbsp;<span class="num" id="5096978">10</span><span class="op" id="5096980">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5096984">&#34;nor&#34;</span><span class="op" id="5096989">:</span>&nbsp;&nbsp;<span class="num" id="5096992">11</span><span class="op" id="5096994">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5096998">&#34;slt&#34;</span><span class="op" id="5097003">:</span>&nbsp;&nbsp;<span class="num" id="5097006">12</span><span class="op" id="5097008">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5097012">&#34;sltu&#34;</span><span class="op" id="5097018">:</span>&nbsp;<span class="num" id="5097020">13</span><span class="op" id="5097022">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5097026">&#34;mul&#34;</span><span class="op" id="5097031">:</span>&nbsp;&nbsp;<span class="num" id="5097034">14</span><span class="op" id="5097036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5097040">&#34;mulu&#34;</span><span class="op" id="5097046">:</span>&nbsp;<span class="num" id="5097048">15</span><span class="op" id="5097050">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5097054">&#34;div&#34;</span><span class="op" id="5097059">:</span>&nbsp;&nbsp;<span class="num" id="5097062">16</span><span class="op" id="5097064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5097068">&#34;divu&#34;</span><span class="op" id="5097074">:</span>&nbsp;<span class="num" id="5097076">17</span><span class="op" id="5097078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5097082">&#34;mod&#34;</span><span class="op" id="5097087">:</span>&nbsp;&nbsp;<span class="num" id="5097090">18</span><span class="op" id="5097092">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5097096">&#34;modu&#34;</span><span class="op" id="5097102">:</span>&nbsp;<span class="num" id="5097104">19</span><span class="op" id="5097106">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5097109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5097113">//&nbsp;op&nbsp;reg&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5097128">opReg2Map</span>&nbsp;<span class="op" id="5097138">=</span>&nbsp;<span class="keyword" id="5097140">map</span><span class="op" id="5097143">[</span><span class="builtintype" id="5097144">string</span><span class="op" id="5097150">]</span><span class="builtintype" id="5097151">uint32</span><span class="op" id="5097157">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5097161">&#34;mov&#34;</span><span class="op" id="5097166">:</span>&nbsp;<span class="num" id="5097168">0</span><span class="op" id="5097169">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5097172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5097176">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5097195">opFloatMap</span>&nbsp;<span class="op" id="5097206">=</span>&nbsp;<span class="keyword" id="5097208">map</span><span class="op" id="5097211">[</span><span class="builtintype" id="5097212">string</span><span class="op" id="5097218">]</span><span class="builtintype" id="5097219">uint32</span><span class="op" id="5097225">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5097229">&#34;fadd&#34;</span><span class="op" id="5097235">:</span>&nbsp;<span class="num" id="5097237">0</span><span class="op" id="5097238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5097242">&#34;fsub&#34;</span><span class="op" id="5097248">:</span>&nbsp;<span class="num" id="5097250">1</span><span class="op" id="5097251">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5097255">&#34;fmul&#34;</span><span class="op" id="5097261">:</span>&nbsp;<span class="num" id="5097263">2</span><span class="op" id="5097264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5097268">&#34;fdiv&#34;</span><span class="op" id="5097274">:</span>&nbsp;<span class="num" id="5097276">3</span><span class="op" id="5097277">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5097281">&#34;fint&#34;</span><span class="op" id="5097287">:</span>&nbsp;<span class="num" id="5097289">4</span><span class="op" id="5097290">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5097293">}</span><br>
<span class="lineno"></span><span class="op" id="5097295">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5097298">func</span>&nbsp;<span class="ident" id="5097303">parseShift</span><span class="op" id="5097313">(</span><span class="ident" id="5097314">p</span>&nbsp;<span class="op" id="5097316">*</span><span class="ident" id="5097317">parser</span><span class="op" id="5097323">,</span>&nbsp;<span class="ident" id="5097325">op</span>&nbsp;<span class="op" id="5097328">*</span><span class="ident" id="5097329">lex8</span><span class="op" id="5097333">.</span><span class="ident" id="5097334">Token</span><span class="op" id="5097339">)</span>&nbsp;<span class="builtintype" id="5097341">uint32</span>&nbsp;<span class="op" id="5097348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5097351">ret</span><span class="op" id="5097354">,</span>&nbsp;<span class="ident" id="5097356">e</span>&nbsp;<span class="op" id="5097358">:=</span>&nbsp;<span class="ident" id="5097361">strconv</span><span class="op" id="5097368">.</span><span class="ident" id="5097369">ParseUint</span><span class="op" id="5097378">(</span><span class="ident" id="5097379">op</span><span class="op" id="5097381">.</span><span class="ident" id="5097382">Lit</span><span class="op" id="5097385">,</span>&nbsp;<span class="num" id="5097387">0</span><span class="op" id="5097388">,</span>&nbsp;<span class="num" id="5097390">32</span><span class="op" id="5097392">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5097395">if</span>&nbsp;<span class="ident" id="5097398">e</span>&nbsp;<span class="op" id="5097400">!=</span>&nbsp;<span class="ident" id="5097403">nil</span>&nbsp;<span class="op" id="5097407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5097411">p</span><span class="op" id="5097412">.</span><span class="ident" id="5097413">err</span><span class="op" id="5097416">(</span><span class="ident" id="5097417">op</span><span class="op" id="5097419">.</span><span class="ident" id="5097420">Pos</span><span class="op" id="5097423">,</span>&nbsp;<span class="string" id="5097425">&#34;invalid&nbsp;shift&nbsp;%q:&nbsp;%s&#34;</span><span class="op" id="5097447">,</span>&nbsp;<span class="ident" id="5097449">op</span><span class="op" id="5097451">.</span><span class="ident" id="5097452">Lit</span><span class="op" id="5097455">,</span>&nbsp;<span class="ident" id="5097457">e</span><span class="op" id="5097458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5097462">return</span>&nbsp;<span class="num" id="5097469">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5097472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5097476">if</span>&nbsp;<span class="op" id="5097479">(</span><span class="ident" id="5097480">ret</span>&nbsp;<span class="op" id="5097484">&amp;</span>&nbsp;<span class="num" id="5097486">0x1f</span><span class="op" id="5097490">)</span>&nbsp;<span class="op" id="5097492">!=</span>&nbsp;<span class="ident" id="5097495">ret</span>&nbsp;<span class="op" id="5097499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5097503">p</span><span class="op" id="5097504">.</span><span class="ident" id="5097505">err</span><span class="op" id="5097508">(</span><span class="ident" id="5097509">op</span><span class="op" id="5097511">.</span><span class="ident" id="5097512">Pos</span><span class="op" id="5097515">,</span>&nbsp;<span class="string" id="5097517">&#34;shift&nbsp;too&nbsp;large:&nbsp;%s&#34;</span><span class="op" id="5097538">,</span>&nbsp;<span class="ident" id="5097540">op</span><span class="op" id="5097542">.</span><span class="ident" id="5097543">Lit</span><span class="op" id="5097546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5097550">return</span>&nbsp;<span class="num" id="5097557">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5097560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5097564">return</span>&nbsp;<span class="builtintype" id="5097571">uint32</span><span class="op" id="5097577">(</span><span class="ident" id="5097578">ret</span><span class="op" id="5097581">)</span><br>
<span class="lineno"></span><span class="op" id="5097583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5097586">func</span>&nbsp;<span class="ident" id="5097591">makeInstReg</span><span class="op" id="5097602">(</span><span class="ident" id="5097603">fn</span><span class="op" id="5097605">,</span>&nbsp;<span class="ident" id="5097607">d</span><span class="op" id="5097608">,</span>&nbsp;<span class="ident" id="5097610">s1</span><span class="op" id="5097612">,</span>&nbsp;<span class="ident" id="5097614">s2</span><span class="op" id="5097616">,</span>&nbsp;<span class="ident" id="5097618">sh</span><span class="op" id="5097620">,</span>&nbsp;<span class="ident" id="5097622">isFloat</span>&nbsp;<span class="builtintype" id="5097630">uint32</span><span class="op" id="5097636">)</span>&nbsp;<span class="op" id="5097638">*</span><span class="ident" id="5097639">inst</span>&nbsp;<span class="op" id="5097644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5097647">ret</span>&nbsp;<span class="op" id="5097651">:=</span>&nbsp;<span class="builtintype" id="5097654">uint32</span><span class="op" id="5097660">(</span><span class="num" id="5097661">0</span><span class="op" id="5097662">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5097665">ret</span>&nbsp;<span class="op" id="5097669">|=</span>&nbsp;<span class="op" id="5097672">(</span><span class="ident" id="5097673">d</span>&nbsp;<span class="op" id="5097675">&amp;</span>&nbsp;<span class="num" id="5097677">0x7</span><span class="op" id="5097680">)</span>&nbsp;<span class="op" id="5097682">&lt;&lt;</span>&nbsp;<span class="num" id="5097685">21</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5097689">ret</span>&nbsp;<span class="op" id="5097693">|=</span>&nbsp;<span class="op" id="5097696">(</span><span class="ident" id="5097697">s1</span>&nbsp;<span class="op" id="5097700">&amp;</span>&nbsp;<span class="num" id="5097702">0x7</span><span class="op" id="5097705">)</span>&nbsp;<span class="op" id="5097707">&lt;&lt;</span>&nbsp;<span class="num" id="5097710">18</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5097714">ret</span>&nbsp;<span class="op" id="5097718">|=</span>&nbsp;<span class="op" id="5097721">(</span><span class="ident" id="5097722">s2</span>&nbsp;<span class="op" id="5097725">&amp;</span>&nbsp;<span class="num" id="5097727">0x7</span><span class="op" id="5097730">)</span>&nbsp;<span class="op" id="5097732">&lt;&lt;</span>&nbsp;<span class="num" id="5097735">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5097739">ret</span>&nbsp;<span class="op" id="5097743">|=</span>&nbsp;<span class="op" id="5097746">(</span><span class="ident" id="5097747">sh</span>&nbsp;<span class="op" id="5097750">&amp;</span>&nbsp;<span class="num" id="5097752">0x1f</span><span class="op" id="5097756">)</span>&nbsp;<span class="op" id="5097758">&lt;&lt;</span>&nbsp;<span class="num" id="5097761">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5097765">ret</span>&nbsp;<span class="op" id="5097769">|=</span>&nbsp;<span class="op" id="5097772">(</span><span class="ident" id="5097773">isFloat</span>&nbsp;<span class="op" id="5097781">&amp;</span>&nbsp;<span class="num" id="5097783">0x1</span><span class="op" id="5097786">)</span>&nbsp;<span class="op" id="5097788">&lt;&lt;</span>&nbsp;<span class="num" id="5097791">8</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5097794">ret</span>&nbsp;<span class="op" id="5097798">|=</span>&nbsp;<span class="ident" id="5097801">fn</span>&nbsp;<span class="op" id="5097804">&amp;</span>&nbsp;<span class="num" id="5097806">0xff</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5097813">return</span>&nbsp;<span class="op" id="5097820">&amp;</span><span class="ident" id="5097821">inst</span><span class="op" id="5097825">{</span><span class="ident" id="5097826">inst</span><span class="op" id="5097830">:</span>&nbsp;<span class="ident" id="5097832">ret</span><span class="op" id="5097835">}</span><br>
<span class="lineno"></span><span class="op" id="5097837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="5097840">func</span>&nbsp;<span class="ident" id="5097845">parseInstReg</span><span class="op" id="5097857">(</span><span class="ident" id="5097858">p</span>&nbsp;<span class="op" id="5097860">*</span><span class="ident" id="5097861">parser</span><span class="op" id="5097867">,</span>&nbsp;<span class="ident" id="5097869">ops</span>&nbsp;<span class="op" id="5097873">[</span><span class="op" id="5097874">]</span><span class="op" id="5097875">*</span><span class="ident" id="5097876">lex8</span><span class="op" id="5097880">.</span><span class="ident" id="5097881">Token</span><span class="op" id="5097886">)</span>&nbsp;<span class="op" id="5097888">(</span><span class="op" id="5097889">*</span><span class="ident" id="5097890">inst</span><span class="op" id="5097894">,</span>&nbsp;<span class="builtintype" id="5097896">bool</span><span class="op" id="5097900">)</span>&nbsp;<span class="op" id="5097902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5097905">op0</span>&nbsp;<span class="op" id="5097909">:=</span>&nbsp;<span class="ident" id="5097912">ops</span><span class="op" id="5097915">[</span><span class="num" id="5097916">0</span><span class="op" id="5097917">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5097920">opName</span>&nbsp;<span class="op" id="5097927">:=</span>&nbsp;<span class="ident" id="5097930">op0</span><span class="op" id="5097933">.</span><span class="ident" id="5097934">Lit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5097939">args</span>&nbsp;<span class="op" id="5097944">:=</span>&nbsp;<span class="ident" id="5097947">ops</span><span class="op" id="5097950">[</span><span class="num" id="5097951">1</span><span class="op" id="5097952">:</span><span class="op" id="5097953">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5097957">//&nbsp;common&nbsp;args</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5097973">var</span>&nbsp;<span class="ident" id="5097977">fn</span><span class="op" id="5097979">,</span>&nbsp;<span class="ident" id="5097981">d</span><span class="op" id="5097982">,</span>&nbsp;<span class="ident" id="5097984">s1</span><span class="op" id="5097986">,</span>&nbsp;<span class="ident" id="5097988">s2</span><span class="op" id="5097990">,</span>&nbsp;<span class="ident" id="5097992">sh</span><span class="op" id="5097994">,</span>&nbsp;<span class="ident" id="5097996">isFloat</span>&nbsp;<span class="builtintype" id="5098004">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098013">argCount</span>&nbsp;<span class="op" id="5098022">:=</span>&nbsp;<span class="keyword" id="5098025">func</span><span class="op" id="5098029">(</span><span class="ident" id="5098030">n</span>&nbsp;<span class="builtintype" id="5098032">int</span><span class="op" id="5098035">)</span>&nbsp;<span class="builtintype" id="5098037">bool</span>&nbsp;<span class="op" id="5098042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5098046">if</span>&nbsp;<span class="op" id="5098049">!</span><span class="ident" id="5098050">argCount</span><span class="op" id="5098058">(</span><span class="ident" id="5098059">p</span><span class="op" id="5098060">,</span>&nbsp;<span class="ident" id="5098062">ops</span><span class="op" id="5098065">,</span>&nbsp;<span class="ident" id="5098067">n</span><span class="op" id="5098068">)</span>&nbsp;<span class="op" id="5098070">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5098075">return</span>&nbsp;<span class="builtintype" id="5098082">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5098090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5098094">if</span>&nbsp;<span class="ident" id="5098097">n</span>&nbsp;<span class="op" id="5098099">&gt;=</span>&nbsp;<span class="num" id="5098102">2</span>&nbsp;<span class="op" id="5098104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098109">d</span>&nbsp;<span class="op" id="5098111">=</span>&nbsp;<span class="ident" id="5098113">parseReg</span><span class="op" id="5098121">(</span><span class="ident" id="5098122">p</span><span class="op" id="5098123">,</span>&nbsp;<span class="ident" id="5098125">args</span><span class="op" id="5098129">[</span><span class="num" id="5098130">0</span><span class="op" id="5098131">]</span><span class="op" id="5098132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098137">s1</span>&nbsp;<span class="op" id="5098140">=</span>&nbsp;<span class="ident" id="5098142">parseReg</span><span class="op" id="5098150">(</span><span class="ident" id="5098151">p</span><span class="op" id="5098152">,</span>&nbsp;<span class="ident" id="5098154">args</span><span class="op" id="5098158">[</span><span class="num" id="5098159">1</span><span class="op" id="5098160">]</span><span class="op" id="5098161">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5098165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5098169">return</span>&nbsp;<span class="builtintype" id="5098176">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5098182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5098186">var</span>&nbsp;<span class="ident" id="5098190">found</span>&nbsp;<span class="builtintype" id="5098196">bool</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5098202">if</span>&nbsp;<span class="ident" id="5098205">fn</span><span class="op" id="5098207">,</span>&nbsp;<span class="ident" id="5098209">found</span>&nbsp;<span class="op" id="5098215">=</span>&nbsp;<span class="ident" id="5098217">opShiftMap</span><span class="op" id="5098227">[</span><span class="ident" id="5098228">opName</span><span class="op" id="5098234">]</span><span class="op" id="5098235">;</span>&nbsp;<span class="ident" id="5098237">found</span>&nbsp;<span class="op" id="5098243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5098247">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5098269">if</span>&nbsp;<span class="ident" id="5098272">argCount</span><span class="op" id="5098280">(</span><span class="num" id="5098281">3</span><span class="op" id="5098282">)</span>&nbsp;<span class="op" id="5098284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098289">sh</span>&nbsp;<span class="op" id="5098292">=</span>&nbsp;<span class="ident" id="5098294">parseShift</span><span class="op" id="5098304">(</span><span class="ident" id="5098305">p</span><span class="op" id="5098306">,</span>&nbsp;<span class="ident" id="5098308">args</span><span class="op" id="5098312">[</span><span class="num" id="5098313">2</span><span class="op" id="5098314">]</span><span class="op" id="5098315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5098319">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5098322">}</span>&nbsp;<span class="keyword" id="5098324">else</span>&nbsp;<span class="keyword" id="5098329">if</span>&nbsp;<span class="ident" id="5098332">fn</span><span class="op" id="5098334">,</span>&nbsp;<span class="ident" id="5098336">found</span>&nbsp;<span class="op" id="5098342">=</span>&nbsp;<span class="ident" id="5098344">opReg3Map</span><span class="op" id="5098353">[</span><span class="ident" id="5098354">opName</span><span class="op" id="5098360">]</span><span class="op" id="5098361">;</span>&nbsp;<span class="ident" id="5098363">found</span>&nbsp;<span class="op" id="5098369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5098373">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5098393">if</span>&nbsp;<span class="ident" id="5098396">argCount</span><span class="op" id="5098404">(</span><span class="num" id="5098405">3</span><span class="op" id="5098406">)</span>&nbsp;<span class="op" id="5098408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098413">s2</span>&nbsp;<span class="op" id="5098416">=</span>&nbsp;<span class="ident" id="5098418">parseReg</span><span class="op" id="5098426">(</span><span class="ident" id="5098427">p</span><span class="op" id="5098428">,</span>&nbsp;<span class="ident" id="5098430">args</span><span class="op" id="5098434">[</span><span class="num" id="5098435">2</span><span class="op" id="5098436">]</span><span class="op" id="5098437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5098441">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5098444">}</span>&nbsp;<span class="keyword" id="5098446">else</span>&nbsp;<span class="keyword" id="5098451">if</span>&nbsp;<span class="ident" id="5098454">fn</span><span class="op" id="5098456">,</span>&nbsp;<span class="ident" id="5098458">found</span>&nbsp;<span class="op" id="5098464">=</span>&nbsp;<span class="ident" id="5098466">opReg2Map</span><span class="op" id="5098475">[</span><span class="ident" id="5098476">opName</span><span class="op" id="5098482">]</span><span class="op" id="5098483">;</span>&nbsp;<span class="ident" id="5098485">found</span>&nbsp;<span class="op" id="5098491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5098495">//&nbsp;op&nbsp;reg&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098511">argCount</span><span class="op" id="5098519">(</span><span class="num" id="5098520">2</span><span class="op" id="5098521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5098524">}</span>&nbsp;<span class="keyword" id="5098526">else</span>&nbsp;<span class="keyword" id="5098531">if</span>&nbsp;<span class="ident" id="5098534">fn</span><span class="op" id="5098536">,</span>&nbsp;<span class="ident" id="5098538">found</span>&nbsp;<span class="op" id="5098544">=</span>&nbsp;<span class="ident" id="5098546">opFloatMap</span><span class="op" id="5098556">[</span><span class="ident" id="5098557">opName</span><span class="op" id="5098563">]</span><span class="op" id="5098564">;</span>&nbsp;<span class="ident" id="5098566">found</span>&nbsp;<span class="op" id="5098572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5098576">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;reg</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5098596">if</span>&nbsp;<span class="ident" id="5098599">argCount</span><span class="op" id="5098607">(</span><span class="num" id="5098608">3</span><span class="op" id="5098609">)</span>&nbsp;<span class="op" id="5098611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098616">s2</span>&nbsp;<span class="op" id="5098619">=</span>&nbsp;<span class="ident" id="5098621">parseReg</span><span class="op" id="5098629">(</span><span class="ident" id="5098630">p</span><span class="op" id="5098631">,</span>&nbsp;<span class="ident" id="5098633">args</span><span class="op" id="5098637">[</span><span class="num" id="5098638">2</span><span class="op" id="5098639">]</span><span class="op" id="5098640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5098644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098648">isFloat</span>&nbsp;<span class="op" id="5098656">=</span>&nbsp;<span class="num" id="5098658">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5098661">}</span>&nbsp;<span class="keyword" id="5098663">else</span>&nbsp;<span class="op" id="5098668">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5098672">return</span>&nbsp;<span class="ident" id="5098679">nil</span><span class="op" id="5098682">,</span>&nbsp;<span class="builtintype" id="5098684">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5098691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5098695">return</span>&nbsp;<span class="ident" id="5098702">makeInstReg</span><span class="op" id="5098713">(</span><span class="ident" id="5098714">fn</span><span class="op" id="5098716">,</span>&nbsp;<span class="ident" id="5098718">d</span><span class="op" id="5098719">,</span>&nbsp;<span class="ident" id="5098721">s1</span><span class="op" id="5098723">,</span>&nbsp;<span class="ident" id="5098725">s2</span><span class="op" id="5098727">,</span>&nbsp;<span class="ident" id="5098729">sh</span><span class="op" id="5098731">,</span>&nbsp;<span class="ident" id="5098733">isFloat</span><span class="op" id="5098740">)</span><span class="op" id="5098741">,</span>&nbsp;<span class="builtintype" id="5098743">true</span><br>
<span class="lineno"></span><span class="op" id="5098748">}</span>
</div>
</body>
</html>
