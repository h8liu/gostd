<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/json</h2>
<ul>
<li><a href="/gostd/encoding/json/bench_test.go.html">bench_test.go</a></li>
<li><a href="/gostd/encoding/json/decode.go.html">decode.go</a></li>
<li><a href="/gostd/encoding/json/decode_test.go.html">decode_test.go</a></li>
<li><a href="/gostd/encoding/json/encode.go.html">encode.go</a></li>
<li><a href="/gostd/encoding/json/encode_test.go.html">encode_test.go</a></li>
<li><a href="/gostd/encoding/json/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/json/fold.go.html">fold.go</a></li>
<li><a href="/gostd/encoding/json/fold_test.go.html">fold_test.go</a></li>
<li><a href="/gostd/encoding/json/indent.go.html">indent.go</a></li>
<li><a href="/gostd/encoding/json/scanner.go.html">scanner.go</a></li>
<li><a href="/gostd/encoding/json/scanner_test.go.html">scanner_test.go</a></li>
<li><a href="/gostd/encoding/json/stream.go.html">stream.go</a></li>
<li><a href="/gostd/encoding/json/stream_test.go.html">stream_test.go</a></li>
<li><a href="/gostd/encoding/json/tagkey_test.go.html">tagkey_test.go</a></li>
<li><a href="/gostd/encoding/json/tags.go.html">tags.go</a></li>
<li><a href="/gostd/encoding/json/tags_test.go.html">tags_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5386244">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5386300">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5386354">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5386405">package</span>&nbsp;<span class="ident" id="5386413">json</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5386419">//&nbsp;JSON&nbsp;value&nbsp;parser&nbsp;state&nbsp;machine.</span><br>
<span class="lineno"></span><span class="comment" id="5386455">//&nbsp;Just&nbsp;about&nbsp;at&nbsp;the&nbsp;limit&nbsp;of&nbsp;what&nbsp;is&nbsp;reasonable&nbsp;to&nbsp;write&nbsp;by&nbsp;hand.</span><br>
<span class="lineno"></span><span class="comment" id="5386522">//&nbsp;Some&nbsp;parts&nbsp;are&nbsp;a&nbsp;bit&nbsp;tedious,&nbsp;but&nbsp;overall&nbsp;it&nbsp;nicely&nbsp;factors&nbsp;out&nbsp;the</span><br>
<span class="lineno">10</span><span class="comment" id="5386593">//&nbsp;otherwise&nbsp;common&nbsp;code&nbsp;from&nbsp;the&nbsp;multiple&nbsp;scanning&nbsp;functions</span><br>
<span class="lineno"></span><span class="comment" id="5386655">//&nbsp;in&nbsp;this&nbsp;package&nbsp;(Compact,&nbsp;Indent,&nbsp;checkValid,&nbsp;nextValue,&nbsp;etc).</span><br>
<span class="lineno"></span><span class="comment" id="5386721">//</span><br>
<span class="lineno"></span><span class="comment" id="5386724">//&nbsp;This&nbsp;file&nbsp;starts&nbsp;with&nbsp;two&nbsp;simple&nbsp;examples&nbsp;using&nbsp;the&nbsp;scanner</span><br>
<span class="lineno"></span><span class="comment" id="5386787">//&nbsp;before&nbsp;diving&nbsp;into&nbsp;the&nbsp;scanner&nbsp;itself.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="5386830">import</span>&nbsp;<span class="string" id="5386837">&#34;strconv&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5386848">//&nbsp;checkValid&nbsp;verifies&nbsp;that&nbsp;data&nbsp;is&nbsp;valid&nbsp;JSON-encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="5386909">//&nbsp;scan&nbsp;is&nbsp;passed&nbsp;in&nbsp;for&nbsp;use&nbsp;by&nbsp;checkValid&nbsp;to&nbsp;avoid&nbsp;an&nbsp;allocation.</span><br>
<span class="lineno">20</span><span class="keyword" id="5386976">func</span>&nbsp;<span class="ident" id="5386981">checkValid</span><span class="op" id="5386991">(</span><span class="ident" id="5386992">data</span>&nbsp;<span class="op" id="5386997">[</span><span class="op" id="5386998">]</span><span class="builtintype" id="5386999">byte</span><span class="op" id="5387003">,</span>&nbsp;<span class="ident" id="5387005">scan</span>&nbsp;<span class="op" id="5387010">*</span><span class="ident" id="5387011">scanner</span><span class="op" id="5387018">)</span>&nbsp;<span class="builtintype" id="5387020">error</span>&nbsp;<span class="op" id="5387026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387029">scan</span><span class="op" id="5387033">.</span><span class="ident" id="5387034">reset</span><span class="op" id="5387039">(</span><span class="op" id="5387040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387043">for</span>&nbsp;<span class="ident" id="5387047">_</span><span class="op" id="5387048">,</span>&nbsp;<span class="ident" id="5387050">c</span>&nbsp;<span class="op" id="5387052">:=</span>&nbsp;<span class="keyword" id="5387055">range</span>&nbsp;<span class="ident" id="5387061">data</span>&nbsp;<span class="op" id="5387066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387070">scan</span><span class="op" id="5387074">.</span><span class="ident" id="5387075">bytes</span><span class="op" id="5387080">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387085">if</span>&nbsp;<span class="ident" id="5387088">scan</span><span class="op" id="5387092">.</span><span class="ident" id="5387093">step</span><span class="op" id="5387097">(</span><span class="ident" id="5387098">scan</span><span class="op" id="5387102">,</span>&nbsp;<span class="builtintype" id="5387104">int</span><span class="op" id="5387107">(</span><span class="ident" id="5387108">c</span><span class="op" id="5387109">)</span><span class="op" id="5387110">)</span>&nbsp;<span class="op" id="5387112">==</span>&nbsp;<span class="ident" id="5387115">scanError</span>&nbsp;<span class="op" id="5387125">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387130">return</span>&nbsp;<span class="ident" id="5387137">scan</span><span class="op" id="5387141">.</span><span class="ident" id="5387142">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5387148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5387151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387154">if</span>&nbsp;<span class="ident" id="5387157">scan</span><span class="op" id="5387161">.</span><span class="ident" id="5387162">eof</span><span class="op" id="5387165">(</span><span class="op" id="5387166">)</span>&nbsp;<span class="op" id="5387168">==</span>&nbsp;<span class="ident" id="5387171">scanError</span>&nbsp;<span class="op" id="5387181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387185">return</span>&nbsp;<span class="ident" id="5387192">scan</span><span class="op" id="5387196">.</span><span class="ident" id="5387197">err</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5387202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387205">return</span>&nbsp;<span class="ident" id="5387212">nil</span><br>
<span class="lineno"></span><span class="op" id="5387216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5387219">//&nbsp;nextValue&nbsp;splits&nbsp;data&nbsp;after&nbsp;the&nbsp;next&nbsp;whole&nbsp;JSON&nbsp;value,</span><br>
<span class="lineno">35</span><span class="comment" id="5387277">//&nbsp;returning&nbsp;that&nbsp;value&nbsp;and&nbsp;the&nbsp;bytes&nbsp;that&nbsp;follow&nbsp;it&nbsp;as&nbsp;separate&nbsp;slices.</span><br>
<span class="lineno"></span><span class="comment" id="5387350">//&nbsp;scan&nbsp;is&nbsp;passed&nbsp;in&nbsp;for&nbsp;use&nbsp;by&nbsp;nextValue&nbsp;to&nbsp;avoid&nbsp;an&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="5387416">func</span>&nbsp;<span class="ident" id="5387421">nextValue</span><span class="op" id="5387430">(</span><span class="ident" id="5387431">data</span>&nbsp;<span class="op" id="5387436">[</span><span class="op" id="5387437">]</span><span class="builtintype" id="5387438">byte</span><span class="op" id="5387442">,</span>&nbsp;<span class="ident" id="5387444">scan</span>&nbsp;<span class="op" id="5387449">*</span><span class="ident" id="5387450">scanner</span><span class="op" id="5387457">)</span>&nbsp;<span class="op" id="5387459">(</span><span class="ident" id="5387460">value</span><span class="op" id="5387465">,</span>&nbsp;<span class="ident" id="5387467">rest</span>&nbsp;<span class="op" id="5387472">[</span><span class="op" id="5387473">]</span><span class="builtintype" id="5387474">byte</span><span class="op" id="5387478">,</span>&nbsp;<span class="ident" id="5387480">err</span>&nbsp;<span class="builtintype" id="5387484">error</span><span class="op" id="5387489">)</span>&nbsp;<span class="op" id="5387491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387494">scan</span><span class="op" id="5387498">.</span><span class="ident" id="5387499">reset</span><span class="op" id="5387504">(</span><span class="op" id="5387505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387508">for</span>&nbsp;<span class="ident" id="5387512">i</span><span class="op" id="5387513">,</span>&nbsp;<span class="ident" id="5387515">c</span>&nbsp;<span class="op" id="5387517">:=</span>&nbsp;<span class="keyword" id="5387520">range</span>&nbsp;<span class="ident" id="5387526">data</span>&nbsp;<span class="op" id="5387531">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387535">v</span>&nbsp;<span class="op" id="5387537">:=</span>&nbsp;<span class="ident" id="5387540">scan</span><span class="op" id="5387544">.</span><span class="ident" id="5387545">step</span><span class="op" id="5387549">(</span><span class="ident" id="5387550">scan</span><span class="op" id="5387554">,</span>&nbsp;<span class="builtintype" id="5387556">int</span><span class="op" id="5387559">(</span><span class="ident" id="5387560">c</span><span class="op" id="5387561">)</span><span class="op" id="5387562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387566">if</span>&nbsp;<span class="ident" id="5387569">v</span>&nbsp;<span class="op" id="5387571">&gt;=</span>&nbsp;<span class="ident" id="5387574">scanEnd</span>&nbsp;<span class="op" id="5387582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387587">switch</span>&nbsp;<span class="ident" id="5387594">v</span>&nbsp;<span class="op" id="5387596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387601">case</span>&nbsp;<span class="ident" id="5387606">scanError</span><span class="op" id="5387615">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387621">return</span>&nbsp;<span class="ident" id="5387628">nil</span><span class="op" id="5387631">,</span>&nbsp;<span class="ident" id="5387633">nil</span><span class="op" id="5387636">,</span>&nbsp;<span class="ident" id="5387638">scan</span><span class="op" id="5387642">.</span><span class="ident" id="5387643">err</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387650">case</span>&nbsp;<span class="ident" id="5387655">scanEnd</span><span class="op" id="5387662">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387668">return</span>&nbsp;<span class="ident" id="5387675">data</span><span class="op" id="5387679">[</span><span class="num" id="5387680">0</span><span class="op" id="5387681">:</span><span class="ident" id="5387682">i</span><span class="op" id="5387683">]</span><span class="op" id="5387684">,</span>&nbsp;<span class="ident" id="5387686">data</span><span class="op" id="5387690">[</span><span class="ident" id="5387691">i</span><span class="op" id="5387692">:</span><span class="op" id="5387693">]</span><span class="op" id="5387694">,</span>&nbsp;<span class="ident" id="5387696">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5387703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5387707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5387710">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387713">if</span>&nbsp;<span class="ident" id="5387716">scan</span><span class="op" id="5387720">.</span><span class="ident" id="5387721">eof</span><span class="op" id="5387724">(</span><span class="op" id="5387725">)</span>&nbsp;<span class="op" id="5387727">==</span>&nbsp;<span class="ident" id="5387730">scanError</span>&nbsp;<span class="op" id="5387740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387744">return</span>&nbsp;<span class="ident" id="5387751">nil</span><span class="op" id="5387754">,</span>&nbsp;<span class="ident" id="5387756">nil</span><span class="op" id="5387759">,</span>&nbsp;<span class="ident" id="5387761">scan</span><span class="op" id="5387765">.</span><span class="ident" id="5387766">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5387771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5387774">return</span>&nbsp;<span class="ident" id="5387781">data</span><span class="op" id="5387785">,</span>&nbsp;<span class="ident" id="5387787">nil</span><span class="op" id="5387790">,</span>&nbsp;<span class="ident" id="5387792">nil</span><br>
<span class="lineno"></span><span class="op" id="5387796">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="5387799">//&nbsp;A&nbsp;SyntaxError&nbsp;is&nbsp;a&nbsp;description&nbsp;of&nbsp;a&nbsp;JSON&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="5387857">type</span>&nbsp;<span class="ident" id="5387862">SyntaxError</span>&nbsp;<span class="keyword" id="5387874">struct</span>&nbsp;<span class="op" id="5387881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387884">msg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5387891">string</span>&nbsp;<span class="comment" id="5387898">//&nbsp;description&nbsp;of&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5387923">Offset</span>&nbsp;<span class="ident" id="5387930">int64</span>&nbsp;&nbsp;<span class="comment" id="5387937">//&nbsp;error&nbsp;occurred&nbsp;after&nbsp;reading&nbsp;Offset&nbsp;bytes</span><br>
<span class="lineno">60</span><span class="op" id="5387982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5387985">func</span>&nbsp;<span class="op" id="5387990">(</span><span class="ident" id="5387991">e</span>&nbsp;<span class="op" id="5387993">*</span><span class="ident" id="5387994">SyntaxError</span><span class="op" id="5388005">)</span>&nbsp;<span class="ident" id="5388007">Error</span><span class="op" id="5388012">(</span><span class="op" id="5388013">)</span>&nbsp;<span class="builtintype" id="5388015">string</span>&nbsp;<span class="op" id="5388022">{</span>&nbsp;<span class="keyword" id="5388024">return</span>&nbsp;<span class="ident" id="5388031">e</span><span class="op" id="5388032">.</span><span class="ident" id="5388033">msg</span>&nbsp;<span class="op" id="5388037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5388040">//&nbsp;A&nbsp;scanner&nbsp;is&nbsp;a&nbsp;JSON&nbsp;scanning&nbsp;state&nbsp;machine.</span><br>
<span class="lineno">65</span><span class="comment" id="5388087">//&nbsp;Callers&nbsp;call&nbsp;scan.reset()&nbsp;and&nbsp;then&nbsp;pass&nbsp;bytes&nbsp;in&nbsp;one&nbsp;at&nbsp;a&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="5388153">//&nbsp;by&nbsp;calling&nbsp;scan.step(&amp;scan,&nbsp;c)&nbsp;for&nbsp;each&nbsp;byte.</span><br>
<span class="lineno"></span><span class="comment" id="5388202">//&nbsp;The&nbsp;return&nbsp;value,&nbsp;referred&nbsp;to&nbsp;as&nbsp;an&nbsp;opcode,&nbsp;tells&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5388259">//&nbsp;caller&nbsp;about&nbsp;significant&nbsp;parsing&nbsp;events&nbsp;like&nbsp;beginning</span><br>
<span class="lineno"></span><span class="comment" id="5388317">//&nbsp;and&nbsp;ending&nbsp;literals,&nbsp;objects,&nbsp;and&nbsp;arrays,&nbsp;so&nbsp;that&nbsp;the</span><br>
<span class="lineno">70</span><span class="comment" id="5388374">//&nbsp;caller&nbsp;can&nbsp;follow&nbsp;along&nbsp;if&nbsp;it&nbsp;wishes.</span><br>
<span class="lineno"></span><span class="comment" id="5388415">//&nbsp;The&nbsp;return&nbsp;value&nbsp;scanEnd&nbsp;indicates&nbsp;that&nbsp;a&nbsp;single&nbsp;top-level</span><br>
<span class="lineno"></span><span class="comment" id="5388477">//&nbsp;JSON&nbsp;value&nbsp;has&nbsp;been&nbsp;completed,&nbsp;*before*&nbsp;the&nbsp;byte&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5388534">//&nbsp;just&nbsp;got&nbsp;passed&nbsp;in.&nbsp;&nbsp;(The&nbsp;indication&nbsp;must&nbsp;be&nbsp;delayed&nbsp;in&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="5388599">//&nbsp;to&nbsp;recognize&nbsp;the&nbsp;end&nbsp;of&nbsp;numbers:&nbsp;is&nbsp;123&nbsp;a&nbsp;whole&nbsp;value&nbsp;or</span><br>
<span class="lineno">75</span><span class="comment" id="5388659">//&nbsp;the&nbsp;beginning&nbsp;of&nbsp;12345e+6?).</span><br>
<span class="lineno"></span><span class="keyword" id="5388691">type</span>&nbsp;<span class="ident" id="5388696">scanner</span>&nbsp;<span class="keyword" id="5388704">struct</span>&nbsp;<span class="op" id="5388711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5388714">//&nbsp;The&nbsp;step&nbsp;is&nbsp;a&nbsp;func&nbsp;to&nbsp;be&nbsp;called&nbsp;to&nbsp;execute&nbsp;the&nbsp;next&nbsp;transition.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5388782">//&nbsp;Also&nbsp;tried&nbsp;using&nbsp;an&nbsp;integer&nbsp;constant&nbsp;and&nbsp;a&nbsp;single&nbsp;func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5388841">//&nbsp;with&nbsp;a&nbsp;switch,&nbsp;but&nbsp;using&nbsp;the&nbsp;func&nbsp;directly&nbsp;was&nbsp;10%&nbsp;faster</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5388903">//&nbsp;on&nbsp;a&nbsp;64-bit&nbsp;Mac&nbsp;Mini,&nbsp;and&nbsp;it&#39;s&nbsp;nicer&nbsp;to&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5388953">step</span>&nbsp;<span class="keyword" id="5388958">func</span><span class="op" id="5388962">(</span><span class="op" id="5388963">*</span><span class="ident" id="5388964">scanner</span><span class="op" id="5388971">,</span>&nbsp;<span class="builtintype" id="5388973">int</span><span class="op" id="5388976">)</span>&nbsp;<span class="builtintype" id="5388978">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5388984">//&nbsp;Reached&nbsp;end&nbsp;of&nbsp;top-level&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389020">endTop</span>&nbsp;<span class="builtintype" id="5389027">bool</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5389034">//&nbsp;Stack&nbsp;of&nbsp;what&nbsp;we&#39;re&nbsp;in&nbsp;the&nbsp;middle&nbsp;of&nbsp;-&nbsp;array&nbsp;values,&nbsp;object&nbsp;keys,&nbsp;object&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389119">parseState</span>&nbsp;<span class="op" id="5389130">[</span><span class="op" id="5389131">]</span><span class="builtintype" id="5389132">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5389138">//&nbsp;Error&nbsp;that&nbsp;happened,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389171">err</span>&nbsp;<span class="builtintype" id="5389175">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5389183">//&nbsp;1-byte&nbsp;redo&nbsp;(see&nbsp;undo&nbsp;method)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389217">redo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5389227">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389233">redoCode</span>&nbsp;&nbsp;<span class="builtintype" id="5389243">int</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389248">redoState</span>&nbsp;<span class="keyword" id="5389258">func</span><span class="op" id="5389262">(</span><span class="op" id="5389263">*</span><span class="ident" id="5389264">scanner</span><span class="op" id="5389271">,</span>&nbsp;<span class="builtintype" id="5389273">int</span><span class="op" id="5389276">)</span>&nbsp;<span class="builtintype" id="5389278">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5389284">//&nbsp;total&nbsp;bytes&nbsp;consumed,&nbsp;updated&nbsp;by&nbsp;decoder.Decode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389336">bytes</span>&nbsp;<span class="ident" id="5389342">int64</span><br>
<span class="lineno"></span><span class="op" id="5389348">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="5389351">//&nbsp;These&nbsp;values&nbsp;are&nbsp;returned&nbsp;by&nbsp;the&nbsp;state&nbsp;transition&nbsp;functions</span><br>
<span class="lineno"></span><span class="comment" id="5389414">//&nbsp;assigned&nbsp;to&nbsp;scanner.state&nbsp;and&nbsp;the&nbsp;method&nbsp;scanner.eof.</span><br>
<span class="lineno"></span><span class="comment" id="5389471">//&nbsp;They&nbsp;give&nbsp;details&nbsp;about&nbsp;the&nbsp;current&nbsp;state&nbsp;of&nbsp;the&nbsp;scan&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5389533">//&nbsp;callers&nbsp;might&nbsp;be&nbsp;interested&nbsp;to&nbsp;know&nbsp;about.</span><br>
<span class="lineno">105</span><span class="comment" id="5389579">//&nbsp;It&nbsp;is&nbsp;okay&nbsp;to&nbsp;ignore&nbsp;the&nbsp;return&nbsp;value&nbsp;of&nbsp;any&nbsp;particular</span><br>
<span class="lineno"></span><span class="comment" id="5389638">//&nbsp;call&nbsp;to&nbsp;scanner.state:&nbsp;if&nbsp;one&nbsp;call&nbsp;returns&nbsp;scanError,</span><br>
<span class="lineno"></span><span class="comment" id="5389695">//&nbsp;every&nbsp;subsequent&nbsp;call&nbsp;will&nbsp;return&nbsp;scanError&nbsp;too.</span><br>
<span class="lineno"></span><span class="keyword" id="5389747">const</span>&nbsp;<span class="op" id="5389753">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5389756">//&nbsp;Continue.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389770">scanContinue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5389787">=</span>&nbsp;<span class="ident" id="5389789">iota</span>&nbsp;<span class="comment" id="5389794">//&nbsp;uninteresting&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389817">scanBeginLiteral</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5389841">//&nbsp;end&nbsp;implied&nbsp;by&nbsp;next&nbsp;result&nbsp;!=&nbsp;scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389888">scanBeginObject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5389912">//&nbsp;begin&nbsp;object</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389929">scanObjectKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5389953">//&nbsp;just&nbsp;finished&nbsp;object&nbsp;key&nbsp;(string)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5389991">scanObjectValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5390015">//&nbsp;just&nbsp;finished&nbsp;non-last&nbsp;object&nbsp;value</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390055">scanEndObject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5390079">//&nbsp;end&nbsp;object&nbsp;(implies&nbsp;scanObjectValue&nbsp;if&nbsp;possible)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390132">scanBeginArray</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5390156">//&nbsp;begin&nbsp;array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390172">scanArrayValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5390196">//&nbsp;just&nbsp;finished&nbsp;array&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390226">scanEndArray</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5390250">//&nbsp;end&nbsp;array&nbsp;(implies&nbsp;scanArrayValue&nbsp;if&nbsp;possible)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390301">scanSkipSpace</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5390325">//&nbsp;space&nbsp;byte;&nbsp;can&nbsp;skip;&nbsp;known&nbsp;to&nbsp;be&nbsp;last&nbsp;&#34;continue&#34;&nbsp;result</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5390387">//&nbsp;Stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390397">scanEnd</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5390407">//&nbsp;top-level&nbsp;value&nbsp;ended&nbsp;*before*&nbsp;this&nbsp;byte;&nbsp;known&nbsp;to&nbsp;be&nbsp;first&nbsp;&#34;stop&#34;&nbsp;result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390485">scanError</span>&nbsp;<span class="comment" id="5390495">//&nbsp;hit&nbsp;an&nbsp;error,&nbsp;scanner.err.</span><br>
<span class="lineno"></span><span class="op" id="5390525">)</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="5390528">//&nbsp;These&nbsp;values&nbsp;are&nbsp;stored&nbsp;in&nbsp;the&nbsp;parseState&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="5390580">//&nbsp;They&nbsp;give&nbsp;the&nbsp;current&nbsp;state&nbsp;of&nbsp;a&nbsp;composite&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="5390632">//&nbsp;being&nbsp;scanned.&nbsp;&nbsp;If&nbsp;the&nbsp;parser&nbsp;is&nbsp;inside&nbsp;a&nbsp;nested&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="5390690">//&nbsp;the&nbsp;parseState&nbsp;describes&nbsp;the&nbsp;nested&nbsp;state,&nbsp;outermost&nbsp;at&nbsp;entry&nbsp;0.</span><br>
<span class="lineno">130</span><span class="keyword" id="5390758">const</span>&nbsp;<span class="op" id="5390764">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390767">parseObjectKey</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5390784">=</span>&nbsp;<span class="ident" id="5390786">iota</span>&nbsp;<span class="comment" id="5390791">//&nbsp;parsing&nbsp;object&nbsp;key&nbsp;(before&nbsp;colon)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390829">parseObjectValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5390853">//&nbsp;parsing&nbsp;object&nbsp;value&nbsp;(after&nbsp;colon)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5390892">parseArrayValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5390916">//&nbsp;parsing&nbsp;array&nbsp;value</span><br>
<span class="lineno"></span><span class="op" id="5390939">)</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="5390942">//&nbsp;reset&nbsp;prepares&nbsp;the&nbsp;scanner&nbsp;for&nbsp;use.</span><br>
<span class="lineno"></span><span class="comment" id="5390981">//&nbsp;It&nbsp;must&nbsp;be&nbsp;called&nbsp;before&nbsp;calling&nbsp;s.step.</span><br>
<span class="lineno"></span><span class="keyword" id="5391025">func</span>&nbsp;<span class="op" id="5391030">(</span><span class="ident" id="5391031">s</span>&nbsp;<span class="op" id="5391033">*</span><span class="ident" id="5391034">scanner</span><span class="op" id="5391041">)</span>&nbsp;<span class="ident" id="5391043">reset</span><span class="op" id="5391048">(</span><span class="op" id="5391049">)</span>&nbsp;<span class="op" id="5391051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391054">s</span><span class="op" id="5391055">.</span><span class="ident" id="5391056">step</span>&nbsp;<span class="op" id="5391061">=</span>&nbsp;<span class="ident" id="5391063">stateBeginValue</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391080">s</span><span class="op" id="5391081">.</span><span class="ident" id="5391082">parseState</span>&nbsp;<span class="op" id="5391093">=</span>&nbsp;<span class="ident" id="5391095">s</span><span class="op" id="5391096">.</span><span class="ident" id="5391097">parseState</span><span class="op" id="5391107">[</span><span class="num" id="5391108">0</span><span class="op" id="5391109">:</span><span class="num" id="5391110">0</span><span class="op" id="5391111">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391114">s</span><span class="op" id="5391115">.</span><span class="ident" id="5391116">err</span>&nbsp;<span class="op" id="5391120">=</span>&nbsp;<span class="ident" id="5391122">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391127">s</span><span class="op" id="5391128">.</span><span class="ident" id="5391129">redo</span>&nbsp;<span class="op" id="5391134">=</span>&nbsp;<span class="builtintype" id="5391136">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391143">s</span><span class="op" id="5391144">.</span><span class="ident" id="5391145">endTop</span>&nbsp;<span class="op" id="5391152">=</span>&nbsp;<span class="builtintype" id="5391154">false</span><br>
<span class="lineno"></span><span class="op" id="5391160">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="5391163">//&nbsp;eof&nbsp;tells&nbsp;the&nbsp;scanner&nbsp;that&nbsp;the&nbsp;end&nbsp;of&nbsp;input&nbsp;has&nbsp;been&nbsp;reached.</span><br>
<span class="lineno"></span><span class="comment" id="5391228">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;scan&nbsp;status&nbsp;just&nbsp;as&nbsp;s.step&nbsp;does.</span><br>
<span class="lineno"></span><span class="keyword" id="5391277">func</span>&nbsp;<span class="op" id="5391282">(</span><span class="ident" id="5391283">s</span>&nbsp;<span class="op" id="5391285">*</span><span class="ident" id="5391286">scanner</span><span class="op" id="5391293">)</span>&nbsp;<span class="ident" id="5391295">eof</span><span class="op" id="5391298">(</span><span class="op" id="5391299">)</span>&nbsp;<span class="builtintype" id="5391301">int</span>&nbsp;<span class="op" id="5391305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5391308">if</span>&nbsp;<span class="ident" id="5391311">s</span><span class="op" id="5391312">.</span><span class="ident" id="5391313">err</span>&nbsp;<span class="op" id="5391317">!=</span>&nbsp;<span class="ident" id="5391320">nil</span>&nbsp;<span class="op" id="5391324">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5391328">return</span>&nbsp;<span class="ident" id="5391335">scanError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5391346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5391349">if</span>&nbsp;<span class="ident" id="5391352">s</span><span class="op" id="5391353">.</span><span class="ident" id="5391354">endTop</span>&nbsp;<span class="op" id="5391361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5391365">return</span>&nbsp;<span class="ident" id="5391372">scanEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5391381">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391384">s</span><span class="op" id="5391385">.</span><span class="ident" id="5391386">step</span><span class="op" id="5391390">(</span><span class="ident" id="5391391">s</span><span class="op" id="5391392">,</span>&nbsp;<span class="string" id="5391394">&#39;&nbsp;&#39;</span><span class="op" id="5391397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5391400">if</span>&nbsp;<span class="ident" id="5391403">s</span><span class="op" id="5391404">.</span><span class="ident" id="5391405">endTop</span>&nbsp;<span class="op" id="5391412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5391416">return</span>&nbsp;<span class="ident" id="5391423">scanEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5391432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5391435">if</span>&nbsp;<span class="ident" id="5391438">s</span><span class="op" id="5391439">.</span><span class="ident" id="5391440">err</span>&nbsp;<span class="op" id="5391444">==</span>&nbsp;<span class="ident" id="5391447">nil</span>&nbsp;<span class="op" id="5391451">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391455">s</span><span class="op" id="5391456">.</span><span class="ident" id="5391457">err</span>&nbsp;<span class="op" id="5391461">=</span>&nbsp;<span class="op" id="5391463">&amp;</span><span class="ident" id="5391464">SyntaxError</span><span class="op" id="5391475">{</span><span class="string" id="5391476">&#34;unexpected&nbsp;end&nbsp;of&nbsp;JSON&nbsp;input&#34;</span><span class="op" id="5391506">,</span>&nbsp;<span class="ident" id="5391508">s</span><span class="op" id="5391509">.</span><span class="ident" id="5391510">bytes</span><span class="op" id="5391515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5391518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5391521">return</span>&nbsp;<span class="ident" id="5391528">scanError</span><br>
<span class="lineno"></span><span class="op" id="5391538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="5391541">//&nbsp;pushParseState&nbsp;pushes&nbsp;a&nbsp;new&nbsp;parse&nbsp;state&nbsp;p&nbsp;onto&nbsp;the&nbsp;parse&nbsp;stack.</span><br>
<span class="lineno"></span><span class="keyword" id="5391608">func</span>&nbsp;<span class="op" id="5391613">(</span><span class="ident" id="5391614">s</span>&nbsp;<span class="op" id="5391616">*</span><span class="ident" id="5391617">scanner</span><span class="op" id="5391624">)</span>&nbsp;<span class="ident" id="5391626">pushParseState</span><span class="op" id="5391640">(</span><span class="ident" id="5391641">p</span>&nbsp;<span class="builtintype" id="5391643">int</span><span class="op" id="5391646">)</span>&nbsp;<span class="op" id="5391648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391651">s</span><span class="op" id="5391652">.</span><span class="ident" id="5391653">parseState</span>&nbsp;<span class="op" id="5391664">=</span>&nbsp;<span class="builtinfunc" id="5391666">append</span><span class="op" id="5391672">(</span><span class="ident" id="5391673">s</span><span class="op" id="5391674">.</span><span class="ident" id="5391675">parseState</span><span class="op" id="5391685">,</span>&nbsp;<span class="ident" id="5391687">p</span><span class="op" id="5391688">)</span><br>
<span class="lineno"></span><span class="op" id="5391690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="comment" id="5391693">//&nbsp;popParseState&nbsp;pops&nbsp;a&nbsp;parse&nbsp;state&nbsp;(already&nbsp;obtained)&nbsp;off&nbsp;the&nbsp;stack</span><br>
<span class="lineno"></span><span class="comment" id="5391762">//&nbsp;and&nbsp;updates&nbsp;s.step&nbsp;accordingly.</span><br>
<span class="lineno"></span><span class="keyword" id="5391797">func</span>&nbsp;<span class="op" id="5391802">(</span><span class="ident" id="5391803">s</span>&nbsp;<span class="op" id="5391805">*</span><span class="ident" id="5391806">scanner</span><span class="op" id="5391813">)</span>&nbsp;<span class="ident" id="5391815">popParseState</span><span class="op" id="5391828">(</span><span class="op" id="5391829">)</span>&nbsp;<span class="op" id="5391831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391834">n</span>&nbsp;<span class="op" id="5391836">:=</span>&nbsp;<span class="builtinfunc" id="5391839">len</span><span class="op" id="5391842">(</span><span class="ident" id="5391843">s</span><span class="op" id="5391844">.</span><span class="ident" id="5391845">parseState</span><span class="op" id="5391855">)</span>&nbsp;<span class="op" id="5391857">-</span>&nbsp;<span class="num" id="5391859">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391862">s</span><span class="op" id="5391863">.</span><span class="ident" id="5391864">parseState</span>&nbsp;<span class="op" id="5391875">=</span>&nbsp;<span class="ident" id="5391877">s</span><span class="op" id="5391878">.</span><span class="ident" id="5391879">parseState</span><span class="op" id="5391889">[</span><span class="num" id="5391890">0</span><span class="op" id="5391891">:</span><span class="ident" id="5391892">n</span><span class="op" id="5391893">]</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391896">s</span><span class="op" id="5391897">.</span><span class="ident" id="5391898">redo</span>&nbsp;<span class="op" id="5391903">=</span>&nbsp;<span class="builtintype" id="5391905">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5391912">if</span>&nbsp;<span class="ident" id="5391915">n</span>&nbsp;<span class="op" id="5391917">==</span>&nbsp;<span class="num" id="5391920">0</span>&nbsp;<span class="op" id="5391922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391926">s</span><span class="op" id="5391927">.</span><span class="ident" id="5391928">step</span>&nbsp;<span class="op" id="5391933">=</span>&nbsp;<span class="ident" id="5391935">stateEndTop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391949">s</span><span class="op" id="5391950">.</span><span class="ident" id="5391951">endTop</span>&nbsp;<span class="op" id="5391958">=</span>&nbsp;<span class="builtintype" id="5391960">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5391966">}</span>&nbsp;<span class="keyword" id="5391968">else</span>&nbsp;<span class="op" id="5391973">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5391977">s</span><span class="op" id="5391978">.</span><span class="ident" id="5391979">step</span>&nbsp;<span class="op" id="5391984">=</span>&nbsp;<span class="ident" id="5391986">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5392001">}</span><br>
<span class="lineno"></span><span class="op" id="5392003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5392006">func</span>&nbsp;<span class="ident" id="5392011">isSpace</span><span class="op" id="5392018">(</span><span class="ident" id="5392019">c</span>&nbsp;<span class="builtintype" id="5392021">rune</span><span class="op" id="5392025">)</span>&nbsp;<span class="builtintype" id="5392027">bool</span>&nbsp;<span class="op" id="5392032">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392035">return</span>&nbsp;<span class="ident" id="5392042">c</span>&nbsp;<span class="op" id="5392044">==</span>&nbsp;<span class="string" id="5392047">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5392051">||</span>&nbsp;<span class="ident" id="5392054">c</span>&nbsp;<span class="op" id="5392056">==</span>&nbsp;<span class="string" id="5392059">&#39;\t&#39;</span>&nbsp;<span class="op" id="5392064">||</span>&nbsp;<span class="ident" id="5392067">c</span>&nbsp;<span class="op" id="5392069">==</span>&nbsp;<span class="string" id="5392072">&#39;\r&#39;</span>&nbsp;<span class="op" id="5392077">||</span>&nbsp;<span class="ident" id="5392080">c</span>&nbsp;<span class="op" id="5392082">==</span>&nbsp;<span class="string" id="5392085">&#39;\n&#39;</span><br>
<span class="lineno"></span><span class="op" id="5392090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5392093">//&nbsp;stateBeginValueOrEmpty&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`[`.</span><br>
<span class="lineno"></span><span class="keyword" id="5392151">func</span>&nbsp;<span class="ident" id="5392156">stateBeginValueOrEmpty</span><span class="op" id="5392178">(</span><span class="ident" id="5392179">s</span>&nbsp;<span class="op" id="5392181">*</span><span class="ident" id="5392182">scanner</span><span class="op" id="5392189">,</span>&nbsp;<span class="ident" id="5392191">c</span>&nbsp;<span class="builtintype" id="5392193">int</span><span class="op" id="5392196">)</span>&nbsp;<span class="builtintype" id="5392198">int</span>&nbsp;<span class="op" id="5392202">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392205">if</span>&nbsp;<span class="ident" id="5392208">c</span>&nbsp;<span class="op" id="5392210">&lt;=</span>&nbsp;<span class="string" id="5392213">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5392217">&amp;&amp;</span>&nbsp;<span class="ident" id="5392220">isSpace</span><span class="op" id="5392227">(</span><span class="builtintype" id="5392228">rune</span><span class="op" id="5392232">(</span><span class="ident" id="5392233">c</span><span class="op" id="5392234">)</span><span class="op" id="5392235">)</span>&nbsp;<span class="op" id="5392237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392241">return</span>&nbsp;<span class="ident" id="5392248">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5392263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392266">if</span>&nbsp;<span class="ident" id="5392269">c</span>&nbsp;<span class="op" id="5392271">==</span>&nbsp;<span class="string" id="5392274">&#39;]&#39;</span>&nbsp;<span class="op" id="5392278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392282">return</span>&nbsp;<span class="ident" id="5392289">stateEndValue</span><span class="op" id="5392302">(</span><span class="ident" id="5392303">s</span><span class="op" id="5392304">,</span>&nbsp;<span class="ident" id="5392306">c</span><span class="op" id="5392307">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5392310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392313">return</span>&nbsp;<span class="ident" id="5392320">stateBeginValue</span><span class="op" id="5392335">(</span><span class="ident" id="5392336">s</span><span class="op" id="5392337">,</span>&nbsp;<span class="ident" id="5392339">c</span><span class="op" id="5392340">)</span><br>
<span class="lineno"></span><span class="op" id="5392342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5392345">//&nbsp;stateBeginValue&nbsp;is&nbsp;the&nbsp;state&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;input.</span><br>
<span class="lineno">200</span><span class="keyword" id="5392408">func</span>&nbsp;<span class="ident" id="5392413">stateBeginValue</span><span class="op" id="5392428">(</span><span class="ident" id="5392429">s</span>&nbsp;<span class="op" id="5392431">*</span><span class="ident" id="5392432">scanner</span><span class="op" id="5392439">,</span>&nbsp;<span class="ident" id="5392441">c</span>&nbsp;<span class="builtintype" id="5392443">int</span><span class="op" id="5392446">)</span>&nbsp;<span class="builtintype" id="5392448">int</span>&nbsp;<span class="op" id="5392452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392455">if</span>&nbsp;<span class="ident" id="5392458">c</span>&nbsp;<span class="op" id="5392460">&lt;=</span>&nbsp;<span class="string" id="5392463">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5392467">&amp;&amp;</span>&nbsp;<span class="ident" id="5392470">isSpace</span><span class="op" id="5392477">(</span><span class="builtintype" id="5392478">rune</span><span class="op" id="5392482">(</span><span class="ident" id="5392483">c</span><span class="op" id="5392484">)</span><span class="op" id="5392485">)</span>&nbsp;<span class="op" id="5392487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392491">return</span>&nbsp;<span class="ident" id="5392498">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5392513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392516">switch</span>&nbsp;<span class="ident" id="5392523">c</span>&nbsp;<span class="op" id="5392525">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392528">case</span>&nbsp;<span class="string" id="5392533">&#39;{&#39;</span><span class="op" id="5392536">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5392540">s</span><span class="op" id="5392541">.</span><span class="ident" id="5392542">step</span>&nbsp;<span class="op" id="5392547">=</span>&nbsp;<span class="ident" id="5392549">stateBeginStringOrEmpty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5392575">s</span><span class="op" id="5392576">.</span><span class="ident" id="5392577">pushParseState</span><span class="op" id="5392591">(</span><span class="ident" id="5392592">parseObjectKey</span><span class="op" id="5392606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392610">return</span>&nbsp;<span class="ident" id="5392617">scanBeginObject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392634">case</span>&nbsp;<span class="string" id="5392639">&#39;[&#39;</span><span class="op" id="5392642">:</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5392646">s</span><span class="op" id="5392647">.</span><span class="ident" id="5392648">step</span>&nbsp;<span class="op" id="5392653">=</span>&nbsp;<span class="ident" id="5392655">stateBeginValueOrEmpty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5392680">s</span><span class="op" id="5392681">.</span><span class="ident" id="5392682">pushParseState</span><span class="op" id="5392696">(</span><span class="ident" id="5392697">parseArrayValue</span><span class="op" id="5392712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392716">return</span>&nbsp;<span class="ident" id="5392723">scanBeginArray</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392739">case</span>&nbsp;<span class="string" id="5392744">&#39;&#34;&#39;</span><span class="op" id="5392747">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5392751">s</span><span class="op" id="5392752">.</span><span class="ident" id="5392753">step</span>&nbsp;<span class="op" id="5392758">=</span>&nbsp;<span class="ident" id="5392760">stateInString</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392776">return</span>&nbsp;<span class="ident" id="5392783">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392801">case</span>&nbsp;<span class="string" id="5392806">&#39;-&#39;</span><span class="op" id="5392809">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5392813">s</span><span class="op" id="5392814">.</span><span class="ident" id="5392815">step</span>&nbsp;<span class="op" id="5392820">=</span>&nbsp;<span class="ident" id="5392822">stateNeg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392833">return</span>&nbsp;<span class="ident" id="5392840">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392858">case</span>&nbsp;<span class="string" id="5392863">&#39;0&#39;</span><span class="op" id="5392866">:</span>&nbsp;<span class="comment" id="5392868">//&nbsp;beginning&nbsp;of&nbsp;0.123</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5392892">s</span><span class="op" id="5392893">.</span><span class="ident" id="5392894">step</span>&nbsp;<span class="op" id="5392899">=</span>&nbsp;<span class="ident" id="5392901">state0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392910">return</span>&nbsp;<span class="ident" id="5392917">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392935">case</span>&nbsp;<span class="string" id="5392940">&#39;t&#39;</span><span class="op" id="5392943">:</span>&nbsp;<span class="comment" id="5392945">//&nbsp;beginning&nbsp;of&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5392968">s</span><span class="op" id="5392969">.</span><span class="ident" id="5392970">step</span>&nbsp;<span class="op" id="5392975">=</span>&nbsp;<span class="ident" id="5392977">stateT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5392986">return</span>&nbsp;<span class="ident" id="5392993">scanBeginLiteral</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393011">case</span>&nbsp;<span class="string" id="5393016">&#39;f&#39;</span><span class="op" id="5393019">:</span>&nbsp;<span class="comment" id="5393021">//&nbsp;beginning&nbsp;of&nbsp;false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5393045">s</span><span class="op" id="5393046">.</span><span class="ident" id="5393047">step</span>&nbsp;<span class="op" id="5393052">=</span>&nbsp;<span class="ident" id="5393054">stateF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393063">return</span>&nbsp;<span class="ident" id="5393070">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393088">case</span>&nbsp;<span class="string" id="5393093">&#39;n&#39;</span><span class="op" id="5393096">:</span>&nbsp;<span class="comment" id="5393098">//&nbsp;beginning&nbsp;of&nbsp;null</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5393121">s</span><span class="op" id="5393122">.</span><span class="ident" id="5393123">step</span>&nbsp;<span class="op" id="5393128">=</span>&nbsp;<span class="ident" id="5393130">stateN</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393139">return</span>&nbsp;<span class="ident" id="5393146">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5393164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393167">if</span>&nbsp;<span class="string" id="5393170">&#39;1&#39;</span>&nbsp;<span class="op" id="5393174">&lt;=</span>&nbsp;<span class="ident" id="5393177">c</span>&nbsp;<span class="op" id="5393179">&amp;&amp;</span>&nbsp;<span class="ident" id="5393182">c</span>&nbsp;<span class="op" id="5393184">&lt;=</span>&nbsp;<span class="string" id="5393187">&#39;9&#39;</span>&nbsp;<span class="op" id="5393191">{</span>&nbsp;<span class="comment" id="5393193">//&nbsp;beginning&nbsp;of&nbsp;1234.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5393218">s</span><span class="op" id="5393219">.</span><span class="ident" id="5393220">step</span>&nbsp;<span class="op" id="5393225">=</span>&nbsp;<span class="ident" id="5393227">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393236">return</span>&nbsp;<span class="ident" id="5393243">scanBeginLiteral</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5393261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393264">return</span>&nbsp;<span class="ident" id="5393271">s</span><span class="op" id="5393272">.</span><span class="builtintype" id="5393273">error</span><span class="op" id="5393278">(</span><span class="ident" id="5393279">c</span><span class="op" id="5393280">,</span>&nbsp;<span class="string" id="5393282">&#34;looking&nbsp;for&nbsp;beginning&nbsp;of&nbsp;value&#34;</span><span class="op" id="5393314">)</span><br>
<span class="lineno"></span><span class="op" id="5393316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5393319">//&nbsp;stateBeginStringOrEmpty&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`{`.</span><br>
<span class="lineno">240</span><span class="keyword" id="5393378">func</span>&nbsp;<span class="ident" id="5393383">stateBeginStringOrEmpty</span><span class="op" id="5393406">(</span><span class="ident" id="5393407">s</span>&nbsp;<span class="op" id="5393409">*</span><span class="ident" id="5393410">scanner</span><span class="op" id="5393417">,</span>&nbsp;<span class="ident" id="5393419">c</span>&nbsp;<span class="builtintype" id="5393421">int</span><span class="op" id="5393424">)</span>&nbsp;<span class="builtintype" id="5393426">int</span>&nbsp;<span class="op" id="5393430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393433">if</span>&nbsp;<span class="ident" id="5393436">c</span>&nbsp;<span class="op" id="5393438">&lt;=</span>&nbsp;<span class="string" id="5393441">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5393445">&amp;&amp;</span>&nbsp;<span class="ident" id="5393448">isSpace</span><span class="op" id="5393455">(</span><span class="builtintype" id="5393456">rune</span><span class="op" id="5393460">(</span><span class="ident" id="5393461">c</span><span class="op" id="5393462">)</span><span class="op" id="5393463">)</span>&nbsp;<span class="op" id="5393465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393469">return</span>&nbsp;<span class="ident" id="5393476">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5393491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393494">if</span>&nbsp;<span class="ident" id="5393497">c</span>&nbsp;<span class="op" id="5393499">==</span>&nbsp;<span class="string" id="5393502">&#39;}&#39;</span>&nbsp;<span class="op" id="5393506">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5393510">n</span>&nbsp;<span class="op" id="5393512">:=</span>&nbsp;<span class="builtinfunc" id="5393515">len</span><span class="op" id="5393518">(</span><span class="ident" id="5393519">s</span><span class="op" id="5393520">.</span><span class="ident" id="5393521">parseState</span><span class="op" id="5393531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5393535">s</span><span class="op" id="5393536">.</span><span class="ident" id="5393537">parseState</span><span class="op" id="5393547">[</span><span class="ident" id="5393548">n</span><span class="op" id="5393549">-</span><span class="num" id="5393550">1</span><span class="op" id="5393551">]</span>&nbsp;<span class="op" id="5393553">=</span>&nbsp;<span class="ident" id="5393555">parseObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393574">return</span>&nbsp;<span class="ident" id="5393581">stateEndValue</span><span class="op" id="5393594">(</span><span class="ident" id="5393595">s</span><span class="op" id="5393596">,</span>&nbsp;<span class="ident" id="5393598">c</span><span class="op" id="5393599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5393602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393605">return</span>&nbsp;<span class="ident" id="5393612">stateBeginString</span><span class="op" id="5393628">(</span><span class="ident" id="5393629">s</span><span class="op" id="5393630">,</span>&nbsp;<span class="ident" id="5393632">c</span><span class="op" id="5393633">)</span><br>
<span class="lineno">250</span><span class="op" id="5393635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5393638">//&nbsp;stateBeginString&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`{&#34;key&#34;:&nbsp;value,`.</span><br>
<span class="lineno"></span><span class="keyword" id="5393703">func</span>&nbsp;<span class="ident" id="5393708">stateBeginString</span><span class="op" id="5393724">(</span><span class="ident" id="5393725">s</span>&nbsp;<span class="op" id="5393727">*</span><span class="ident" id="5393728">scanner</span><span class="op" id="5393735">,</span>&nbsp;<span class="ident" id="5393737">c</span>&nbsp;<span class="builtintype" id="5393739">int</span><span class="op" id="5393742">)</span>&nbsp;<span class="builtintype" id="5393744">int</span>&nbsp;<span class="op" id="5393748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393751">if</span>&nbsp;<span class="ident" id="5393754">c</span>&nbsp;<span class="op" id="5393756">&lt;=</span>&nbsp;<span class="string" id="5393759">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5393763">&amp;&amp;</span>&nbsp;<span class="ident" id="5393766">isSpace</span><span class="op" id="5393773">(</span><span class="builtintype" id="5393774">rune</span><span class="op" id="5393778">(</span><span class="ident" id="5393779">c</span><span class="op" id="5393780">)</span><span class="op" id="5393781">)</span>&nbsp;<span class="op" id="5393783">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393787">return</span>&nbsp;<span class="ident" id="5393794">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5393809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393812">if</span>&nbsp;<span class="ident" id="5393815">c</span>&nbsp;<span class="op" id="5393817">==</span>&nbsp;<span class="string" id="5393820">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="5393824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5393828">s</span><span class="op" id="5393829">.</span><span class="ident" id="5393830">step</span>&nbsp;<span class="op" id="5393835">=</span>&nbsp;<span class="ident" id="5393837">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393853">return</span>&nbsp;<span class="ident" id="5393860">scanBeginLiteral</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5393878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5393881">return</span>&nbsp;<span class="ident" id="5393888">s</span><span class="op" id="5393889">.</span><span class="builtintype" id="5393890">error</span><span class="op" id="5393895">(</span><span class="ident" id="5393896">c</span><span class="op" id="5393897">,</span>&nbsp;<span class="string" id="5393899">&#34;looking&nbsp;for&nbsp;beginning&nbsp;of&nbsp;object&nbsp;key&nbsp;string&#34;</span><span class="op" id="5393943">)</span><br>
<span class="lineno"></span><span class="op" id="5393945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5393948">//&nbsp;stateEndValue&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;completing&nbsp;a&nbsp;value,</span><br>
<span class="lineno">265</span><span class="comment" id="5394004">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`{}`&nbsp;or&nbsp;`true`&nbsp;or&nbsp;`[&#34;x&#34;`.</span><br>
<span class="lineno"></span><span class="keyword" id="5394055">func</span>&nbsp;<span class="ident" id="5394060">stateEndValue</span><span class="op" id="5394073">(</span><span class="ident" id="5394074">s</span>&nbsp;<span class="op" id="5394076">*</span><span class="ident" id="5394077">scanner</span><span class="op" id="5394084">,</span>&nbsp;<span class="ident" id="5394086">c</span>&nbsp;<span class="builtintype" id="5394088">int</span><span class="op" id="5394091">)</span>&nbsp;<span class="builtintype" id="5394093">int</span>&nbsp;<span class="op" id="5394097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5394100">n</span>&nbsp;<span class="op" id="5394102">:=</span>&nbsp;<span class="builtinfunc" id="5394105">len</span><span class="op" id="5394108">(</span><span class="ident" id="5394109">s</span><span class="op" id="5394110">.</span><span class="ident" id="5394111">parseState</span><span class="op" id="5394121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394124">if</span>&nbsp;<span class="ident" id="5394127">n</span>&nbsp;<span class="op" id="5394129">==</span>&nbsp;<span class="num" id="5394132">0</span>&nbsp;<span class="op" id="5394134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5394138">//&nbsp;Completed&nbsp;top-level&nbsp;before&nbsp;the&nbsp;current&nbsp;byte.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5394188">s</span><span class="op" id="5394189">.</span><span class="ident" id="5394190">step</span>&nbsp;<span class="op" id="5394195">=</span>&nbsp;<span class="ident" id="5394197">stateEndTop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5394211">s</span><span class="op" id="5394212">.</span><span class="ident" id="5394213">endTop</span>&nbsp;<span class="op" id="5394220">=</span>&nbsp;<span class="builtintype" id="5394222">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394229">return</span>&nbsp;<span class="ident" id="5394236">stateEndTop</span><span class="op" id="5394247">(</span><span class="ident" id="5394248">s</span><span class="op" id="5394249">,</span>&nbsp;<span class="ident" id="5394251">c</span><span class="op" id="5394252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5394255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394258">if</span>&nbsp;<span class="ident" id="5394261">c</span>&nbsp;<span class="op" id="5394263">&lt;=</span>&nbsp;<span class="string" id="5394266">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5394270">&amp;&amp;</span>&nbsp;<span class="ident" id="5394273">isSpace</span><span class="op" id="5394280">(</span><span class="builtintype" id="5394281">rune</span><span class="op" id="5394285">(</span><span class="ident" id="5394286">c</span><span class="op" id="5394287">)</span><span class="op" id="5394288">)</span>&nbsp;<span class="op" id="5394290">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5394294">s</span><span class="op" id="5394295">.</span><span class="ident" id="5394296">step</span>&nbsp;<span class="op" id="5394301">=</span>&nbsp;<span class="ident" id="5394303">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394319">return</span>&nbsp;<span class="ident" id="5394326">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5394341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5394344">ps</span>&nbsp;<span class="op" id="5394347">:=</span>&nbsp;<span class="ident" id="5394350">s</span><span class="op" id="5394351">.</span><span class="ident" id="5394352">parseState</span><span class="op" id="5394362">[</span><span class="ident" id="5394363">n</span><span class="op" id="5394364">-</span><span class="num" id="5394365">1</span><span class="op" id="5394366">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394369">switch</span>&nbsp;<span class="ident" id="5394376">ps</span>&nbsp;<span class="op" id="5394379">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394382">case</span>&nbsp;<span class="ident" id="5394387">parseObjectKey</span><span class="op" id="5394401">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394405">if</span>&nbsp;<span class="ident" id="5394408">c</span>&nbsp;<span class="op" id="5394410">==</span>&nbsp;<span class="string" id="5394413">&#39;:&#39;</span>&nbsp;<span class="op" id="5394417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5394422">s</span><span class="op" id="5394423">.</span><span class="ident" id="5394424">parseState</span><span class="op" id="5394434">[</span><span class="ident" id="5394435">n</span><span class="op" id="5394436">-</span><span class="num" id="5394437">1</span><span class="op" id="5394438">]</span>&nbsp;<span class="op" id="5394440">=</span>&nbsp;<span class="ident" id="5394442">parseObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5394462">s</span><span class="op" id="5394463">.</span><span class="ident" id="5394464">step</span>&nbsp;<span class="op" id="5394469">=</span>&nbsp;<span class="ident" id="5394471">stateBeginValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394490">return</span>&nbsp;<span class="ident" id="5394497">scanObjectKey</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5394513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394517">return</span>&nbsp;<span class="ident" id="5394524">s</span><span class="op" id="5394525">.</span><span class="builtintype" id="5394526">error</span><span class="op" id="5394531">(</span><span class="ident" id="5394532">c</span><span class="op" id="5394533">,</span>&nbsp;<span class="string" id="5394535">&#34;after&nbsp;object&nbsp;key&#34;</span><span class="op" id="5394553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394556">case</span>&nbsp;<span class="ident" id="5394561">parseObjectValue</span><span class="op" id="5394577">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394581">if</span>&nbsp;<span class="ident" id="5394584">c</span>&nbsp;<span class="op" id="5394586">==</span>&nbsp;<span class="string" id="5394589">&#39;,&#39;</span>&nbsp;<span class="op" id="5394593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5394598">s</span><span class="op" id="5394599">.</span><span class="ident" id="5394600">parseState</span><span class="op" id="5394610">[</span><span class="ident" id="5394611">n</span><span class="op" id="5394612">-</span><span class="num" id="5394613">1</span><span class="op" id="5394614">]</span>&nbsp;<span class="op" id="5394616">=</span>&nbsp;<span class="ident" id="5394618">parseObjectKey</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5394636">s</span><span class="op" id="5394637">.</span><span class="ident" id="5394638">step</span>&nbsp;<span class="op" id="5394643">=</span>&nbsp;<span class="ident" id="5394645">stateBeginString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394665">return</span>&nbsp;<span class="ident" id="5394672">scanObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5394690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394694">if</span>&nbsp;<span class="ident" id="5394697">c</span>&nbsp;<span class="op" id="5394699">==</span>&nbsp;<span class="string" id="5394702">&#39;}&#39;</span>&nbsp;<span class="op" id="5394706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5394711">s</span><span class="op" id="5394712">.</span><span class="ident" id="5394713">popParseState</span><span class="op" id="5394726">(</span><span class="op" id="5394727">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394732">return</span>&nbsp;<span class="ident" id="5394739">scanEndObject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5394755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394759">return</span>&nbsp;<span class="ident" id="5394766">s</span><span class="op" id="5394767">.</span><span class="builtintype" id="5394768">error</span><span class="op" id="5394773">(</span><span class="ident" id="5394774">c</span><span class="op" id="5394775">,</span>&nbsp;<span class="string" id="5394777">&#34;after&nbsp;object&nbsp;key:value&nbsp;pair&#34;</span><span class="op" id="5394806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394809">case</span>&nbsp;<span class="ident" id="5394814">parseArrayValue</span><span class="op" id="5394829">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394833">if</span>&nbsp;<span class="ident" id="5394836">c</span>&nbsp;<span class="op" id="5394838">==</span>&nbsp;<span class="string" id="5394841">&#39;,&#39;</span>&nbsp;<span class="op" id="5394845">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5394850">s</span><span class="op" id="5394851">.</span><span class="ident" id="5394852">step</span>&nbsp;<span class="op" id="5394857">=</span>&nbsp;<span class="ident" id="5394859">stateBeginValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394878">return</span>&nbsp;<span class="ident" id="5394885">scanArrayValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5394902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394906">if</span>&nbsp;<span class="ident" id="5394909">c</span>&nbsp;<span class="op" id="5394911">==</span>&nbsp;<span class="string" id="5394914">&#39;]&#39;</span>&nbsp;<span class="op" id="5394918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5394923">s</span><span class="op" id="5394924">.</span><span class="ident" id="5394925">popParseState</span><span class="op" id="5394938">(</span><span class="op" id="5394939">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394944">return</span>&nbsp;<span class="ident" id="5394951">scanEndArray</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5394966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5394970">return</span>&nbsp;<span class="ident" id="5394977">s</span><span class="op" id="5394978">.</span><span class="builtintype" id="5394979">error</span><span class="op" id="5394984">(</span><span class="ident" id="5394985">c</span><span class="op" id="5394986">,</span>&nbsp;<span class="string" id="5394988">&#34;after&nbsp;array&nbsp;element&#34;</span><span class="op" id="5395009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5395012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5395015">return</span>&nbsp;<span class="ident" id="5395022">s</span><span class="op" id="5395023">.</span><span class="builtintype" id="5395024">error</span><span class="op" id="5395029">(</span><span class="ident" id="5395030">c</span><span class="op" id="5395031">,</span>&nbsp;<span class="string" id="5395033">&#34;&#34;</span><span class="op" id="5395035">)</span><br>
<span class="lineno">310</span><span class="op" id="5395037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5395040">//&nbsp;stateEndTop&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;finishing&nbsp;the&nbsp;top-level&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="5395105">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`{}`&nbsp;or&nbsp;`[1,2,3]`.</span><br>
<span class="lineno"></span><span class="comment" id="5395149">//&nbsp;Only&nbsp;space&nbsp;characters&nbsp;should&nbsp;be&nbsp;seen&nbsp;now.</span><br>
<span class="lineno">315</span><span class="keyword" id="5395194">func</span>&nbsp;<span class="ident" id="5395199">stateEndTop</span><span class="op" id="5395210">(</span><span class="ident" id="5395211">s</span>&nbsp;<span class="op" id="5395213">*</span><span class="ident" id="5395214">scanner</span><span class="op" id="5395221">,</span>&nbsp;<span class="ident" id="5395223">c</span>&nbsp;<span class="builtintype" id="5395225">int</span><span class="op" id="5395228">)</span>&nbsp;<span class="builtintype" id="5395230">int</span>&nbsp;<span class="op" id="5395234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5395237">if</span>&nbsp;<span class="ident" id="5395240">c</span>&nbsp;<span class="op" id="5395242">!=</span>&nbsp;<span class="string" id="5395245">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5395249">&amp;&amp;</span>&nbsp;<span class="ident" id="5395252">c</span>&nbsp;<span class="op" id="5395254">!=</span>&nbsp;<span class="string" id="5395257">&#39;\t&#39;</span>&nbsp;<span class="op" id="5395262">&amp;&amp;</span>&nbsp;<span class="ident" id="5395265">c</span>&nbsp;<span class="op" id="5395267">!=</span>&nbsp;<span class="string" id="5395270">&#39;\r&#39;</span>&nbsp;<span class="op" id="5395275">&amp;&amp;</span>&nbsp;<span class="ident" id="5395278">c</span>&nbsp;<span class="op" id="5395280">!=</span>&nbsp;<span class="string" id="5395283">&#39;\n&#39;</span>&nbsp;<span class="op" id="5395288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5395292">//&nbsp;Complain&nbsp;about&nbsp;non-space&nbsp;byte&nbsp;on&nbsp;next&nbsp;call.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5395341">s</span><span class="op" id="5395342">.</span><span class="builtintype" id="5395343">error</span><span class="op" id="5395348">(</span><span class="ident" id="5395349">c</span><span class="op" id="5395350">,</span>&nbsp;<span class="string" id="5395352">&#34;after&nbsp;top-level&nbsp;value&#34;</span><span class="op" id="5395375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5395378">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5395381">return</span>&nbsp;<span class="ident" id="5395388">scanEnd</span><br>
<span class="lineno"></span><span class="op" id="5395396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5395399">//&nbsp;stateInString&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;`.</span><br>
<span class="lineno"></span><span class="keyword" id="5395448">func</span>&nbsp;<span class="ident" id="5395453">stateInString</span><span class="op" id="5395466">(</span><span class="ident" id="5395467">s</span>&nbsp;<span class="op" id="5395469">*</span><span class="ident" id="5395470">scanner</span><span class="op" id="5395477">,</span>&nbsp;<span class="ident" id="5395479">c</span>&nbsp;<span class="builtintype" id="5395481">int</span><span class="op" id="5395484">)</span>&nbsp;<span class="builtintype" id="5395486">int</span>&nbsp;<span class="op" id="5395490">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5395493">if</span>&nbsp;<span class="ident" id="5395496">c</span>&nbsp;<span class="op" id="5395498">==</span>&nbsp;<span class="string" id="5395501">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="5395505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5395509">s</span><span class="op" id="5395510">.</span><span class="ident" id="5395511">step</span>&nbsp;<span class="op" id="5395516">=</span>&nbsp;<span class="ident" id="5395518">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5395534">return</span>&nbsp;<span class="ident" id="5395541">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5395555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5395558">if</span>&nbsp;<span class="ident" id="5395561">c</span>&nbsp;<span class="op" id="5395563">==</span>&nbsp;<span class="string" id="5395566">&#39;\\&#39;</span>&nbsp;<span class="op" id="5395571">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5395575">s</span><span class="op" id="5395576">.</span><span class="ident" id="5395577">step</span>&nbsp;<span class="op" id="5395582">=</span>&nbsp;<span class="ident" id="5395584">stateInStringEsc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5395603">return</span>&nbsp;<span class="ident" id="5395610">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5395624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5395627">if</span>&nbsp;<span class="ident" id="5395630">c</span>&nbsp;<span class="op" id="5395632">&lt;</span>&nbsp;<span class="num" id="5395634">0x20</span>&nbsp;<span class="op" id="5395639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5395643">return</span>&nbsp;<span class="ident" id="5395650">s</span><span class="op" id="5395651">.</span><span class="builtintype" id="5395652">error</span><span class="op" id="5395657">(</span><span class="ident" id="5395658">c</span><span class="op" id="5395659">,</span>&nbsp;<span class="string" id="5395661">&#34;in&nbsp;string&nbsp;literal&#34;</span><span class="op" id="5395680">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5395683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5395686">return</span>&nbsp;<span class="ident" id="5395693">scanContinue</span><br>
<span class="lineno"></span><span class="op" id="5395706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5395709">//&nbsp;stateInStringEsc&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">340</span><span class="keyword" id="5395785">func</span>&nbsp;<span class="ident" id="5395790">stateInStringEsc</span><span class="op" id="5395806">(</span><span class="ident" id="5395807">s</span>&nbsp;<span class="op" id="5395809">*</span><span class="ident" id="5395810">scanner</span><span class="op" id="5395817">,</span>&nbsp;<span class="ident" id="5395819">c</span>&nbsp;<span class="builtintype" id="5395821">int</span><span class="op" id="5395824">)</span>&nbsp;<span class="builtintype" id="5395826">int</span>&nbsp;<span class="op" id="5395830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5395833">switch</span>&nbsp;<span class="ident" id="5395840">c</span>&nbsp;<span class="op" id="5395842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5395845">case</span>&nbsp;<span class="string" id="5395850">&#39;b&#39;</span><span class="op" id="5395853">,</span>&nbsp;<span class="string" id="5395855">&#39;f&#39;</span><span class="op" id="5395858">,</span>&nbsp;<span class="string" id="5395860">&#39;n&#39;</span><span class="op" id="5395863">,</span>&nbsp;<span class="string" id="5395865">&#39;r&#39;</span><span class="op" id="5395868">,</span>&nbsp;<span class="string" id="5395870">&#39;t&#39;</span><span class="op" id="5395873">,</span>&nbsp;<span class="string" id="5395875">&#39;\\&#39;</span><span class="op" id="5395879">,</span>&nbsp;<span class="string" id="5395881">&#39;/&#39;</span><span class="op" id="5395884">,</span>&nbsp;<span class="string" id="5395886">&#39;&#34;&#39;</span><span class="op" id="5395889">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5395893">s</span><span class="op" id="5395894">.</span><span class="ident" id="5395895">step</span>&nbsp;<span class="op" id="5395900">=</span>&nbsp;<span class="ident" id="5395902">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5395918">return</span>&nbsp;<span class="ident" id="5395925">scanContinue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5395939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5395942">if</span>&nbsp;<span class="ident" id="5395945">c</span>&nbsp;<span class="op" id="5395947">==</span>&nbsp;<span class="string" id="5395950">&#39;u&#39;</span>&nbsp;<span class="op" id="5395954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5395958">s</span><span class="op" id="5395959">.</span><span class="ident" id="5395960">step</span>&nbsp;<span class="op" id="5395965">=</span>&nbsp;<span class="ident" id="5395967">stateInStringEscU</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5395987">return</span>&nbsp;<span class="ident" id="5395994">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5396008">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5396011">return</span>&nbsp;<span class="ident" id="5396018">s</span><span class="op" id="5396019">.</span><span class="builtintype" id="5396020">error</span><span class="op" id="5396025">(</span><span class="ident" id="5396026">c</span><span class="op" id="5396027">,</span>&nbsp;<span class="string" id="5396029">&#34;in&nbsp;string&nbsp;escape&nbsp;code&#34;</span><span class="op" id="5396052">)</span><br>
<span class="lineno"></span><span class="op" id="5396054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5396057">//&nbsp;stateInStringEscU&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5396135">func</span>&nbsp;<span class="ident" id="5396140">stateInStringEscU</span><span class="op" id="5396157">(</span><span class="ident" id="5396158">s</span>&nbsp;<span class="op" id="5396160">*</span><span class="ident" id="5396161">scanner</span><span class="op" id="5396168">,</span>&nbsp;<span class="ident" id="5396170">c</span>&nbsp;<span class="builtintype" id="5396172">int</span><span class="op" id="5396175">)</span>&nbsp;<span class="builtintype" id="5396177">int</span>&nbsp;<span class="op" id="5396181">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5396184">if</span>&nbsp;<span class="string" id="5396187">&#39;0&#39;</span>&nbsp;<span class="op" id="5396191">&lt;=</span>&nbsp;<span class="ident" id="5396194">c</span>&nbsp;<span class="op" id="5396196">&amp;&amp;</span>&nbsp;<span class="ident" id="5396199">c</span>&nbsp;<span class="op" id="5396201">&lt;=</span>&nbsp;<span class="string" id="5396204">&#39;9&#39;</span>&nbsp;<span class="op" id="5396208">||</span>&nbsp;<span class="string" id="5396211">&#39;a&#39;</span>&nbsp;<span class="op" id="5396215">&lt;=</span>&nbsp;<span class="ident" id="5396218">c</span>&nbsp;<span class="op" id="5396220">&amp;&amp;</span>&nbsp;<span class="ident" id="5396223">c</span>&nbsp;<span class="op" id="5396225">&lt;=</span>&nbsp;<span class="string" id="5396228">&#39;f&#39;</span>&nbsp;<span class="op" id="5396232">||</span>&nbsp;<span class="string" id="5396235">&#39;A&#39;</span>&nbsp;<span class="op" id="5396239">&lt;=</span>&nbsp;<span class="ident" id="5396242">c</span>&nbsp;<span class="op" id="5396244">&amp;&amp;</span>&nbsp;<span class="ident" id="5396247">c</span>&nbsp;<span class="op" id="5396249">&lt;=</span>&nbsp;<span class="string" id="5396252">&#39;F&#39;</span>&nbsp;<span class="op" id="5396256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5396260">s</span><span class="op" id="5396261">.</span><span class="ident" id="5396262">step</span>&nbsp;<span class="op" id="5396267">=</span>&nbsp;<span class="ident" id="5396269">stateInStringEscU1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5396290">return</span>&nbsp;<span class="ident" id="5396297">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5396311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5396314">//&nbsp;numbers</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5396326">return</span>&nbsp;<span class="ident" id="5396333">s</span><span class="op" id="5396334">.</span><span class="builtintype" id="5396335">error</span><span class="op" id="5396340">(</span><span class="ident" id="5396341">c</span><span class="op" id="5396342">,</span>&nbsp;<span class="string" id="5396344">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="5396381">)</span><br>
<span class="lineno"></span><span class="op" id="5396383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5396386">//&nbsp;stateInStringEscU1&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u1`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5396466">func</span>&nbsp;<span class="ident" id="5396471">stateInStringEscU1</span><span class="op" id="5396489">(</span><span class="ident" id="5396490">s</span>&nbsp;<span class="op" id="5396492">*</span><span class="ident" id="5396493">scanner</span><span class="op" id="5396500">,</span>&nbsp;<span class="ident" id="5396502">c</span>&nbsp;<span class="builtintype" id="5396504">int</span><span class="op" id="5396507">)</span>&nbsp;<span class="builtintype" id="5396509">int</span>&nbsp;<span class="op" id="5396513">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5396516">if</span>&nbsp;<span class="string" id="5396519">&#39;0&#39;</span>&nbsp;<span class="op" id="5396523">&lt;=</span>&nbsp;<span class="ident" id="5396526">c</span>&nbsp;<span class="op" id="5396528">&amp;&amp;</span>&nbsp;<span class="ident" id="5396531">c</span>&nbsp;<span class="op" id="5396533">&lt;=</span>&nbsp;<span class="string" id="5396536">&#39;9&#39;</span>&nbsp;<span class="op" id="5396540">||</span>&nbsp;<span class="string" id="5396543">&#39;a&#39;</span>&nbsp;<span class="op" id="5396547">&lt;=</span>&nbsp;<span class="ident" id="5396550">c</span>&nbsp;<span class="op" id="5396552">&amp;&amp;</span>&nbsp;<span class="ident" id="5396555">c</span>&nbsp;<span class="op" id="5396557">&lt;=</span>&nbsp;<span class="string" id="5396560">&#39;f&#39;</span>&nbsp;<span class="op" id="5396564">||</span>&nbsp;<span class="string" id="5396567">&#39;A&#39;</span>&nbsp;<span class="op" id="5396571">&lt;=</span>&nbsp;<span class="ident" id="5396574">c</span>&nbsp;<span class="op" id="5396576">&amp;&amp;</span>&nbsp;<span class="ident" id="5396579">c</span>&nbsp;<span class="op" id="5396581">&lt;=</span>&nbsp;<span class="string" id="5396584">&#39;F&#39;</span>&nbsp;<span class="op" id="5396588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5396592">s</span><span class="op" id="5396593">.</span><span class="ident" id="5396594">step</span>&nbsp;<span class="op" id="5396599">=</span>&nbsp;<span class="ident" id="5396601">stateInStringEscU12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5396623">return</span>&nbsp;<span class="ident" id="5396630">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5396644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5396647">//&nbsp;numbers</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5396659">return</span>&nbsp;<span class="ident" id="5396666">s</span><span class="op" id="5396667">.</span><span class="builtintype" id="5396668">error</span><span class="op" id="5396673">(</span><span class="ident" id="5396674">c</span><span class="op" id="5396675">,</span>&nbsp;<span class="string" id="5396677">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="5396714">)</span><br>
<span class="lineno"></span><span class="op" id="5396716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5396719">//&nbsp;stateInStringEscU12&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u12`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5396801">func</span>&nbsp;<span class="ident" id="5396806">stateInStringEscU12</span><span class="op" id="5396825">(</span><span class="ident" id="5396826">s</span>&nbsp;<span class="op" id="5396828">*</span><span class="ident" id="5396829">scanner</span><span class="op" id="5396836">,</span>&nbsp;<span class="ident" id="5396838">c</span>&nbsp;<span class="builtintype" id="5396840">int</span><span class="op" id="5396843">)</span>&nbsp;<span class="builtintype" id="5396845">int</span>&nbsp;<span class="op" id="5396849">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5396852">if</span>&nbsp;<span class="string" id="5396855">&#39;0&#39;</span>&nbsp;<span class="op" id="5396859">&lt;=</span>&nbsp;<span class="ident" id="5396862">c</span>&nbsp;<span class="op" id="5396864">&amp;&amp;</span>&nbsp;<span class="ident" id="5396867">c</span>&nbsp;<span class="op" id="5396869">&lt;=</span>&nbsp;<span class="string" id="5396872">&#39;9&#39;</span>&nbsp;<span class="op" id="5396876">||</span>&nbsp;<span class="string" id="5396879">&#39;a&#39;</span>&nbsp;<span class="op" id="5396883">&lt;=</span>&nbsp;<span class="ident" id="5396886">c</span>&nbsp;<span class="op" id="5396888">&amp;&amp;</span>&nbsp;<span class="ident" id="5396891">c</span>&nbsp;<span class="op" id="5396893">&lt;=</span>&nbsp;<span class="string" id="5396896">&#39;f&#39;</span>&nbsp;<span class="op" id="5396900">||</span>&nbsp;<span class="string" id="5396903">&#39;A&#39;</span>&nbsp;<span class="op" id="5396907">&lt;=</span>&nbsp;<span class="ident" id="5396910">c</span>&nbsp;<span class="op" id="5396912">&amp;&amp;</span>&nbsp;<span class="ident" id="5396915">c</span>&nbsp;<span class="op" id="5396917">&lt;=</span>&nbsp;<span class="string" id="5396920">&#39;F&#39;</span>&nbsp;<span class="op" id="5396924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5396928">s</span><span class="op" id="5396929">.</span><span class="ident" id="5396930">step</span>&nbsp;<span class="op" id="5396935">=</span>&nbsp;<span class="ident" id="5396937">stateInStringEscU123</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5396960">return</span>&nbsp;<span class="ident" id="5396967">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5396981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5396984">//&nbsp;numbers</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5396996">return</span>&nbsp;<span class="ident" id="5397003">s</span><span class="op" id="5397004">.</span><span class="builtintype" id="5397005">error</span><span class="op" id="5397010">(</span><span class="ident" id="5397011">c</span><span class="op" id="5397012">,</span>&nbsp;<span class="string" id="5397014">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="5397051">)</span><br>
<span class="lineno"></span><span class="op" id="5397053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5397056">//&nbsp;stateInStringEscU123&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u123`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5397140">func</span>&nbsp;<span class="ident" id="5397145">stateInStringEscU123</span><span class="op" id="5397165">(</span><span class="ident" id="5397166">s</span>&nbsp;<span class="op" id="5397168">*</span><span class="ident" id="5397169">scanner</span><span class="op" id="5397176">,</span>&nbsp;<span class="ident" id="5397178">c</span>&nbsp;<span class="builtintype" id="5397180">int</span><span class="op" id="5397183">)</span>&nbsp;<span class="builtintype" id="5397185">int</span>&nbsp;<span class="op" id="5397189">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5397192">if</span>&nbsp;<span class="string" id="5397195">&#39;0&#39;</span>&nbsp;<span class="op" id="5397199">&lt;=</span>&nbsp;<span class="ident" id="5397202">c</span>&nbsp;<span class="op" id="5397204">&amp;&amp;</span>&nbsp;<span class="ident" id="5397207">c</span>&nbsp;<span class="op" id="5397209">&lt;=</span>&nbsp;<span class="string" id="5397212">&#39;9&#39;</span>&nbsp;<span class="op" id="5397216">||</span>&nbsp;<span class="string" id="5397219">&#39;a&#39;</span>&nbsp;<span class="op" id="5397223">&lt;=</span>&nbsp;<span class="ident" id="5397226">c</span>&nbsp;<span class="op" id="5397228">&amp;&amp;</span>&nbsp;<span class="ident" id="5397231">c</span>&nbsp;<span class="op" id="5397233">&lt;=</span>&nbsp;<span class="string" id="5397236">&#39;f&#39;</span>&nbsp;<span class="op" id="5397240">||</span>&nbsp;<span class="string" id="5397243">&#39;A&#39;</span>&nbsp;<span class="op" id="5397247">&lt;=</span>&nbsp;<span class="ident" id="5397250">c</span>&nbsp;<span class="op" id="5397252">&amp;&amp;</span>&nbsp;<span class="ident" id="5397255">c</span>&nbsp;<span class="op" id="5397257">&lt;=</span>&nbsp;<span class="string" id="5397260">&#39;F&#39;</span>&nbsp;<span class="op" id="5397264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5397268">s</span><span class="op" id="5397269">.</span><span class="ident" id="5397270">step</span>&nbsp;<span class="op" id="5397275">=</span>&nbsp;<span class="ident" id="5397277">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5397293">return</span>&nbsp;<span class="ident" id="5397300">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5397314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5397317">//&nbsp;numbers</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5397329">return</span>&nbsp;<span class="ident" id="5397336">s</span><span class="op" id="5397337">.</span><span class="builtintype" id="5397338">error</span><span class="op" id="5397343">(</span><span class="ident" id="5397344">c</span><span class="op" id="5397345">,</span>&nbsp;<span class="string" id="5397347">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="5397384">)</span><br>
<span class="lineno"></span><span class="op" id="5397386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5397389">//&nbsp;stateNeg&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`-`&nbsp;during&nbsp;a&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="5397449">func</span>&nbsp;<span class="ident" id="5397454">stateNeg</span><span class="op" id="5397462">(</span><span class="ident" id="5397463">s</span>&nbsp;<span class="op" id="5397465">*</span><span class="ident" id="5397466">scanner</span><span class="op" id="5397473">,</span>&nbsp;<span class="ident" id="5397475">c</span>&nbsp;<span class="builtintype" id="5397477">int</span><span class="op" id="5397480">)</span>&nbsp;<span class="builtintype" id="5397482">int</span>&nbsp;<span class="op" id="5397486">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5397489">if</span>&nbsp;<span class="ident" id="5397492">c</span>&nbsp;<span class="op" id="5397494">==</span>&nbsp;<span class="string" id="5397497">&#39;0&#39;</span>&nbsp;<span class="op" id="5397501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5397505">s</span><span class="op" id="5397506">.</span><span class="ident" id="5397507">step</span>&nbsp;<span class="op" id="5397512">=</span>&nbsp;<span class="ident" id="5397514">state0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5397523">return</span>&nbsp;<span class="ident" id="5397530">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5397544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5397547">if</span>&nbsp;<span class="string" id="5397550">&#39;1&#39;</span>&nbsp;<span class="op" id="5397554">&lt;=</span>&nbsp;<span class="ident" id="5397557">c</span>&nbsp;<span class="op" id="5397559">&amp;&amp;</span>&nbsp;<span class="ident" id="5397562">c</span>&nbsp;<span class="op" id="5397564">&lt;=</span>&nbsp;<span class="string" id="5397567">&#39;9&#39;</span>&nbsp;<span class="op" id="5397571">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5397575">s</span><span class="op" id="5397576">.</span><span class="ident" id="5397577">step</span>&nbsp;<span class="op" id="5397582">=</span>&nbsp;<span class="ident" id="5397584">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5397593">return</span>&nbsp;<span class="ident" id="5397600">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5397614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5397617">return</span>&nbsp;<span class="ident" id="5397624">s</span><span class="op" id="5397625">.</span><span class="builtintype" id="5397626">error</span><span class="op" id="5397631">(</span><span class="ident" id="5397632">c</span><span class="op" id="5397633">,</span>&nbsp;<span class="string" id="5397635">&#34;in&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="5397655">)</span><br>
<span class="lineno"></span><span class="op" id="5397657">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="comment" id="5397660">//&nbsp;state1&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;a&nbsp;non-zero&nbsp;integer&nbsp;during&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="5397733">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`1`&nbsp;or&nbsp;`100`&nbsp;but&nbsp;not&nbsp;`0`.</span><br>
<span class="lineno"></span><span class="keyword" id="5397784">func</span>&nbsp;<span class="ident" id="5397789">state1</span><span class="op" id="5397795">(</span><span class="ident" id="5397796">s</span>&nbsp;<span class="op" id="5397798">*</span><span class="ident" id="5397799">scanner</span><span class="op" id="5397806">,</span>&nbsp;<span class="ident" id="5397808">c</span>&nbsp;<span class="builtintype" id="5397810">int</span><span class="op" id="5397813">)</span>&nbsp;<span class="builtintype" id="5397815">int</span>&nbsp;<span class="op" id="5397819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5397822">if</span>&nbsp;<span class="string" id="5397825">&#39;0&#39;</span>&nbsp;<span class="op" id="5397829">&lt;=</span>&nbsp;<span class="ident" id="5397832">c</span>&nbsp;<span class="op" id="5397834">&amp;&amp;</span>&nbsp;<span class="ident" id="5397837">c</span>&nbsp;<span class="op" id="5397839">&lt;=</span>&nbsp;<span class="string" id="5397842">&#39;9&#39;</span>&nbsp;<span class="op" id="5397846">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5397850">s</span><span class="op" id="5397851">.</span><span class="ident" id="5397852">step</span>&nbsp;<span class="op" id="5397857">=</span>&nbsp;<span class="ident" id="5397859">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5397868">return</span>&nbsp;<span class="ident" id="5397875">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5397889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5397892">return</span>&nbsp;<span class="ident" id="5397899">state0</span><span class="op" id="5397905">(</span><span class="ident" id="5397906">s</span><span class="op" id="5397907">,</span>&nbsp;<span class="ident" id="5397909">c</span><span class="op" id="5397910">)</span><br>
<span class="lineno"></span><span class="op" id="5397912">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="comment" id="5397915">//&nbsp;state0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`0`&nbsp;during&nbsp;a&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="5397973">func</span>&nbsp;<span class="ident" id="5397978">state0</span><span class="op" id="5397984">(</span><span class="ident" id="5397985">s</span>&nbsp;<span class="op" id="5397987">*</span><span class="ident" id="5397988">scanner</span><span class="op" id="5397995">,</span>&nbsp;<span class="ident" id="5397997">c</span>&nbsp;<span class="builtintype" id="5397999">int</span><span class="op" id="5398002">)</span>&nbsp;<span class="builtintype" id="5398004">int</span>&nbsp;<span class="op" id="5398008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398011">if</span>&nbsp;<span class="ident" id="5398014">c</span>&nbsp;<span class="op" id="5398016">==</span>&nbsp;<span class="string" id="5398019">&#39;.&#39;</span>&nbsp;<span class="op" id="5398023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5398027">s</span><span class="op" id="5398028">.</span><span class="ident" id="5398029">step</span>&nbsp;<span class="op" id="5398034">=</span>&nbsp;<span class="ident" id="5398036">stateDot</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398047">return</span>&nbsp;<span class="ident" id="5398054">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5398068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398071">if</span>&nbsp;<span class="ident" id="5398074">c</span>&nbsp;<span class="op" id="5398076">==</span>&nbsp;<span class="string" id="5398079">&#39;e&#39;</span>&nbsp;<span class="op" id="5398083">||</span>&nbsp;<span class="ident" id="5398086">c</span>&nbsp;<span class="op" id="5398088">==</span>&nbsp;<span class="string" id="5398091">&#39;E&#39;</span>&nbsp;<span class="op" id="5398095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5398099">s</span><span class="op" id="5398100">.</span><span class="ident" id="5398101">step</span>&nbsp;<span class="op" id="5398106">=</span>&nbsp;<span class="ident" id="5398108">stateE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398117">return</span>&nbsp;<span class="ident" id="5398124">scanContinue</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5398138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398141">return</span>&nbsp;<span class="ident" id="5398148">stateEndValue</span><span class="op" id="5398161">(</span><span class="ident" id="5398162">s</span><span class="op" id="5398163">,</span>&nbsp;<span class="ident" id="5398165">c</span><span class="op" id="5398166">)</span><br>
<span class="lineno"></span><span class="op" id="5398168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5398171">//&nbsp;stateDot&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;integer&nbsp;and&nbsp;decimal&nbsp;point&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno">430</span><span class="comment" id="5398253">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`1.`.</span><br>
<span class="lineno"></span><span class="keyword" id="5398284">func</span>&nbsp;<span class="ident" id="5398289">stateDot</span><span class="op" id="5398297">(</span><span class="ident" id="5398298">s</span>&nbsp;<span class="op" id="5398300">*</span><span class="ident" id="5398301">scanner</span><span class="op" id="5398308">,</span>&nbsp;<span class="ident" id="5398310">c</span>&nbsp;<span class="builtintype" id="5398312">int</span><span class="op" id="5398315">)</span>&nbsp;<span class="builtintype" id="5398317">int</span>&nbsp;<span class="op" id="5398321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398324">if</span>&nbsp;<span class="string" id="5398327">&#39;0&#39;</span>&nbsp;<span class="op" id="5398331">&lt;=</span>&nbsp;<span class="ident" id="5398334">c</span>&nbsp;<span class="op" id="5398336">&amp;&amp;</span>&nbsp;<span class="ident" id="5398339">c</span>&nbsp;<span class="op" id="5398341">&lt;=</span>&nbsp;<span class="string" id="5398344">&#39;9&#39;</span>&nbsp;<span class="op" id="5398348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5398352">s</span><span class="op" id="5398353">.</span><span class="ident" id="5398354">step</span>&nbsp;<span class="op" id="5398359">=</span>&nbsp;<span class="ident" id="5398361">stateDot0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398373">return</span>&nbsp;<span class="ident" id="5398380">scanContinue</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5398394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398397">return</span>&nbsp;<span class="ident" id="5398404">s</span><span class="op" id="5398405">.</span><span class="builtintype" id="5398406">error</span><span class="op" id="5398411">(</span><span class="ident" id="5398412">c</span><span class="op" id="5398413">,</span>&nbsp;<span class="string" id="5398415">&#34;after&nbsp;decimal&nbsp;point&nbsp;in&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="5398455">)</span><br>
<span class="lineno"></span><span class="op" id="5398457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5398460">//&nbsp;stateDot0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;integer,&nbsp;decimal&nbsp;point,&nbsp;and&nbsp;subsequent</span><br>
<span class="lineno">440</span><span class="comment" id="5398543">//&nbsp;digits&nbsp;of&nbsp;a&nbsp;number,&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`3.14`.</span><br>
<span class="lineno"></span><span class="keyword" id="5398596">func</span>&nbsp;<span class="ident" id="5398601">stateDot0</span><span class="op" id="5398610">(</span><span class="ident" id="5398611">s</span>&nbsp;<span class="op" id="5398613">*</span><span class="ident" id="5398614">scanner</span><span class="op" id="5398621">,</span>&nbsp;<span class="ident" id="5398623">c</span>&nbsp;<span class="builtintype" id="5398625">int</span><span class="op" id="5398628">)</span>&nbsp;<span class="builtintype" id="5398630">int</span>&nbsp;<span class="op" id="5398634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398637">if</span>&nbsp;<span class="string" id="5398640">&#39;0&#39;</span>&nbsp;<span class="op" id="5398644">&lt;=</span>&nbsp;<span class="ident" id="5398647">c</span>&nbsp;<span class="op" id="5398649">&amp;&amp;</span>&nbsp;<span class="ident" id="5398652">c</span>&nbsp;<span class="op" id="5398654">&lt;=</span>&nbsp;<span class="string" id="5398657">&#39;9&#39;</span>&nbsp;<span class="op" id="5398661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5398665">s</span><span class="op" id="5398666">.</span><span class="ident" id="5398667">step</span>&nbsp;<span class="op" id="5398672">=</span>&nbsp;<span class="ident" id="5398674">stateDot0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398686">return</span>&nbsp;<span class="ident" id="5398693">scanContinue</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5398707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398710">if</span>&nbsp;<span class="ident" id="5398713">c</span>&nbsp;<span class="op" id="5398715">==</span>&nbsp;<span class="string" id="5398718">&#39;e&#39;</span>&nbsp;<span class="op" id="5398722">||</span>&nbsp;<span class="ident" id="5398725">c</span>&nbsp;<span class="op" id="5398727">==</span>&nbsp;<span class="string" id="5398730">&#39;E&#39;</span>&nbsp;<span class="op" id="5398734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5398738">s</span><span class="op" id="5398739">.</span><span class="ident" id="5398740">step</span>&nbsp;<span class="op" id="5398745">=</span>&nbsp;<span class="ident" id="5398747">stateE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398756">return</span>&nbsp;<span class="ident" id="5398763">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5398777">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398780">return</span>&nbsp;<span class="ident" id="5398787">stateEndValue</span><span class="op" id="5398800">(</span><span class="ident" id="5398801">s</span><span class="op" id="5398802">,</span>&nbsp;<span class="ident" id="5398804">c</span><span class="op" id="5398805">)</span><br>
<span class="lineno"></span><span class="op" id="5398807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5398810">//&nbsp;stateE&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa&nbsp;and&nbsp;e&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="5398879">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e`&nbsp;or&nbsp;`0.314e`.</span><br>
<span class="lineno">455</span><span class="keyword" id="5398924">func</span>&nbsp;<span class="ident" id="5398929">stateE</span><span class="op" id="5398935">(</span><span class="ident" id="5398936">s</span>&nbsp;<span class="op" id="5398938">*</span><span class="ident" id="5398939">scanner</span><span class="op" id="5398946">,</span>&nbsp;<span class="ident" id="5398948">c</span>&nbsp;<span class="builtintype" id="5398950">int</span><span class="op" id="5398953">)</span>&nbsp;<span class="builtintype" id="5398955">int</span>&nbsp;<span class="op" id="5398959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5398962">if</span>&nbsp;<span class="ident" id="5398965">c</span>&nbsp;<span class="op" id="5398967">==</span>&nbsp;<span class="string" id="5398970">&#39;+&#39;</span>&nbsp;<span class="op" id="5398974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5398978">s</span><span class="op" id="5398979">.</span><span class="ident" id="5398980">step</span>&nbsp;<span class="op" id="5398985">=</span>&nbsp;<span class="ident" id="5398987">stateESign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5399000">return</span>&nbsp;<span class="ident" id="5399007">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5399021">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5399024">if</span>&nbsp;<span class="ident" id="5399027">c</span>&nbsp;<span class="op" id="5399029">==</span>&nbsp;<span class="string" id="5399032">&#39;-&#39;</span>&nbsp;<span class="op" id="5399036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5399040">s</span><span class="op" id="5399041">.</span><span class="ident" id="5399042">step</span>&nbsp;<span class="op" id="5399047">=</span>&nbsp;<span class="ident" id="5399049">stateESign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5399062">return</span>&nbsp;<span class="ident" id="5399069">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5399083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5399086">return</span>&nbsp;<span class="ident" id="5399093">stateESign</span><span class="op" id="5399103">(</span><span class="ident" id="5399104">s</span><span class="op" id="5399105">,</span>&nbsp;<span class="ident" id="5399107">c</span><span class="op" id="5399108">)</span><br>
<span class="lineno">465</span><span class="op" id="5399110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5399113">//&nbsp;stateESign&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa,&nbsp;e,&nbsp;and&nbsp;sign&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="5399193">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e-`&nbsp;or&nbsp;`0.314e+`.</span><br>
<span class="lineno"></span><span class="keyword" id="5399240">func</span>&nbsp;<span class="ident" id="5399245">stateESign</span><span class="op" id="5399255">(</span><span class="ident" id="5399256">s</span>&nbsp;<span class="op" id="5399258">*</span><span class="ident" id="5399259">scanner</span><span class="op" id="5399266">,</span>&nbsp;<span class="ident" id="5399268">c</span>&nbsp;<span class="builtintype" id="5399270">int</span><span class="op" id="5399273">)</span>&nbsp;<span class="builtintype" id="5399275">int</span>&nbsp;<span class="op" id="5399279">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5399282">if</span>&nbsp;<span class="string" id="5399285">&#39;0&#39;</span>&nbsp;<span class="op" id="5399289">&lt;=</span>&nbsp;<span class="ident" id="5399292">c</span>&nbsp;<span class="op" id="5399294">&amp;&amp;</span>&nbsp;<span class="ident" id="5399297">c</span>&nbsp;<span class="op" id="5399299">&lt;=</span>&nbsp;<span class="string" id="5399302">&#39;9&#39;</span>&nbsp;<span class="op" id="5399306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5399310">s</span><span class="op" id="5399311">.</span><span class="ident" id="5399312">step</span>&nbsp;<span class="op" id="5399317">=</span>&nbsp;<span class="ident" id="5399319">stateE0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5399329">return</span>&nbsp;<span class="ident" id="5399336">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5399350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5399353">return</span>&nbsp;<span class="ident" id="5399360">s</span><span class="op" id="5399361">.</span><span class="builtintype" id="5399362">error</span><span class="op" id="5399367">(</span><span class="ident" id="5399368">c</span><span class="op" id="5399369">,</span>&nbsp;<span class="string" id="5399371">&#34;in&nbsp;exponent&nbsp;of&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="5399403">)</span><br>
<span class="lineno">475</span><span class="op" id="5399405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5399408">//&nbsp;stateE0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa,&nbsp;e,&nbsp;optional&nbsp;sign,</span><br>
<span class="lineno"></span><span class="comment" id="5399478">//&nbsp;and&nbsp;at&nbsp;least&nbsp;one&nbsp;digit&nbsp;of&nbsp;the&nbsp;exponent&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="5399533">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e-2`&nbsp;or&nbsp;`0.314e+1`&nbsp;or&nbsp;`3.14e0`.</span><br>
<span class="lineno">480</span><span class="keyword" id="5399594">func</span>&nbsp;<span class="ident" id="5399599">stateE0</span><span class="op" id="5399606">(</span><span class="ident" id="5399607">s</span>&nbsp;<span class="op" id="5399609">*</span><span class="ident" id="5399610">scanner</span><span class="op" id="5399617">,</span>&nbsp;<span class="ident" id="5399619">c</span>&nbsp;<span class="builtintype" id="5399621">int</span><span class="op" id="5399624">)</span>&nbsp;<span class="builtintype" id="5399626">int</span>&nbsp;<span class="op" id="5399630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5399633">if</span>&nbsp;<span class="string" id="5399636">&#39;0&#39;</span>&nbsp;<span class="op" id="5399640">&lt;=</span>&nbsp;<span class="ident" id="5399643">c</span>&nbsp;<span class="op" id="5399645">&amp;&amp;</span>&nbsp;<span class="ident" id="5399648">c</span>&nbsp;<span class="op" id="5399650">&lt;=</span>&nbsp;<span class="string" id="5399653">&#39;9&#39;</span>&nbsp;<span class="op" id="5399657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5399661">s</span><span class="op" id="5399662">.</span><span class="ident" id="5399663">step</span>&nbsp;<span class="op" id="5399668">=</span>&nbsp;<span class="ident" id="5399670">stateE0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5399680">return</span>&nbsp;<span class="ident" id="5399687">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5399701">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5399704">return</span>&nbsp;<span class="ident" id="5399711">stateEndValue</span><span class="op" id="5399724">(</span><span class="ident" id="5399725">s</span><span class="op" id="5399726">,</span>&nbsp;<span class="ident" id="5399728">c</span><span class="op" id="5399729">)</span><br>
<span class="lineno"></span><span class="op" id="5399731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5399734">//&nbsp;stateT&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`t`.</span><br>
<span class="lineno"></span><span class="keyword" id="5399776">func</span>&nbsp;<span class="ident" id="5399781">stateT</span><span class="op" id="5399787">(</span><span class="ident" id="5399788">s</span>&nbsp;<span class="op" id="5399790">*</span><span class="ident" id="5399791">scanner</span><span class="op" id="5399798">,</span>&nbsp;<span class="ident" id="5399800">c</span>&nbsp;<span class="builtintype" id="5399802">int</span><span class="op" id="5399805">)</span>&nbsp;<span class="builtintype" id="5399807">int</span>&nbsp;<span class="op" id="5399811">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5399814">if</span>&nbsp;<span class="ident" id="5399817">c</span>&nbsp;<span class="op" id="5399819">==</span>&nbsp;<span class="string" id="5399822">&#39;r&#39;</span>&nbsp;<span class="op" id="5399826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5399830">s</span><span class="op" id="5399831">.</span><span class="ident" id="5399832">step</span>&nbsp;<span class="op" id="5399837">=</span>&nbsp;<span class="ident" id="5399839">stateTr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5399849">return</span>&nbsp;<span class="ident" id="5399856">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5399870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5399873">return</span>&nbsp;<span class="ident" id="5399880">s</span><span class="op" id="5399881">.</span><span class="builtintype" id="5399882">error</span><span class="op" id="5399887">(</span><span class="ident" id="5399888">c</span><span class="op" id="5399889">,</span>&nbsp;<span class="string" id="5399891">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;r&#39;)&#34;</span><span class="op" id="5399924">)</span><br>
<span class="lineno">495</span><span class="op" id="5399926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5399929">//&nbsp;stateTr&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`tr`.</span><br>
<span class="lineno"></span><span class="keyword" id="5399973">func</span>&nbsp;<span class="ident" id="5399978">stateTr</span><span class="op" id="5399985">(</span><span class="ident" id="5399986">s</span>&nbsp;<span class="op" id="5399988">*</span><span class="ident" id="5399989">scanner</span><span class="op" id="5399996">,</span>&nbsp;<span class="ident" id="5399998">c</span>&nbsp;<span class="builtintype" id="5400000">int</span><span class="op" id="5400003">)</span>&nbsp;<span class="builtintype" id="5400005">int</span>&nbsp;<span class="op" id="5400009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5400012">if</span>&nbsp;<span class="ident" id="5400015">c</span>&nbsp;<span class="op" id="5400017">==</span>&nbsp;<span class="string" id="5400020">&#39;u&#39;</span>&nbsp;<span class="op" id="5400024">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5400028">s</span><span class="op" id="5400029">.</span><span class="ident" id="5400030">step</span>&nbsp;<span class="op" id="5400035">=</span>&nbsp;<span class="ident" id="5400037">stateTru</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5400048">return</span>&nbsp;<span class="ident" id="5400055">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5400069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5400072">return</span>&nbsp;<span class="ident" id="5400079">s</span><span class="op" id="5400080">.</span><span class="builtintype" id="5400081">error</span><span class="op" id="5400086">(</span><span class="ident" id="5400087">c</span><span class="op" id="5400088">,</span>&nbsp;<span class="string" id="5400090">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;u&#39;)&#34;</span><span class="op" id="5400123">)</span><br>
<span class="lineno"></span><span class="op" id="5400125">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="5400128">//&nbsp;stateTru&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`tru`.</span><br>
<span class="lineno"></span><span class="keyword" id="5400174">func</span>&nbsp;<span class="ident" id="5400179">stateTru</span><span class="op" id="5400187">(</span><span class="ident" id="5400188">s</span>&nbsp;<span class="op" id="5400190">*</span><span class="ident" id="5400191">scanner</span><span class="op" id="5400198">,</span>&nbsp;<span class="ident" id="5400200">c</span>&nbsp;<span class="builtintype" id="5400202">int</span><span class="op" id="5400205">)</span>&nbsp;<span class="builtintype" id="5400207">int</span>&nbsp;<span class="op" id="5400211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5400214">if</span>&nbsp;<span class="ident" id="5400217">c</span>&nbsp;<span class="op" id="5400219">==</span>&nbsp;<span class="string" id="5400222">&#39;e&#39;</span>&nbsp;<span class="op" id="5400226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5400230">s</span><span class="op" id="5400231">.</span><span class="ident" id="5400232">step</span>&nbsp;<span class="op" id="5400237">=</span>&nbsp;<span class="ident" id="5400239">stateEndValue</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5400255">return</span>&nbsp;<span class="ident" id="5400262">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5400276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5400279">return</span>&nbsp;<span class="ident" id="5400286">s</span><span class="op" id="5400287">.</span><span class="builtintype" id="5400288">error</span><span class="op" id="5400293">(</span><span class="ident" id="5400294">c</span><span class="op" id="5400295">,</span>&nbsp;<span class="string" id="5400297">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;e&#39;)&#34;</span><span class="op" id="5400330">)</span><br>
<span class="lineno"></span><span class="op" id="5400332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="comment" id="5400335">//&nbsp;stateF&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`f`.</span><br>
<span class="lineno"></span><span class="keyword" id="5400377">func</span>&nbsp;<span class="ident" id="5400382">stateF</span><span class="op" id="5400388">(</span><span class="ident" id="5400389">s</span>&nbsp;<span class="op" id="5400391">*</span><span class="ident" id="5400392">scanner</span><span class="op" id="5400399">,</span>&nbsp;<span class="ident" id="5400401">c</span>&nbsp;<span class="builtintype" id="5400403">int</span><span class="op" id="5400406">)</span>&nbsp;<span class="builtintype" id="5400408">int</span>&nbsp;<span class="op" id="5400412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5400415">if</span>&nbsp;<span class="ident" id="5400418">c</span>&nbsp;<span class="op" id="5400420">==</span>&nbsp;<span class="string" id="5400423">&#39;a&#39;</span>&nbsp;<span class="op" id="5400427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5400431">s</span><span class="op" id="5400432">.</span><span class="ident" id="5400433">step</span>&nbsp;<span class="op" id="5400438">=</span>&nbsp;<span class="ident" id="5400440">stateFa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5400450">return</span>&nbsp;<span class="ident" id="5400457">scanContinue</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5400471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5400474">return</span>&nbsp;<span class="ident" id="5400481">s</span><span class="op" id="5400482">.</span><span class="builtintype" id="5400483">error</span><span class="op" id="5400488">(</span><span class="ident" id="5400489">c</span><span class="op" id="5400490">,</span>&nbsp;<span class="string" id="5400492">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;a&#39;)&#34;</span><span class="op" id="5400526">)</span><br>
<span class="lineno"></span><span class="op" id="5400528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5400531">//&nbsp;stateFa&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fa`.</span><br>
<span class="lineno">525</span><span class="keyword" id="5400575">func</span>&nbsp;<span class="ident" id="5400580">stateFa</span><span class="op" id="5400587">(</span><span class="ident" id="5400588">s</span>&nbsp;<span class="op" id="5400590">*</span><span class="ident" id="5400591">scanner</span><span class="op" id="5400598">,</span>&nbsp;<span class="ident" id="5400600">c</span>&nbsp;<span class="builtintype" id="5400602">int</span><span class="op" id="5400605">)</span>&nbsp;<span class="builtintype" id="5400607">int</span>&nbsp;<span class="op" id="5400611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5400614">if</span>&nbsp;<span class="ident" id="5400617">c</span>&nbsp;<span class="op" id="5400619">==</span>&nbsp;<span class="string" id="5400622">&#39;l&#39;</span>&nbsp;<span class="op" id="5400626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5400630">s</span><span class="op" id="5400631">.</span><span class="ident" id="5400632">step</span>&nbsp;<span class="op" id="5400637">=</span>&nbsp;<span class="ident" id="5400639">stateFal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5400650">return</span>&nbsp;<span class="ident" id="5400657">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5400671">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5400674">return</span>&nbsp;<span class="ident" id="5400681">s</span><span class="op" id="5400682">.</span><span class="builtintype" id="5400683">error</span><span class="op" id="5400688">(</span><span class="ident" id="5400689">c</span><span class="op" id="5400690">,</span>&nbsp;<span class="string" id="5400692">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="5400726">)</span><br>
<span class="lineno"></span><span class="op" id="5400728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5400731">//&nbsp;stateFal&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fal`.</span><br>
<span class="lineno"></span><span class="keyword" id="5400777">func</span>&nbsp;<span class="ident" id="5400782">stateFal</span><span class="op" id="5400790">(</span><span class="ident" id="5400791">s</span>&nbsp;<span class="op" id="5400793">*</span><span class="ident" id="5400794">scanner</span><span class="op" id="5400801">,</span>&nbsp;<span class="ident" id="5400803">c</span>&nbsp;<span class="builtintype" id="5400805">int</span><span class="op" id="5400808">)</span>&nbsp;<span class="builtintype" id="5400810">int</span>&nbsp;<span class="op" id="5400814">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5400817">if</span>&nbsp;<span class="ident" id="5400820">c</span>&nbsp;<span class="op" id="5400822">==</span>&nbsp;<span class="string" id="5400825">&#39;s&#39;</span>&nbsp;<span class="op" id="5400829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5400833">s</span><span class="op" id="5400834">.</span><span class="ident" id="5400835">step</span>&nbsp;<span class="op" id="5400840">=</span>&nbsp;<span class="ident" id="5400842">stateFals</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5400854">return</span>&nbsp;<span class="ident" id="5400861">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5400875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5400878">return</span>&nbsp;<span class="ident" id="5400885">s</span><span class="op" id="5400886">.</span><span class="builtintype" id="5400887">error</span><span class="op" id="5400892">(</span><span class="ident" id="5400893">c</span><span class="op" id="5400894">,</span>&nbsp;<span class="string" id="5400896">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;s&#39;)&#34;</span><span class="op" id="5400930">)</span><br>
<span class="lineno">540</span><span class="op" id="5400932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5400935">//&nbsp;stateFals&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fals`.</span><br>
<span class="lineno"></span><span class="keyword" id="5400983">func</span>&nbsp;<span class="ident" id="5400988">stateFals</span><span class="op" id="5400997">(</span><span class="ident" id="5400998">s</span>&nbsp;<span class="op" id="5401000">*</span><span class="ident" id="5401001">scanner</span><span class="op" id="5401008">,</span>&nbsp;<span class="ident" id="5401010">c</span>&nbsp;<span class="builtintype" id="5401012">int</span><span class="op" id="5401015">)</span>&nbsp;<span class="builtintype" id="5401017">int</span>&nbsp;<span class="op" id="5401021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5401024">if</span>&nbsp;<span class="ident" id="5401027">c</span>&nbsp;<span class="op" id="5401029">==</span>&nbsp;<span class="string" id="5401032">&#39;e&#39;</span>&nbsp;<span class="op" id="5401036">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5401040">s</span><span class="op" id="5401041">.</span><span class="ident" id="5401042">step</span>&nbsp;<span class="op" id="5401047">=</span>&nbsp;<span class="ident" id="5401049">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5401065">return</span>&nbsp;<span class="ident" id="5401072">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5401086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5401089">return</span>&nbsp;<span class="ident" id="5401096">s</span><span class="op" id="5401097">.</span><span class="builtintype" id="5401098">error</span><span class="op" id="5401103">(</span><span class="ident" id="5401104">c</span><span class="op" id="5401105">,</span>&nbsp;<span class="string" id="5401107">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;e&#39;)&#34;</span><span class="op" id="5401141">)</span><br>
<span class="lineno"></span><span class="op" id="5401143">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span><span class="comment" id="5401146">//&nbsp;stateN&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`n`.</span><br>
<span class="lineno"></span><span class="keyword" id="5401188">func</span>&nbsp;<span class="ident" id="5401193">stateN</span><span class="op" id="5401199">(</span><span class="ident" id="5401200">s</span>&nbsp;<span class="op" id="5401202">*</span><span class="ident" id="5401203">scanner</span><span class="op" id="5401210">,</span>&nbsp;<span class="ident" id="5401212">c</span>&nbsp;<span class="builtintype" id="5401214">int</span><span class="op" id="5401217">)</span>&nbsp;<span class="builtintype" id="5401219">int</span>&nbsp;<span class="op" id="5401223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5401226">if</span>&nbsp;<span class="ident" id="5401229">c</span>&nbsp;<span class="op" id="5401231">==</span>&nbsp;<span class="string" id="5401234">&#39;u&#39;</span>&nbsp;<span class="op" id="5401238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5401242">s</span><span class="op" id="5401243">.</span><span class="ident" id="5401244">step</span>&nbsp;<span class="op" id="5401249">=</span>&nbsp;<span class="ident" id="5401251">stateNu</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5401261">return</span>&nbsp;<span class="ident" id="5401268">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5401282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5401285">return</span>&nbsp;<span class="ident" id="5401292">s</span><span class="op" id="5401293">.</span><span class="builtintype" id="5401294">error</span><span class="op" id="5401299">(</span><span class="ident" id="5401300">c</span><span class="op" id="5401301">,</span>&nbsp;<span class="string" id="5401303">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;u&#39;)&#34;</span><span class="op" id="5401336">)</span><br>
<span class="lineno"></span><span class="op" id="5401338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="comment" id="5401341">//&nbsp;stateNu&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`nu`.</span><br>
<span class="lineno"></span><span class="keyword" id="5401385">func</span>&nbsp;<span class="ident" id="5401390">stateNu</span><span class="op" id="5401397">(</span><span class="ident" id="5401398">s</span>&nbsp;<span class="op" id="5401400">*</span><span class="ident" id="5401401">scanner</span><span class="op" id="5401408">,</span>&nbsp;<span class="ident" id="5401410">c</span>&nbsp;<span class="builtintype" id="5401412">int</span><span class="op" id="5401415">)</span>&nbsp;<span class="builtintype" id="5401417">int</span>&nbsp;<span class="op" id="5401421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5401424">if</span>&nbsp;<span class="ident" id="5401427">c</span>&nbsp;<span class="op" id="5401429">==</span>&nbsp;<span class="string" id="5401432">&#39;l&#39;</span>&nbsp;<span class="op" id="5401436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5401440">s</span><span class="op" id="5401441">.</span><span class="ident" id="5401442">step</span>&nbsp;<span class="op" id="5401447">=</span>&nbsp;<span class="ident" id="5401449">stateNul</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5401460">return</span>&nbsp;<span class="ident" id="5401467">scanContinue</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5401481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5401484">return</span>&nbsp;<span class="ident" id="5401491">s</span><span class="op" id="5401492">.</span><span class="builtintype" id="5401493">error</span><span class="op" id="5401498">(</span><span class="ident" id="5401499">c</span><span class="op" id="5401500">,</span>&nbsp;<span class="string" id="5401502">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="5401535">)</span><br>
<span class="lineno"></span><span class="op" id="5401537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5401540">//&nbsp;stateNul&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`nul`.</span><br>
<span class="lineno">570</span><span class="keyword" id="5401586">func</span>&nbsp;<span class="ident" id="5401591">stateNul</span><span class="op" id="5401599">(</span><span class="ident" id="5401600">s</span>&nbsp;<span class="op" id="5401602">*</span><span class="ident" id="5401603">scanner</span><span class="op" id="5401610">,</span>&nbsp;<span class="ident" id="5401612">c</span>&nbsp;<span class="builtintype" id="5401614">int</span><span class="op" id="5401617">)</span>&nbsp;<span class="builtintype" id="5401619">int</span>&nbsp;<span class="op" id="5401623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5401626">if</span>&nbsp;<span class="ident" id="5401629">c</span>&nbsp;<span class="op" id="5401631">==</span>&nbsp;<span class="string" id="5401634">&#39;l&#39;</span>&nbsp;<span class="op" id="5401638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5401642">s</span><span class="op" id="5401643">.</span><span class="ident" id="5401644">step</span>&nbsp;<span class="op" id="5401649">=</span>&nbsp;<span class="ident" id="5401651">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5401667">return</span>&nbsp;<span class="ident" id="5401674">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5401688">}</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5401691">return</span>&nbsp;<span class="ident" id="5401698">s</span><span class="op" id="5401699">.</span><span class="builtintype" id="5401700">error</span><span class="op" id="5401705">(</span><span class="ident" id="5401706">c</span><span class="op" id="5401707">,</span>&nbsp;<span class="string" id="5401709">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="5401742">)</span><br>
<span class="lineno"></span><span class="op" id="5401744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5401747">//&nbsp;stateError&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reaching&nbsp;a&nbsp;syntax&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="5401805">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`[1}`&nbsp;or&nbsp;`5.1.2`.</span><br>
<span class="lineno">580</span><span class="keyword" id="5401848">func</span>&nbsp;<span class="ident" id="5401853">stateError</span><span class="op" id="5401863">(</span><span class="ident" id="5401864">s</span>&nbsp;<span class="op" id="5401866">*</span><span class="ident" id="5401867">scanner</span><span class="op" id="5401874">,</span>&nbsp;<span class="ident" id="5401876">c</span>&nbsp;<span class="builtintype" id="5401878">int</span><span class="op" id="5401881">)</span>&nbsp;<span class="builtintype" id="5401883">int</span>&nbsp;<span class="op" id="5401887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5401890">return</span>&nbsp;<span class="ident" id="5401897">scanError</span><br>
<span class="lineno"></span><span class="op" id="5401907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5401910">//&nbsp;error&nbsp;records&nbsp;an&nbsp;error&nbsp;and&nbsp;switches&nbsp;to&nbsp;the&nbsp;error&nbsp;state.</span><br>
<span class="lineno">585</span><span class="keyword" id="5401969">func</span>&nbsp;<span class="op" id="5401974">(</span><span class="ident" id="5401975">s</span>&nbsp;<span class="op" id="5401977">*</span><span class="ident" id="5401978">scanner</span><span class="op" id="5401985">)</span>&nbsp;<span class="builtintype" id="5401987">error</span><span class="op" id="5401992">(</span><span class="ident" id="5401993">c</span>&nbsp;<span class="builtintype" id="5401995">int</span><span class="op" id="5401998">,</span>&nbsp;<span class="ident" id="5402000">context</span>&nbsp;<span class="builtintype" id="5402008">string</span><span class="op" id="5402014">)</span>&nbsp;<span class="builtintype" id="5402016">int</span>&nbsp;<span class="op" id="5402020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5402023">s</span><span class="op" id="5402024">.</span><span class="ident" id="5402025">step</span>&nbsp;<span class="op" id="5402030">=</span>&nbsp;<span class="ident" id="5402032">stateError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5402044">s</span><span class="op" id="5402045">.</span><span class="ident" id="5402046">err</span>&nbsp;<span class="op" id="5402050">=</span>&nbsp;<span class="op" id="5402052">&amp;</span><span class="ident" id="5402053">SyntaxError</span><span class="op" id="5402064">{</span><span class="string" id="5402065">&#34;invalid&nbsp;character&nbsp;&#34;</span>&nbsp;<span class="op" id="5402086">+</span>&nbsp;<span class="ident" id="5402088">quoteChar</span><span class="op" id="5402097">(</span><span class="ident" id="5402098">c</span><span class="op" id="5402099">)</span>&nbsp;<span class="op" id="5402101">+</span>&nbsp;<span class="string" id="5402103">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="5402107">+</span>&nbsp;<span class="ident" id="5402109">context</span><span class="op" id="5402116">,</span>&nbsp;<span class="ident" id="5402118">s</span><span class="op" id="5402119">.</span><span class="ident" id="5402120">bytes</span><span class="op" id="5402125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5402128">return</span>&nbsp;<span class="ident" id="5402135">scanError</span><br>
<span class="lineno"></span><span class="op" id="5402145">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="5402148">//&nbsp;quoteChar&nbsp;formats&nbsp;c&nbsp;as&nbsp;a&nbsp;quoted&nbsp;character&nbsp;literal</span><br>
<span class="lineno"></span><span class="keyword" id="5402201">func</span>&nbsp;<span class="ident" id="5402206">quoteChar</span><span class="op" id="5402215">(</span><span class="ident" id="5402216">c</span>&nbsp;<span class="builtintype" id="5402218">int</span><span class="op" id="5402221">)</span>&nbsp;<span class="builtintype" id="5402223">string</span>&nbsp;<span class="op" id="5402230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5402233">//&nbsp;special&nbsp;cases&nbsp;-&nbsp;different&nbsp;from&nbsp;quoted&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5402283">if</span>&nbsp;<span class="ident" id="5402286">c</span>&nbsp;<span class="op" id="5402288">==</span>&nbsp;<span class="string" id="5402291">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="5402296">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5402300">return</span>&nbsp;<span class="string" id="5402307">`&#39;\&#39;&#39;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5402315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5402318">if</span>&nbsp;<span class="ident" id="5402321">c</span>&nbsp;<span class="op" id="5402323">==</span>&nbsp;<span class="string" id="5402326">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="5402330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5402334">return</span>&nbsp;<span class="string" id="5402341">`&#39;&#34;&#39;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5402348">}</span><br>
<span class="lineno">600</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5402352">//&nbsp;use&nbsp;quoted&nbsp;string&nbsp;with&nbsp;different&nbsp;quotation&nbsp;marks</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5402405">s</span>&nbsp;<span class="op" id="5402407">:=</span>&nbsp;<span class="ident" id="5402410">strconv</span><span class="op" id="5402417">.</span><span class="ident" id="5402418">Quote</span><span class="op" id="5402423">(</span><span class="builtintype" id="5402424">string</span><span class="op" id="5402430">(</span><span class="ident" id="5402431">c</span><span class="op" id="5402432">)</span><span class="op" id="5402433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5402436">return</span>&nbsp;<span class="string" id="5402443">&#34;&#39;&#34;</span>&nbsp;<span class="op" id="5402447">+</span>&nbsp;<span class="ident" id="5402449">s</span><span class="op" id="5402450">[</span><span class="num" id="5402451">1</span><span class="op" id="5402452">:</span><span class="builtinfunc" id="5402453">len</span><span class="op" id="5402456">(</span><span class="ident" id="5402457">s</span><span class="op" id="5402458">)</span><span class="op" id="5402459">-</span><span class="num" id="5402460">1</span><span class="op" id="5402461">]</span>&nbsp;<span class="op" id="5402463">+</span>&nbsp;<span class="string" id="5402465">&#34;&#39;&#34;</span><br>
<span class="lineno"></span><span class="op" id="5402469">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span><span class="comment" id="5402472">//&nbsp;undo&nbsp;causes&nbsp;the&nbsp;scanner&nbsp;to&nbsp;return&nbsp;scanCode&nbsp;from&nbsp;the&nbsp;next&nbsp;state&nbsp;transition.</span><br>
<span class="lineno"></span><span class="comment" id="5402550">//&nbsp;This&nbsp;gives&nbsp;callers&nbsp;a&nbsp;simple&nbsp;1-byte&nbsp;undo&nbsp;mechanism.</span><br>
<span class="lineno"></span><span class="keyword" id="5402604">func</span>&nbsp;<span class="op" id="5402609">(</span><span class="ident" id="5402610">s</span>&nbsp;<span class="op" id="5402612">*</span><span class="ident" id="5402613">scanner</span><span class="op" id="5402620">)</span>&nbsp;<span class="ident" id="5402622">undo</span><span class="op" id="5402626">(</span><span class="ident" id="5402627">scanCode</span>&nbsp;<span class="builtintype" id="5402636">int</span><span class="op" id="5402639">)</span>&nbsp;<span class="op" id="5402641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5402644">if</span>&nbsp;<span class="ident" id="5402647">s</span><span class="op" id="5402648">.</span><span class="ident" id="5402649">redo</span>&nbsp;<span class="op" id="5402654">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5402658">panic</span><span class="op" id="5402663">(</span><span class="string" id="5402664">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;scanner&#34;</span><span class="op" id="5402694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5402697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5402700">s</span><span class="op" id="5402701">.</span><span class="ident" id="5402702">redoCode</span>&nbsp;<span class="op" id="5402711">=</span>&nbsp;<span class="ident" id="5402713">scanCode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5402723">s</span><span class="op" id="5402724">.</span><span class="ident" id="5402725">redoState</span>&nbsp;<span class="op" id="5402735">=</span>&nbsp;<span class="ident" id="5402737">s</span><span class="op" id="5402738">.</span><span class="ident" id="5402739">step</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5402745">s</span><span class="op" id="5402746">.</span><span class="ident" id="5402747">step</span>&nbsp;<span class="op" id="5402752">=</span>&nbsp;<span class="ident" id="5402754">stateRedo</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5402765">s</span><span class="op" id="5402766">.</span><span class="ident" id="5402767">redo</span>&nbsp;<span class="op" id="5402772">=</span>&nbsp;<span class="builtintype" id="5402774">true</span><br>
<span class="lineno"></span><span class="op" id="5402779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5402782">//&nbsp;stateRedo&nbsp;helps&nbsp;implement&nbsp;the&nbsp;scanner&#39;s&nbsp;1-byte&nbsp;undo.</span><br>
<span class="lineno"></span><span class="keyword" id="5402838">func</span>&nbsp;<span class="ident" id="5402843">stateRedo</span><span class="op" id="5402852">(</span><span class="ident" id="5402853">s</span>&nbsp;<span class="op" id="5402855">*</span><span class="ident" id="5402856">scanner</span><span class="op" id="5402863">,</span>&nbsp;<span class="ident" id="5402865">c</span>&nbsp;<span class="builtintype" id="5402867">int</span><span class="op" id="5402870">)</span>&nbsp;<span class="builtintype" id="5402872">int</span>&nbsp;<span class="op" id="5402876">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5402879">s</span><span class="op" id="5402880">.</span><span class="ident" id="5402881">redo</span>&nbsp;<span class="op" id="5402886">=</span>&nbsp;<span class="builtintype" id="5402888">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5402895">s</span><span class="op" id="5402896">.</span><span class="ident" id="5402897">step</span>&nbsp;<span class="op" id="5402902">=</span>&nbsp;<span class="ident" id="5402904">s</span><span class="op" id="5402905">.</span><span class="ident" id="5402906">redoState</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5402917">return</span>&nbsp;<span class="ident" id="5402924">s</span><span class="op" id="5402925">.</span><span class="ident" id="5402926">redoCode</span><br>
<span class="lineno"></span><span class="op" id="5402935">}</span>
</div>
</body>
</html>
