<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime/debug</h2>
<ul>
<li><a href="/gostd/runtime/debug/garbage.go.html">garbage.go</a></li>
<li><a href="/gostd/runtime/debug/garbage_test.go.html">garbage_test.go</a></li>
<li><a href="/gostd/runtime/debug/heapdump_test.go.html">heapdump_test.go</a></li>
<li><a href="/gostd/runtime/debug/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/debug/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/debug/stubs.go.html">stubs.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5932958">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5933014">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5933068">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5933119">package</span>&nbsp;<span class="ident" id="5933127">debug</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5933134">import</span>&nbsp;<span class="op" id="5933141">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5933144">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5933155">&#34;sort&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5933163">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="5933170">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5933173">//&nbsp;GCStats&nbsp;collect&nbsp;information&nbsp;about&nbsp;recent&nbsp;garbage&nbsp;collections.</span><br>
<span class="lineno"></span><span class="keyword" id="5933238">type</span>&nbsp;<span class="ident" id="5933243">GCStats</span>&nbsp;<span class="keyword" id="5933251">struct</span>&nbsp;<span class="op" id="5933258">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5933261">LastGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5933276">time</span><span class="op" id="5933280">.</span><span class="ident" id="5933281">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5933292">//&nbsp;time&nbsp;of&nbsp;last&nbsp;collection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5933320">NumGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5933335">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5933351">//&nbsp;number&nbsp;of&nbsp;garbage&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5933385">PauseTotal</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5933400">time</span><span class="op" id="5933404">.</span><span class="ident" id="5933405">Duration</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5933416">//&nbsp;total&nbsp;pause&nbsp;for&nbsp;all&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5933452">Pause</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5933467">[</span><span class="op" id="5933468">]</span><span class="ident" id="5933469">time</span><span class="op" id="5933473">.</span><span class="ident" id="5933474">Duration</span>&nbsp;<span class="comment" id="5933483">//&nbsp;pause&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5933520">PauseEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5933535">[</span><span class="op" id="5933536">]</span><span class="ident" id="5933537">time</span><span class="op" id="5933541">.</span><span class="ident" id="5933542">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5933551">//&nbsp;pause&nbsp;end&nbsp;times&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5933598">PauseQuantiles</span>&nbsp;<span class="op" id="5933613">[</span><span class="op" id="5933614">]</span><span class="ident" id="5933615">time</span><span class="op" id="5933619">.</span><span class="ident" id="5933620">Duration</span><br>
<span class="lineno"></span><span class="op" id="5933629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5933632">//&nbsp;ReadGCStats&nbsp;reads&nbsp;statistics&nbsp;about&nbsp;garbage&nbsp;collection&nbsp;into&nbsp;stats.</span><br>
<span class="lineno"></span><span class="comment" id="5933701">//&nbsp;The&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;the&nbsp;pause&nbsp;history&nbsp;is&nbsp;system-dependent;</span><br>
<span class="lineno">25</span><span class="comment" id="5933768">//&nbsp;stats.Pause&nbsp;slice&nbsp;will&nbsp;be&nbsp;reused&nbsp;if&nbsp;large&nbsp;enough,&nbsp;reallocated&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="5933844">//&nbsp;ReadGCStats&nbsp;may&nbsp;use&nbsp;the&nbsp;full&nbsp;capacity&nbsp;of&nbsp;the&nbsp;stats.Pause&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="5933911">//&nbsp;If&nbsp;stats.PauseQuantiles&nbsp;is&nbsp;non-empty,&nbsp;ReadGCStats&nbsp;fills&nbsp;it&nbsp;with&nbsp;quantiles</span><br>
<span class="lineno"></span><span class="comment" id="5933988">//&nbsp;summarizing&nbsp;the&nbsp;distribution&nbsp;of&nbsp;pause&nbsp;time.&nbsp;For&nbsp;example,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="5934051">//&nbsp;len(stats.PauseQuantiles)&nbsp;is&nbsp;5,&nbsp;it&nbsp;will&nbsp;be&nbsp;filled&nbsp;with&nbsp;the&nbsp;minimum,</span><br>
<span class="lineno">30</span><span class="comment" id="5934122">//&nbsp;25%,&nbsp;50%,&nbsp;75%,&nbsp;and&nbsp;maximum&nbsp;pause&nbsp;times.</span><br>
<span class="lineno"></span><span class="keyword" id="5934165">func</span>&nbsp;<span class="ident" id="5934170">ReadGCStats</span><span class="op" id="5934181">(</span><span class="ident" id="5934182">stats</span>&nbsp;<span class="op" id="5934188">*</span><span class="ident" id="5934189">GCStats</span><span class="op" id="5934196">)</span>&nbsp;<span class="op" id="5934198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5934201">//&nbsp;Create&nbsp;a&nbsp;buffer&nbsp;with&nbsp;space&nbsp;for&nbsp;at&nbsp;least&nbsp;two&nbsp;copies&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5934263">//&nbsp;pause&nbsp;history&nbsp;tracked&nbsp;by&nbsp;the&nbsp;runtime.&nbsp;One&nbsp;will&nbsp;be&nbsp;returned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5934326">//&nbsp;to&nbsp;the&nbsp;caller&nbsp;and&nbsp;the&nbsp;other&nbsp;will&nbsp;be&nbsp;used&nbsp;as&nbsp;transfer&nbsp;buffer</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5934390">//&nbsp;for&nbsp;end&nbsp;times&nbsp;history&nbsp;and&nbsp;as&nbsp;a&nbsp;temporary&nbsp;buffer&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5934446">//&nbsp;computing&nbsp;quantiles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934471">const</span>&nbsp;<span class="ident" id="5934477">maxPause</span>&nbsp;<span class="op" id="5934486">=</span>&nbsp;<span class="builtinfunc" id="5934488">len</span><span class="op" id="5934491">(</span><span class="op" id="5934492">(</span><span class="op" id="5934493">(</span><span class="op" id="5934494">*</span><span class="ident" id="5934495">runtime</span><span class="op" id="5934502">.</span><span class="ident" id="5934503">MemStats</span><span class="op" id="5934511">)</span><span class="op" id="5934512">(</span><span class="ident" id="5934513">nil</span><span class="op" id="5934516">)</span><span class="op" id="5934517">)</span><span class="op" id="5934518">.</span><span class="ident" id="5934519">PauseNs</span><span class="op" id="5934526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5934529">if</span>&nbsp;<span class="builtinfunc" id="5934532">cap</span><span class="op" id="5934535">(</span><span class="ident" id="5934536">stats</span><span class="op" id="5934541">.</span><span class="ident" id="5934542">Pause</span><span class="op" id="5934547">)</span>&nbsp;<span class="op" id="5934549">&lt;</span>&nbsp;<span class="num" id="5934551">2</span><span class="op" id="5934552">*</span><span class="ident" id="5934553">maxPause</span><span class="op" id="5934561">+</span><span class="num" id="5934562">3</span>&nbsp;<span class="op" id="5934564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934568">stats</span><span class="op" id="5934573">.</span><span class="ident" id="5934574">Pause</span>&nbsp;<span class="op" id="5934580">=</span>&nbsp;<span class="builtinfunc" id="5934582">make</span><span class="op" id="5934586">(</span><span class="op" id="5934587">[</span><span class="op" id="5934588">]</span><span class="ident" id="5934589">time</span><span class="op" id="5934593">.</span><span class="ident" id="5934594">Duration</span><span class="op" id="5934602">,</span>&nbsp;<span class="num" id="5934604">2</span><span class="op" id="5934605">*</span><span class="ident" id="5934606">maxPause</span><span class="op" id="5934614">+</span><span class="num" id="5934615">3</span><span class="op" id="5934616">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5934619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5934623">//&nbsp;readGCStats&nbsp;fills&nbsp;in&nbsp;the&nbsp;pause&nbsp;and&nbsp;end&nbsp;times&nbsp;histories&nbsp;(up&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5934689">//&nbsp;maxPause&nbsp;entries)&nbsp;and&nbsp;then&nbsp;three&nbsp;more:&nbsp;Unix&nbsp;ns&nbsp;time&nbsp;of&nbsp;last&nbsp;GC,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5934757">//&nbsp;number&nbsp;of&nbsp;GC,&nbsp;and&nbsp;total&nbsp;pause&nbsp;time&nbsp;in&nbsp;nanoseconds.&nbsp;Here&nbsp;we</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5934820">//&nbsp;depend&nbsp;on&nbsp;the&nbsp;fact&nbsp;that&nbsp;time.Duration&#39;s&nbsp;native&nbsp;unit&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5934879">//&nbsp;nanoseconds,&nbsp;so&nbsp;the&nbsp;pauses&nbsp;and&nbsp;the&nbsp;total&nbsp;pause&nbsp;time&nbsp;do&nbsp;not&nbsp;need</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5934947">//&nbsp;any&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934967">readGCStats</span><span class="op" id="5934978">(</span><span class="op" id="5934979">&amp;</span><span class="ident" id="5934980">stats</span><span class="op" id="5934985">.</span><span class="ident" id="5934986">Pause</span><span class="op" id="5934991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5934994">n</span>&nbsp;<span class="op" id="5934996">:=</span>&nbsp;<span class="builtinfunc" id="5934999">len</span><span class="op" id="5935002">(</span><span class="ident" id="5935003">stats</span><span class="op" id="5935008">.</span><span class="ident" id="5935009">Pause</span><span class="op" id="5935014">)</span>&nbsp;<span class="op" id="5935016">-</span>&nbsp;<span class="num" id="5935018">3</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935021">stats</span><span class="op" id="5935026">.</span><span class="ident" id="5935027">LastGC</span>&nbsp;<span class="op" id="5935034">=</span>&nbsp;<span class="ident" id="5935036">time</span><span class="op" id="5935040">.</span><span class="ident" id="5935041">Unix</span><span class="op" id="5935045">(</span><span class="num" id="5935046">0</span><span class="op" id="5935047">,</span>&nbsp;<span class="ident" id="5935049">int64</span><span class="op" id="5935054">(</span><span class="ident" id="5935055">stats</span><span class="op" id="5935060">.</span><span class="ident" id="5935061">Pause</span><span class="op" id="5935066">[</span><span class="ident" id="5935067">n</span><span class="op" id="5935068">]</span><span class="op" id="5935069">)</span><span class="op" id="5935070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935073">stats</span><span class="op" id="5935078">.</span><span class="ident" id="5935079">NumGC</span>&nbsp;<span class="op" id="5935085">=</span>&nbsp;<span class="ident" id="5935087">int64</span><span class="op" id="5935092">(</span><span class="ident" id="5935093">stats</span><span class="op" id="5935098">.</span><span class="ident" id="5935099">Pause</span><span class="op" id="5935104">[</span><span class="ident" id="5935105">n</span><span class="op" id="5935106">+</span><span class="num" id="5935107">1</span><span class="op" id="5935108">]</span><span class="op" id="5935109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935112">stats</span><span class="op" id="5935117">.</span><span class="ident" id="5935118">PauseTotal</span>&nbsp;<span class="op" id="5935129">=</span>&nbsp;<span class="ident" id="5935131">stats</span><span class="op" id="5935136">.</span><span class="ident" id="5935137">Pause</span><span class="op" id="5935142">[</span><span class="ident" id="5935143">n</span><span class="op" id="5935144">+</span><span class="num" id="5935145">2</span><span class="op" id="5935146">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935149">n</span>&nbsp;<span class="op" id="5935151">/=</span>&nbsp;<span class="num" id="5935154">2</span>&nbsp;<span class="comment" id="5935156">//&nbsp;buffer&nbsp;holds&nbsp;pauses&nbsp;and&nbsp;end&nbsp;times</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935194">stats</span><span class="op" id="5935199">.</span><span class="ident" id="5935200">Pause</span>&nbsp;<span class="op" id="5935206">=</span>&nbsp;<span class="ident" id="5935208">stats</span><span class="op" id="5935213">.</span><span class="ident" id="5935214">Pause</span><span class="op" id="5935219">[</span><span class="op" id="5935220">:</span><span class="ident" id="5935221">n</span><span class="op" id="5935222">]</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5935226">if</span>&nbsp;<span class="builtinfunc" id="5935229">cap</span><span class="op" id="5935232">(</span><span class="ident" id="5935233">stats</span><span class="op" id="5935238">.</span><span class="ident" id="5935239">PauseEnd</span><span class="op" id="5935247">)</span>&nbsp;<span class="op" id="5935249">&lt;</span>&nbsp;<span class="ident" id="5935251">maxPause</span>&nbsp;<span class="op" id="5935260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935264">stats</span><span class="op" id="5935269">.</span><span class="ident" id="5935270">PauseEnd</span>&nbsp;<span class="op" id="5935279">=</span>&nbsp;<span class="builtinfunc" id="5935281">make</span><span class="op" id="5935285">(</span><span class="op" id="5935286">[</span><span class="op" id="5935287">]</span><span class="ident" id="5935288">time</span><span class="op" id="5935292">.</span><span class="ident" id="5935293">Time</span><span class="op" id="5935297">,</span>&nbsp;<span class="num" id="5935299">0</span><span class="op" id="5935300">,</span>&nbsp;<span class="ident" id="5935302">maxPause</span><span class="op" id="5935310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5935313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935316">stats</span><span class="op" id="5935321">.</span><span class="ident" id="5935322">PauseEnd</span>&nbsp;<span class="op" id="5935331">=</span>&nbsp;<span class="ident" id="5935333">stats</span><span class="op" id="5935338">.</span><span class="ident" id="5935339">PauseEnd</span><span class="op" id="5935347">[</span><span class="op" id="5935348">:</span><span class="num" id="5935349">0</span><span class="op" id="5935350">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5935353">for</span>&nbsp;<span class="ident" id="5935357">_</span><span class="op" id="5935358">,</span>&nbsp;<span class="ident" id="5935360">ns</span>&nbsp;<span class="op" id="5935363">:=</span>&nbsp;<span class="keyword" id="5935366">range</span>&nbsp;<span class="ident" id="5935372">stats</span><span class="op" id="5935377">.</span><span class="ident" id="5935378">Pause</span><span class="op" id="5935383">[</span><span class="ident" id="5935384">n</span>&nbsp;<span class="op" id="5935386">:</span>&nbsp;<span class="ident" id="5935388">n</span><span class="op" id="5935389">+</span><span class="ident" id="5935390">n</span><span class="op" id="5935391">]</span>&nbsp;<span class="op" id="5935393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935397">stats</span><span class="op" id="5935402">.</span><span class="ident" id="5935403">PauseEnd</span>&nbsp;<span class="op" id="5935412">=</span>&nbsp;<span class="builtinfunc" id="5935414">append</span><span class="op" id="5935420">(</span><span class="ident" id="5935421">stats</span><span class="op" id="5935426">.</span><span class="ident" id="5935427">PauseEnd</span><span class="op" id="5935435">,</span>&nbsp;<span class="ident" id="5935437">time</span><span class="op" id="5935441">.</span><span class="ident" id="5935442">Unix</span><span class="op" id="5935446">(</span><span class="num" id="5935447">0</span><span class="op" id="5935448">,</span>&nbsp;<span class="ident" id="5935450">int64</span><span class="op" id="5935455">(</span><span class="ident" id="5935456">ns</span><span class="op" id="5935458">)</span><span class="op" id="5935459">)</span><span class="op" id="5935460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5935463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5935467">if</span>&nbsp;<span class="builtinfunc" id="5935470">len</span><span class="op" id="5935473">(</span><span class="ident" id="5935474">stats</span><span class="op" id="5935479">.</span><span class="ident" id="5935480">PauseQuantiles</span><span class="op" id="5935494">)</span>&nbsp;<span class="op" id="5935496">&gt;</span>&nbsp;<span class="num" id="5935498">0</span>&nbsp;<span class="op" id="5935500">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5935504">if</span>&nbsp;<span class="ident" id="5935507">n</span>&nbsp;<span class="op" id="5935509">==</span>&nbsp;<span class="num" id="5935512">0</span>&nbsp;<span class="op" id="5935514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5935519">for</span>&nbsp;<span class="ident" id="5935523">i</span>&nbsp;<span class="op" id="5935525">:=</span>&nbsp;<span class="keyword" id="5935528">range</span>&nbsp;<span class="ident" id="5935534">stats</span><span class="op" id="5935539">.</span><span class="ident" id="5935540">PauseQuantiles</span>&nbsp;<span class="op" id="5935555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935561">stats</span><span class="op" id="5935566">.</span><span class="ident" id="5935567">PauseQuantiles</span><span class="op" id="5935581">[</span><span class="ident" id="5935582">i</span><span class="op" id="5935583">]</span>&nbsp;<span class="op" id="5935585">=</span>&nbsp;<span class="num" id="5935587">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5935592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5935596">}</span>&nbsp;<span class="keyword" id="5935598">else</span>&nbsp;<span class="op" id="5935603">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5935608">//&nbsp;There&#39;s&nbsp;room&nbsp;for&nbsp;a&nbsp;second&nbsp;copy&nbsp;of&nbsp;the&nbsp;data&nbsp;in&nbsp;stats.Pause.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5935673">//&nbsp;See&nbsp;the&nbsp;allocation&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935726">sorted</span>&nbsp;<span class="op" id="5935733">:=</span>&nbsp;<span class="ident" id="5935736">stats</span><span class="op" id="5935741">.</span><span class="ident" id="5935742">Pause</span><span class="op" id="5935747">[</span><span class="ident" id="5935748">n</span>&nbsp;<span class="op" id="5935750">:</span>&nbsp;<span class="ident" id="5935752">n</span><span class="op" id="5935753">+</span><span class="ident" id="5935754">n</span><span class="op" id="5935755">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5935760">copy</span><span class="op" id="5935764">(</span><span class="ident" id="5935765">sorted</span><span class="op" id="5935771">,</span>&nbsp;<span class="ident" id="5935773">stats</span><span class="op" id="5935778">.</span><span class="ident" id="5935779">Pause</span><span class="op" id="5935784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935789">sort</span><span class="op" id="5935793">.</span><span class="ident" id="5935794">Sort</span><span class="op" id="5935798">(</span><span class="ident" id="5935799">byDuration</span><span class="op" id="5935809">(</span><span class="ident" id="5935810">sorted</span><span class="op" id="5935816">)</span><span class="op" id="5935817">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935822">nq</span>&nbsp;<span class="op" id="5935825">:=</span>&nbsp;<span class="builtinfunc" id="5935828">len</span><span class="op" id="5935831">(</span><span class="ident" id="5935832">stats</span><span class="op" id="5935837">.</span><span class="ident" id="5935838">PauseQuantiles</span><span class="op" id="5935852">)</span>&nbsp;<span class="op" id="5935854">-</span>&nbsp;<span class="num" id="5935856">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5935861">for</span>&nbsp;<span class="ident" id="5935865">i</span>&nbsp;<span class="op" id="5935867">:=</span>&nbsp;<span class="num" id="5935870">0</span><span class="op" id="5935871">;</span>&nbsp;<span class="ident" id="5935873">i</span>&nbsp;<span class="op" id="5935875">&lt;</span>&nbsp;<span class="ident" id="5935877">nq</span><span class="op" id="5935879">;</span>&nbsp;<span class="ident" id="5935881">i</span><span class="op" id="5935882">++</span>&nbsp;<span class="op" id="5935885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935891">stats</span><span class="op" id="5935896">.</span><span class="ident" id="5935897">PauseQuantiles</span><span class="op" id="5935911">[</span><span class="ident" id="5935912">i</span><span class="op" id="5935913">]</span>&nbsp;<span class="op" id="5935915">=</span>&nbsp;<span class="ident" id="5935917">sorted</span><span class="op" id="5935923">[</span><span class="builtinfunc" id="5935924">len</span><span class="op" id="5935927">(</span><span class="ident" id="5935928">sorted</span><span class="op" id="5935934">)</span><span class="op" id="5935935">*</span><span class="ident" id="5935936">i</span><span class="op" id="5935937">/</span><span class="ident" id="5935938">nq</span><span class="op" id="5935940">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5935945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5935950">stats</span><span class="op" id="5935955">.</span><span class="ident" id="5935956">PauseQuantiles</span><span class="op" id="5935970">[</span><span class="ident" id="5935971">nq</span><span class="op" id="5935973">]</span>&nbsp;<span class="op" id="5935975">=</span>&nbsp;<span class="ident" id="5935977">sorted</span><span class="op" id="5935983">[</span><span class="builtinfunc" id="5935984">len</span><span class="op" id="5935987">(</span><span class="ident" id="5935988">sorted</span><span class="op" id="5935994">)</span><span class="op" id="5935995">-</span><span class="num" id="5935996">1</span><span class="op" id="5935997">]</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5936001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5936004">}</span><br>
<span class="lineno"></span><span class="op" id="5936006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5936009">type</span>&nbsp;<span class="ident" id="5936014">byDuration</span>&nbsp;<span class="op" id="5936025">[</span><span class="op" id="5936026">]</span><span class="ident" id="5936027">time</span><span class="op" id="5936031">.</span><span class="ident" id="5936032">Duration</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="5936042">func</span>&nbsp;<span class="op" id="5936047">(</span><span class="ident" id="5936048">x</span>&nbsp;<span class="ident" id="5936050">byDuration</span><span class="op" id="5936060">)</span>&nbsp;<span class="ident" id="5936062">Len</span><span class="op" id="5936065">(</span><span class="op" id="5936066">)</span>&nbsp;<span class="builtintype" id="5936068">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5936082">{</span>&nbsp;<span class="keyword" id="5936084">return</span>&nbsp;<span class="builtinfunc" id="5936091">len</span><span class="op" id="5936094">(</span><span class="ident" id="5936095">x</span><span class="op" id="5936096">)</span>&nbsp;<span class="op" id="5936098">}</span><br>
<span class="lineno"></span><span class="keyword" id="5936100">func</span>&nbsp;<span class="op" id="5936105">(</span><span class="ident" id="5936106">x</span>&nbsp;<span class="ident" id="5936108">byDuration</span><span class="op" id="5936118">)</span>&nbsp;<span class="ident" id="5936120">Swap</span><span class="op" id="5936124">(</span><span class="ident" id="5936125">i</span><span class="op" id="5936126">,</span>&nbsp;<span class="ident" id="5936128">j</span>&nbsp;<span class="builtintype" id="5936130">int</span><span class="op" id="5936133">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5936140">{</span>&nbsp;<span class="ident" id="5936142">x</span><span class="op" id="5936143">[</span><span class="ident" id="5936144">i</span><span class="op" id="5936145">]</span><span class="op" id="5936146">,</span>&nbsp;<span class="ident" id="5936148">x</span><span class="op" id="5936149">[</span><span class="ident" id="5936150">j</span><span class="op" id="5936151">]</span>&nbsp;<span class="op" id="5936153">=</span>&nbsp;<span class="ident" id="5936155">x</span><span class="op" id="5936156">[</span><span class="ident" id="5936157">j</span><span class="op" id="5936158">]</span><span class="op" id="5936159">,</span>&nbsp;<span class="ident" id="5936161">x</span><span class="op" id="5936162">[</span><span class="ident" id="5936163">i</span><span class="op" id="5936164">]</span>&nbsp;<span class="op" id="5936166">}</span><br>
<span class="lineno"></span><span class="keyword" id="5936168">func</span>&nbsp;<span class="op" id="5936173">(</span><span class="ident" id="5936174">x</span>&nbsp;<span class="ident" id="5936176">byDuration</span><span class="op" id="5936186">)</span>&nbsp;<span class="ident" id="5936188">Less</span><span class="op" id="5936192">(</span><span class="ident" id="5936193">i</span><span class="op" id="5936194">,</span>&nbsp;<span class="ident" id="5936196">j</span>&nbsp;<span class="builtintype" id="5936198">int</span><span class="op" id="5936201">)</span>&nbsp;<span class="builtintype" id="5936203">bool</span>&nbsp;<span class="op" id="5936208">{</span>&nbsp;<span class="keyword" id="5936210">return</span>&nbsp;<span class="ident" id="5936217">x</span><span class="op" id="5936218">[</span><span class="ident" id="5936219">i</span><span class="op" id="5936220">]</span>&nbsp;<span class="op" id="5936222">&lt;</span>&nbsp;<span class="ident" id="5936224">x</span><span class="op" id="5936225">[</span><span class="ident" id="5936226">j</span><span class="op" id="5936227">]</span>&nbsp;<span class="op" id="5936229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="comment" id="5936232">//&nbsp;SetGCPercent&nbsp;sets&nbsp;the&nbsp;garbage&nbsp;collection&nbsp;target&nbsp;percentage:</span><br>
<span class="lineno"></span><span class="comment" id="5936295">//&nbsp;a&nbsp;collection&nbsp;is&nbsp;triggered&nbsp;when&nbsp;the&nbsp;ratio&nbsp;of&nbsp;freshly&nbsp;allocated&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="5936365">//&nbsp;to&nbsp;live&nbsp;data&nbsp;remaining&nbsp;after&nbsp;the&nbsp;previous&nbsp;collection&nbsp;reaches&nbsp;this&nbsp;percentage.</span><br>
<span class="lineno"></span><span class="comment" id="5936446">//&nbsp;SetGCPercent&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="5936492">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;GOGC&nbsp;environment&nbsp;variable</span><br>
<span class="lineno">95</span><span class="comment" id="5936561">//&nbsp;at&nbsp;startup,&nbsp;or&nbsp;100&nbsp;if&nbsp;the&nbsp;variable&nbsp;is&nbsp;not&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="5936611">//&nbsp;A&nbsp;negative&nbsp;percentage&nbsp;disables&nbsp;garbage&nbsp;collection.</span><br>
<span class="lineno"></span><span class="keyword" id="5936665">func</span>&nbsp;<span class="ident" id="5936670">SetGCPercent</span><span class="op" id="5936682">(</span><span class="ident" id="5936683">percent</span>&nbsp;<span class="builtintype" id="5936691">int</span><span class="op" id="5936694">)</span>&nbsp;<span class="builtintype" id="5936696">int</span>&nbsp;<span class="op" id="5936700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936703">old</span>&nbsp;<span class="op" id="5936707">:=</span>&nbsp;<span class="ident" id="5936710">setGCPercent</span><span class="op" id="5936722">(</span><span class="builtintype" id="5936723">int32</span><span class="op" id="5936728">(</span><span class="ident" id="5936729">percent</span><span class="op" id="5936736">)</span><span class="op" id="5936737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5936740">runtime</span><span class="op" id="5936747">.</span><span class="ident" id="5936748">GC</span><span class="op" id="5936750">(</span><span class="op" id="5936751">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5936754">return</span>&nbsp;<span class="builtintype" id="5936761">int</span><span class="op" id="5936764">(</span><span class="ident" id="5936765">old</span><span class="op" id="5936768">)</span><br>
<span class="lineno"></span><span class="op" id="5936770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5936773">//&nbsp;FreeOSMemory&nbsp;forces&nbsp;a&nbsp;garbage&nbsp;collection&nbsp;followed&nbsp;by&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="5936832">//&nbsp;attempt&nbsp;to&nbsp;return&nbsp;as&nbsp;much&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system</span><br>
<span class="lineno">105</span><span class="comment" id="5936892">//&nbsp;as&nbsp;possible.&nbsp;(Even&nbsp;if&nbsp;this&nbsp;is&nbsp;not&nbsp;called,&nbsp;the&nbsp;runtime&nbsp;gradually</span><br>
<span class="lineno"></span><span class="comment" id="5936959">//&nbsp;returns&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system&nbsp;in&nbsp;a&nbsp;background&nbsp;task.)</span><br>
<span class="lineno"></span><span class="keyword" id="5937024">func</span>&nbsp;<span class="ident" id="5937029">FreeOSMemory</span><span class="op" id="5937041">(</span><span class="op" id="5937042">)</span>&nbsp;<span class="op" id="5937044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5937047">freeOSMemory</span><span class="op" id="5937059">(</span><span class="op" id="5937060">)</span><br>
<span class="lineno"></span><span class="op" id="5937062">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="5937065">//&nbsp;SetMaxStack&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;amount&nbsp;of&nbsp;memory&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5937119">//&nbsp;can&nbsp;be&nbsp;used&nbsp;by&nbsp;a&nbsp;single&nbsp;goroutine&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="5937163">//&nbsp;If&nbsp;any&nbsp;goroutine&nbsp;exceeds&nbsp;this&nbsp;limit&nbsp;while&nbsp;growing&nbsp;its&nbsp;stack,</span><br>
<span class="lineno"></span><span class="comment" id="5937227">//&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno">115</span><span class="comment" id="5937251">//&nbsp;SetMaxStack&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="5937296">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;1&nbsp;GB&nbsp;on&nbsp;64-bit&nbsp;systems,&nbsp;250&nbsp;MB&nbsp;on&nbsp;32-bit&nbsp;systems.</span><br>
<span class="lineno"></span><span class="comment" id="5937372">//</span><br>
<span class="lineno"></span><span class="comment" id="5937375">//&nbsp;SetMaxStack&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5937439">//&nbsp;goroutines&nbsp;that&nbsp;enter&nbsp;an&nbsp;infinite&nbsp;recursion.&nbsp;It&nbsp;only&nbsp;limits&nbsp;future</span><br>
<span class="lineno">120</span><span class="comment" id="5937509">//&nbsp;stack&nbsp;growth.</span><br>
<span class="lineno"></span><span class="keyword" id="5937526">func</span>&nbsp;<span class="ident" id="5937531">SetMaxStack</span><span class="op" id="5937542">(</span><span class="ident" id="5937543">bytes</span>&nbsp;<span class="builtintype" id="5937549">int</span><span class="op" id="5937552">)</span>&nbsp;<span class="builtintype" id="5937554">int</span>&nbsp;<span class="op" id="5937558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5937561">return</span>&nbsp;<span class="ident" id="5937568">setMaxStack</span><span class="op" id="5937579">(</span><span class="ident" id="5937580">bytes</span><span class="op" id="5937585">)</span><br>
<span class="lineno"></span><span class="op" id="5937587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="5937590">//&nbsp;SetMaxThreads&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;operating&nbsp;system</span><br>
<span class="lineno"></span><span class="comment" id="5937651">//&nbsp;threads&nbsp;that&nbsp;the&nbsp;Go&nbsp;program&nbsp;can&nbsp;use.&nbsp;If&nbsp;it&nbsp;attempts&nbsp;to&nbsp;use&nbsp;more&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="5937723">//&nbsp;this&nbsp;many,&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno"></span><span class="comment" id="5937758">//&nbsp;SetMaxThreads&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="5937805">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;10,000&nbsp;threads.</span><br>
<span class="lineno">130</span><span class="comment" id="5937847">//</span><br>
<span class="lineno"></span><span class="comment" id="5937850">//&nbsp;The&nbsp;limit&nbsp;controls&nbsp;the&nbsp;number&nbsp;of&nbsp;operating&nbsp;system&nbsp;threads,&nbsp;not&nbsp;the&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="5937927">//&nbsp;of&nbsp;goroutines.&nbsp;A&nbsp;Go&nbsp;program&nbsp;creates&nbsp;a&nbsp;new&nbsp;thread&nbsp;only&nbsp;when&nbsp;a&nbsp;goroutine</span><br>
<span class="lineno"></span><span class="comment" id="5938001">//&nbsp;is&nbsp;ready&nbsp;to&nbsp;run&nbsp;but&nbsp;all&nbsp;the&nbsp;existing&nbsp;threads&nbsp;are&nbsp;blocked&nbsp;in&nbsp;system&nbsp;calls,&nbsp;cgo&nbsp;calls,</span><br>
<span class="lineno"></span><span class="comment" id="5938089">//&nbsp;or&nbsp;are&nbsp;locked&nbsp;to&nbsp;other&nbsp;goroutines&nbsp;due&nbsp;to&nbsp;use&nbsp;of&nbsp;runtime.LockOSThread.</span><br>
<span class="lineno">135</span><span class="comment" id="5938162">//</span><br>
<span class="lineno"></span><span class="comment" id="5938165">//&nbsp;SetMaxThreads&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5938231">//&nbsp;programs&nbsp;that&nbsp;create&nbsp;an&nbsp;unbounded&nbsp;number&nbsp;of&nbsp;threads.&nbsp;The&nbsp;idea&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5938299">//&nbsp;to&nbsp;take&nbsp;down&nbsp;the&nbsp;program&nbsp;before&nbsp;it&nbsp;takes&nbsp;down&nbsp;the&nbsp;operating&nbsp;system.</span><br>
<span class="lineno"></span><span class="keyword" id="5938370">func</span>&nbsp;<span class="ident" id="5938375">SetMaxThreads</span><span class="op" id="5938388">(</span><span class="ident" id="5938389">threads</span>&nbsp;<span class="builtintype" id="5938397">int</span><span class="op" id="5938400">)</span>&nbsp;<span class="builtintype" id="5938402">int</span>&nbsp;<span class="op" id="5938406">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5938409">return</span>&nbsp;<span class="ident" id="5938416">setMaxThreads</span><span class="op" id="5938429">(</span><span class="ident" id="5938430">threads</span><span class="op" id="5938437">)</span><br>
<span class="lineno"></span><span class="op" id="5938439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5938442">//&nbsp;SetPanicOnFault&nbsp;controls&nbsp;the&nbsp;runtime&#39;s&nbsp;behavior&nbsp;when&nbsp;a&nbsp;program&nbsp;faults</span><br>
<span class="lineno"></span><span class="comment" id="5938515">//&nbsp;at&nbsp;an&nbsp;unexpected&nbsp;(non-nil)&nbsp;address.&nbsp;Such&nbsp;faults&nbsp;are&nbsp;typically&nbsp;caused&nbsp;by</span><br>
<span class="lineno">145</span><span class="comment" id="5938590">//&nbsp;bugs&nbsp;such&nbsp;as&nbsp;runtime&nbsp;memory&nbsp;corruption,&nbsp;so&nbsp;the&nbsp;default&nbsp;response&nbsp;is&nbsp;to&nbsp;crash</span><br>
<span class="lineno"></span><span class="comment" id="5938669">//&nbsp;the&nbsp;program.&nbsp;Programs&nbsp;working&nbsp;with&nbsp;memory-mapped&nbsp;files&nbsp;or&nbsp;unsafe</span><br>
<span class="lineno"></span><span class="comment" id="5938737">//&nbsp;manipulation&nbsp;of&nbsp;memory&nbsp;may&nbsp;cause&nbsp;faults&nbsp;at&nbsp;non-nil&nbsp;addresses&nbsp;in&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="5938809">//&nbsp;dramatic&nbsp;situations;&nbsp;SetPanicOnFault&nbsp;allows&nbsp;such&nbsp;programs&nbsp;to&nbsp;request</span><br>
<span class="lineno"></span><span class="comment" id="5938881">//&nbsp;that&nbsp;the&nbsp;runtime&nbsp;trigger&nbsp;only&nbsp;a&nbsp;panic,&nbsp;not&nbsp;a&nbsp;crash.</span><br>
<span class="lineno">150</span><span class="comment" id="5938936">//&nbsp;SetPanicOnFault&nbsp;applies&nbsp;only&nbsp;to&nbsp;the&nbsp;current&nbsp;goroutine.</span><br>
<span class="lineno"></span><span class="comment" id="5938994">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="keyword" id="5939030">func</span>&nbsp;<span class="ident" id="5939035">SetPanicOnFault</span><span class="op" id="5939050">(</span><span class="ident" id="5939051">enabled</span>&nbsp;<span class="builtintype" id="5939059">bool</span><span class="op" id="5939063">)</span>&nbsp;<span class="builtintype" id="5939065">bool</span>&nbsp;<span class="op" id="5939070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5939073">return</span>&nbsp;<span class="ident" id="5939080">setPanicOnFault</span><span class="op" id="5939095">(</span><span class="ident" id="5939096">enabled</span><span class="op" id="5939103">)</span><br>
<span class="lineno"></span><span class="op" id="5939105">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="5939108">//&nbsp;WriteHeapDump&nbsp;writes&nbsp;a&nbsp;description&nbsp;of&nbsp;the&nbsp;heap&nbsp;and&nbsp;the&nbsp;objects&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5939177">//&nbsp;it&nbsp;to&nbsp;the&nbsp;given&nbsp;file&nbsp;descriptor.</span><br>
<span class="lineno"></span><span class="comment" id="5939213">//&nbsp;The&nbsp;heap&nbsp;dump&nbsp;format&nbsp;is&nbsp;defined&nbsp;at&nbsp;http://golang.org/s/go13heapdump.</span><br>
<span class="lineno"></span><span class="keyword" id="5939285">func</span>&nbsp;<span class="ident" id="5939290">WriteHeapDump</span><span class="op" id="5939303">(</span><span class="ident" id="5939304">fd</span>&nbsp;<span class="builtintype" id="5939307">uintptr</span><span class="op" id="5939314">)</span>
</div>
</body>
</html>
