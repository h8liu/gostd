<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8545665">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8545720">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8545774">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8545825">package</span>&nbsp;<span class="ident" id="8545833">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8545838">import</span>&nbsp;<span class="op" id="8545845">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8545848">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8545857">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8545866">&#34;compress/bzip2&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8545884">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8545894">_</span>&nbsp;<span class="string" id="8545896">&#34;crypto/md5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8545910">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8545925">&#34;crypto/sha1&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8545940">_</span>&nbsp;<span class="string" id="8545942">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8545959">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8545975">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8545987">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8545993">&#34;strconv&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8546004">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8546015">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8546025">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8546028">func</span>&nbsp;<span class="ident" id="8546033">TestEMSAPSS</span><span class="op" id="8546044">(</span><span class="ident" id="8546045">t</span>&nbsp;<span class="op" id="8546047">*</span><span class="ident" id="8546048">testing</span><span class="op" id="8546055">.</span><span class="ident" id="8546056">T</span><span class="op" id="8546057">)</span>&nbsp;<span class="op" id="8546059">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8546062">//&nbsp;Test&nbsp;vector&nbsp;in&nbsp;file&nbsp;pss-int.txt&nbsp;from:&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8546165">msg</span>&nbsp;<span class="op" id="8546169">:=</span>&nbsp;<span class="op" id="8546172">[</span><span class="op" id="8546173">]</span><span class="builtintype" id="8546174">byte</span><span class="op" id="8546178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8546182">0x85</span><span class="op" id="8546186">,</span>&nbsp;<span class="num" id="8546188">0x9e</span><span class="op" id="8546192">,</span>&nbsp;<span class="num" id="8546194">0xef</span><span class="op" id="8546198">,</span>&nbsp;<span class="num" id="8546200">0x2f</span><span class="op" id="8546204">,</span>&nbsp;<span class="num" id="8546206">0xd7</span><span class="op" id="8546210">,</span>&nbsp;<span class="num" id="8546212">0x8a</span><span class="op" id="8546216">,</span>&nbsp;<span class="num" id="8546218">0xca</span><span class="op" id="8546222">,</span>&nbsp;<span class="num" id="8546224">0x00</span><span class="op" id="8546228">,</span>&nbsp;<span class="num" id="8546230">0x30</span><span class="op" id="8546234">,</span>&nbsp;<span class="num" id="8546236">0x8b</span><span class="op" id="8546240">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8546244">0xdc</span><span class="op" id="8546248">,</span>&nbsp;<span class="num" id="8546250">0x47</span><span class="op" id="8546254">,</span>&nbsp;<span class="num" id="8546256">0x11</span><span class="op" id="8546260">,</span>&nbsp;<span class="num" id="8546262">0x93</span><span class="op" id="8546266">,</span>&nbsp;<span class="num" id="8546268">0xbf</span><span class="op" id="8546272">,</span>&nbsp;<span class="num" id="8546274">0x55</span><span class="op" id="8546278">,</span>&nbsp;<span class="num" id="8546280">0xbf</span><span class="op" id="8546284">,</span>&nbsp;<span class="num" id="8546286">0x9d</span><span class="op" id="8546290">,</span>&nbsp;<span class="num" id="8546292">0x78</span><span class="op" id="8546296">,</span>&nbsp;<span class="num" id="8546298">0xdb</span><span class="op" id="8546302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8546306">0x8f</span><span class="op" id="8546310">,</span>&nbsp;<span class="num" id="8546312">0x8a</span><span class="op" id="8546316">,</span>&nbsp;<span class="num" id="8546318">0x67</span><span class="op" id="8546322">,</span>&nbsp;<span class="num" id="8546324">0x2b</span><span class="op" id="8546328">,</span>&nbsp;<span class="num" id="8546330">0x48</span><span class="op" id="8546334">,</span>&nbsp;<span class="num" id="8546336">0x46</span><span class="op" id="8546340">,</span>&nbsp;<span class="num" id="8546342">0x34</span><span class="op" id="8546346">,</span>&nbsp;<span class="num" id="8546348">0xf3</span><span class="op" id="8546352">,</span>&nbsp;<span class="num" id="8546354">0xc9</span><span class="op" id="8546358">,</span>&nbsp;<span class="num" id="8546360">0xc2</span><span class="op" id="8546364">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8546368">0x6e</span><span class="op" id="8546372">,</span>&nbsp;<span class="num" id="8546374">0x64</span><span class="op" id="8546378">,</span>&nbsp;<span class="num" id="8546380">0x78</span><span class="op" id="8546384">,</span>&nbsp;<span class="num" id="8546386">0xae</span><span class="op" id="8546390">,</span>&nbsp;<span class="num" id="8546392">0x10</span><span class="op" id="8546396">,</span>&nbsp;<span class="num" id="8546398">0x26</span><span class="op" id="8546402">,</span>&nbsp;<span class="num" id="8546404">0x0f</span><span class="op" id="8546408">,</span>&nbsp;<span class="num" id="8546410">0xe0</span><span class="op" id="8546414">,</span>&nbsp;<span class="num" id="8546416">0xdd</span><span class="op" id="8546420">,</span>&nbsp;<span class="num" id="8546422">0x8c</span><span class="op" id="8546426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8546430">0x08</span><span class="op" id="8546434">,</span>&nbsp;<span class="num" id="8546436">0x2e</span><span class="op" id="8546440">,</span>&nbsp;<span class="num" id="8546442">0x53</span><span class="op" id="8546446">,</span>&nbsp;<span class="num" id="8546448">0xa5</span><span class="op" id="8546452">,</span>&nbsp;<span class="num" id="8546454">0x29</span><span class="op" id="8546458">,</span>&nbsp;<span class="num" id="8546460">0x3a</span><span class="op" id="8546464">,</span>&nbsp;<span class="num" id="8546466">0xf2</span><span class="op" id="8546470">,</span>&nbsp;<span class="num" id="8546472">0x17</span><span class="op" id="8546476">,</span>&nbsp;<span class="num" id="8546478">0x3c</span><span class="op" id="8546482">,</span>&nbsp;<span class="num" id="8546484">0xd5</span><span class="op" id="8546488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8546492">0x0c</span><span class="op" id="8546496">,</span>&nbsp;<span class="num" id="8546498">0x6d</span><span class="op" id="8546502">,</span>&nbsp;<span class="num" id="8546504">0x5d</span><span class="op" id="8546508">,</span>&nbsp;<span class="num" id="8546510">0x35</span><span class="op" id="8546514">,</span>&nbsp;<span class="num" id="8546516">0x4f</span><span class="op" id="8546520">,</span>&nbsp;<span class="num" id="8546522">0xeb</span><span class="op" id="8546526">,</span>&nbsp;<span class="num" id="8546528">0xf7</span><span class="op" id="8546532">,</span>&nbsp;<span class="num" id="8546534">0x8b</span><span class="op" id="8546538">,</span>&nbsp;<span class="num" id="8546540">0x26</span><span class="op" id="8546544">,</span>&nbsp;<span class="num" id="8546546">0x02</span><span class="op" id="8546550">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8546554">0x1c</span><span class="op" id="8546558">,</span>&nbsp;<span class="num" id="8546560">0x25</span><span class="op" id="8546564">,</span>&nbsp;<span class="num" id="8546566">0xc0</span><span class="op" id="8546570">,</span>&nbsp;<span class="num" id="8546572">0x27</span><span class="op" id="8546576">,</span>&nbsp;<span class="num" id="8546578">0x12</span><span class="op" id="8546582">,</span>&nbsp;<span class="num" id="8546584">0xe7</span><span class="op" id="8546588">,</span>&nbsp;<span class="num" id="8546590">0x8c</span><span class="op" id="8546594">,</span>&nbsp;<span class="num" id="8546596">0xd4</span><span class="op" id="8546600">,</span>&nbsp;<span class="num" id="8546602">0x69</span><span class="op" id="8546606">,</span>&nbsp;<span class="num" id="8546608">0x4c</span><span class="op" id="8546612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8546616">0x9f</span><span class="op" id="8546620">,</span>&nbsp;<span class="num" id="8546622">0x46</span><span class="op" id="8546626">,</span>&nbsp;<span class="num" id="8546628">0x97</span><span class="op" id="8546632">,</span>&nbsp;<span class="num" id="8546634">0x77</span><span class="op" id="8546638">,</span>&nbsp;<span class="num" id="8546640">0xe4</span><span class="op" id="8546644">,</span>&nbsp;<span class="num" id="8546646">0x51</span><span class="op" id="8546650">,</span>&nbsp;<span class="num" id="8546652">0xe7</span><span class="op" id="8546656">,</span>&nbsp;<span class="num" id="8546658">0xf8</span><span class="op" id="8546662">,</span>&nbsp;<span class="num" id="8546664">0xe9</span><span class="op" id="8546668">,</span>&nbsp;<span class="num" id="8546670">0xe0</span><span class="op" id="8546674">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8546678">0x4c</span><span class="op" id="8546682">,</span>&nbsp;<span class="num" id="8546684">0xd3</span><span class="op" id="8546688">,</span>&nbsp;<span class="num" id="8546690">0x73</span><span class="op" id="8546694">,</span>&nbsp;<span class="num" id="8546696">0x9c</span><span class="op" id="8546700">,</span>&nbsp;<span class="num" id="8546702">0x6b</span><span class="op" id="8546706">,</span>&nbsp;<span class="num" id="8546708">0xbf</span><span class="op" id="8546712">,</span>&nbsp;<span class="num" id="8546714">0xed</span><span class="op" id="8546718">,</span>&nbsp;<span class="num" id="8546720">0xae</span><span class="op" id="8546724">,</span>&nbsp;<span class="num" id="8546726">0x48</span><span class="op" id="8546730">,</span>&nbsp;<span class="num" id="8546732">0x7f</span><span class="op" id="8546736">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8546740">0xb5</span><span class="op" id="8546744">,</span>&nbsp;<span class="num" id="8546746">0x56</span><span class="op" id="8546750">,</span>&nbsp;<span class="num" id="8546752">0x44</span><span class="op" id="8546756">,</span>&nbsp;<span class="num" id="8546758">0xe9</span><span class="op" id="8546762">,</span>&nbsp;<span class="num" id="8546764">0xca</span><span class="op" id="8546768">,</span>&nbsp;<span class="num" id="8546770">0x74</span><span class="op" id="8546774">,</span>&nbsp;<span class="num" id="8546776">0xff</span><span class="op" id="8546780">,</span>&nbsp;<span class="num" id="8546782">0x77</span><span class="op" id="8546786">,</span>&nbsp;<span class="num" id="8546788">0xa5</span><span class="op" id="8546792">,</span>&nbsp;<span class="num" id="8546794">0x3c</span><span class="op" id="8546798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8546802">0xb7</span><span class="op" id="8546806">,</span>&nbsp;<span class="num" id="8546808">0x29</span><span class="op" id="8546812">,</span>&nbsp;<span class="num" id="8546814">0x80</span><span class="op" id="8546818">,</span>&nbsp;<span class="num" id="8546820">0x2f</span><span class="op" id="8546824">,</span>&nbsp;<span class="num" id="8546826">0x6e</span><span class="op" id="8546830">,</span>&nbsp;<span class="num" id="8546832">0xd4</span><span class="op" id="8546836">,</span>&nbsp;<span class="num" id="8546838">0xa5</span><span class="op" id="8546842">,</span>&nbsp;<span class="num" id="8546844">0xff</span><span class="op" id="8546848">,</span>&nbsp;<span class="num" id="8546850">0xa8</span><span class="op" id="8546854">,</span>&nbsp;<span class="num" id="8546856">0xba</span><span class="op" id="8546860">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8546864">0x15</span><span class="op" id="8546868">,</span>&nbsp;<span class="num" id="8546870">0x98</span><span class="op" id="8546874">,</span>&nbsp;<span class="num" id="8546876">0x90</span><span class="op" id="8546880">,</span>&nbsp;<span class="num" id="8546882">0xfc</span><span class="op" id="8546886">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8546889">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8546892">salt</span>&nbsp;<span class="op" id="8546897">:=</span>&nbsp;<span class="op" id="8546900">[</span><span class="op" id="8546901">]</span><span class="builtintype" id="8546902">byte</span><span class="op" id="8546906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8546910">0xe3</span><span class="op" id="8546914">,</span>&nbsp;<span class="num" id="8546916">0xb5</span><span class="op" id="8546920">,</span>&nbsp;<span class="num" id="8546922">0xd5</span><span class="op" id="8546926">,</span>&nbsp;<span class="num" id="8546928">0xd0</span><span class="op" id="8546932">,</span>&nbsp;<span class="num" id="8546934">0x02</span><span class="op" id="8546938">,</span>&nbsp;<span class="num" id="8546940">0xc1</span><span class="op" id="8546944">,</span>&nbsp;<span class="num" id="8546946">0xbc</span><span class="op" id="8546950">,</span>&nbsp;<span class="num" id="8546952">0xe5</span><span class="op" id="8546956">,</span>&nbsp;<span class="num" id="8546958">0x0c</span><span class="op" id="8546962">,</span>&nbsp;<span class="num" id="8546964">0x2b</span><span class="op" id="8546968">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8546972">0x65</span><span class="op" id="8546976">,</span>&nbsp;<span class="num" id="8546978">0xef</span><span class="op" id="8546982">,</span>&nbsp;<span class="num" id="8546984">0x88</span><span class="op" id="8546988">,</span>&nbsp;<span class="num" id="8546990">0xa1</span><span class="op" id="8546994">,</span>&nbsp;<span class="num" id="8546996">0x88</span><span class="op" id="8547000">,</span>&nbsp;<span class="num" id="8547002">0xd8</span><span class="op" id="8547006">,</span>&nbsp;<span class="num" id="8547008">0x3b</span><span class="op" id="8547012">,</span>&nbsp;<span class="num" id="8547014">0xce</span><span class="op" id="8547018">,</span>&nbsp;<span class="num" id="8547020">0x7e</span><span class="op" id="8547024">,</span>&nbsp;<span class="num" id="8547026">0x61</span><span class="op" id="8547030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8547033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8547036">expected</span>&nbsp;<span class="op" id="8547045">:=</span>&nbsp;<span class="op" id="8547048">[</span><span class="op" id="8547049">]</span><span class="builtintype" id="8547050">byte</span><span class="op" id="8547054">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8547058">0x66</span><span class="op" id="8547062">,</span>&nbsp;<span class="num" id="8547064">0xe4</span><span class="op" id="8547068">,</span>&nbsp;<span class="num" id="8547070">0x67</span><span class="op" id="8547074">,</span>&nbsp;<span class="num" id="8547076">0x2e</span><span class="op" id="8547080">,</span>&nbsp;<span class="num" id="8547082">0x83</span><span class="op" id="8547086">,</span>&nbsp;<span class="num" id="8547088">0x6a</span><span class="op" id="8547092">,</span>&nbsp;<span class="num" id="8547094">0xd1</span><span class="op" id="8547098">,</span>&nbsp;<span class="num" id="8547100">0x21</span><span class="op" id="8547104">,</span>&nbsp;<span class="num" id="8547106">0xba</span><span class="op" id="8547110">,</span>&nbsp;<span class="num" id="8547112">0x24</span><span class="op" id="8547116">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8547120">0x4b</span><span class="op" id="8547124">,</span>&nbsp;<span class="num" id="8547126">0xed</span><span class="op" id="8547130">,</span>&nbsp;<span class="num" id="8547132">0x65</span><span class="op" id="8547136">,</span>&nbsp;<span class="num" id="8547138">0x76</span><span class="op" id="8547142">,</span>&nbsp;<span class="num" id="8547144">0xb8</span><span class="op" id="8547148">,</span>&nbsp;<span class="num" id="8547150">0x67</span><span class="op" id="8547154">,</span>&nbsp;<span class="num" id="8547156">0xd9</span><span class="op" id="8547160">,</span>&nbsp;<span class="num" id="8547162">0xa4</span><span class="op" id="8547166">,</span>&nbsp;<span class="num" id="8547168">0x47</span><span class="op" id="8547172">,</span>&nbsp;<span class="num" id="8547174">0xc2</span><span class="op" id="8547178">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8547182">0x8a</span><span class="op" id="8547186">,</span>&nbsp;<span class="num" id="8547188">0x6e</span><span class="op" id="8547192">,</span>&nbsp;<span class="num" id="8547194">0x66</span><span class="op" id="8547198">,</span>&nbsp;<span class="num" id="8547200">0xa5</span><span class="op" id="8547204">,</span>&nbsp;<span class="num" id="8547206">0xb8</span><span class="op" id="8547210">,</span>&nbsp;<span class="num" id="8547212">0x7d</span><span class="op" id="8547216">,</span>&nbsp;<span class="num" id="8547218">0xee</span><span class="op" id="8547222">,</span>&nbsp;<span class="num" id="8547224">0x7f</span><span class="op" id="8547228">,</span>&nbsp;<span class="num" id="8547230">0xbc</span><span class="op" id="8547234">,</span>&nbsp;<span class="num" id="8547236">0x7e</span><span class="op" id="8547240">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8547244">0x65</span><span class="op" id="8547248">,</span>&nbsp;<span class="num" id="8547250">0xaf</span><span class="op" id="8547254">,</span>&nbsp;<span class="num" id="8547256">0x50</span><span class="op" id="8547260">,</span>&nbsp;<span class="num" id="8547262">0x57</span><span class="op" id="8547266">,</span>&nbsp;<span class="num" id="8547268">0xf8</span><span class="op" id="8547272">,</span>&nbsp;<span class="num" id="8547274">0x6f</span><span class="op" id="8547278">,</span>&nbsp;<span class="num" id="8547280">0xae</span><span class="op" id="8547284">,</span>&nbsp;<span class="num" id="8547286">0x89</span><span class="op" id="8547290">,</span>&nbsp;<span class="num" id="8547292">0x84</span><span class="op" id="8547296">,</span>&nbsp;<span class="num" id="8547298">0xd9</span><span class="op" id="8547302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8547306">0xba</span><span class="op" id="8547310">,</span>&nbsp;<span class="num" id="8547312">0x7f</span><span class="op" id="8547316">,</span>&nbsp;<span class="num" id="8547318">0x96</span><span class="op" id="8547322">,</span>&nbsp;<span class="num" id="8547324">0x9a</span><span class="op" id="8547328">,</span>&nbsp;<span class="num" id="8547330">0xd6</span><span class="op" id="8547334">,</span>&nbsp;<span class="num" id="8547336">0xfe</span><span class="op" id="8547340">,</span>&nbsp;<span class="num" id="8547342">0x02</span><span class="op" id="8547346">,</span>&nbsp;<span class="num" id="8547348">0xa4</span><span class="op" id="8547352">,</span>&nbsp;<span class="num" id="8547354">0xd7</span><span class="op" id="8547358">,</span>&nbsp;<span class="num" id="8547360">0x5f</span><span class="op" id="8547364">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8547368">0x74</span><span class="op" id="8547372">,</span>&nbsp;<span class="num" id="8547374">0x45</span><span class="op" id="8547378">,</span>&nbsp;<span class="num" id="8547380">0xfe</span><span class="op" id="8547384">,</span>&nbsp;<span class="num" id="8547386">0xfd</span><span class="op" id="8547390">,</span>&nbsp;<span class="num" id="8547392">0xd8</span><span class="op" id="8547396">,</span>&nbsp;<span class="num" id="8547398">0x5b</span><span class="op" id="8547402">,</span>&nbsp;<span class="num" id="8547404">0x6d</span><span class="op" id="8547408">,</span>&nbsp;<span class="num" id="8547410">0x3a</span><span class="op" id="8547414">,</span>&nbsp;<span class="num" id="8547416">0x47</span><span class="op" id="8547420">,</span>&nbsp;<span class="num" id="8547422">0x7c</span><span class="op" id="8547426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8547430">0x28</span><span class="op" id="8547434">,</span>&nbsp;<span class="num" id="8547436">0xd2</span><span class="op" id="8547440">,</span>&nbsp;<span class="num" id="8547442">0x4b</span><span class="op" id="8547446">,</span>&nbsp;<span class="num" id="8547448">0xa1</span><span class="op" id="8547452">,</span>&nbsp;<span class="num" id="8547454">0xe3</span><span class="op" id="8547458">,</span>&nbsp;<span class="num" id="8547460">0x75</span><span class="op" id="8547464">,</span>&nbsp;<span class="num" id="8547466">0x6f</span><span class="op" id="8547470">,</span>&nbsp;<span class="num" id="8547472">0x79</span><span class="op" id="8547476">,</span>&nbsp;<span class="num" id="8547478">0x2d</span><span class="op" id="8547482">,</span>&nbsp;<span class="num" id="8547484">0xd1</span><span class="op" id="8547488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8547492">0xdc</span><span class="op" id="8547496">,</span>&nbsp;<span class="num" id="8547498">0xe8</span><span class="op" id="8547502">,</span>&nbsp;<span class="num" id="8547504">0xca</span><span class="op" id="8547508">,</span>&nbsp;<span class="num" id="8547510">0x94</span><span class="op" id="8547514">,</span>&nbsp;<span class="num" id="8547516">0x44</span><span class="op" id="8547520">,</span>&nbsp;<span class="num" id="8547522">0x0e</span><span class="op" id="8547526">,</span>&nbsp;<span class="num" id="8547528">0xcb</span><span class="op" id="8547532">,</span>&nbsp;<span class="num" id="8547534">0x52</span><span class="op" id="8547538">,</span>&nbsp;<span class="num" id="8547540">0x79</span><span class="op" id="8547544">,</span>&nbsp;<span class="num" id="8547546">0xec</span><span class="op" id="8547550">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8547554">0xd3</span><span class="op" id="8547558">,</span>&nbsp;<span class="num" id="8547560">0x18</span><span class="op" id="8547564">,</span>&nbsp;<span class="num" id="8547566">0x3a</span><span class="op" id="8547570">,</span>&nbsp;<span class="num" id="8547572">0x31</span><span class="op" id="8547576">,</span>&nbsp;<span class="num" id="8547578">0x1f</span><span class="op" id="8547582">,</span>&nbsp;<span class="num" id="8547584">0xc8</span><span class="op" id="8547588">,</span>&nbsp;<span class="num" id="8547590">0x96</span><span class="op" id="8547594">,</span>&nbsp;<span class="num" id="8547596">0xda</span><span class="op" id="8547600">,</span>&nbsp;<span class="num" id="8547602">0x1c</span><span class="op" id="8547606">,</span>&nbsp;<span class="num" id="8547608">0xb3</span><span class="op" id="8547612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8547616">0x93</span><span class="op" id="8547620">,</span>&nbsp;<span class="num" id="8547622">0x11</span><span class="op" id="8547626">,</span>&nbsp;<span class="num" id="8547628">0xaf</span><span class="op" id="8547632">,</span>&nbsp;<span class="num" id="8547634">0x37</span><span class="op" id="8547638">,</span>&nbsp;<span class="num" id="8547640">0xea</span><span class="op" id="8547644">,</span>&nbsp;<span class="num" id="8547646">0x4a</span><span class="op" id="8547650">,</span>&nbsp;<span class="num" id="8547652">0x75</span><span class="op" id="8547656">,</span>&nbsp;<span class="num" id="8547658">0xe2</span><span class="op" id="8547662">,</span>&nbsp;<span class="num" id="8547664">0x4b</span><span class="op" id="8547668">,</span>&nbsp;<span class="num" id="8547670">0xdb</span><span class="op" id="8547674">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8547678">0xfd</span><span class="op" id="8547682">,</span>&nbsp;<span class="num" id="8547684">0x5c</span><span class="op" id="8547688">,</span>&nbsp;<span class="num" id="8547690">0x1d</span><span class="op" id="8547694">,</span>&nbsp;<span class="num" id="8547696">0xa0</span><span class="op" id="8547700">,</span>&nbsp;<span class="num" id="8547702">0xde</span><span class="op" id="8547706">,</span>&nbsp;<span class="num" id="8547708">0x7c</span><span class="op" id="8547712">,</span>&nbsp;<span class="num" id="8547714">0xec</span><span class="op" id="8547718">,</span>&nbsp;<span class="num" id="8547720">0xdf</span><span class="op" id="8547724">,</span>&nbsp;<span class="num" id="8547726">0x1a</span><span class="op" id="8547730">,</span>&nbsp;<span class="num" id="8547732">0x89</span><span class="op" id="8547736">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8547740">0x6f</span><span class="op" id="8547744">,</span>&nbsp;<span class="num" id="8547746">0x9d</span><span class="op" id="8547750">,</span>&nbsp;<span class="num" id="8547752">0x8b</span><span class="op" id="8547756">,</span>&nbsp;<span class="num" id="8547758">0xc8</span><span class="op" id="8547762">,</span>&nbsp;<span class="num" id="8547764">0x16</span><span class="op" id="8547768">,</span>&nbsp;<span class="num" id="8547770">0xd9</span><span class="op" id="8547774">,</span>&nbsp;<span class="num" id="8547776">0x7c</span><span class="op" id="8547780">,</span>&nbsp;<span class="num" id="8547782">0xd7</span><span class="op" id="8547786">,</span>&nbsp;<span class="num" id="8547788">0xa2</span><span class="op" id="8547792">,</span>&nbsp;<span class="num" id="8547794">0xc4</span><span class="op" id="8547798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8547802">0x3b</span><span class="op" id="8547806">,</span>&nbsp;<span class="num" id="8547808">0xad</span><span class="op" id="8547812">,</span>&nbsp;<span class="num" id="8547814">0x54</span><span class="op" id="8547818">,</span>&nbsp;<span class="num" id="8547820">0x6f</span><span class="op" id="8547824">,</span>&nbsp;<span class="num" id="8547826">0xbe</span><span class="op" id="8547830">,</span>&nbsp;<span class="num" id="8547832">0x8c</span><span class="op" id="8547836">,</span>&nbsp;<span class="num" id="8547838">0xfe</span><span class="op" id="8547842">,</span>&nbsp;<span class="num" id="8547844">0xbc</span><span class="op" id="8547848">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8547851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8547855">hash</span>&nbsp;<span class="op" id="8547860">:=</span>&nbsp;<span class="ident" id="8547863">sha1</span><span class="op" id="8547867">.</span><span class="ident" id="8547868">New</span><span class="op" id="8547871">(</span><span class="op" id="8547872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8547875">hash</span><span class="op" id="8547879">.</span><span class="ident" id="8547880">Write</span><span class="op" id="8547885">(</span><span class="ident" id="8547886">msg</span><span class="op" id="8547889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8547892">hashed</span>&nbsp;<span class="op" id="8547899">:=</span>&nbsp;<span class="ident" id="8547902">hash</span><span class="op" id="8547906">.</span><span class="ident" id="8547907">Sum</span><span class="op" id="8547910">(</span><span class="ident" id="8547911">nil</span><span class="op" id="8547914">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8547918">encoded</span><span class="op" id="8547925">,</span>&nbsp;<span class="ident" id="8547927">err</span>&nbsp;<span class="op" id="8547931">:=</span>&nbsp;<span class="ident" id="8547934">emsaPSSEncode</span><span class="op" id="8547947">(</span><span class="ident" id="8547948">hashed</span><span class="op" id="8547954">,</span>&nbsp;<span class="num" id="8547956">1023</span><span class="op" id="8547960">,</span>&nbsp;<span class="ident" id="8547962">salt</span><span class="op" id="8547966">,</span>&nbsp;<span class="ident" id="8547968">sha1</span><span class="op" id="8547972">.</span><span class="ident" id="8547973">New</span><span class="op" id="8547976">(</span><span class="op" id="8547977">)</span><span class="op" id="8547978">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8547981">if</span>&nbsp;<span class="ident" id="8547984">err</span>&nbsp;<span class="op" id="8547988">!=</span>&nbsp;<span class="ident" id="8547991">nil</span>&nbsp;<span class="op" id="8547995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8547999">t</span><span class="op" id="8548000">.</span><span class="ident" id="8548001">Errorf</span><span class="op" id="8548007">(</span><span class="string" id="8548008">&#34;Error&nbsp;from&nbsp;emsaPSSEncode:&nbsp;%s\n&#34;</span><span class="op" id="8548040">,</span>&nbsp;<span class="ident" id="8548042">err</span><span class="op" id="8548045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8548048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8548051">if</span>&nbsp;<span class="op" id="8548054">!</span><span class="ident" id="8548055">bytes</span><span class="op" id="8548060">.</span><span class="ident" id="8548061">Equal</span><span class="op" id="8548066">(</span><span class="ident" id="8548067">encoded</span><span class="op" id="8548074">,</span>&nbsp;<span class="ident" id="8548076">expected</span><span class="op" id="8548084">)</span>&nbsp;<span class="op" id="8548086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8548090">t</span><span class="op" id="8548091">.</span><span class="ident" id="8548092">Errorf</span><span class="op" id="8548098">(</span><span class="string" id="8548099">&#34;Bad&nbsp;encoding.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="8548130">,</span>&nbsp;<span class="ident" id="8548132">encoded</span><span class="op" id="8548139">,</span>&nbsp;<span class="ident" id="8548141">expected</span><span class="op" id="8548149">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8548152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8548156">if</span>&nbsp;<span class="ident" id="8548159">err</span>&nbsp;<span class="op" id="8548163">=</span>&nbsp;<span class="ident" id="8548165">emsaPSSVerify</span><span class="op" id="8548178">(</span><span class="ident" id="8548179">hashed</span><span class="op" id="8548185">,</span>&nbsp;<span class="ident" id="8548187">encoded</span><span class="op" id="8548194">,</span>&nbsp;<span class="num" id="8548196">1023</span><span class="op" id="8548200">,</span>&nbsp;<span class="builtinfunc" id="8548202">len</span><span class="op" id="8548205">(</span><span class="ident" id="8548206">salt</span><span class="op" id="8548210">)</span><span class="op" id="8548211">,</span>&nbsp;<span class="ident" id="8548213">sha1</span><span class="op" id="8548217">.</span><span class="ident" id="8548218">New</span><span class="op" id="8548221">(</span><span class="op" id="8548222">)</span><span class="op" id="8548223">)</span><span class="op" id="8548224">;</span>&nbsp;<span class="ident" id="8548226">err</span>&nbsp;<span class="op" id="8548230">!=</span>&nbsp;<span class="ident" id="8548233">nil</span>&nbsp;<span class="op" id="8548237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8548241">t</span><span class="op" id="8548242">.</span><span class="ident" id="8548243">Errorf</span><span class="op" id="8548249">(</span><span class="string" id="8548250">&#34;Bad&nbsp;verification:&nbsp;%s&#34;</span><span class="op" id="8548272">,</span>&nbsp;<span class="ident" id="8548274">err</span><span class="op" id="8548277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8548280">}</span><br>
<span class="lineno">75</span><span class="op" id="8548282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8548285">//&nbsp;TestPSSGolden&nbsp;tests&nbsp;all&nbsp;the&nbsp;test&nbsp;vectors&nbsp;in&nbsp;pss-vect.txt&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="8548350">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1-vec.zip</span><br>
<span class="lineno"></span><span class="keyword" id="8548414">func</span>&nbsp;<span class="ident" id="8548419">TestPSSGolden</span><span class="op" id="8548432">(</span><span class="ident" id="8548433">t</span>&nbsp;<span class="op" id="8548435">*</span><span class="ident" id="8548436">testing</span><span class="op" id="8548443">.</span><span class="ident" id="8548444">T</span><span class="op" id="8548445">)</span>&nbsp;<span class="op" id="8548447">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8548450">inFile</span><span class="op" id="8548456">,</span>&nbsp;<span class="ident" id="8548458">err</span>&nbsp;<span class="op" id="8548462">:=</span>&nbsp;<span class="ident" id="8548465">os</span><span class="op" id="8548467">.</span><span class="ident" id="8548468">Open</span><span class="op" id="8548472">(</span><span class="string" id="8548473">&#34;testdata/pss-vect.txt.bz2&#34;</span><span class="op" id="8548500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8548503">if</span>&nbsp;<span class="ident" id="8548506">err</span>&nbsp;<span class="op" id="8548510">!=</span>&nbsp;<span class="ident" id="8548513">nil</span>&nbsp;<span class="op" id="8548517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8548521">t</span><span class="op" id="8548522">.</span><span class="ident" id="8548523">Fatalf</span><span class="op" id="8548529">(</span><span class="string" id="8548530">&#34;Failed&nbsp;to&nbsp;open&nbsp;input&nbsp;file:&nbsp;%s&#34;</span><span class="op" id="8548561">,</span>&nbsp;<span class="ident" id="8548563">err</span><span class="op" id="8548566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8548569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8548572">defer</span>&nbsp;<span class="ident" id="8548578">inFile</span><span class="op" id="8548584">.</span><span class="ident" id="8548585">Close</span><span class="op" id="8548590">(</span><span class="op" id="8548591">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8548595">//&nbsp;The&nbsp;pss-vect.txt&nbsp;file&nbsp;contains&nbsp;RSA&nbsp;keys&nbsp;and&nbsp;then&nbsp;a&nbsp;series&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8548660">//&nbsp;signatures.&nbsp;A&nbsp;goroutine&nbsp;is&nbsp;used&nbsp;to&nbsp;preprocess&nbsp;the&nbsp;input&nbsp;by&nbsp;merging</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8548731">//&nbsp;lines,&nbsp;removing&nbsp;spaces&nbsp;in&nbsp;hex&nbsp;values&nbsp;and&nbsp;identifying&nbsp;the&nbsp;start&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8548801">//&nbsp;new&nbsp;keys&nbsp;and&nbsp;signature&nbsp;blocks.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8548836">const</span>&nbsp;<span class="ident" id="8548842">newKeyMarker</span>&nbsp;<span class="op" id="8548855">=</span>&nbsp;<span class="string" id="8548857">&#34;START&nbsp;NEW&nbsp;KEY&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8548874">const</span>&nbsp;<span class="ident" id="8548880">newSignatureMarker</span>&nbsp;<span class="op" id="8548899">=</span>&nbsp;<span class="string" id="8548901">&#34;START&nbsp;NEW&nbsp;SIGNATURE&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8548925">values</span>&nbsp;<span class="op" id="8548932">:=</span>&nbsp;<span class="builtinfunc" id="8548935">make</span><span class="op" id="8548939">(</span><span class="keyword" id="8548940">chan</span>&nbsp;<span class="builtintype" id="8548945">string</span><span class="op" id="8548951">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8548955">go</span>&nbsp;<span class="keyword" id="8548958">func</span><span class="op" id="8548962">(</span><span class="op" id="8548963">)</span>&nbsp;<span class="op" id="8548965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8548969">defer</span>&nbsp;<span class="builtinfunc" id="8548975">close</span><span class="op" id="8548980">(</span><span class="ident" id="8548981">values</span><span class="op" id="8548987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8548991">scanner</span>&nbsp;<span class="op" id="8548999">:=</span>&nbsp;<span class="ident" id="8549002">bufio</span><span class="op" id="8549007">.</span><span class="ident" id="8549008">NewScanner</span><span class="op" id="8549018">(</span><span class="ident" id="8549019">bzip2</span><span class="op" id="8549024">.</span><span class="ident" id="8549025">NewReader</span><span class="op" id="8549034">(</span><span class="ident" id="8549035">inFile</span><span class="op" id="8549041">)</span><span class="op" id="8549042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8549046">var</span>&nbsp;<span class="ident" id="8549050">partialValue</span>&nbsp;<span class="builtintype" id="8549063">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549072">lastWasValue</span>&nbsp;<span class="op" id="8549085">:=</span>&nbsp;<span class="builtintype" id="8549088">true</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8549096">for</span>&nbsp;<span class="ident" id="8549100">scanner</span><span class="op" id="8549107">.</span><span class="ident" id="8549108">Scan</span><span class="op" id="8549112">(</span><span class="op" id="8549113">)</span>&nbsp;<span class="op" id="8549115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549120">line</span>&nbsp;<span class="op" id="8549125">:=</span>&nbsp;<span class="ident" id="8549128">scanner</span><span class="op" id="8549135">.</span><span class="ident" id="8549136">Text</span><span class="op" id="8549140">(</span><span class="op" id="8549141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8549146">switch</span>&nbsp;<span class="op" id="8549153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8549158">case</span>&nbsp;<span class="builtinfunc" id="8549163">len</span><span class="op" id="8549166">(</span><span class="ident" id="8549167">line</span><span class="op" id="8549171">)</span>&nbsp;<span class="op" id="8549173">==</span>&nbsp;<span class="num" id="8549176">0</span><span class="op" id="8549177">:</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8549183">if</span>&nbsp;<span class="builtinfunc" id="8549186">len</span><span class="op" id="8549189">(</span><span class="ident" id="8549190">partialValue</span><span class="op" id="8549202">)</span>&nbsp;<span class="op" id="8549204">&gt;</span>&nbsp;<span class="num" id="8549206">0</span>&nbsp;<span class="op" id="8549208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549215">values</span>&nbsp;<span class="op" id="8549222">&lt;-</span>&nbsp;<span class="ident" id="8549225">strings</span><span class="op" id="8549232">.</span><span class="ident" id="8549233">Replace</span><span class="op" id="8549240">(</span><span class="ident" id="8549241">partialValue</span><span class="op" id="8549253">,</span>&nbsp;<span class="string" id="8549255">&#34;&nbsp;&#34;</span><span class="op" id="8549258">,</span>&nbsp;<span class="string" id="8549260">&#34;&#34;</span><span class="op" id="8549262">,</span>&nbsp;<span class="op" id="8549264">-</span><span class="num" id="8549265">1</span><span class="op" id="8549266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549273">partialValue</span>&nbsp;<span class="op" id="8549286">=</span>&nbsp;<span class="string" id="8549288">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549296">lastWasValue</span>&nbsp;<span class="op" id="8549309">=</span>&nbsp;<span class="builtintype" id="8549311">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549320">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8549326">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8549338">case</span>&nbsp;<span class="ident" id="8549343">strings</span><span class="op" id="8549350">.</span><span class="ident" id="8549351">HasPrefix</span><span class="op" id="8549360">(</span><span class="ident" id="8549361">line</span><span class="op" id="8549365">,</span>&nbsp;<span class="string" id="8549367">&#34;#&nbsp;======&#34;</span><span class="op" id="8549377">)</span>&nbsp;<span class="op" id="8549379">&amp;&amp;</span>&nbsp;<span class="ident" id="8549382">lastWasValue</span><span class="op" id="8549394">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549400">values</span>&nbsp;<span class="op" id="8549407">&lt;-</span>&nbsp;<span class="ident" id="8549410">newKeyMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549427">lastWasValue</span>&nbsp;<span class="op" id="8549440">=</span>&nbsp;<span class="builtintype" id="8549442">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8549451">case</span>&nbsp;<span class="ident" id="8549456">strings</span><span class="op" id="8549463">.</span><span class="ident" id="8549464">HasPrefix</span><span class="op" id="8549473">(</span><span class="ident" id="8549474">line</span><span class="op" id="8549478">,</span>&nbsp;<span class="string" id="8549480">&#34;#&nbsp;------&#34;</span><span class="op" id="8549490">)</span>&nbsp;<span class="op" id="8549492">&amp;&amp;</span>&nbsp;<span class="ident" id="8549495">lastWasValue</span><span class="op" id="8549507">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549513">values</span>&nbsp;<span class="op" id="8549520">&lt;-</span>&nbsp;<span class="ident" id="8549523">newSignatureMarker</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549546">lastWasValue</span>&nbsp;<span class="op" id="8549559">=</span>&nbsp;<span class="builtintype" id="8549561">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8549570">case</span>&nbsp;<span class="ident" id="8549575">strings</span><span class="op" id="8549582">.</span><span class="ident" id="8549583">HasPrefix</span><span class="op" id="8549592">(</span><span class="ident" id="8549593">line</span><span class="op" id="8549597">,</span>&nbsp;<span class="string" id="8549599">&#34;#&#34;</span><span class="op" id="8549602">)</span><span class="op" id="8549603">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8549609">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8549621">default</span><span class="op" id="8549628">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549634">partialValue</span>&nbsp;<span class="op" id="8549647">+=</span>&nbsp;<span class="ident" id="8549650">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8549666">if</span>&nbsp;<span class="ident" id="8549669">err</span>&nbsp;<span class="op" id="8549673">:=</span>&nbsp;<span class="ident" id="8549676">scanner</span><span class="op" id="8549683">.</span><span class="ident" id="8549684">Err</span><span class="op" id="8549687">(</span><span class="op" id="8549688">)</span><span class="op" id="8549689">;</span>&nbsp;<span class="ident" id="8549691">err</span>&nbsp;<span class="op" id="8549695">!=</span>&nbsp;<span class="ident" id="8549698">nil</span>&nbsp;<span class="op" id="8549702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8549707">panic</span><span class="op" id="8549712">(</span><span class="ident" id="8549713">err</span><span class="op" id="8549716">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549723">}</span><span class="op" id="8549724">(</span><span class="op" id="8549725">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8549729">var</span>&nbsp;<span class="ident" id="8549733">key</span>&nbsp;<span class="op" id="8549737">*</span><span class="ident" id="8549738">PublicKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8549749">var</span>&nbsp;<span class="ident" id="8549753">hashed</span>&nbsp;<span class="op" id="8549760">[</span><span class="op" id="8549761">]</span><span class="builtintype" id="8549762">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549768">hash</span>&nbsp;<span class="op" id="8549773">:=</span>&nbsp;<span class="ident" id="8549776">crypto</span><span class="op" id="8549782">.</span><span class="ident" id="8549783">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549789">h</span>&nbsp;<span class="op" id="8549791">:=</span>&nbsp;<span class="ident" id="8549794">hash</span><span class="op" id="8549798">.</span><span class="ident" id="8549799">New</span><span class="op" id="8549802">(</span><span class="op" id="8549803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549806">opts</span>&nbsp;<span class="op" id="8549811">:=</span>&nbsp;<span class="op" id="8549814">&amp;</span><span class="ident" id="8549815">PSSOptions</span><span class="op" id="8549825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549829">SaltLength</span><span class="op" id="8549839">:</span>&nbsp;<span class="ident" id="8549841">PSSSaltLengthEqualsHash</span><span class="op" id="8549864">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8549867">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8549871">for</span>&nbsp;<span class="ident" id="8549875">marker</span>&nbsp;<span class="op" id="8549882">:=</span>&nbsp;<span class="keyword" id="8549885">range</span>&nbsp;<span class="ident" id="8549891">values</span>&nbsp;<span class="op" id="8549898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8549902">switch</span>&nbsp;<span class="ident" id="8549909">marker</span>&nbsp;<span class="op" id="8549916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8549920">case</span>&nbsp;<span class="ident" id="8549925">newKeyMarker</span><span class="op" id="8549937">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549942">key</span>&nbsp;<span class="op" id="8549946">=</span>&nbsp;<span class="builtinfunc" id="8549948">new</span><span class="op" id="8549951">(</span><span class="ident" id="8549952">PublicKey</span><span class="op" id="8549961">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8549966">nHex</span><span class="op" id="8549970">,</span>&nbsp;<span class="ident" id="8549972">ok</span>&nbsp;<span class="op" id="8549975">:=</span>&nbsp;<span class="op" id="8549978">&lt;-</span><span class="ident" id="8549980">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8549990">if</span>&nbsp;<span class="op" id="8549993">!</span><span class="ident" id="8549994">ok</span>&nbsp;<span class="op" id="8549997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8550003">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8550015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8550020">key</span><span class="op" id="8550023">.</span><span class="ident" id="8550024">N</span>&nbsp;<span class="op" id="8550026">=</span>&nbsp;<span class="ident" id="8550028">bigFromHex</span><span class="op" id="8550038">(</span><span class="ident" id="8550039">nHex</span><span class="op" id="8550043">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8550048">key</span><span class="op" id="8550051">.</span><span class="ident" id="8550052">E</span>&nbsp;<span class="op" id="8550054">=</span>&nbsp;<span class="ident" id="8550056">intFromHex</span><span class="op" id="8550066">(</span><span class="op" id="8550067">&lt;-</span><span class="ident" id="8550069">values</span><span class="op" id="8550075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8550080">//&nbsp;We&nbsp;don&#39;t&nbsp;care&nbsp;for&nbsp;d,&nbsp;p,&nbsp;q,&nbsp;dP,&nbsp;dQ&nbsp;or&nbsp;qInv.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8550129">for</span>&nbsp;<span class="ident" id="8550133">i</span>&nbsp;<span class="op" id="8550135">:=</span>&nbsp;<span class="num" id="8550138">0</span><span class="op" id="8550139">;</span>&nbsp;<span class="ident" id="8550141">i</span>&nbsp;<span class="op" id="8550143">&lt;</span>&nbsp;<span class="num" id="8550145">6</span><span class="op" id="8550146">;</span>&nbsp;<span class="ident" id="8550148">i</span><span class="op" id="8550149">++</span>&nbsp;<span class="op" id="8550152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8550158">&lt;-</span><span class="ident" id="8550160">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8550170">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8550174">case</span>&nbsp;<span class="ident" id="8550179">newSignatureMarker</span><span class="op" id="8550197">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8550202">msg</span>&nbsp;<span class="op" id="8550206">:=</span>&nbsp;<span class="ident" id="8550209">fromHex</span><span class="op" id="8550216">(</span><span class="op" id="8550217">&lt;-</span><span class="ident" id="8550219">values</span><span class="op" id="8550225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8550230">&lt;-</span><span class="ident" id="8550232">values</span>&nbsp;<span class="comment" id="8550239">//&nbsp;skip&nbsp;salt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8550255">sig</span>&nbsp;<span class="op" id="8550259">:=</span>&nbsp;<span class="ident" id="8550262">fromHex</span><span class="op" id="8550269">(</span><span class="op" id="8550270">&lt;-</span><span class="ident" id="8550272">values</span><span class="op" id="8550278">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8550284">h</span><span class="op" id="8550285">.</span><span class="ident" id="8550286">Reset</span><span class="op" id="8550291">(</span><span class="op" id="8550292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8550297">h</span><span class="op" id="8550298">.</span><span class="ident" id="8550299">Write</span><span class="op" id="8550304">(</span><span class="ident" id="8550305">msg</span><span class="op" id="8550308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8550313">hashed</span>&nbsp;<span class="op" id="8550320">=</span>&nbsp;<span class="ident" id="8550322">h</span><span class="op" id="8550323">.</span><span class="ident" id="8550324">Sum</span><span class="op" id="8550327">(</span><span class="ident" id="8550328">hashed</span><span class="op" id="8550334">[</span><span class="op" id="8550335">:</span><span class="num" id="8550336">0</span><span class="op" id="8550337">]</span><span class="op" id="8550338">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8550344">if</span>&nbsp;<span class="ident" id="8550347">err</span>&nbsp;<span class="op" id="8550351">:=</span>&nbsp;<span class="ident" id="8550354">VerifyPSS</span><span class="op" id="8550363">(</span><span class="ident" id="8550364">key</span><span class="op" id="8550367">,</span>&nbsp;<span class="ident" id="8550369">hash</span><span class="op" id="8550373">,</span>&nbsp;<span class="ident" id="8550375">hashed</span><span class="op" id="8550381">,</span>&nbsp;<span class="ident" id="8550383">sig</span><span class="op" id="8550386">,</span>&nbsp;<span class="ident" id="8550388">opts</span><span class="op" id="8550392">)</span><span class="op" id="8550393">;</span>&nbsp;<span class="ident" id="8550395">err</span>&nbsp;<span class="op" id="8550399">!=</span>&nbsp;<span class="ident" id="8550402">nil</span>&nbsp;<span class="op" id="8550406">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8550412">t</span><span class="op" id="8550413">.</span><span class="ident" id="8550414">Error</span><span class="op" id="8550419">(</span><span class="ident" id="8550420">err</span><span class="op" id="8550423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8550428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8550432">default</span><span class="op" id="8550439">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8550444">t</span><span class="op" id="8550445">.</span><span class="ident" id="8550446">Fatalf</span><span class="op" id="8550452">(</span><span class="string" id="8550453">&#34;unknown&nbsp;marker:&nbsp;&#34;</span>&nbsp;<span class="op" id="8550472">+</span>&nbsp;<span class="ident" id="8550474">marker</span><span class="op" id="8550480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8550484">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8550487">}</span><br>
<span class="lineno"></span><span class="op" id="8550489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8550492">//&nbsp;TestPSSOpenSSL&nbsp;ensures&nbsp;that&nbsp;we&nbsp;can&nbsp;verify&nbsp;a&nbsp;PSS&nbsp;signature&nbsp;from&nbsp;OpenSSL&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="8550571">//&nbsp;the&nbsp;default&nbsp;options.&nbsp;OpenSSL&nbsp;sets&nbsp;the&nbsp;salt&nbsp;length&nbsp;to&nbsp;be&nbsp;maximal.</span><br>
<span class="lineno">170</span><span class="keyword" id="8550639">func</span>&nbsp;<span class="ident" id="8550644">TestPSSOpenSSL</span><span class="op" id="8550658">(</span><span class="ident" id="8550659">t</span>&nbsp;<span class="op" id="8550661">*</span><span class="ident" id="8550662">testing</span><span class="op" id="8550669">.</span><span class="ident" id="8550670">T</span><span class="op" id="8550671">)</span>&nbsp;<span class="op" id="8550673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8550676">hash</span>&nbsp;<span class="op" id="8550681">:=</span>&nbsp;<span class="ident" id="8550684">crypto</span><span class="op" id="8550690">.</span><span class="ident" id="8550691">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8550699">h</span>&nbsp;<span class="op" id="8550701">:=</span>&nbsp;<span class="ident" id="8550704">hash</span><span class="op" id="8550708">.</span><span class="ident" id="8550709">New</span><span class="op" id="8550712">(</span><span class="op" id="8550713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8550716">h</span><span class="op" id="8550717">.</span><span class="ident" id="8550718">Write</span><span class="op" id="8550723">(</span><span class="op" id="8550724">[</span><span class="op" id="8550725">]</span><span class="builtintype" id="8550726">byte</span><span class="op" id="8550730">(</span><span class="string" id="8550731">&#34;testing&#34;</span><span class="op" id="8550740">)</span><span class="op" id="8550741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8550744">hashed</span>&nbsp;<span class="op" id="8550751">:=</span>&nbsp;<span class="ident" id="8550754">h</span><span class="op" id="8550755">.</span><span class="ident" id="8550756">Sum</span><span class="op" id="8550759">(</span><span class="ident" id="8550760">nil</span><span class="op" id="8550763">)</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8550767">//&nbsp;Generated&nbsp;with&nbsp;`echo&nbsp;-n&nbsp;testing&nbsp;|&nbsp;openssl&nbsp;dgst&nbsp;-sign&nbsp;key.pem&nbsp;-sigopt&nbsp;rsa_padding_mode:pss&nbsp;-sha256&nbsp;&gt;&nbsp;sig`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8550876">sig</span>&nbsp;<span class="op" id="8550880">:=</span>&nbsp;<span class="op" id="8550883">[</span><span class="op" id="8550884">]</span><span class="builtintype" id="8550885">byte</span><span class="op" id="8550889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8550893">0x95</span><span class="op" id="8550897">,</span>&nbsp;<span class="num" id="8550899">0x59</span><span class="op" id="8550903">,</span>&nbsp;<span class="num" id="8550905">0x6f</span><span class="op" id="8550909">,</span>&nbsp;<span class="num" id="8550911">0xd3</span><span class="op" id="8550915">,</span>&nbsp;<span class="num" id="8550917">0x10</span><span class="op" id="8550921">,</span>&nbsp;<span class="num" id="8550923">0xa2</span><span class="op" id="8550927">,</span>&nbsp;<span class="num" id="8550929">0xe7</span><span class="op" id="8550933">,</span>&nbsp;<span class="num" id="8550935">0xa2</span><span class="op" id="8550939">,</span>&nbsp;<span class="num" id="8550941">0x92</span><span class="op" id="8550945">,</span>&nbsp;<span class="num" id="8550947">0x9d</span><span class="op" id="8550951">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8550955">0x4a</span><span class="op" id="8550959">,</span>&nbsp;<span class="num" id="8550961">0x07</span><span class="op" id="8550965">,</span>&nbsp;<span class="num" id="8550967">0x2e</span><span class="op" id="8550971">,</span>&nbsp;<span class="num" id="8550973">0x2b</span><span class="op" id="8550977">,</span>&nbsp;<span class="num" id="8550979">0x27</span><span class="op" id="8550983">,</span>&nbsp;<span class="num" id="8550985">0xcc</span><span class="op" id="8550989">,</span>&nbsp;<span class="num" id="8550991">0x06</span><span class="op" id="8550995">,</span>&nbsp;<span class="num" id="8550997">0xc2</span><span class="op" id="8551001">,</span>&nbsp;<span class="num" id="8551003">0x87</span><span class="op" id="8551007">,</span>&nbsp;<span class="num" id="8551009">0x2c</span><span class="op" id="8551013">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8551017">0x52</span><span class="op" id="8551021">,</span>&nbsp;<span class="num" id="8551023">0xf0</span><span class="op" id="8551027">,</span>&nbsp;<span class="num" id="8551029">0x4a</span><span class="op" id="8551033">,</span>&nbsp;<span class="num" id="8551035">0xcc</span><span class="op" id="8551039">,</span>&nbsp;<span class="num" id="8551041">0x05</span><span class="op" id="8551045">,</span>&nbsp;<span class="num" id="8551047">0x94</span><span class="op" id="8551051">,</span>&nbsp;<span class="num" id="8551053">0xf2</span><span class="op" id="8551057">,</span>&nbsp;<span class="num" id="8551059">0xc3</span><span class="op" id="8551063">,</span>&nbsp;<span class="num" id="8551065">0x2e</span><span class="op" id="8551069">,</span>&nbsp;<span class="num" id="8551071">0x20</span><span class="op" id="8551075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8551079">0xd7</span><span class="op" id="8551083">,</span>&nbsp;<span class="num" id="8551085">0x3e</span><span class="op" id="8551089">,</span>&nbsp;<span class="num" id="8551091">0x66</span><span class="op" id="8551095">,</span>&nbsp;<span class="num" id="8551097">0x62</span><span class="op" id="8551101">,</span>&nbsp;<span class="num" id="8551103">0xb5</span><span class="op" id="8551107">,</span>&nbsp;<span class="num" id="8551109">0x95</span><span class="op" id="8551113">,</span>&nbsp;<span class="num" id="8551115">0x2b</span><span class="op" id="8551119">,</span>&nbsp;<span class="num" id="8551121">0xa3</span><span class="op" id="8551125">,</span>&nbsp;<span class="num" id="8551127">0x93</span><span class="op" id="8551131">,</span>&nbsp;<span class="num" id="8551133">0x9a</span><span class="op" id="8551137">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8551141">0x66</span><span class="op" id="8551145">,</span>&nbsp;<span class="num" id="8551147">0x64</span><span class="op" id="8551151">,</span>&nbsp;<span class="num" id="8551153">0x25</span><span class="op" id="8551157">,</span>&nbsp;<span class="num" id="8551159">0xe0</span><span class="op" id="8551163">,</span>&nbsp;<span class="num" id="8551165">0x74</span><span class="op" id="8551169">,</span>&nbsp;<span class="num" id="8551171">0x66</span><span class="op" id="8551175">,</span>&nbsp;<span class="num" id="8551177">0x8c</span><span class="op" id="8551181">,</span>&nbsp;<span class="num" id="8551183">0x3e</span><span class="op" id="8551187">,</span>&nbsp;<span class="num" id="8551189">0x92</span><span class="op" id="8551193">,</span>&nbsp;<span class="num" id="8551195">0xeb</span><span class="op" id="8551199">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8551203">0xc6</span><span class="op" id="8551207">,</span>&nbsp;<span class="num" id="8551209">0xe6</span><span class="op" id="8551213">,</span>&nbsp;<span class="num" id="8551215">0xc0</span><span class="op" id="8551219">,</span>&nbsp;<span class="num" id="8551221">0x44</span><span class="op" id="8551225">,</span>&nbsp;<span class="num" id="8551227">0xf3</span><span class="op" id="8551231">,</span>&nbsp;<span class="num" id="8551233">0xb4</span><span class="op" id="8551237">,</span>&nbsp;<span class="num" id="8551239">0xb4</span><span class="op" id="8551243">,</span>&nbsp;<span class="num" id="8551245">0x2e</span><span class="op" id="8551249">,</span>&nbsp;<span class="num" id="8551251">0x8c</span><span class="op" id="8551255">,</span>&nbsp;<span class="num" id="8551257">0x66</span><span class="op" id="8551261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8551265">0x0a</span><span class="op" id="8551269">,</span>&nbsp;<span class="num" id="8551271">0x37</span><span class="op" id="8551275">,</span>&nbsp;<span class="num" id="8551277">0x9c</span><span class="op" id="8551281">,</span>&nbsp;<span class="num" id="8551283">0x69</span><span class="op" id="8551287">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8551290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8551294">if</span>&nbsp;<span class="ident" id="8551297">err</span>&nbsp;<span class="op" id="8551301">:=</span>&nbsp;<span class="ident" id="8551304">VerifyPSS</span><span class="op" id="8551313">(</span><span class="op" id="8551314">&amp;</span><span class="ident" id="8551315">rsaPrivateKey</span><span class="op" id="8551328">.</span><span class="ident" id="8551329">PublicKey</span><span class="op" id="8551338">,</span>&nbsp;<span class="ident" id="8551340">hash</span><span class="op" id="8551344">,</span>&nbsp;<span class="ident" id="8551346">hashed</span><span class="op" id="8551352">,</span>&nbsp;<span class="ident" id="8551354">sig</span><span class="op" id="8551357">,</span>&nbsp;<span class="ident" id="8551359">nil</span><span class="op" id="8551362">)</span><span class="op" id="8551363">;</span>&nbsp;<span class="ident" id="8551365">err</span>&nbsp;<span class="op" id="8551369">!=</span>&nbsp;<span class="ident" id="8551372">nil</span>&nbsp;<span class="op" id="8551376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551380">t</span><span class="op" id="8551381">.</span><span class="ident" id="8551382">Error</span><span class="op" id="8551387">(</span><span class="ident" id="8551388">err</span><span class="op" id="8551391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8551394">}</span><br>
<span class="lineno">190</span><span class="op" id="8551396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8551399">func</span>&nbsp;<span class="ident" id="8551404">TestPSSSigning</span><span class="op" id="8551418">(</span><span class="ident" id="8551419">t</span>&nbsp;<span class="op" id="8551421">*</span><span class="ident" id="8551422">testing</span><span class="op" id="8551429">.</span><span class="ident" id="8551430">T</span><span class="op" id="8551431">)</span>&nbsp;<span class="op" id="8551433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8551436">var</span>&nbsp;<span class="ident" id="8551440">saltLengthCombinations</span>&nbsp;<span class="op" id="8551463">=</span>&nbsp;<span class="op" id="8551465">[</span><span class="op" id="8551466">]</span><span class="keyword" id="8551467">struct</span>&nbsp;<span class="op" id="8551474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551478">signSaltLength</span><span class="op" id="8551492">,</span>&nbsp;<span class="ident" id="8551494">verifySaltLength</span>&nbsp;<span class="builtintype" id="8551511">int</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551517">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8551550">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8551556">}</span><span class="op" id="8551557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8551561">{</span><span class="ident" id="8551562">PSSSaltLengthAuto</span><span class="op" id="8551579">,</span>&nbsp;<span class="ident" id="8551581">PSSSaltLengthAuto</span><span class="op" id="8551598">,</span>&nbsp;<span class="builtintype" id="8551600">true</span><span class="op" id="8551604">}</span><span class="op" id="8551605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8551609">{</span><span class="ident" id="8551610">PSSSaltLengthEqualsHash</span><span class="op" id="8551633">,</span>&nbsp;<span class="ident" id="8551635">PSSSaltLengthAuto</span><span class="op" id="8551652">,</span>&nbsp;<span class="builtintype" id="8551654">true</span><span class="op" id="8551658">}</span><span class="op" id="8551659">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8551663">{</span><span class="ident" id="8551664">PSSSaltLengthEqualsHash</span><span class="op" id="8551687">,</span>&nbsp;<span class="ident" id="8551689">PSSSaltLengthEqualsHash</span><span class="op" id="8551712">,</span>&nbsp;<span class="builtintype" id="8551714">true</span><span class="op" id="8551718">}</span><span class="op" id="8551719">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8551723">{</span><span class="ident" id="8551724">PSSSaltLengthEqualsHash</span><span class="op" id="8551747">,</span>&nbsp;<span class="num" id="8551749">8</span><span class="op" id="8551750">,</span>&nbsp;<span class="builtintype" id="8551752">false</span><span class="op" id="8551757">}</span><span class="op" id="8551758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8551762">{</span><span class="ident" id="8551763">PSSSaltLengthAuto</span><span class="op" id="8551780">,</span>&nbsp;<span class="ident" id="8551782">PSSSaltLengthEqualsHash</span><span class="op" id="8551805">,</span>&nbsp;<span class="builtintype" id="8551807">false</span><span class="op" id="8551812">}</span><span class="op" id="8551813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8551817">{</span><span class="num" id="8551818">8</span><span class="op" id="8551819">,</span>&nbsp;<span class="num" id="8551821">8</span><span class="op" id="8551822">,</span>&nbsp;<span class="builtintype" id="8551824">true</span><span class="op" id="8551828">}</span><span class="op" id="8551829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8551832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551836">hash</span>&nbsp;<span class="op" id="8551841">:=</span>&nbsp;<span class="ident" id="8551844">crypto</span><span class="op" id="8551850">.</span><span class="ident" id="8551851">MD5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551856">h</span>&nbsp;<span class="op" id="8551858">:=</span>&nbsp;<span class="ident" id="8551861">hash</span><span class="op" id="8551865">.</span><span class="ident" id="8551866">New</span><span class="op" id="8551869">(</span><span class="op" id="8551870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551873">h</span><span class="op" id="8551874">.</span><span class="ident" id="8551875">Write</span><span class="op" id="8551880">(</span><span class="op" id="8551881">[</span><span class="op" id="8551882">]</span><span class="builtintype" id="8551883">byte</span><span class="op" id="8551887">(</span><span class="string" id="8551888">&#34;testing&#34;</span><span class="op" id="8551897">)</span><span class="op" id="8551898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551901">hashed</span>&nbsp;<span class="op" id="8551908">:=</span>&nbsp;<span class="ident" id="8551911">h</span><span class="op" id="8551912">.</span><span class="ident" id="8551913">Sum</span><span class="op" id="8551916">(</span><span class="ident" id="8551917">nil</span><span class="op" id="8551920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8551923">var</span>&nbsp;<span class="ident" id="8551927">opts</span>&nbsp;<span class="ident" id="8551932">PSSOptions</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8551945">for</span>&nbsp;<span class="ident" id="8551949">i</span><span class="op" id="8551950">,</span>&nbsp;<span class="ident" id="8551952">test</span>&nbsp;<span class="op" id="8551957">:=</span>&nbsp;<span class="keyword" id="8551960">range</span>&nbsp;<span class="ident" id="8551966">saltLengthCombinations</span>&nbsp;<span class="op" id="8551989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8551993">opts</span><span class="op" id="8551997">.</span><span class="ident" id="8551998">SaltLength</span>&nbsp;<span class="op" id="8552009">=</span>&nbsp;<span class="ident" id="8552011">test</span><span class="op" id="8552015">.</span><span class="ident" id="8552016">signSaltLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552033">sig</span><span class="op" id="8552036">,</span>&nbsp;<span class="ident" id="8552038">err</span>&nbsp;<span class="op" id="8552042">:=</span>&nbsp;<span class="ident" id="8552045">SignPSS</span><span class="op" id="8552052">(</span><span class="ident" id="8552053">rand</span><span class="op" id="8552057">.</span><span class="ident" id="8552058">Reader</span><span class="op" id="8552064">,</span>&nbsp;<span class="ident" id="8552066">rsaPrivateKey</span><span class="op" id="8552079">,</span>&nbsp;<span class="ident" id="8552081">hash</span><span class="op" id="8552085">,</span>&nbsp;<span class="ident" id="8552087">hashed</span><span class="op" id="8552093">,</span>&nbsp;<span class="op" id="8552095">&amp;</span><span class="ident" id="8552096">opts</span><span class="op" id="8552100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8552104">if</span>&nbsp;<span class="ident" id="8552107">err</span>&nbsp;<span class="op" id="8552111">!=</span>&nbsp;<span class="ident" id="8552114">nil</span>&nbsp;<span class="op" id="8552118">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552123">t</span><span class="op" id="8552124">.</span><span class="ident" id="8552125">Errorf</span><span class="op" id="8552131">(</span><span class="string" id="8552132">&#34;#%d:&nbsp;error&nbsp;while&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="8552162">,</span>&nbsp;<span class="ident" id="8552164">i</span><span class="op" id="8552165">,</span>&nbsp;<span class="ident" id="8552167">err</span><span class="op" id="8552170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8552175">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8552186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552191">opts</span><span class="op" id="8552195">.</span><span class="ident" id="8552196">SaltLength</span>&nbsp;<span class="op" id="8552207">=</span>&nbsp;<span class="ident" id="8552209">test</span><span class="op" id="8552213">.</span><span class="ident" id="8552214">verifySaltLength</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552233">err</span>&nbsp;<span class="op" id="8552237">=</span>&nbsp;<span class="ident" id="8552239">VerifyPSS</span><span class="op" id="8552248">(</span><span class="op" id="8552249">&amp;</span><span class="ident" id="8552250">rsaPrivateKey</span><span class="op" id="8552263">.</span><span class="ident" id="8552264">PublicKey</span><span class="op" id="8552273">,</span>&nbsp;<span class="ident" id="8552275">hash</span><span class="op" id="8552279">,</span>&nbsp;<span class="ident" id="8552281">hashed</span><span class="op" id="8552287">,</span>&nbsp;<span class="ident" id="8552289">sig</span><span class="op" id="8552292">,</span>&nbsp;<span class="op" id="8552294">&amp;</span><span class="ident" id="8552295">opts</span><span class="op" id="8552299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8552303">if</span>&nbsp;<span class="op" id="8552306">(</span><span class="ident" id="8552307">err</span>&nbsp;<span class="op" id="8552311">==</span>&nbsp;<span class="ident" id="8552314">nil</span><span class="op" id="8552317">)</span>&nbsp;<span class="op" id="8552319">!=</span>&nbsp;<span class="ident" id="8552322">test</span><span class="op" id="8552326">.</span><span class="ident" id="8552327">good</span>&nbsp;<span class="op" id="8552332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552337">t</span><span class="op" id="8552338">.</span><span class="ident" id="8552339">Errorf</span><span class="op" id="8552345">(</span><span class="string" id="8552346">&#34;#%d:&nbsp;bad&nbsp;result,&nbsp;wanted:&nbsp;%t,&nbsp;got:&nbsp;%s&#34;</span><span class="op" id="8552384">,</span>&nbsp;<span class="ident" id="8552386">i</span><span class="op" id="8552387">,</span>&nbsp;<span class="ident" id="8552389">test</span><span class="op" id="8552393">.</span><span class="ident" id="8552394">good</span><span class="op" id="8552398">,</span>&nbsp;<span class="ident" id="8552400">err</span><span class="op" id="8552403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8552407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8552410">}</span><br>
<span class="lineno">225</span><span class="op" id="8552412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8552415">func</span>&nbsp;<span class="ident" id="8552420">bigFromHex</span><span class="op" id="8552430">(</span><span class="ident" id="8552431">hex</span>&nbsp;<span class="builtintype" id="8552435">string</span><span class="op" id="8552441">)</span>&nbsp;<span class="op" id="8552443">*</span><span class="ident" id="8552444">big</span><span class="op" id="8552447">.</span><span class="ident" id="8552448">Int</span>&nbsp;<span class="op" id="8552452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552455">n</span><span class="op" id="8552456">,</span>&nbsp;<span class="ident" id="8552458">ok</span>&nbsp;<span class="op" id="8552461">:=</span>&nbsp;<span class="builtinfunc" id="8552464">new</span><span class="op" id="8552467">(</span><span class="ident" id="8552468">big</span><span class="op" id="8552471">.</span><span class="ident" id="8552472">Int</span><span class="op" id="8552475">)</span><span class="op" id="8552476">.</span><span class="ident" id="8552477">SetString</span><span class="op" id="8552486">(</span><span class="ident" id="8552487">hex</span><span class="op" id="8552490">,</span>&nbsp;<span class="num" id="8552492">16</span><span class="op" id="8552494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8552497">if</span>&nbsp;<span class="op" id="8552500">!</span><span class="ident" id="8552501">ok</span>&nbsp;<span class="op" id="8552504">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8552508">panic</span><span class="op" id="8552513">(</span><span class="string" id="8552514">&#34;bad&nbsp;hex:&nbsp;&#34;</span>&nbsp;<span class="op" id="8552526">+</span>&nbsp;<span class="ident" id="8552528">hex</span><span class="op" id="8552531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8552534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8552537">return</span>&nbsp;<span class="ident" id="8552544">n</span><br>
<span class="lineno"></span><span class="op" id="8552546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="8552549">func</span>&nbsp;<span class="ident" id="8552554">intFromHex</span><span class="op" id="8552564">(</span><span class="ident" id="8552565">hex</span>&nbsp;<span class="builtintype" id="8552569">string</span><span class="op" id="8552575">)</span>&nbsp;<span class="builtintype" id="8552577">int</span>&nbsp;<span class="op" id="8552581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552584">i</span><span class="op" id="8552585">,</span>&nbsp;<span class="ident" id="8552587">err</span>&nbsp;<span class="op" id="8552591">:=</span>&nbsp;<span class="ident" id="8552594">strconv</span><span class="op" id="8552601">.</span><span class="ident" id="8552602">ParseInt</span><span class="op" id="8552610">(</span><span class="ident" id="8552611">hex</span><span class="op" id="8552614">,</span>&nbsp;<span class="num" id="8552616">16</span><span class="op" id="8552618">,</span>&nbsp;<span class="num" id="8552620">32</span><span class="op" id="8552622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8552625">if</span>&nbsp;<span class="ident" id="8552628">err</span>&nbsp;<span class="op" id="8552632">!=</span>&nbsp;<span class="ident" id="8552635">nil</span>&nbsp;<span class="op" id="8552639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8552643">panic</span><span class="op" id="8552648">(</span><span class="ident" id="8552649">err</span><span class="op" id="8552652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8552655">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8552658">return</span>&nbsp;<span class="builtintype" id="8552665">int</span><span class="op" id="8552668">(</span><span class="ident" id="8552669">i</span><span class="op" id="8552670">)</span><br>
<span class="lineno"></span><span class="op" id="8552672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8552675">func</span>&nbsp;<span class="ident" id="8552680">fromHex</span><span class="op" id="8552687">(</span><span class="ident" id="8552688">hexStr</span>&nbsp;<span class="builtintype" id="8552695">string</span><span class="op" id="8552701">)</span>&nbsp;<span class="op" id="8552703">[</span><span class="op" id="8552704">]</span><span class="builtintype" id="8552705">byte</span>&nbsp;<span class="op" id="8552710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8552713">s</span><span class="op" id="8552714">,</span>&nbsp;<span class="ident" id="8552716">err</span>&nbsp;<span class="op" id="8552720">:=</span>&nbsp;<span class="ident" id="8552723">hex</span><span class="op" id="8552726">.</span><span class="ident" id="8552727">DecodeString</span><span class="op" id="8552739">(</span><span class="ident" id="8552740">hexStr</span><span class="op" id="8552746">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8552749">if</span>&nbsp;<span class="ident" id="8552752">err</span>&nbsp;<span class="op" id="8552756">!=</span>&nbsp;<span class="ident" id="8552759">nil</span>&nbsp;<span class="op" id="8552763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8552767">panic</span><span class="op" id="8552772">(</span><span class="ident" id="8552773">err</span><span class="op" id="8552776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8552779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8552782">return</span>&nbsp;<span class="ident" id="8552789">s</span><br>
<span class="lineno"></span><span class="op" id="8552791">}</span>
</div>
</body>
</html>
