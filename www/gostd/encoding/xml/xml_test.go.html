<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/xml</h2>
<ul>
<li><a href="/gostd/encoding/xml/atom_test.go.html">atom_test.go</a></li>
<li><a href="/gostd/encoding/xml/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/xml/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/xml/marshal_test.go.html">marshal_test.go</a></li>
<li><a href="/gostd/encoding/xml/read.go.html">read.go</a></li>
<li><a href="/gostd/encoding/xml/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/encoding/xml/typeinfo.go.html">typeinfo.go</a></li>
<li><a href="/gostd/encoding/xml/xml.go.html">xml.go</a></li>
<li><a href="/gostd/encoding/xml/xml_test.go.html">xml_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8651495">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8651551">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8651605">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8651656">package</span>&nbsp;<span class="ident" id="8651664">xml</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8651669">import</span>&nbsp;<span class="op" id="8651676">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8651679">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8651688">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8651695">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8651701">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8651712">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8651723">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8651734">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">15</span><span class="op" id="8651749">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8651752">const</span>&nbsp;<span class="ident" id="8651758">testInput</span>&nbsp;<span class="op" id="8651768">=</span>&nbsp;<span class="string" id="8651770">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;?&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno">20</span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;&gt;<br>
<span class="lineno"></span>&lt;body&nbsp;xmlns:foo=&#34;ns1&#34;&nbsp;xmlns=&#34;ns2&#34;&nbsp;xmlns:tag=&#34;ns3&#34;&nbsp;`</span>&nbsp;<span class="op" id="8651987">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8651990">&#34;\r\n\t&#34;</span>&nbsp;<span class="op" id="8651999">+</span>&nbsp;<span class="string" id="8652001">`&nbsp;&nbsp;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;hello&nbsp;lang=&#34;en&#34;&gt;World&nbsp;&amp;lt;&amp;gt;&amp;apos;&amp;quot;&nbsp;&amp;#x767d;&amp;#40300;翔&lt;/hello&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;query&gt;&amp;何;&nbsp;&amp;is-it;&lt;/query&gt;<br>
<span class="lineno">25</span>&nbsp;&nbsp;&lt;goodbye&nbsp;/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;outer&nbsp;foo:attr=&#34;value&#34;&nbsp;xmlns:tag=&#34;ns4&#34;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;inner/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/outer&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;tag:name&gt;<br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;![CDATA[Some&nbsp;text&nbsp;here.]]&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/tag:name&gt;<br>
<span class="lineno"></span>&lt;/body&gt;&lt;!--&nbsp;missing&nbsp;final&nbsp;newline&nbsp;--&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8652291">var</span>&nbsp;<span class="ident" id="8652295">testEntity</span>&nbsp;<span class="op" id="8652306">=</span>&nbsp;<span class="keyword" id="8652308">map</span><span class="op" id="8652311">[</span><span class="builtintype" id="8652312">string</span><span class="op" id="8652318">]</span><span class="builtintype" id="8652319">string</span><span class="op" id="8652325">{</span><span class="string" id="8652326">&#34;何&#34;</span><span class="op" id="8652331">:</span>&nbsp;<span class="string" id="8652333">&#34;What&#34;</span><span class="op" id="8652339">,</span>&nbsp;<span class="string" id="8652341">&#34;is-it&#34;</span><span class="op" id="8652348">:</span>&nbsp;<span class="string" id="8652350">&#34;is&nbsp;it?&#34;</span><span class="op" id="8652358">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="8652361">var</span>&nbsp;<span class="ident" id="8652365">rawTokens</span>&nbsp;<span class="op" id="8652375">=</span>&nbsp;<span class="op" id="8652377">[</span><span class="op" id="8652378">]</span><span class="ident" id="8652379">Token</span><span class="op" id="8652384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8652387">CharData</span><span class="op" id="8652395">(</span><span class="string" id="8652396">&#34;\n&#34;</span><span class="op" id="8652400">)</span><span class="op" id="8652401">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8652404">ProcInst</span><span class="op" id="8652412">{</span><span class="string" id="8652413">&#34;xml&#34;</span><span class="op" id="8652418">,</span>&nbsp;<span class="op" id="8652420">[</span><span class="op" id="8652421">]</span><span class="builtintype" id="8652422">byte</span><span class="op" id="8652426">(</span><span class="string" id="8652427">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="8652459">)</span><span class="op" id="8652460">}</span><span class="op" id="8652461">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8652464">CharData</span><span class="op" id="8652472">(</span><span class="string" id="8652473">&#34;\n&#34;</span><span class="op" id="8652477">)</span><span class="op" id="8652478">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8652481">Directive</span><span class="op" id="8652490">(</span><span class="string" id="8652491">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="8652613">)</span><span class="op" id="8652614">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8652617">CharData</span><span class="op" id="8652625">(</span><span class="string" id="8652626">&#34;\n&#34;</span><span class="op" id="8652630">)</span><span class="op" id="8652631">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8652634">StartElement</span><span class="op" id="8652646">{</span><span class="ident" id="8652647">Name</span><span class="op" id="8652651">{</span><span class="string" id="8652652">&#34;&#34;</span><span class="op" id="8652654">,</span>&nbsp;<span class="string" id="8652656">&#34;body&#34;</span><span class="op" id="8652662">}</span><span class="op" id="8652663">,</span>&nbsp;<span class="op" id="8652665">[</span><span class="op" id="8652666">]</span><span class="ident" id="8652667">Attr</span><span class="op" id="8652671">{</span><span class="op" id="8652672">{</span><span class="ident" id="8652673">Name</span><span class="op" id="8652677">{</span><span class="string" id="8652678">&#34;xmlns&#34;</span><span class="op" id="8652685">,</span>&nbsp;<span class="string" id="8652687">&#34;foo&#34;</span><span class="op" id="8652692">}</span><span class="op" id="8652693">,</span>&nbsp;<span class="string" id="8652695">&#34;ns1&#34;</span><span class="op" id="8652700">}</span><span class="op" id="8652701">,</span>&nbsp;<span class="op" id="8652703">{</span><span class="ident" id="8652704">Name</span><span class="op" id="8652708">{</span><span class="string" id="8652709">&#34;&#34;</span><span class="op" id="8652711">,</span>&nbsp;<span class="string" id="8652713">&#34;xmlns&#34;</span><span class="op" id="8652720">}</span><span class="op" id="8652721">,</span>&nbsp;<span class="string" id="8652723">&#34;ns2&#34;</span><span class="op" id="8652728">}</span><span class="op" id="8652729">,</span>&nbsp;<span class="op" id="8652731">{</span><span class="ident" id="8652732">Name</span><span class="op" id="8652736">{</span><span class="string" id="8652737">&#34;xmlns&#34;</span><span class="op" id="8652744">,</span>&nbsp;<span class="string" id="8652746">&#34;tag&#34;</span><span class="op" id="8652751">}</span><span class="op" id="8652752">,</span>&nbsp;<span class="string" id="8652754">&#34;ns3&#34;</span><span class="op" id="8652759">}</span><span class="op" id="8652760">}</span><span class="op" id="8652761">}</span><span class="op" id="8652762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8652765">CharData</span><span class="op" id="8652773">(</span><span class="string" id="8652774">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8652780">)</span><span class="op" id="8652781">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8652784">StartElement</span><span class="op" id="8652796">{</span><span class="ident" id="8652797">Name</span><span class="op" id="8652801">{</span><span class="string" id="8652802">&#34;&#34;</span><span class="op" id="8652804">,</span>&nbsp;<span class="string" id="8652806">&#34;hello&#34;</span><span class="op" id="8652813">}</span><span class="op" id="8652814">,</span>&nbsp;<span class="op" id="8652816">[</span><span class="op" id="8652817">]</span><span class="ident" id="8652818">Attr</span><span class="op" id="8652822">{</span><span class="op" id="8652823">{</span><span class="ident" id="8652824">Name</span><span class="op" id="8652828">{</span><span class="string" id="8652829">&#34;&#34;</span><span class="op" id="8652831">,</span>&nbsp;<span class="string" id="8652833">&#34;lang&#34;</span><span class="op" id="8652839">}</span><span class="op" id="8652840">,</span>&nbsp;<span class="string" id="8652842">&#34;en&#34;</span><span class="op" id="8652846">}</span><span class="op" id="8652847">}</span><span class="op" id="8652848">}</span><span class="op" id="8652849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8652852">CharData</span><span class="op" id="8652860">(</span><span class="string" id="8652861">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="8652884">)</span><span class="op" id="8652885">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8652888">EndElement</span><span class="op" id="8652898">{</span><span class="ident" id="8652899">Name</span><span class="op" id="8652903">{</span><span class="string" id="8652904">&#34;&#34;</span><span class="op" id="8652906">,</span>&nbsp;<span class="string" id="8652908">&#34;hello&#34;</span><span class="op" id="8652915">}</span><span class="op" id="8652916">}</span><span class="op" id="8652917">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8652920">CharData</span><span class="op" id="8652928">(</span><span class="string" id="8652929">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8652935">)</span><span class="op" id="8652936">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8652939">StartElement</span><span class="op" id="8652951">{</span><span class="ident" id="8652952">Name</span><span class="op" id="8652956">{</span><span class="string" id="8652957">&#34;&#34;</span><span class="op" id="8652959">,</span>&nbsp;<span class="string" id="8652961">&#34;query&#34;</span><span class="op" id="8652968">}</span><span class="op" id="8652969">,</span>&nbsp;<span class="op" id="8652971">[</span><span class="op" id="8652972">]</span><span class="ident" id="8652973">Attr</span><span class="op" id="8652977">{</span><span class="op" id="8652978">}</span><span class="op" id="8652979">}</span><span class="op" id="8652980">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8652983">CharData</span><span class="op" id="8652991">(</span><span class="string" id="8652992">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="8653005">)</span><span class="op" id="8653006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653009">EndElement</span><span class="op" id="8653019">{</span><span class="ident" id="8653020">Name</span><span class="op" id="8653024">{</span><span class="string" id="8653025">&#34;&#34;</span><span class="op" id="8653027">,</span>&nbsp;<span class="string" id="8653029">&#34;query&#34;</span><span class="op" id="8653036">}</span><span class="op" id="8653037">}</span><span class="op" id="8653038">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653041">CharData</span><span class="op" id="8653049">(</span><span class="string" id="8653050">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8653056">)</span><span class="op" id="8653057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653060">StartElement</span><span class="op" id="8653072">{</span><span class="ident" id="8653073">Name</span><span class="op" id="8653077">{</span><span class="string" id="8653078">&#34;&#34;</span><span class="op" id="8653080">,</span>&nbsp;<span class="string" id="8653082">&#34;goodbye&#34;</span><span class="op" id="8653091">}</span><span class="op" id="8653092">,</span>&nbsp;<span class="op" id="8653094">[</span><span class="op" id="8653095">]</span><span class="ident" id="8653096">Attr</span><span class="op" id="8653100">{</span><span class="op" id="8653101">}</span><span class="op" id="8653102">}</span><span class="op" id="8653103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653106">EndElement</span><span class="op" id="8653116">{</span><span class="ident" id="8653117">Name</span><span class="op" id="8653121">{</span><span class="string" id="8653122">&#34;&#34;</span><span class="op" id="8653124">,</span>&nbsp;<span class="string" id="8653126">&#34;goodbye&#34;</span><span class="op" id="8653135">}</span><span class="op" id="8653136">}</span><span class="op" id="8653137">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653140">CharData</span><span class="op" id="8653148">(</span><span class="string" id="8653149">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8653155">)</span><span class="op" id="8653156">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653159">StartElement</span><span class="op" id="8653171">{</span><span class="ident" id="8653172">Name</span><span class="op" id="8653176">{</span><span class="string" id="8653177">&#34;&#34;</span><span class="op" id="8653179">,</span>&nbsp;<span class="string" id="8653181">&#34;outer&#34;</span><span class="op" id="8653188">}</span><span class="op" id="8653189">,</span>&nbsp;<span class="op" id="8653191">[</span><span class="op" id="8653192">]</span><span class="ident" id="8653193">Attr</span><span class="op" id="8653197">{</span><span class="op" id="8653198">{</span><span class="ident" id="8653199">Name</span><span class="op" id="8653203">{</span><span class="string" id="8653204">&#34;foo&#34;</span><span class="op" id="8653209">,</span>&nbsp;<span class="string" id="8653211">&#34;attr&#34;</span><span class="op" id="8653217">}</span><span class="op" id="8653218">,</span>&nbsp;<span class="string" id="8653220">&#34;value&#34;</span><span class="op" id="8653227">}</span><span class="op" id="8653228">,</span>&nbsp;<span class="op" id="8653230">{</span><span class="ident" id="8653231">Name</span><span class="op" id="8653235">{</span><span class="string" id="8653236">&#34;xmlns&#34;</span><span class="op" id="8653243">,</span>&nbsp;<span class="string" id="8653245">&#34;tag&#34;</span><span class="op" id="8653250">}</span><span class="op" id="8653251">,</span>&nbsp;<span class="string" id="8653253">&#34;ns4&#34;</span><span class="op" id="8653258">}</span><span class="op" id="8653259">}</span><span class="op" id="8653260">}</span><span class="op" id="8653261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653264">CharData</span><span class="op" id="8653272">(</span><span class="string" id="8653273">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="8653281">)</span><span class="op" id="8653282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653285">StartElement</span><span class="op" id="8653297">{</span><span class="ident" id="8653298">Name</span><span class="op" id="8653302">{</span><span class="string" id="8653303">&#34;&#34;</span><span class="op" id="8653305">,</span>&nbsp;<span class="string" id="8653307">&#34;inner&#34;</span><span class="op" id="8653314">}</span><span class="op" id="8653315">,</span>&nbsp;<span class="op" id="8653317">[</span><span class="op" id="8653318">]</span><span class="ident" id="8653319">Attr</span><span class="op" id="8653323">{</span><span class="op" id="8653324">}</span><span class="op" id="8653325">}</span><span class="op" id="8653326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653329">EndElement</span><span class="op" id="8653339">{</span><span class="ident" id="8653340">Name</span><span class="op" id="8653344">{</span><span class="string" id="8653345">&#34;&#34;</span><span class="op" id="8653347">,</span>&nbsp;<span class="string" id="8653349">&#34;inner&#34;</span><span class="op" id="8653356">}</span><span class="op" id="8653357">}</span><span class="op" id="8653358">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653361">CharData</span><span class="op" id="8653369">(</span><span class="string" id="8653370">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8653376">)</span><span class="op" id="8653377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653380">EndElement</span><span class="op" id="8653390">{</span><span class="ident" id="8653391">Name</span><span class="op" id="8653395">{</span><span class="string" id="8653396">&#34;&#34;</span><span class="op" id="8653398">,</span>&nbsp;<span class="string" id="8653400">&#34;outer&#34;</span><span class="op" id="8653407">}</span><span class="op" id="8653408">}</span><span class="op" id="8653409">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653412">CharData</span><span class="op" id="8653420">(</span><span class="string" id="8653421">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8653427">)</span><span class="op" id="8653428">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653431">StartElement</span><span class="op" id="8653443">{</span><span class="ident" id="8653444">Name</span><span class="op" id="8653448">{</span><span class="string" id="8653449">&#34;tag&#34;</span><span class="op" id="8653454">,</span>&nbsp;<span class="string" id="8653456">&#34;name&#34;</span><span class="op" id="8653462">}</span><span class="op" id="8653463">,</span>&nbsp;<span class="op" id="8653465">[</span><span class="op" id="8653466">]</span><span class="ident" id="8653467">Attr</span><span class="op" id="8653471">{</span><span class="op" id="8653472">}</span><span class="op" id="8653473">}</span><span class="op" id="8653474">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653477">CharData</span><span class="op" id="8653485">(</span><span class="string" id="8653486">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="8653494">)</span><span class="op" id="8653495">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653498">CharData</span><span class="op" id="8653506">(</span><span class="string" id="8653507">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="8653524">)</span><span class="op" id="8653525">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653528">CharData</span><span class="op" id="8653536">(</span><span class="string" id="8653537">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8653543">)</span><span class="op" id="8653544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653547">EndElement</span><span class="op" id="8653557">{</span><span class="ident" id="8653558">Name</span><span class="op" id="8653562">{</span><span class="string" id="8653563">&#34;tag&#34;</span><span class="op" id="8653568">,</span>&nbsp;<span class="string" id="8653570">&#34;name&#34;</span><span class="op" id="8653576">}</span><span class="op" id="8653577">}</span><span class="op" id="8653578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653581">CharData</span><span class="op" id="8653589">(</span><span class="string" id="8653590">&#34;\n&#34;</span><span class="op" id="8653594">)</span><span class="op" id="8653595">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653598">EndElement</span><span class="op" id="8653608">{</span><span class="ident" id="8653609">Name</span><span class="op" id="8653613">{</span><span class="string" id="8653614">&#34;&#34;</span><span class="op" id="8653616">,</span>&nbsp;<span class="string" id="8653618">&#34;body&#34;</span><span class="op" id="8653624">}</span><span class="op" id="8653625">}</span><span class="op" id="8653626">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653629">Comment</span><span class="op" id="8653636">(</span><span class="string" id="8653637">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="8653662">)</span><span class="op" id="8653663">,</span><br>
<span class="lineno"></span><span class="op" id="8653665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8653668">var</span>&nbsp;<span class="ident" id="8653672">cookedTokens</span>&nbsp;<span class="op" id="8653685">=</span>&nbsp;<span class="op" id="8653687">[</span><span class="op" id="8653688">]</span><span class="ident" id="8653689">Token</span><span class="op" id="8653694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653697">CharData</span><span class="op" id="8653705">(</span><span class="string" id="8653706">&#34;\n&#34;</span><span class="op" id="8653710">)</span><span class="op" id="8653711">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653714">ProcInst</span><span class="op" id="8653722">{</span><span class="string" id="8653723">&#34;xml&#34;</span><span class="op" id="8653728">,</span>&nbsp;<span class="op" id="8653730">[</span><span class="op" id="8653731">]</span><span class="builtintype" id="8653732">byte</span><span class="op" id="8653736">(</span><span class="string" id="8653737">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="8653769">)</span><span class="op" id="8653770">}</span><span class="op" id="8653771">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653774">CharData</span><span class="op" id="8653782">(</span><span class="string" id="8653783">&#34;\n&#34;</span><span class="op" id="8653787">)</span><span class="op" id="8653788">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653791">Directive</span><span class="op" id="8653800">(</span><span class="string" id="8653801">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="8653923">)</span><span class="op" id="8653924">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653927">CharData</span><span class="op" id="8653935">(</span><span class="string" id="8653936">&#34;\n&#34;</span><span class="op" id="8653940">)</span><span class="op" id="8653941">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8653944">StartElement</span><span class="op" id="8653956">{</span><span class="ident" id="8653957">Name</span><span class="op" id="8653961">{</span><span class="string" id="8653962">&#34;ns2&#34;</span><span class="op" id="8653967">,</span>&nbsp;<span class="string" id="8653969">&#34;body&#34;</span><span class="op" id="8653975">}</span><span class="op" id="8653976">,</span>&nbsp;<span class="op" id="8653978">[</span><span class="op" id="8653979">]</span><span class="ident" id="8653980">Attr</span><span class="op" id="8653984">{</span><span class="op" id="8653985">{</span><span class="ident" id="8653986">Name</span><span class="op" id="8653990">{</span><span class="string" id="8653991">&#34;xmlns&#34;</span><span class="op" id="8653998">,</span>&nbsp;<span class="string" id="8654000">&#34;foo&#34;</span><span class="op" id="8654005">}</span><span class="op" id="8654006">,</span>&nbsp;<span class="string" id="8654008">&#34;ns1&#34;</span><span class="op" id="8654013">}</span><span class="op" id="8654014">,</span>&nbsp;<span class="op" id="8654016">{</span><span class="ident" id="8654017">Name</span><span class="op" id="8654021">{</span><span class="string" id="8654022">&#34;&#34;</span><span class="op" id="8654024">,</span>&nbsp;<span class="string" id="8654026">&#34;xmlns&#34;</span><span class="op" id="8654033">}</span><span class="op" id="8654034">,</span>&nbsp;<span class="string" id="8654036">&#34;ns2&#34;</span><span class="op" id="8654041">}</span><span class="op" id="8654042">,</span>&nbsp;<span class="op" id="8654044">{</span><span class="ident" id="8654045">Name</span><span class="op" id="8654049">{</span><span class="string" id="8654050">&#34;xmlns&#34;</span><span class="op" id="8654057">,</span>&nbsp;<span class="string" id="8654059">&#34;tag&#34;</span><span class="op" id="8654064">}</span><span class="op" id="8654065">,</span>&nbsp;<span class="string" id="8654067">&#34;ns3&#34;</span><span class="op" id="8654072">}</span><span class="op" id="8654073">}</span><span class="op" id="8654074">}</span><span class="op" id="8654075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654078">CharData</span><span class="op" id="8654086">(</span><span class="string" id="8654087">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8654093">)</span><span class="op" id="8654094">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654097">StartElement</span><span class="op" id="8654109">{</span><span class="ident" id="8654110">Name</span><span class="op" id="8654114">{</span><span class="string" id="8654115">&#34;ns2&#34;</span><span class="op" id="8654120">,</span>&nbsp;<span class="string" id="8654122">&#34;hello&#34;</span><span class="op" id="8654129">}</span><span class="op" id="8654130">,</span>&nbsp;<span class="op" id="8654132">[</span><span class="op" id="8654133">]</span><span class="ident" id="8654134">Attr</span><span class="op" id="8654138">{</span><span class="op" id="8654139">{</span><span class="ident" id="8654140">Name</span><span class="op" id="8654144">{</span><span class="string" id="8654145">&#34;&#34;</span><span class="op" id="8654147">,</span>&nbsp;<span class="string" id="8654149">&#34;lang&#34;</span><span class="op" id="8654155">}</span><span class="op" id="8654156">,</span>&nbsp;<span class="string" id="8654158">&#34;en&#34;</span><span class="op" id="8654162">}</span><span class="op" id="8654163">}</span><span class="op" id="8654164">}</span><span class="op" id="8654165">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654168">CharData</span><span class="op" id="8654176">(</span><span class="string" id="8654177">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="8654200">)</span><span class="op" id="8654201">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654204">EndElement</span><span class="op" id="8654214">{</span><span class="ident" id="8654215">Name</span><span class="op" id="8654219">{</span><span class="string" id="8654220">&#34;ns2&#34;</span><span class="op" id="8654225">,</span>&nbsp;<span class="string" id="8654227">&#34;hello&#34;</span><span class="op" id="8654234">}</span><span class="op" id="8654235">}</span><span class="op" id="8654236">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654239">CharData</span><span class="op" id="8654247">(</span><span class="string" id="8654248">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8654254">)</span><span class="op" id="8654255">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654258">StartElement</span><span class="op" id="8654270">{</span><span class="ident" id="8654271">Name</span><span class="op" id="8654275">{</span><span class="string" id="8654276">&#34;ns2&#34;</span><span class="op" id="8654281">,</span>&nbsp;<span class="string" id="8654283">&#34;query&#34;</span><span class="op" id="8654290">}</span><span class="op" id="8654291">,</span>&nbsp;<span class="op" id="8654293">[</span><span class="op" id="8654294">]</span><span class="ident" id="8654295">Attr</span><span class="op" id="8654299">{</span><span class="op" id="8654300">}</span><span class="op" id="8654301">}</span><span class="op" id="8654302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654305">CharData</span><span class="op" id="8654313">(</span><span class="string" id="8654314">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="8654327">)</span><span class="op" id="8654328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654331">EndElement</span><span class="op" id="8654341">{</span><span class="ident" id="8654342">Name</span><span class="op" id="8654346">{</span><span class="string" id="8654347">&#34;ns2&#34;</span><span class="op" id="8654352">,</span>&nbsp;<span class="string" id="8654354">&#34;query&#34;</span><span class="op" id="8654361">}</span><span class="op" id="8654362">}</span><span class="op" id="8654363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654366">CharData</span><span class="op" id="8654374">(</span><span class="string" id="8654375">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8654381">)</span><span class="op" id="8654382">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654385">StartElement</span><span class="op" id="8654397">{</span><span class="ident" id="8654398">Name</span><span class="op" id="8654402">{</span><span class="string" id="8654403">&#34;ns2&#34;</span><span class="op" id="8654408">,</span>&nbsp;<span class="string" id="8654410">&#34;goodbye&#34;</span><span class="op" id="8654419">}</span><span class="op" id="8654420">,</span>&nbsp;<span class="op" id="8654422">[</span><span class="op" id="8654423">]</span><span class="ident" id="8654424">Attr</span><span class="op" id="8654428">{</span><span class="op" id="8654429">}</span><span class="op" id="8654430">}</span><span class="op" id="8654431">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654434">EndElement</span><span class="op" id="8654444">{</span><span class="ident" id="8654445">Name</span><span class="op" id="8654449">{</span><span class="string" id="8654450">&#34;ns2&#34;</span><span class="op" id="8654455">,</span>&nbsp;<span class="string" id="8654457">&#34;goodbye&#34;</span><span class="op" id="8654466">}</span><span class="op" id="8654467">}</span><span class="op" id="8654468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654471">CharData</span><span class="op" id="8654479">(</span><span class="string" id="8654480">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8654486">)</span><span class="op" id="8654487">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654490">StartElement</span><span class="op" id="8654502">{</span><span class="ident" id="8654503">Name</span><span class="op" id="8654507">{</span><span class="string" id="8654508">&#34;ns2&#34;</span><span class="op" id="8654513">,</span>&nbsp;<span class="string" id="8654515">&#34;outer&#34;</span><span class="op" id="8654522">}</span><span class="op" id="8654523">,</span>&nbsp;<span class="op" id="8654525">[</span><span class="op" id="8654526">]</span><span class="ident" id="8654527">Attr</span><span class="op" id="8654531">{</span><span class="op" id="8654532">{</span><span class="ident" id="8654533">Name</span><span class="op" id="8654537">{</span><span class="string" id="8654538">&#34;ns1&#34;</span><span class="op" id="8654543">,</span>&nbsp;<span class="string" id="8654545">&#34;attr&#34;</span><span class="op" id="8654551">}</span><span class="op" id="8654552">,</span>&nbsp;<span class="string" id="8654554">&#34;value&#34;</span><span class="op" id="8654561">}</span><span class="op" id="8654562">,</span>&nbsp;<span class="op" id="8654564">{</span><span class="ident" id="8654565">Name</span><span class="op" id="8654569">{</span><span class="string" id="8654570">&#34;xmlns&#34;</span><span class="op" id="8654577">,</span>&nbsp;<span class="string" id="8654579">&#34;tag&#34;</span><span class="op" id="8654584">}</span><span class="op" id="8654585">,</span>&nbsp;<span class="string" id="8654587">&#34;ns4&#34;</span><span class="op" id="8654592">}</span><span class="op" id="8654593">}</span><span class="op" id="8654594">}</span><span class="op" id="8654595">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654598">CharData</span><span class="op" id="8654606">(</span><span class="string" id="8654607">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="8654615">)</span><span class="op" id="8654616">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654619">StartElement</span><span class="op" id="8654631">{</span><span class="ident" id="8654632">Name</span><span class="op" id="8654636">{</span><span class="string" id="8654637">&#34;ns2&#34;</span><span class="op" id="8654642">,</span>&nbsp;<span class="string" id="8654644">&#34;inner&#34;</span><span class="op" id="8654651">}</span><span class="op" id="8654652">,</span>&nbsp;<span class="op" id="8654654">[</span><span class="op" id="8654655">]</span><span class="ident" id="8654656">Attr</span><span class="op" id="8654660">{</span><span class="op" id="8654661">}</span><span class="op" id="8654662">}</span><span class="op" id="8654663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654666">EndElement</span><span class="op" id="8654676">{</span><span class="ident" id="8654677">Name</span><span class="op" id="8654681">{</span><span class="string" id="8654682">&#34;ns2&#34;</span><span class="op" id="8654687">,</span>&nbsp;<span class="string" id="8654689">&#34;inner&#34;</span><span class="op" id="8654696">}</span><span class="op" id="8654697">}</span><span class="op" id="8654698">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654701">CharData</span><span class="op" id="8654709">(</span><span class="string" id="8654710">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8654716">)</span><span class="op" id="8654717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654720">EndElement</span><span class="op" id="8654730">{</span><span class="ident" id="8654731">Name</span><span class="op" id="8654735">{</span><span class="string" id="8654736">&#34;ns2&#34;</span><span class="op" id="8654741">,</span>&nbsp;<span class="string" id="8654743">&#34;outer&#34;</span><span class="op" id="8654750">}</span><span class="op" id="8654751">}</span><span class="op" id="8654752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654755">CharData</span><span class="op" id="8654763">(</span><span class="string" id="8654764">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8654770">)</span><span class="op" id="8654771">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654774">StartElement</span><span class="op" id="8654786">{</span><span class="ident" id="8654787">Name</span><span class="op" id="8654791">{</span><span class="string" id="8654792">&#34;ns3&#34;</span><span class="op" id="8654797">,</span>&nbsp;<span class="string" id="8654799">&#34;name&#34;</span><span class="op" id="8654805">}</span><span class="op" id="8654806">,</span>&nbsp;<span class="op" id="8654808">[</span><span class="op" id="8654809">]</span><span class="ident" id="8654810">Attr</span><span class="op" id="8654814">{</span><span class="op" id="8654815">}</span><span class="op" id="8654816">}</span><span class="op" id="8654817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654820">CharData</span><span class="op" id="8654828">(</span><span class="string" id="8654829">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="8654837">)</span><span class="op" id="8654838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654841">CharData</span><span class="op" id="8654849">(</span><span class="string" id="8654850">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="8654867">)</span><span class="op" id="8654868">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654871">CharData</span><span class="op" id="8654879">(</span><span class="string" id="8654880">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="8654886">)</span><span class="op" id="8654887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654890">EndElement</span><span class="op" id="8654900">{</span><span class="ident" id="8654901">Name</span><span class="op" id="8654905">{</span><span class="string" id="8654906">&#34;ns3&#34;</span><span class="op" id="8654911">,</span>&nbsp;<span class="string" id="8654913">&#34;name&#34;</span><span class="op" id="8654919">}</span><span class="op" id="8654920">}</span><span class="op" id="8654921">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654924">CharData</span><span class="op" id="8654932">(</span><span class="string" id="8654933">&#34;\n&#34;</span><span class="op" id="8654937">)</span><span class="op" id="8654938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654941">EndElement</span><span class="op" id="8654951">{</span><span class="ident" id="8654952">Name</span><span class="op" id="8654956">{</span><span class="string" id="8654957">&#34;ns2&#34;</span><span class="op" id="8654962">,</span>&nbsp;<span class="string" id="8654964">&#34;body&#34;</span><span class="op" id="8654970">}</span><span class="op" id="8654971">}</span><span class="op" id="8654972">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8654975">Comment</span><span class="op" id="8654982">(</span><span class="string" id="8654983">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="8655008">)</span><span class="op" id="8655009">,</span><br>
<span class="lineno"></span><span class="op" id="8655011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="8655014">const</span>&nbsp;<span class="ident" id="8655020">testInputAltEncoding</span>&nbsp;<span class="op" id="8655041">=</span>&nbsp;<span class="string" id="8655043">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;?&gt;<br>
<span class="lineno"></span>&lt;TAG&gt;VALUE&lt;/TAG&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8655117">var</span>&nbsp;<span class="ident" id="8655121">rawTokensAltEncoding</span>&nbsp;<span class="op" id="8655142">=</span>&nbsp;<span class="op" id="8655144">[</span><span class="op" id="8655145">]</span><span class="ident" id="8655146">Token</span><span class="op" id="8655151">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8655154">CharData</span><span class="op" id="8655162">(</span><span class="string" id="8655163">&#34;\n&#34;</span><span class="op" id="8655167">)</span><span class="op" id="8655168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8655171">ProcInst</span><span class="op" id="8655179">{</span><span class="string" id="8655180">&#34;xml&#34;</span><span class="op" id="8655185">,</span>&nbsp;<span class="op" id="8655187">[</span><span class="op" id="8655188">]</span><span class="builtintype" id="8655189">byte</span><span class="op" id="8655193">(</span><span class="string" id="8655194">`version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;`</span><span class="op" id="8655240">)</span><span class="op" id="8655241">}</span><span class="op" id="8655242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8655245">CharData</span><span class="op" id="8655253">(</span><span class="string" id="8655254">&#34;\n&#34;</span><span class="op" id="8655258">)</span><span class="op" id="8655259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8655262">StartElement</span><span class="op" id="8655274">{</span><span class="ident" id="8655275">Name</span><span class="op" id="8655279">{</span><span class="string" id="8655280">&#34;&#34;</span><span class="op" id="8655282">,</span>&nbsp;<span class="string" id="8655284">&#34;tag&#34;</span><span class="op" id="8655289">}</span><span class="op" id="8655290">,</span>&nbsp;<span class="op" id="8655292">[</span><span class="op" id="8655293">]</span><span class="ident" id="8655294">Attr</span><span class="op" id="8655298">{</span><span class="op" id="8655299">}</span><span class="op" id="8655300">}</span><span class="op" id="8655301">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8655304">CharData</span><span class="op" id="8655312">(</span><span class="string" id="8655313">&#34;value&#34;</span><span class="op" id="8655320">)</span><span class="op" id="8655321">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8655324">EndElement</span><span class="op" id="8655334">{</span><span class="ident" id="8655335">Name</span><span class="op" id="8655339">{</span><span class="string" id="8655340">&#34;&#34;</span><span class="op" id="8655342">,</span>&nbsp;<span class="string" id="8655344">&#34;tag&#34;</span><span class="op" id="8655349">}</span><span class="op" id="8655350">}</span><span class="op" id="8655351">,</span><br>
<span class="lineno"></span><span class="op" id="8655353">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8655356">var</span>&nbsp;<span class="ident" id="8655360">xmlInput</span>&nbsp;<span class="op" id="8655369">=</span>&nbsp;<span class="op" id="8655371">[</span><span class="op" id="8655372">]</span><span class="builtintype" id="8655373">string</span><span class="op" id="8655379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8655382">//&nbsp;unexpected&nbsp;EOF&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655407">&#34;&lt;&#34;</span><span class="op" id="8655410">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655413">&#34;&lt;t&#34;</span><span class="op" id="8655417">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655420">&#34;&lt;t&nbsp;&#34;</span><span class="op" id="8655425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655428">&#34;&lt;t/&#34;</span><span class="op" id="8655433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655436">&#34;&lt;!&#34;</span><span class="op" id="8655440">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655443">&#34;&lt;!-&#34;</span><span class="op" id="8655448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655451">&#34;&lt;!--&#34;</span><span class="op" id="8655457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655460">&#34;&lt;!--c-&#34;</span><span class="op" id="8655468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655471">&#34;&lt;!--c--&#34;</span><span class="op" id="8655480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655483">&#34;&lt;!d&#34;</span><span class="op" id="8655488">,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655491">&#34;&lt;t&gt;&lt;/&#34;</span><span class="op" id="8655498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655501">&#34;&lt;t&gt;&lt;/t&#34;</span><span class="op" id="8655509">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655512">&#34;&lt;?&#34;</span><span class="op" id="8655516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655519">&#34;&lt;?p&#34;</span><span class="op" id="8655524">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655527">&#34;&lt;t&nbsp;a&#34;</span><span class="op" id="8655533">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655536">&#34;&lt;t&nbsp;a=&#34;</span><span class="op" id="8655543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655546">&#34;&lt;t&nbsp;a=&#39;&#34;</span><span class="op" id="8655554">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655557">&#34;&lt;t&nbsp;a=&#39;&#39;&#34;</span><span class="op" id="8655566">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655569">&#34;&lt;t/&gt;&lt;![&#34;</span><span class="op" id="8655578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655581">&#34;&lt;t/&gt;&lt;![C&#34;</span><span class="op" id="8655591">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655594">&#34;&lt;t/&gt;&lt;![CDATA[d&#34;</span><span class="op" id="8655610">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655613">&#34;&lt;t/&gt;&lt;![CDATA[d]&#34;</span><span class="op" id="8655630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655633">&#34;&lt;t/&gt;&lt;![CDATA[d]]&#34;</span><span class="op" id="8655651">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8655655">//&nbsp;other&nbsp;Syntax&nbsp;errors</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655679">&#34;&lt;&gt;&#34;</span><span class="op" id="8655683">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655686">&#34;&lt;t/a&#34;</span><span class="op" id="8655692">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655695">&#34;&lt;0&nbsp;/&gt;&#34;</span><span class="op" id="8655702">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655705">&#34;&lt;?0&nbsp;&gt;&#34;</span><span class="op" id="8655712">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8655715">//&nbsp;&nbsp;&nbsp;&nbsp&#34;&lt;!0&nbsp;&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655761">&#34;&lt;/0&gt;&#34;</span><span class="op" id="8655767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655770">&#34;&lt;t&nbsp;0=&#39;&#39;&gt;&#34;</span><span class="op" id="8655780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655783">&#34;&lt;t&nbsp;a=&#39;&amp;&#39;&gt;&#34;</span><span class="op" id="8655794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655797">&#34;&lt;t&nbsp;a=&#39;&lt;&#39;&gt;&#34;</span><span class="op" id="8655808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655811">&#34;&lt;t&gt;&amp;nbspc;&lt;/t&gt;&#34;</span><span class="op" id="8655827">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655830">&#34;&lt;t&nbsp;a&gt;&#34;</span><span class="op" id="8655837">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655840">&#34;&lt;t&nbsp;a=&gt;&#34;</span><span class="op" id="8655848">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655851">&#34;&lt;t&nbsp;a=v&gt;&#34;</span><span class="op" id="8655860">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8655863">//&nbsp;&nbsp;&nbsp;&nbsp&#34;&lt;![CDATA[d]]&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655917">&#34;&lt;t&gt;&lt;/e&gt;&#34;</span><span class="op" id="8655926">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655929">&#34;&lt;t&gt;&lt;/&gt;&#34;</span><span class="op" id="8655937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655940">&#34;&lt;t&gt;&lt;/t!&#34;</span><span class="op" id="8655949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8655952">&#34;&lt;t&gt;cdata]]&gt;&lt;/t&gt;&#34;</span><span class="op" id="8655969">,</span><br>
<span class="lineno"></span><span class="op" id="8655971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="8655974">func</span>&nbsp;<span class="ident" id="8655979">TestRawToken</span><span class="op" id="8655991">(</span><span class="ident" id="8655992">t</span>&nbsp;<span class="op" id="8655994">*</span><span class="ident" id="8655995">testing</span><span class="op" id="8656002">.</span><span class="ident" id="8656003">T</span><span class="op" id="8656004">)</span>&nbsp;<span class="op" id="8656006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8656009">d</span>&nbsp;<span class="op" id="8656011">:=</span>&nbsp;<span class="ident" id="8656014">NewDecoder</span><span class="op" id="8656024">(</span><span class="ident" id="8656025">strings</span><span class="op" id="8656032">.</span><span class="ident" id="8656033">NewReader</span><span class="op" id="8656042">(</span><span class="ident" id="8656043">testInput</span><span class="op" id="8656052">)</span><span class="op" id="8656053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8656056">d</span><span class="op" id="8656057">.</span><span class="ident" id="8656058">Entity</span>&nbsp;<span class="op" id="8656065">=</span>&nbsp;<span class="ident" id="8656067">testEntity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8656079">testRawToken</span><span class="op" id="8656091">(</span><span class="ident" id="8656092">t</span><span class="op" id="8656093">,</span>&nbsp;<span class="ident" id="8656095">d</span><span class="op" id="8656096">,</span>&nbsp;<span class="ident" id="8656098">testInput</span><span class="op" id="8656107">,</span>&nbsp;<span class="ident" id="8656109">rawTokens</span><span class="op" id="8656118">)</span><br>
<span class="lineno"></span><span class="op" id="8656120">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="8656123">const</span>&nbsp;<span class="ident" id="8656129">nonStrictInput</span>&nbsp;<span class="op" id="8656144">=</span>&nbsp;<span class="string" id="8656146">`<br>
<span class="lineno"></span>&lt;tag&gt;non&amp;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;unknown;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;#123&lt;/tag&gt;<br>
<span class="lineno">180</span>&lt;tag&gt;&amp;#zzz;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;なまえ3;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;lt-gt;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;0a;&lt;/tag&gt;<br>
<span class="lineno">185</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8656308">var</span>&nbsp;<span class="ident" id="8656312">nonStringEntity</span>&nbsp;<span class="op" id="8656328">=</span>&nbsp;<span class="keyword" id="8656330">map</span><span class="op" id="8656333">[</span><span class="builtintype" id="8656334">string</span><span class="op" id="8656340">]</span><span class="builtintype" id="8656341">string</span><span class="op" id="8656347">{</span><span class="string" id="8656348">&#34;&#34;</span><span class="op" id="8656350">:</span>&nbsp;<span class="string" id="8656352">&#34;oops!&#34;</span><span class="op" id="8656359">,</span>&nbsp;<span class="string" id="8656361">&#34;0a&#34;</span><span class="op" id="8656365">:</span>&nbsp;<span class="string" id="8656367">&#34;oops!&#34;</span><span class="op" id="8656374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8656377">var</span>&nbsp;<span class="ident" id="8656381">nonStrictTokens</span>&nbsp;<span class="op" id="8656397">=</span>&nbsp;<span class="op" id="8656399">[</span><span class="op" id="8656400">]</span><span class="ident" id="8656401">Token</span><span class="op" id="8656406">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8656409">CharData</span><span class="op" id="8656417">(</span><span class="string" id="8656418">&#34;\n&#34;</span><span class="op" id="8656422">)</span><span class="op" id="8656423">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8656426">StartElement</span><span class="op" id="8656438">{</span><span class="ident" id="8656439">Name</span><span class="op" id="8656443">{</span><span class="string" id="8656444">&#34;&#34;</span><span class="op" id="8656446">,</span>&nbsp;<span class="string" id="8656448">&#34;tag&#34;</span><span class="op" id="8656453">}</span><span class="op" id="8656454">,</span>&nbsp;<span class="op" id="8656456">[</span><span class="op" id="8656457">]</span><span class="ident" id="8656458">Attr</span><span class="op" id="8656462">{</span><span class="op" id="8656463">}</span><span class="op" id="8656464">}</span><span class="op" id="8656465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8656468">CharData</span><span class="op" id="8656476">(</span><span class="string" id="8656477">&#34;non&amp;entity&#34;</span><span class="op" id="8656489">)</span><span class="op" id="8656490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8656493">EndElement</span><span class="op" id="8656503">{</span><span class="ident" id="8656504">Name</span><span class="op" id="8656508">{</span><span class="string" id="8656509">&#34;&#34;</span><span class="op" id="8656511">,</span>&nbsp;<span class="string" id="8656513">&#34;tag&#34;</span><span class="op" id="8656518">}</span><span class="op" id="8656519">}</span><span class="op" id="8656520">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8656523">CharData</span><span class="op" id="8656531">(</span><span class="string" id="8656532">&#34;\n&#34;</span><span class="op" id="8656536">)</span><span class="op" id="8656537">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8656540">StartElement</span><span class="op" id="8656552">{</span><span class="ident" id="8656553">Name</span><span class="op" id="8656557">{</span><span class="string" id="8656558">&#34;&#34;</span><span class="op" id="8656560">,</span>&nbsp;<span class="string" id="8656562">&#34;tag&#34;</span><span class="op" id="8656567">}</span><span class="op" id="8656568">,</span>&nbsp;<span class="op" id="8656570">[</span><span class="op" id="8656571">]</span><span class="ident" id="8656572">Attr</span><span class="op" id="8656576">{</span><span class="op" id="8656577">}</span><span class="op" id="8656578">}</span><span class="op" id="8656579">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8656582">CharData</span><span class="op" id="8656590">(</span><span class="string" id="8656591">&#34;&amp;unknown;entity&#34;</span><span class="op" id="8656608">)</span><span class="op" id="8656609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8656612">EndElement</span><span class="op" id="8656622">{</span><span class="ident" id="8656623">Name</span><span class="op" id="8656627">{</span><span class="string" id="8656628">&#34;&#34;</span><span class="op" id="8656630">,</span>&nbsp;<span class="string" id="8656632">&#34;tag&#34;</span><span class="op" id="8656637">}</span><span class="op" id="8656638">}</span><span class="op" id="8656639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8656642">CharData</span><span class="op" id="8656650">(</span><span class="string" id="8656651">&#34;\n&#34;</span><span class="op" id="8656655">)</span><span class="op" id="8656656">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8656659">StartElement</span><span class="op" id="8656671">{</span><span class="ident" id="8656672">Name</span><span class="op" id="8656676">{</span><span class="string" id="8656677">&#34;&#34;</span><span class="op" id="8656679">,</span>&nbsp;<span class="string" id="8656681">&#34;tag&#34;</span><span class="op" id="8656686">}</span><span class="op" id="8656687">,</span>&nbsp;<span class="op" id="8656689">[</span><span class="op" id="8656690">]</span><span class="ident" id="8656691">Attr</span><span class="op" id="8656695">{</span><span class="op" id="8656696">}</span><span class="op" id="8656697">}</span><span class="op" id="8656698">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8656701">CharData</span><span class="op" id="8656709">(</span><span class="string" id="8656710">&#34;&amp;#123&#34;</span><span class="op" id="8656717">)</span><span class="op" id="8656718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8656721">EndElement</span><span class="op" id="8656731">{</span><span class="ident" id="8656732">Name</span><span class="op" id="8656736">{</span><span class="string" id="8656737">&#34;&#34;</span><span class="op" id="8656739">,</span>&nbsp;<span class="string" id="8656741">&#34;tag&#34;</span><span class="op" id="8656746">}</span><span class="op" id="8656747">}</span><span class="op" id="8656748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8656751">CharData</span><span class="op" id="8656759">(</span><span class="string" id="8656760">&#34;\n&#34;</span><span class="op" id="8656764">)</span><span class="op" id="8656765">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8656768">StartElement</span><span class="op" id="8656780">{</span><span class="ident" id="8656781">Name</span><span class="op" id="8656785">{</span><span class="string" id="8656786">&#34;&#34;</span><span class="op" id="8656788">,</span>&nbsp;<span class="string" id="8656790">&#34;tag&#34;</span><span class="op" id="8656795">}</span><span class="op" id="8656796">,</span>&nbsp;<span class="op" id="8656798">[</span><span class="op" id="8656799">]</span><span class="ident" id="8656800">Attr</span><span class="op" id="8656804">{</span><span class="op" id="8656805">}</span><span class="op" id="8656806">}</span><span class="op" id="8656807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8656810">CharData</span><span class="op" id="8656818">(</span><span class="string" id="8656819">&#34;&amp;#zzz;&#34;</span><span class="op" id="8656827">)</span><span class="op" id="8656828">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8656831">EndElement</span><span class="op" id="8656841">{</span><span class="ident" id="8656842">Name</span><span class="op" id="8656846">{</span><span class="string" id="8656847">&#34;&#34;</span><span class="op" id="8656849">,</span>&nbsp;<span class="string" id="8656851">&#34;tag&#34;</span><span class="op" id="8656856">}</span><span class="op" id="8656857">}</span><span class="op" id="8656858">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8656861">CharData</span><span class="op" id="8656869">(</span><span class="string" id="8656870">&#34;\n&#34;</span><span class="op" id="8656874">)</span><span class="op" id="8656875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8656878">StartElement</span><span class="op" id="8656890">{</span><span class="ident" id="8656891">Name</span><span class="op" id="8656895">{</span><span class="string" id="8656896">&#34;&#34;</span><span class="op" id="8656898">,</span>&nbsp;<span class="string" id="8656900">&#34;tag&#34;</span><span class="op" id="8656905">}</span><span class="op" id="8656906">,</span>&nbsp;<span class="op" id="8656908">[</span><span class="op" id="8656909">]</span><span class="ident" id="8656910">Attr</span><span class="op" id="8656914">{</span><span class="op" id="8656915">}</span><span class="op" id="8656916">}</span><span class="op" id="8656917">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8656920">CharData</span><span class="op" id="8656928">(</span><span class="string" id="8656929">&#34;&amp;なまえ3;&#34;</span><span class="op" id="8656943">)</span><span class="op" id="8656944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8656947">EndElement</span><span class="op" id="8656957">{</span><span class="ident" id="8656958">Name</span><span class="op" id="8656962">{</span><span class="string" id="8656963">&#34;&#34;</span><span class="op" id="8656965">,</span>&nbsp;<span class="string" id="8656967">&#34;tag&#34;</span><span class="op" id="8656972">}</span><span class="op" id="8656973">}</span><span class="op" id="8656974">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8656977">CharData</span><span class="op" id="8656985">(</span><span class="string" id="8656986">&#34;\n&#34;</span><span class="op" id="8656990">)</span><span class="op" id="8656991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8656994">StartElement</span><span class="op" id="8657006">{</span><span class="ident" id="8657007">Name</span><span class="op" id="8657011">{</span><span class="string" id="8657012">&#34;&#34;</span><span class="op" id="8657014">,</span>&nbsp;<span class="string" id="8657016">&#34;tag&#34;</span><span class="op" id="8657021">}</span><span class="op" id="8657022">,</span>&nbsp;<span class="op" id="8657024">[</span><span class="op" id="8657025">]</span><span class="ident" id="8657026">Attr</span><span class="op" id="8657030">{</span><span class="op" id="8657031">}</span><span class="op" id="8657032">}</span><span class="op" id="8657033">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8657036">CharData</span><span class="op" id="8657044">(</span><span class="string" id="8657045">&#34;&amp;lt-gt;&#34;</span><span class="op" id="8657054">)</span><span class="op" id="8657055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8657058">EndElement</span><span class="op" id="8657068">{</span><span class="ident" id="8657069">Name</span><span class="op" id="8657073">{</span><span class="string" id="8657074">&#34;&#34;</span><span class="op" id="8657076">,</span>&nbsp;<span class="string" id="8657078">&#34;tag&#34;</span><span class="op" id="8657083">}</span><span class="op" id="8657084">}</span><span class="op" id="8657085">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8657088">CharData</span><span class="op" id="8657096">(</span><span class="string" id="8657097">&#34;\n&#34;</span><span class="op" id="8657101">)</span><span class="op" id="8657102">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8657105">StartElement</span><span class="op" id="8657117">{</span><span class="ident" id="8657118">Name</span><span class="op" id="8657122">{</span><span class="string" id="8657123">&#34;&#34;</span><span class="op" id="8657125">,</span>&nbsp;<span class="string" id="8657127">&#34;tag&#34;</span><span class="op" id="8657132">}</span><span class="op" id="8657133">,</span>&nbsp;<span class="op" id="8657135">[</span><span class="op" id="8657136">]</span><span class="ident" id="8657137">Attr</span><span class="op" id="8657141">{</span><span class="op" id="8657142">}</span><span class="op" id="8657143">}</span><span class="op" id="8657144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8657147">CharData</span><span class="op" id="8657155">(</span><span class="string" id="8657156">&#34;&amp;;&#34;</span><span class="op" id="8657160">)</span><span class="op" id="8657161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8657164">EndElement</span><span class="op" id="8657174">{</span><span class="ident" id="8657175">Name</span><span class="op" id="8657179">{</span><span class="string" id="8657180">&#34;&#34;</span><span class="op" id="8657182">,</span>&nbsp;<span class="string" id="8657184">&#34;tag&#34;</span><span class="op" id="8657189">}</span><span class="op" id="8657190">}</span><span class="op" id="8657191">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8657194">CharData</span><span class="op" id="8657202">(</span><span class="string" id="8657203">&#34;\n&#34;</span><span class="op" id="8657207">)</span><span class="op" id="8657208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8657211">StartElement</span><span class="op" id="8657223">{</span><span class="ident" id="8657224">Name</span><span class="op" id="8657228">{</span><span class="string" id="8657229">&#34;&#34;</span><span class="op" id="8657231">,</span>&nbsp;<span class="string" id="8657233">&#34;tag&#34;</span><span class="op" id="8657238">}</span><span class="op" id="8657239">,</span>&nbsp;<span class="op" id="8657241">[</span><span class="op" id="8657242">]</span><span class="ident" id="8657243">Attr</span><span class="op" id="8657247">{</span><span class="op" id="8657248">}</span><span class="op" id="8657249">}</span><span class="op" id="8657250">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8657253">CharData</span><span class="op" id="8657261">(</span><span class="string" id="8657262">&#34;&amp;0a;&#34;</span><span class="op" id="8657268">)</span><span class="op" id="8657269">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8657272">EndElement</span><span class="op" id="8657282">{</span><span class="ident" id="8657283">Name</span><span class="op" id="8657287">{</span><span class="string" id="8657288">&#34;&#34;</span><span class="op" id="8657290">,</span>&nbsp;<span class="string" id="8657292">&#34;tag&#34;</span><span class="op" id="8657297">}</span><span class="op" id="8657298">}</span><span class="op" id="8657299">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8657302">CharData</span><span class="op" id="8657310">(</span><span class="string" id="8657311">&#34;\n&#34;</span><span class="op" id="8657315">)</span><span class="op" id="8657316">,</span><br>
<span class="lineno"></span><span class="op" id="8657318">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="8657321">func</span>&nbsp;<span class="ident" id="8657326">TestNonStrictRawToken</span><span class="op" id="8657347">(</span><span class="ident" id="8657348">t</span>&nbsp;<span class="op" id="8657350">*</span><span class="ident" id="8657351">testing</span><span class="op" id="8657358">.</span><span class="ident" id="8657359">T</span><span class="op" id="8657360">)</span>&nbsp;<span class="op" id="8657362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8657365">d</span>&nbsp;<span class="op" id="8657367">:=</span>&nbsp;<span class="ident" id="8657370">NewDecoder</span><span class="op" id="8657380">(</span><span class="ident" id="8657381">strings</span><span class="op" id="8657388">.</span><span class="ident" id="8657389">NewReader</span><span class="op" id="8657398">(</span><span class="ident" id="8657399">nonStrictInput</span><span class="op" id="8657413">)</span><span class="op" id="8657414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8657417">d</span><span class="op" id="8657418">.</span><span class="ident" id="8657419">Strict</span>&nbsp;<span class="op" id="8657426">=</span>&nbsp;<span class="builtintype" id="8657428">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8657435">testRawToken</span><span class="op" id="8657447">(</span><span class="ident" id="8657448">t</span><span class="op" id="8657449">,</span>&nbsp;<span class="ident" id="8657451">d</span><span class="op" id="8657452">,</span>&nbsp;<span class="ident" id="8657454">nonStrictInput</span><span class="op" id="8657468">,</span>&nbsp;<span class="ident" id="8657470">nonStrictTokens</span><span class="op" id="8657485">)</span><br>
<span class="lineno"></span><span class="op" id="8657487">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="8657490">type</span>&nbsp;<span class="ident" id="8657495">downCaser</span>&nbsp;<span class="keyword" id="8657505">struct</span>&nbsp;<span class="op" id="8657512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8657515">t</span>&nbsp;<span class="op" id="8657517">*</span><span class="ident" id="8657518">testing</span><span class="op" id="8657525">.</span><span class="ident" id="8657526">T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8657529">r</span>&nbsp;<span class="ident" id="8657531">io</span><span class="op" id="8657533">.</span><span class="ident" id="8657534">ByteReader</span><br>
<span class="lineno"></span><span class="op" id="8657545">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="8657548">func</span>&nbsp;<span class="op" id="8657553">(</span><span class="ident" id="8657554">d</span>&nbsp;<span class="op" id="8657556">*</span><span class="ident" id="8657557">downCaser</span><span class="op" id="8657566">)</span>&nbsp;<span class="ident" id="8657568">ReadByte</span><span class="op" id="8657576">(</span><span class="op" id="8657577">)</span>&nbsp;<span class="op" id="8657579">(</span><span class="ident" id="8657580">c</span>&nbsp;<span class="builtintype" id="8657582">byte</span><span class="op" id="8657586">,</span>&nbsp;<span class="ident" id="8657588">err</span>&nbsp;<span class="builtintype" id="8657592">error</span><span class="op" id="8657597">)</span>&nbsp;<span class="op" id="8657599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8657602">c</span><span class="op" id="8657603">,</span>&nbsp;<span class="ident" id="8657605">err</span>&nbsp;<span class="op" id="8657609">=</span>&nbsp;<span class="ident" id="8657611">d</span><span class="op" id="8657612">.</span><span class="ident" id="8657613">r</span><span class="op" id="8657614">.</span><span class="ident" id="8657615">ReadByte</span><span class="op" id="8657623">(</span><span class="op" id="8657624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8657627">if</span>&nbsp;<span class="ident" id="8657630">c</span>&nbsp;<span class="op" id="8657632">&gt;=</span>&nbsp;<span class="string" id="8657635">&#39;A&#39;</span>&nbsp;<span class="op" id="8657639">&amp;&amp;</span>&nbsp;<span class="ident" id="8657642">c</span>&nbsp;<span class="op" id="8657644">&lt;=</span>&nbsp;<span class="string" id="8657647">&#39;Z&#39;</span>&nbsp;<span class="op" id="8657651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8657655">c</span>&nbsp;<span class="op" id="8657657">+=</span>&nbsp;<span class="string" id="8657660">&#39;a&#39;</span>&nbsp;<span class="op" id="8657664">-</span>&nbsp;<span class="string" id="8657666">&#39;A&#39;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8657671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8657674">return</span><br>
<span class="lineno"></span><span class="op" id="8657681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8657684">func</span>&nbsp;<span class="op" id="8657689">(</span><span class="ident" id="8657690">d</span>&nbsp;<span class="op" id="8657692">*</span><span class="ident" id="8657693">downCaser</span><span class="op" id="8657702">)</span>&nbsp;<span class="ident" id="8657704">Read</span><span class="op" id="8657708">(</span><span class="ident" id="8657709">p</span>&nbsp;<span class="op" id="8657711">[</span><span class="op" id="8657712">]</span><span class="builtintype" id="8657713">byte</span><span class="op" id="8657717">)</span>&nbsp;<span class="op" id="8657719">(</span><span class="builtintype" id="8657720">int</span><span class="op" id="8657723">,</span>&nbsp;<span class="builtintype" id="8657725">error</span><span class="op" id="8657730">)</span>&nbsp;<span class="op" id="8657732">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8657735">d</span><span class="op" id="8657736">.</span><span class="ident" id="8657737">t</span><span class="op" id="8657738">.</span><span class="ident" id="8657739">Fatalf</span><span class="op" id="8657745">(</span><span class="string" id="8657746">&#34;unexpected&nbsp;Read&nbsp;call&nbsp;on&nbsp;downCaser&nbsp;reader&#34;</span><span class="op" id="8657788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8657791">panic</span><span class="op" id="8657796">(</span><span class="string" id="8657797">&#34;unreachable&#34;</span><span class="op" id="8657810">)</span><br>
<span class="lineno"></span><span class="op" id="8657812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8657815">func</span>&nbsp;<span class="ident" id="8657820">TestRawTokenAltEncoding</span><span class="op" id="8657843">(</span><span class="ident" id="8657844">t</span>&nbsp;<span class="op" id="8657846">*</span><span class="ident" id="8657847">testing</span><span class="op" id="8657854">.</span><span class="ident" id="8657855">T</span><span class="op" id="8657856">)</span>&nbsp;<span class="op" id="8657858">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8657861">d</span>&nbsp;<span class="op" id="8657863">:=</span>&nbsp;<span class="ident" id="8657866">NewDecoder</span><span class="op" id="8657876">(</span><span class="ident" id="8657877">strings</span><span class="op" id="8657884">.</span><span class="ident" id="8657885">NewReader</span><span class="op" id="8657894">(</span><span class="ident" id="8657895">testInputAltEncoding</span><span class="op" id="8657915">)</span><span class="op" id="8657916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8657919">d</span><span class="op" id="8657920">.</span><span class="ident" id="8657921">CharsetReader</span>&nbsp;<span class="op" id="8657935">=</span>&nbsp;<span class="keyword" id="8657937">func</span><span class="op" id="8657941">(</span><span class="ident" id="8657942">charset</span>&nbsp;<span class="builtintype" id="8657950">string</span><span class="op" id="8657956">,</span>&nbsp;<span class="ident" id="8657958">input</span>&nbsp;<span class="ident" id="8657964">io</span><span class="op" id="8657966">.</span><span class="ident" id="8657967">Reader</span><span class="op" id="8657973">)</span>&nbsp;<span class="op" id="8657975">(</span><span class="ident" id="8657976">io</span><span class="op" id="8657978">.</span><span class="ident" id="8657979">Reader</span><span class="op" id="8657985">,</span>&nbsp;<span class="builtintype" id="8657987">error</span><span class="op" id="8657992">)</span>&nbsp;<span class="op" id="8657994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8657998">if</span>&nbsp;<span class="ident" id="8658001">charset</span>&nbsp;<span class="op" id="8658009">!=</span>&nbsp;<span class="string" id="8658012">&#34;x-testing-uppercase&#34;</span>&nbsp;<span class="op" id="8658034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8658039">t</span><span class="op" id="8658040">.</span><span class="ident" id="8658041">Fatalf</span><span class="op" id="8658047">(</span><span class="string" id="8658048">&#34;unexpected&nbsp;charset&nbsp;%q&#34;</span><span class="op" id="8658071">,</span>&nbsp;<span class="ident" id="8658073">charset</span><span class="op" id="8658080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8658084">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8658088">return</span>&nbsp;<span class="op" id="8658095">&amp;</span><span class="ident" id="8658096">downCaser</span><span class="op" id="8658105">{</span><span class="ident" id="8658106">t</span><span class="op" id="8658107">,</span>&nbsp;<span class="ident" id="8658109">input</span><span class="op" id="8658114">.</span><span class="op" id="8658115">(</span><span class="ident" id="8658116">io</span><span class="op" id="8658118">.</span><span class="ident" id="8658119">ByteReader</span><span class="op" id="8658129">)</span><span class="op" id="8658130">}</span><span class="op" id="8658131">,</span>&nbsp;<span class="ident" id="8658133">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8658138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8658141">testRawToken</span><span class="op" id="8658153">(</span><span class="ident" id="8658154">t</span><span class="op" id="8658155">,</span>&nbsp;<span class="ident" id="8658157">d</span><span class="op" id="8658158">,</span>&nbsp;<span class="ident" id="8658160">testInputAltEncoding</span><span class="op" id="8658180">,</span>&nbsp;<span class="ident" id="8658182">rawTokensAltEncoding</span><span class="op" id="8658202">)</span><br>
<span class="lineno"></span><span class="op" id="8658204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="8658207">func</span>&nbsp;<span class="ident" id="8658212">TestRawTokenAltEncodingNoConverter</span><span class="op" id="8658246">(</span><span class="ident" id="8658247">t</span>&nbsp;<span class="op" id="8658249">*</span><span class="ident" id="8658250">testing</span><span class="op" id="8658257">.</span><span class="ident" id="8658258">T</span><span class="op" id="8658259">)</span>&nbsp;<span class="op" id="8658261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8658264">d</span>&nbsp;<span class="op" id="8658266">:=</span>&nbsp;<span class="ident" id="8658269">NewDecoder</span><span class="op" id="8658279">(</span><span class="ident" id="8658280">strings</span><span class="op" id="8658287">.</span><span class="ident" id="8658288">NewReader</span><span class="op" id="8658297">(</span><span class="ident" id="8658298">testInputAltEncoding</span><span class="op" id="8658318">)</span><span class="op" id="8658319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8658322">token</span><span class="op" id="8658327">,</span>&nbsp;<span class="ident" id="8658329">err</span>&nbsp;<span class="op" id="8658333">:=</span>&nbsp;<span class="ident" id="8658336">d</span><span class="op" id="8658337">.</span><span class="ident" id="8658338">RawToken</span><span class="op" id="8658346">(</span><span class="op" id="8658347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8658350">if</span>&nbsp;<span class="ident" id="8658353">token</span>&nbsp;<span class="op" id="8658359">==</span>&nbsp;<span class="ident" id="8658362">nil</span>&nbsp;<span class="op" id="8658366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8658370">t</span><span class="op" id="8658371">.</span><span class="ident" id="8658372">Fatalf</span><span class="op" id="8658378">(</span><span class="string" id="8658379">&#34;expected&nbsp;a&nbsp;token&nbsp;on&nbsp;first&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="8658420">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8658423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8658426">if</span>&nbsp;<span class="ident" id="8658429">err</span>&nbsp;<span class="op" id="8658433">!=</span>&nbsp;<span class="ident" id="8658436">nil</span>&nbsp;<span class="op" id="8658440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8658444">t</span><span class="op" id="8658445">.</span><span class="ident" id="8658446">Fatal</span><span class="op" id="8658451">(</span><span class="ident" id="8658452">err</span><span class="op" id="8658455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8658458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8658461">token</span><span class="op" id="8658466">,</span>&nbsp;<span class="ident" id="8658468">err</span>&nbsp;<span class="op" id="8658472">=</span>&nbsp;<span class="ident" id="8658474">d</span><span class="op" id="8658475">.</span><span class="ident" id="8658476">RawToken</span><span class="op" id="8658484">(</span><span class="op" id="8658485">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8658488">if</span>&nbsp;<span class="ident" id="8658491">token</span>&nbsp;<span class="op" id="8658497">!=</span>&nbsp;<span class="ident" id="8658500">nil</span>&nbsp;<span class="op" id="8658504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8658508">t</span><span class="op" id="8658509">.</span><span class="ident" id="8658510">Errorf</span><span class="op" id="8658516">(</span><span class="string" id="8658517">&#34;expected&nbsp;a&nbsp;nil&nbsp;token;&nbsp;got&nbsp;%#v&#34;</span><span class="op" id="8658548">,</span>&nbsp;<span class="ident" id="8658550">token</span><span class="op" id="8658555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8658558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8658561">if</span>&nbsp;<span class="ident" id="8658564">err</span>&nbsp;<span class="op" id="8658568">==</span>&nbsp;<span class="ident" id="8658571">nil</span>&nbsp;<span class="op" id="8658575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8658579">t</span><span class="op" id="8658580">.</span><span class="ident" id="8658581">Fatalf</span><span class="op" id="8658587">(</span><span class="string" id="8658588">&#34;expected&nbsp;an&nbsp;error&nbsp;on&nbsp;second&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="8658631">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8658634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8658637">const</span>&nbsp;<span class="ident" id="8658643">encoding</span>&nbsp;<span class="op" id="8658652">=</span>&nbsp;<span class="string" id="8658654">&#34;x-testing-uppercase&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8658677">if</span>&nbsp;<span class="op" id="8658680">!</span><span class="ident" id="8658681">strings</span><span class="op" id="8658688">.</span><span class="ident" id="8658689">Contains</span><span class="op" id="8658697">(</span><span class="ident" id="8658698">err</span><span class="op" id="8658701">.</span><span class="ident" id="8658702">Error</span><span class="op" id="8658707">(</span><span class="op" id="8658708">)</span><span class="op" id="8658709">,</span>&nbsp;<span class="ident" id="8658711">encoding</span><span class="op" id="8658719">)</span>&nbsp;<span class="op" id="8658721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8658725">t</span><span class="op" id="8658726">.</span><span class="ident" id="8658727">Errorf</span><span class="op" id="8658733">(</span><span class="string" id="8658734">&#34;expected&nbsp;error&nbsp;to&nbsp;contain&nbsp;%q;&nbsp;got&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8658779">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8658784">encoding</span><span class="op" id="8658792">,</span>&nbsp;<span class="ident" id="8658794">err</span><span class="op" id="8658797">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8658800">}</span><br>
<span class="lineno"></span><span class="op" id="8658802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8658805">func</span>&nbsp;<span class="ident" id="8658810">testRawToken</span><span class="op" id="8658822">(</span><span class="ident" id="8658823">t</span>&nbsp;<span class="op" id="8658825">*</span><span class="ident" id="8658826">testing</span><span class="op" id="8658833">.</span><span class="ident" id="8658834">T</span><span class="op" id="8658835">,</span>&nbsp;<span class="ident" id="8658837">d</span>&nbsp;<span class="op" id="8658839">*</span><span class="ident" id="8658840">Decoder</span><span class="op" id="8658847">,</span>&nbsp;<span class="ident" id="8658849">raw</span>&nbsp;<span class="builtintype" id="8658853">string</span><span class="op" id="8658859">,</span>&nbsp;<span class="ident" id="8658861">rawTokens</span>&nbsp;<span class="op" id="8658871">[</span><span class="op" id="8658872">]</span><span class="ident" id="8658873">Token</span><span class="op" id="8658878">)</span>&nbsp;<span class="op" id="8658880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8658883">lastEnd</span>&nbsp;<span class="op" id="8658891">:=</span>&nbsp;<span class="ident" id="8658894">int64</span><span class="op" id="8658899">(</span><span class="num" id="8658900">0</span><span class="op" id="8658901">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8658904">for</span>&nbsp;<span class="ident" id="8658908">i</span><span class="op" id="8658909">,</span>&nbsp;<span class="ident" id="8658911">want</span>&nbsp;<span class="op" id="8658916">:=</span>&nbsp;<span class="keyword" id="8658919">range</span>&nbsp;<span class="ident" id="8658925">rawTokens</span>&nbsp;<span class="op" id="8658935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8658939">start</span>&nbsp;<span class="op" id="8658945">:=</span>&nbsp;<span class="ident" id="8658948">d</span><span class="op" id="8658949">.</span><span class="ident" id="8658950">InputOffset</span><span class="op" id="8658961">(</span><span class="op" id="8658962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8658966">have</span><span class="op" id="8658970">,</span>&nbsp;<span class="ident" id="8658972">err</span>&nbsp;<span class="op" id="8658976">:=</span>&nbsp;<span class="ident" id="8658979">d</span><span class="op" id="8658980">.</span><span class="ident" id="8658981">RawToken</span><span class="op" id="8658989">(</span><span class="op" id="8658990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8658994">end</span>&nbsp;<span class="op" id="8658998">:=</span>&nbsp;<span class="ident" id="8659001">d</span><span class="op" id="8659002">.</span><span class="ident" id="8659003">InputOffset</span><span class="op" id="8659014">(</span><span class="op" id="8659015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8659019">if</span>&nbsp;<span class="ident" id="8659022">err</span>&nbsp;<span class="op" id="8659026">!=</span>&nbsp;<span class="ident" id="8659029">nil</span>&nbsp;<span class="op" id="8659033">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8659038">t</span><span class="op" id="8659039">.</span><span class="ident" id="8659040">Fatalf</span><span class="op" id="8659046">(</span><span class="string" id="8659047">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8659079">,</span>&nbsp;<span class="ident" id="8659081">i</span><span class="op" id="8659082">,</span>&nbsp;<span class="ident" id="8659084">err</span><span class="op" id="8659087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8659091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8659095">if</span>&nbsp;<span class="op" id="8659098">!</span><span class="ident" id="8659099">reflect</span><span class="op" id="8659106">.</span><span class="ident" id="8659107">DeepEqual</span><span class="op" id="8659116">(</span><span class="ident" id="8659117">have</span><span class="op" id="8659121">,</span>&nbsp;<span class="ident" id="8659123">want</span><span class="op" id="8659127">)</span>&nbsp;<span class="op" id="8659129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8659134">var</span>&nbsp;<span class="ident" id="8659138">shave</span><span class="op" id="8659143">,</span>&nbsp;<span class="ident" id="8659145">swant</span>&nbsp;<span class="builtintype" id="8659151">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8659161">if</span>&nbsp;<span class="ident" id="8659164">_</span><span class="op" id="8659165">,</span>&nbsp;<span class="ident" id="8659167">ok</span>&nbsp;<span class="op" id="8659170">:=</span>&nbsp;<span class="ident" id="8659173">have</span><span class="op" id="8659177">.</span><span class="op" id="8659178">(</span><span class="ident" id="8659179">CharData</span><span class="op" id="8659187">)</span><span class="op" id="8659188">;</span>&nbsp;<span class="ident" id="8659190">ok</span>&nbsp;<span class="op" id="8659193">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8659199">shave</span>&nbsp;<span class="op" id="8659205">=</span>&nbsp;<span class="ident" id="8659207">fmt</span><span class="op" id="8659210">.</span><span class="ident" id="8659211">Sprintf</span><span class="op" id="8659218">(</span><span class="string" id="8659219">&#34;CharData(%q)&#34;</span><span class="op" id="8659233">,</span>&nbsp;<span class="ident" id="8659235">have</span><span class="op" id="8659239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8659244">}</span>&nbsp;<span class="keyword" id="8659246">else</span>&nbsp;<span class="op" id="8659251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8659257">shave</span>&nbsp;<span class="op" id="8659263">=</span>&nbsp;<span class="ident" id="8659265">fmt</span><span class="op" id="8659268">.</span><span class="ident" id="8659269">Sprintf</span><span class="op" id="8659276">(</span><span class="string" id="8659277">&#34;%#v&#34;</span><span class="op" id="8659282">,</span>&nbsp;<span class="ident" id="8659284">have</span><span class="op" id="8659288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8659293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8659298">if</span>&nbsp;<span class="ident" id="8659301">_</span><span class="op" id="8659302">,</span>&nbsp;<span class="ident" id="8659304">ok</span>&nbsp;<span class="op" id="8659307">:=</span>&nbsp;<span class="ident" id="8659310">want</span><span class="op" id="8659314">.</span><span class="op" id="8659315">(</span><span class="ident" id="8659316">CharData</span><span class="op" id="8659324">)</span><span class="op" id="8659325">;</span>&nbsp;<span class="ident" id="8659327">ok</span>&nbsp;<span class="op" id="8659330">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8659336">swant</span>&nbsp;<span class="op" id="8659342">=</span>&nbsp;<span class="ident" id="8659344">fmt</span><span class="op" id="8659347">.</span><span class="ident" id="8659348">Sprintf</span><span class="op" id="8659355">(</span><span class="string" id="8659356">&#34;CharData(%q)&#34;</span><span class="op" id="8659370">,</span>&nbsp;<span class="ident" id="8659372">want</span><span class="op" id="8659376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8659381">}</span>&nbsp;<span class="keyword" id="8659383">else</span>&nbsp;<span class="op" id="8659388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8659394">swant</span>&nbsp;<span class="op" id="8659400">=</span>&nbsp;<span class="ident" id="8659402">fmt</span><span class="op" id="8659405">.</span><span class="ident" id="8659406">Sprintf</span><span class="op" id="8659413">(</span><span class="string" id="8659414">&#34;%#v&#34;</span><span class="op" id="8659419">,</span>&nbsp;<span class="ident" id="8659421">want</span><span class="op" id="8659425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8659430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8659435">t</span><span class="op" id="8659436">.</span><span class="ident" id="8659437">Errorf</span><span class="op" id="8659443">(</span><span class="string" id="8659444">&#34;token&nbsp;%d&nbsp;=&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8659468">,</span>&nbsp;<span class="ident" id="8659470">i</span><span class="op" id="8659471">,</span>&nbsp;<span class="ident" id="8659473">shave</span><span class="op" id="8659478">,</span>&nbsp;<span class="ident" id="8659480">swant</span><span class="op" id="8659485">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8659489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8659494">//&nbsp;Check&nbsp;that&nbsp;InputOffset&nbsp;returned&nbsp;actual&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8659545">switch</span>&nbsp;<span class="op" id="8659552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8659556">case</span>&nbsp;<span class="ident" id="8659561">start</span>&nbsp;<span class="op" id="8659567">&lt;</span>&nbsp;<span class="ident" id="8659569">lastEnd</span><span class="op" id="8659576">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8659581">t</span><span class="op" id="8659582">.</span><span class="ident" id="8659583">Errorf</span><span class="op" id="8659589">(</span><span class="string" id="8659590">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;before&nbsp;previous&nbsp;token&#34;</span><span class="op" id="8659650">,</span>&nbsp;<span class="ident" id="8659652">i</span><span class="op" id="8659653">,</span>&nbsp;<span class="ident" id="8659655">start</span><span class="op" id="8659660">,</span>&nbsp;<span class="ident" id="8659662">end</span><span class="op" id="8659665">,</span>&nbsp;<span class="ident" id="8659667">have</span><span class="op" id="8659671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8659675">case</span>&nbsp;<span class="ident" id="8659680">start</span>&nbsp;<span class="op" id="8659686">&gt;=</span>&nbsp;<span class="ident" id="8659689">end</span><span class="op" id="8659692">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8659697">//&nbsp;Special&nbsp;case:&nbsp;EndElement&nbsp;can&nbsp;be&nbsp;synthesized.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8659748">if</span>&nbsp;<span class="ident" id="8659751">start</span>&nbsp;<span class="op" id="8659757">==</span>&nbsp;<span class="ident" id="8659760">end</span>&nbsp;<span class="op" id="8659764">&amp;&amp;</span>&nbsp;<span class="ident" id="8659767">end</span>&nbsp;<span class="op" id="8659771">==</span>&nbsp;<span class="ident" id="8659774">lastEnd</span>&nbsp;<span class="op" id="8659782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8659788">break</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8659797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8659802">t</span><span class="op" id="8659803">.</span><span class="ident" id="8659804">Errorf</span><span class="op" id="8659810">(</span><span class="string" id="8659811">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;empty&#34;</span><span class="op" id="8659855">,</span>&nbsp;<span class="ident" id="8659857">i</span><span class="op" id="8659858">,</span>&nbsp;<span class="ident" id="8659860">start</span><span class="op" id="8659865">,</span>&nbsp;<span class="ident" id="8659867">end</span><span class="op" id="8659870">,</span>&nbsp;<span class="ident" id="8659872">have</span><span class="op" id="8659876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8659880">case</span>&nbsp;<span class="ident" id="8659885">end</span>&nbsp;<span class="op" id="8659889">&gt;</span>&nbsp;<span class="ident" id="8659891">int64</span><span class="op" id="8659896">(</span><span class="builtinfunc" id="8659897">len</span><span class="op" id="8659900">(</span><span class="ident" id="8659901">raw</span><span class="op" id="8659904">)</span><span class="op" id="8659905">)</span><span class="op" id="8659906">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8659911">t</span><span class="op" id="8659912">.</span><span class="ident" id="8659913">Errorf</span><span class="op" id="8659919">(</span><span class="string" id="8659920">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;extends&nbsp;beyond&nbsp;input&#34;</span><span class="op" id="8659976">,</span>&nbsp;<span class="ident" id="8659978">i</span><span class="op" id="8659979">,</span>&nbsp;<span class="ident" id="8659981">start</span><span class="op" id="8659986">,</span>&nbsp;<span class="ident" id="8659988">end</span><span class="op" id="8659991">,</span>&nbsp;<span class="ident" id="8659993">have</span><span class="op" id="8659997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8660001">default</span><span class="op" id="8660008">:</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8660013">text</span>&nbsp;<span class="op" id="8660018">:=</span>&nbsp;<span class="ident" id="8660021">raw</span><span class="op" id="8660024">[</span><span class="ident" id="8660025">start</span><span class="op" id="8660030">:</span><span class="ident" id="8660031">end</span><span class="op" id="8660034">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8660039">if</span>&nbsp;<span class="ident" id="8660042">strings</span><span class="op" id="8660049">.</span><span class="ident" id="8660050">ContainsAny</span><span class="op" id="8660061">(</span><span class="ident" id="8660062">text</span><span class="op" id="8660066">,</span>&nbsp;<span class="string" id="8660068">&#34;&lt;&gt;&#34;</span><span class="op" id="8660072">)</span>&nbsp;<span class="op" id="8660074">&amp;&amp;</span>&nbsp;<span class="op" id="8660077">(</span><span class="op" id="8660078">!</span><span class="ident" id="8660079">strings</span><span class="op" id="8660086">.</span><span class="ident" id="8660087">HasPrefix</span><span class="op" id="8660096">(</span><span class="ident" id="8660097">text</span><span class="op" id="8660101">,</span>&nbsp;<span class="string" id="8660103">&#34;&lt;&#34;</span><span class="op" id="8660106">)</span>&nbsp;<span class="op" id="8660108">||</span>&nbsp;<span class="op" id="8660111">!</span><span class="ident" id="8660112">strings</span><span class="op" id="8660119">.</span><span class="ident" id="8660120">HasSuffix</span><span class="op" id="8660129">(</span><span class="ident" id="8660130">text</span><span class="op" id="8660134">,</span>&nbsp;<span class="string" id="8660136">&#34;&gt;&#34;</span><span class="op" id="8660139">)</span><span class="op" id="8660140">)</span>&nbsp;<span class="op" id="8660142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8660148">t</span><span class="op" id="8660149">.</span><span class="ident" id="8660150">Errorf</span><span class="op" id="8660156">(</span><span class="string" id="8660157">&#34;token&nbsp;%d:&nbsp;misaligned&nbsp;raw&nbsp;token&nbsp;%#q&nbsp;for&nbsp;%T&#34;</span><span class="op" id="8660200">,</span>&nbsp;<span class="ident" id="8660202">i</span><span class="op" id="8660203">,</span>&nbsp;<span class="ident" id="8660205">text</span><span class="op" id="8660209">,</span>&nbsp;<span class="ident" id="8660211">have</span><span class="op" id="8660215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8660220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8660224">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8660228">lastEnd</span>&nbsp;<span class="op" id="8660236">=</span>&nbsp;<span class="ident" id="8660238">end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8660243">}</span><br>
<span class="lineno"></span><span class="op" id="8660245">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8660248">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;(specifically&nbsp;!DOCTYPE)&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno">330</span><span class="comment" id="8660319">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives,&nbsp;noting&nbsp;that&nbsp;&lt;&nbsp;and&nbsp;&gt;&nbsp;do&nbsp;not&nbsp;change</span><br>
<span class="lineno"></span><span class="comment" id="8660387">//&nbsp;nesting&nbsp;depth&nbsp;if&nbsp;they&nbsp;are&nbsp;in&nbsp;single&nbsp;or&nbsp;double&nbsp;quotes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8660445">var</span>&nbsp;<span class="ident" id="8660449">nestedDirectivesInput</span>&nbsp;<span class="op" id="8660471">=</span>&nbsp;<span class="string" id="8660473">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno">335</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]&gt;<br>
<span class="lineno">340</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8660739">var</span>&nbsp;<span class="ident" id="8660743">nestedDirectivesTokens</span>&nbsp;<span class="op" id="8660766">=</span>&nbsp;<span class="op" id="8660768">[</span><span class="op" id="8660769">]</span><span class="ident" id="8660770">Token</span><span class="op" id="8660775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8660778">CharData</span><span class="op" id="8660786">(</span><span class="string" id="8660787">&#34;\n&#34;</span><span class="op" id="8660791">)</span><span class="op" id="8660792">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8660795">Directive</span><span class="op" id="8660804">(</span><span class="string" id="8660805">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="8660876">)</span><span class="op" id="8660877">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8660880">CharData</span><span class="op" id="8660888">(</span><span class="string" id="8660889">&#34;\n&#34;</span><span class="op" id="8660893">)</span><span class="op" id="8660894">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8660897">Directive</span><span class="op" id="8660906">(</span><span class="string" id="8660907">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]`</span><span class="op" id="8660936">)</span><span class="op" id="8660937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8660940">CharData</span><span class="op" id="8660948">(</span><span class="string" id="8660949">&#34;\n&#34;</span><span class="op" id="8660953">)</span><span class="op" id="8660954">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8660957">Directive</span><span class="op" id="8660966">(</span><span class="string" id="8660967">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]`</span><span class="op" id="8660996">)</span><span class="op" id="8660997">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8661000">CharData</span><span class="op" id="8661008">(</span><span class="string" id="8661009">&#34;\n&#34;</span><span class="op" id="8661013">)</span><span class="op" id="8661014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8661017">Directive</span><span class="op" id="8661026">(</span><span class="string" id="8661027">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]`</span><span class="op" id="8661056">)</span><span class="op" id="8661057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8661060">CharData</span><span class="op" id="8661068">(</span><span class="string" id="8661069">&#34;\n&#34;</span><span class="op" id="8661073">)</span><span class="op" id="8661074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8661077">Directive</span><span class="op" id="8661086">(</span><span class="string" id="8661087">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]`</span><span class="op" id="8661116">)</span><span class="op" id="8661117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8661120">CharData</span><span class="op" id="8661128">(</span><span class="string" id="8661129">&#34;\n&#34;</span><span class="op" id="8661133">)</span><span class="op" id="8661134">,</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8661137">Directive</span><span class="op" id="8661146">(</span><span class="string" id="8661147">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]`</span><span class="op" id="8661177">)</span><span class="op" id="8661178">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8661181">CharData</span><span class="op" id="8661189">(</span><span class="string" id="8661190">&#34;\n&#34;</span><span class="op" id="8661194">)</span><span class="op" id="8661195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8661198">Directive</span><span class="op" id="8661207">(</span><span class="string" id="8661208">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]`</span><span class="op" id="8661238">)</span><span class="op" id="8661239">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8661242">CharData</span><span class="op" id="8661250">(</span><span class="string" id="8661251">&#34;\n&#34;</span><span class="op" id="8661255">)</span><span class="op" id="8661256">,</span><br>
<span class="lineno"></span><span class="op" id="8661258">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="8661261">func</span>&nbsp;<span class="ident" id="8661266">TestNestedDirectives</span><span class="op" id="8661286">(</span><span class="ident" id="8661287">t</span>&nbsp;<span class="op" id="8661289">*</span><span class="ident" id="8661290">testing</span><span class="op" id="8661297">.</span><span class="ident" id="8661298">T</span><span class="op" id="8661299">)</span>&nbsp;<span class="op" id="8661301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8661304">d</span>&nbsp;<span class="op" id="8661306">:=</span>&nbsp;<span class="ident" id="8661309">NewDecoder</span><span class="op" id="8661319">(</span><span class="ident" id="8661320">strings</span><span class="op" id="8661327">.</span><span class="ident" id="8661328">NewReader</span><span class="op" id="8661337">(</span><span class="ident" id="8661338">nestedDirectivesInput</span><span class="op" id="8661359">)</span><span class="op" id="8661360">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8661364">for</span>&nbsp;<span class="ident" id="8661368">i</span><span class="op" id="8661369">,</span>&nbsp;<span class="ident" id="8661371">want</span>&nbsp;<span class="op" id="8661376">:=</span>&nbsp;<span class="keyword" id="8661379">range</span>&nbsp;<span class="ident" id="8661385">nestedDirectivesTokens</span>&nbsp;<span class="op" id="8661408">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8661412">have</span><span class="op" id="8661416">,</span>&nbsp;<span class="ident" id="8661418">err</span>&nbsp;<span class="op" id="8661422">:=</span>&nbsp;<span class="ident" id="8661425">d</span><span class="op" id="8661426">.</span><span class="ident" id="8661427">Token</span><span class="op" id="8661432">(</span><span class="op" id="8661433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8661437">if</span>&nbsp;<span class="ident" id="8661440">err</span>&nbsp;<span class="op" id="8661444">!=</span>&nbsp;<span class="ident" id="8661447">nil</span>&nbsp;<span class="op" id="8661451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8661456">t</span><span class="op" id="8661457">.</span><span class="ident" id="8661458">Fatalf</span><span class="op" id="8661464">(</span><span class="string" id="8661465">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8661497">,</span>&nbsp;<span class="ident" id="8661499">i</span><span class="op" id="8661500">,</span>&nbsp;<span class="ident" id="8661502">err</span><span class="op" id="8661505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8661509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8661513">if</span>&nbsp;<span class="op" id="8661516">!</span><span class="ident" id="8661517">reflect</span><span class="op" id="8661524">.</span><span class="ident" id="8661525">DeepEqual</span><span class="op" id="8661534">(</span><span class="ident" id="8661535">have</span><span class="op" id="8661539">,</span>&nbsp;<span class="ident" id="8661541">want</span><span class="op" id="8661545">)</span>&nbsp;<span class="op" id="8661547">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8661552">t</span><span class="op" id="8661553">.</span><span class="ident" id="8661554">Errorf</span><span class="op" id="8661560">(</span><span class="string" id="8661561">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="8661586">,</span>&nbsp;<span class="ident" id="8661588">i</span><span class="op" id="8661589">,</span>&nbsp;<span class="ident" id="8661591">have</span><span class="op" id="8661595">,</span>&nbsp;<span class="ident" id="8661597">want</span><span class="op" id="8661601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8661605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8661608">}</span><br>
<span class="lineno"></span><span class="op" id="8661610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="keyword" id="8661613">func</span>&nbsp;<span class="ident" id="8661618">TestToken</span><span class="op" id="8661627">(</span><span class="ident" id="8661628">t</span>&nbsp;<span class="op" id="8661630">*</span><span class="ident" id="8661631">testing</span><span class="op" id="8661638">.</span><span class="ident" id="8661639">T</span><span class="op" id="8661640">)</span>&nbsp;<span class="op" id="8661642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8661645">d</span>&nbsp;<span class="op" id="8661647">:=</span>&nbsp;<span class="ident" id="8661650">NewDecoder</span><span class="op" id="8661660">(</span><span class="ident" id="8661661">strings</span><span class="op" id="8661668">.</span><span class="ident" id="8661669">NewReader</span><span class="op" id="8661678">(</span><span class="ident" id="8661679">testInput</span><span class="op" id="8661688">)</span><span class="op" id="8661689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8661692">d</span><span class="op" id="8661693">.</span><span class="ident" id="8661694">Entity</span>&nbsp;<span class="op" id="8661701">=</span>&nbsp;<span class="ident" id="8661703">testEntity</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8661716">for</span>&nbsp;<span class="ident" id="8661720">i</span><span class="op" id="8661721">,</span>&nbsp;<span class="ident" id="8661723">want</span>&nbsp;<span class="op" id="8661728">:=</span>&nbsp;<span class="keyword" id="8661731">range</span>&nbsp;<span class="ident" id="8661737">cookedTokens</span>&nbsp;<span class="op" id="8661750">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8661754">have</span><span class="op" id="8661758">,</span>&nbsp;<span class="ident" id="8661760">err</span>&nbsp;<span class="op" id="8661764">:=</span>&nbsp;<span class="ident" id="8661767">d</span><span class="op" id="8661768">.</span><span class="ident" id="8661769">Token</span><span class="op" id="8661774">(</span><span class="op" id="8661775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8661779">if</span>&nbsp;<span class="ident" id="8661782">err</span>&nbsp;<span class="op" id="8661786">!=</span>&nbsp;<span class="ident" id="8661789">nil</span>&nbsp;<span class="op" id="8661793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8661798">t</span><span class="op" id="8661799">.</span><span class="ident" id="8661800">Fatalf</span><span class="op" id="8661806">(</span><span class="string" id="8661807">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8661839">,</span>&nbsp;<span class="ident" id="8661841">i</span><span class="op" id="8661842">,</span>&nbsp;<span class="ident" id="8661844">err</span><span class="op" id="8661847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8661851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8661855">if</span>&nbsp;<span class="op" id="8661858">!</span><span class="ident" id="8661859">reflect</span><span class="op" id="8661866">.</span><span class="ident" id="8661867">DeepEqual</span><span class="op" id="8661876">(</span><span class="ident" id="8661877">have</span><span class="op" id="8661881">,</span>&nbsp;<span class="ident" id="8661883">want</span><span class="op" id="8661887">)</span>&nbsp;<span class="op" id="8661889">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8661894">t</span><span class="op" id="8661895">.</span><span class="ident" id="8661896">Errorf</span><span class="op" id="8661902">(</span><span class="string" id="8661903">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="8661928">,</span>&nbsp;<span class="ident" id="8661930">i</span><span class="op" id="8661931">,</span>&nbsp;<span class="ident" id="8661933">have</span><span class="op" id="8661937">,</span>&nbsp;<span class="ident" id="8661939">want</span><span class="op" id="8661943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8661947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8661950">}</span><br>
<span class="lineno"></span><span class="op" id="8661952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="keyword" id="8661955">func</span>&nbsp;<span class="ident" id="8661960">TestSyntax</span><span class="op" id="8661970">(</span><span class="ident" id="8661971">t</span>&nbsp;<span class="op" id="8661973">*</span><span class="ident" id="8661974">testing</span><span class="op" id="8661981">.</span><span class="ident" id="8661982">T</span><span class="op" id="8661983">)</span>&nbsp;<span class="op" id="8661985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8661988">for</span>&nbsp;<span class="ident" id="8661992">i</span>&nbsp;<span class="op" id="8661994">:=</span>&nbsp;<span class="keyword" id="8661997">range</span>&nbsp;<span class="ident" id="8662003">xmlInput</span>&nbsp;<span class="op" id="8662012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662016">d</span>&nbsp;<span class="op" id="8662018">:=</span>&nbsp;<span class="ident" id="8662021">NewDecoder</span><span class="op" id="8662031">(</span><span class="ident" id="8662032">strings</span><span class="op" id="8662039">.</span><span class="ident" id="8662040">NewReader</span><span class="op" id="8662049">(</span><span class="ident" id="8662050">xmlInput</span><span class="op" id="8662058">[</span><span class="ident" id="8662059">i</span><span class="op" id="8662060">]</span><span class="op" id="8662061">)</span><span class="op" id="8662062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8662066">var</span>&nbsp;<span class="ident" id="8662070">err</span>&nbsp;<span class="builtintype" id="8662074">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8662082">for</span>&nbsp;<span class="ident" id="8662086">_</span><span class="op" id="8662087">,</span>&nbsp;<span class="ident" id="8662089">err</span>&nbsp;<span class="op" id="8662093">=</span>&nbsp;<span class="ident" id="8662095">d</span><span class="op" id="8662096">.</span><span class="ident" id="8662097">Token</span><span class="op" id="8662102">(</span><span class="op" id="8662103">)</span><span class="op" id="8662104">;</span>&nbsp;<span class="ident" id="8662106">err</span>&nbsp;<span class="op" id="8662110">==</span>&nbsp;<span class="ident" id="8662113">nil</span><span class="op" id="8662116">;</span>&nbsp;<span class="ident" id="8662118">_</span><span class="op" id="8662119">,</span>&nbsp;<span class="ident" id="8662121">err</span>&nbsp;<span class="op" id="8662125">=</span>&nbsp;<span class="ident" id="8662127">d</span><span class="op" id="8662128">.</span><span class="ident" id="8662129">Token</span><span class="op" id="8662134">(</span><span class="op" id="8662135">)</span>&nbsp;<span class="op" id="8662137">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8662141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8662145">if</span>&nbsp;<span class="ident" id="8662148">_</span><span class="op" id="8662149">,</span>&nbsp;<span class="ident" id="8662151">ok</span>&nbsp;<span class="op" id="8662154">:=</span>&nbsp;<span class="ident" id="8662157">err</span><span class="op" id="8662160">.</span><span class="op" id="8662161">(</span><span class="op" id="8662162">*</span><span class="ident" id="8662163">SyntaxError</span><span class="op" id="8662174">)</span><span class="op" id="8662175">;</span>&nbsp;<span class="op" id="8662177">!</span><span class="ident" id="8662178">ok</span>&nbsp;<span class="op" id="8662181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662186">t</span><span class="op" id="8662187">.</span><span class="ident" id="8662188">Fatalf</span><span class="op" id="8662194">(</span><span class="string" id="8662195">`xmlInput&nbsp;&#34;%s&#34;:&nbsp;expected&nbsp;SyntaxError&nbsp;not&nbsp;received`</span><span class="op" id="8662245">,</span>&nbsp;<span class="ident" id="8662247">xmlInput</span><span class="op" id="8662255">[</span><span class="ident" id="8662256">i</span><span class="op" id="8662257">]</span><span class="op" id="8662258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8662262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8662265">}</span><br>
<span class="lineno">400</span><span class="op" id="8662267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8662270">type</span>&nbsp;<span class="ident" id="8662275">allScalars</span>&nbsp;<span class="keyword" id="8662286">struct</span>&nbsp;<span class="op" id="8662293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662296">True1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8662306">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662312">True2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8662322">bool</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662328">False1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8662338">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662344">False2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8662354">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662360">Int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8662370">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662375">Int8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8662385">int8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662391">Int16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8662401">int16</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662408">Int32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8662418">int32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662425">Int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8662435">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662442">Uint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8662452">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662457">Uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8662467">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662474">Uint16</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8662484">uint16</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662492">Uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8662502">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662510">Uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8662520">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662528">Uintptr</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8662538">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662547">Float32</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8662557">float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662566">Float64</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8662576">float64</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662585">String</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8662595">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662603">PtrString</span>&nbsp;<span class="op" id="8662613">*</span><span class="builtintype" id="8662614">string</span><br>
<span class="lineno"></span><span class="op" id="8662621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8662624">var</span>&nbsp;<span class="ident" id="8662628">all</span>&nbsp;<span class="op" id="8662632">=</span>&nbsp;<span class="ident" id="8662634">allScalars</span><span class="op" id="8662644">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662647">True1</span><span class="op" id="8662652">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8662658">true</span><span class="op" id="8662662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662665">True2</span><span class="op" id="8662670">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8662676">true</span><span class="op" id="8662680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662683">False1</span><span class="op" id="8662689">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8662694">false</span><span class="op" id="8662699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662702">False2</span><span class="op" id="8662708">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8662713">false</span><span class="op" id="8662718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662721">Int</span><span class="op" id="8662724">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8662732">1</span><span class="op" id="8662733">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662736">Int8</span><span class="op" id="8662740">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8662747">-</span><span class="num" id="8662748">2</span><span class="op" id="8662749">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662752">Int16</span><span class="op" id="8662757">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8662763">3</span><span class="op" id="8662764">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662767">Int32</span><span class="op" id="8662772">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8662778">-</span><span class="num" id="8662779">4</span><span class="op" id="8662780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662783">Int64</span><span class="op" id="8662788">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8662794">5</span><span class="op" id="8662795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662798">Uint</span><span class="op" id="8662802">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8662809">6</span><span class="op" id="8662810">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662813">Uint8</span><span class="op" id="8662818">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8662824">7</span><span class="op" id="8662825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662828">Uint16</span><span class="op" id="8662834">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8662839">8</span><span class="op" id="8662840">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662843">Uint32</span><span class="op" id="8662849">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8662854">9</span><span class="op" id="8662855">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662858">Uint64</span><span class="op" id="8662864">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8662869">10</span><span class="op" id="8662871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662874">Uintptr</span><span class="op" id="8662881">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8662885">11</span><span class="op" id="8662887">,</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662890">Float32</span><span class="op" id="8662897">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8662901">13.0</span><span class="op" id="8662905">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662908">Float64</span><span class="op" id="8662915">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="8662919">14.0</span><span class="op" id="8662923">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662926">String</span><span class="op" id="8662932">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8662937">&#34;15&#34;</span><span class="op" id="8662941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8662944">PtrString</span><span class="op" id="8662953">:</span>&nbsp;<span class="op" id="8662955">&amp;</span><span class="ident" id="8662956">sixteen</span><span class="op" id="8662963">,</span><br>
<span class="lineno"></span><span class="op" id="8662965">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="8662968">var</span>&nbsp;<span class="ident" id="8662972">sixteen</span>&nbsp;<span class="op" id="8662980">=</span>&nbsp;<span class="string" id="8662982">&#34;16&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8662988">const</span>&nbsp;<span class="ident" id="8662994">testScalarsInput</span>&nbsp;<span class="op" id="8663011">=</span>&nbsp;<span class="string" id="8663013">`&lt;allscalars&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;True1&gt;true&lt;/True1&gt;<br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;True2&gt;1&lt;/True2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;False1&gt;false&lt;/False1&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;False2&gt;0&lt;/False2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int&gt;1&lt;/Int&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int8&gt;-2&lt;/Int8&gt;<br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int16&gt;3&lt;/Int16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int32&gt;-4&lt;/Int32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int64&gt;5&lt;/Int64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint&gt;6&lt;/Uint&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint8&gt;7&lt;/Uint8&gt;<br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint16&gt;8&lt;/Uint16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint32&gt;9&lt;/Uint32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint64&gt;10&lt;/Uint64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uintptr&gt;11&lt;/Uintptr&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float&gt;12.0&lt;/Float&gt;<br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float32&gt;13.0&lt;/Float32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float64&gt;14.0&lt;/Float64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;String&gt;15&lt;/String&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;PtrString&gt;16&lt;/PtrString&gt;<br>
<span class="lineno"></span>&lt;/allscalars&gt;`</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="keyword" id="8663449">func</span>&nbsp;<span class="ident" id="8663454">TestAllScalars</span><span class="op" id="8663468">(</span><span class="ident" id="8663469">t</span>&nbsp;<span class="op" id="8663471">*</span><span class="ident" id="8663472">testing</span><span class="op" id="8663479">.</span><span class="ident" id="8663480">T</span><span class="op" id="8663481">)</span>&nbsp;<span class="op" id="8663483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8663486">var</span>&nbsp;<span class="ident" id="8663490">a</span>&nbsp;<span class="ident" id="8663492">allScalars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8663504">err</span>&nbsp;<span class="op" id="8663508">:=</span>&nbsp;<span class="ident" id="8663511">Unmarshal</span><span class="op" id="8663520">(</span><span class="op" id="8663521">[</span><span class="op" id="8663522">]</span><span class="builtintype" id="8663523">byte</span><span class="op" id="8663527">(</span><span class="ident" id="8663528">testScalarsInput</span><span class="op" id="8663544">)</span><span class="op" id="8663545">,</span>&nbsp;<span class="op" id="8663547">&amp;</span><span class="ident" id="8663548">a</span><span class="op" id="8663549">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8663553">if</span>&nbsp;<span class="ident" id="8663556">err</span>&nbsp;<span class="op" id="8663560">!=</span>&nbsp;<span class="ident" id="8663563">nil</span>&nbsp;<span class="op" id="8663567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8663571">t</span><span class="op" id="8663572">.</span><span class="ident" id="8663573">Fatal</span><span class="op" id="8663578">(</span><span class="ident" id="8663579">err</span><span class="op" id="8663582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8663585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8663588">if</span>&nbsp;<span class="op" id="8663591">!</span><span class="ident" id="8663592">reflect</span><span class="op" id="8663599">.</span><span class="ident" id="8663600">DeepEqual</span><span class="op" id="8663609">(</span><span class="ident" id="8663610">a</span><span class="op" id="8663611">,</span>&nbsp;<span class="ident" id="8663613">all</span><span class="op" id="8663616">)</span>&nbsp;<span class="op" id="8663618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8663622">t</span><span class="op" id="8663623">.</span><span class="ident" id="8663624">Errorf</span><span class="op" id="8663630">(</span><span class="string" id="8663631">&#34;have&nbsp;%+v&nbsp;want&nbsp;%+v&#34;</span><span class="op" id="8663650">,</span>&nbsp;<span class="ident" id="8663652">a</span><span class="op" id="8663653">,</span>&nbsp;<span class="ident" id="8663655">all</span><span class="op" id="8663658">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8663661">}</span><br>
<span class="lineno"></span><span class="op" id="8663663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8663666">type</span>&nbsp;<span class="ident" id="8663671">item</span>&nbsp;<span class="keyword" id="8663676">struct</span>&nbsp;<span class="op" id="8663683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8663686">Field_a</span>&nbsp;<span class="builtintype" id="8663694">string</span><br>
<span class="lineno">485</span><span class="op" id="8663701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8663704">func</span>&nbsp;<span class="ident" id="8663709">TestIssue569</span><span class="op" id="8663721">(</span><span class="ident" id="8663722">t</span>&nbsp;<span class="op" id="8663724">*</span><span class="ident" id="8663725">testing</span><span class="op" id="8663732">.</span><span class="ident" id="8663733">T</span><span class="op" id="8663734">)</span>&nbsp;<span class="op" id="8663736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8663739">data</span>&nbsp;<span class="op" id="8663744">:=</span>&nbsp;<span class="string" id="8663747">`&lt;item&gt;&lt;Field_a&gt;abcd&lt;/Field_a&gt;&lt;/item&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8663787">var</span>&nbsp;<span class="ident" id="8663791">i</span>&nbsp;<span class="ident" id="8663793">item</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8663799">err</span>&nbsp;<span class="op" id="8663803">:=</span>&nbsp;<span class="ident" id="8663806">Unmarshal</span><span class="op" id="8663815">(</span><span class="op" id="8663816">[</span><span class="op" id="8663817">]</span><span class="builtintype" id="8663818">byte</span><span class="op" id="8663822">(</span><span class="ident" id="8663823">data</span><span class="op" id="8663827">)</span><span class="op" id="8663828">,</span>&nbsp;<span class="op" id="8663830">&amp;</span><span class="ident" id="8663831">i</span><span class="op" id="8663832">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8663836">if</span>&nbsp;<span class="ident" id="8663839">err</span>&nbsp;<span class="op" id="8663843">!=</span>&nbsp;<span class="ident" id="8663846">nil</span>&nbsp;<span class="op" id="8663850">||</span>&nbsp;<span class="ident" id="8663853">i</span><span class="op" id="8663854">.</span><span class="ident" id="8663855">Field_a</span>&nbsp;<span class="op" id="8663863">!=</span>&nbsp;<span class="string" id="8663866">&#34;abcd&#34;</span>&nbsp;<span class="op" id="8663873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8663877">t</span><span class="op" id="8663878">.</span><span class="ident" id="8663879">Fatal</span><span class="op" id="8663884">(</span><span class="string" id="8663885">&#34;Expecting&nbsp;abcd&#34;</span><span class="op" id="8663901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8663904">}</span><br>
<span class="lineno">495</span><span class="op" id="8663906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8663909">func</span>&nbsp;<span class="ident" id="8663914">TestUnquotedAttrs</span><span class="op" id="8663931">(</span><span class="ident" id="8663932">t</span>&nbsp;<span class="op" id="8663934">*</span><span class="ident" id="8663935">testing</span><span class="op" id="8663942">.</span><span class="ident" id="8663943">T</span><span class="op" id="8663944">)</span>&nbsp;<span class="op" id="8663946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8663949">data</span>&nbsp;<span class="op" id="8663954">:=</span>&nbsp;<span class="string" id="8663957">&#34;&lt;tag&nbsp;attr=azAZ09:-_\t&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8663983">d</span>&nbsp;<span class="op" id="8663985">:=</span>&nbsp;<span class="ident" id="8663988">NewDecoder</span><span class="op" id="8663998">(</span><span class="ident" id="8663999">strings</span><span class="op" id="8664006">.</span><span class="ident" id="8664007">NewReader</span><span class="op" id="8664016">(</span><span class="ident" id="8664017">data</span><span class="op" id="8664021">)</span><span class="op" id="8664022">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8664025">d</span><span class="op" id="8664026">.</span><span class="ident" id="8664027">Strict</span>&nbsp;<span class="op" id="8664034">=</span>&nbsp;<span class="builtintype" id="8664036">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8664043">token</span><span class="op" id="8664048">,</span>&nbsp;<span class="ident" id="8664050">err</span>&nbsp;<span class="op" id="8664054">:=</span>&nbsp;<span class="ident" id="8664057">d</span><span class="op" id="8664058">.</span><span class="ident" id="8664059">Token</span><span class="op" id="8664064">(</span><span class="op" id="8664065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8664068">if</span>&nbsp;<span class="ident" id="8664071">_</span><span class="op" id="8664072">,</span>&nbsp;<span class="ident" id="8664074">ok</span>&nbsp;<span class="op" id="8664077">:=</span>&nbsp;<span class="ident" id="8664080">err</span><span class="op" id="8664083">.</span><span class="op" id="8664084">(</span><span class="op" id="8664085">*</span><span class="ident" id="8664086">SyntaxError</span><span class="op" id="8664097">)</span><span class="op" id="8664098">;</span>&nbsp;<span class="ident" id="8664100">ok</span>&nbsp;<span class="op" id="8664103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8664107">t</span><span class="op" id="8664108">.</span><span class="ident" id="8664109">Errorf</span><span class="op" id="8664115">(</span><span class="string" id="8664116">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8664138">,</span>&nbsp;<span class="ident" id="8664140">err</span><span class="op" id="8664143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8664146">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8664149">if</span>&nbsp;<span class="ident" id="8664152">token</span><span class="op" id="8664157">.</span><span class="op" id="8664158">(</span><span class="ident" id="8664159">StartElement</span><span class="op" id="8664171">)</span><span class="op" id="8664172">.</span><span class="ident" id="8664173">Name</span><span class="op" id="8664177">.</span><span class="ident" id="8664178">Local</span>&nbsp;<span class="op" id="8664184">!=</span>&nbsp;<span class="string" id="8664187">&#34;tag&#34;</span>&nbsp;<span class="op" id="8664193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8664197">t</span><span class="op" id="8664198">.</span><span class="ident" id="8664199">Errorf</span><span class="op" id="8664205">(</span><span class="string" id="8664206">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="8664231">,</span>&nbsp;<span class="ident" id="8664233">token</span><span class="op" id="8664238">.</span><span class="op" id="8664239">(</span><span class="ident" id="8664240">StartElement</span><span class="op" id="8664252">)</span><span class="op" id="8664253">.</span><span class="ident" id="8664254">Name</span><span class="op" id="8664258">.</span><span class="ident" id="8664259">Local</span><span class="op" id="8664264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8664267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8664270">attr</span>&nbsp;<span class="op" id="8664275">:=</span>&nbsp;<span class="ident" id="8664278">token</span><span class="op" id="8664283">.</span><span class="op" id="8664284">(</span><span class="ident" id="8664285">StartElement</span><span class="op" id="8664297">)</span><span class="op" id="8664298">.</span><span class="ident" id="8664299">Attr</span><span class="op" id="8664303">[</span><span class="num" id="8664304">0</span><span class="op" id="8664305">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8664308">if</span>&nbsp;<span class="ident" id="8664311">attr</span><span class="op" id="8664315">.</span><span class="ident" id="8664316">Value</span>&nbsp;<span class="op" id="8664322">!=</span>&nbsp;<span class="string" id="8664325">&#34;azAZ09:-_&#34;</span>&nbsp;<span class="op" id="8664337">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8664341">t</span><span class="op" id="8664342">.</span><span class="ident" id="8664343">Errorf</span><span class="op" id="8664349">(</span><span class="string" id="8664350">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="8664382">,</span>&nbsp;<span class="ident" id="8664384">attr</span><span class="op" id="8664388">.</span><span class="ident" id="8664389">Value</span><span class="op" id="8664394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8664397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8664400">if</span>&nbsp;<span class="ident" id="8664403">attr</span><span class="op" id="8664407">.</span><span class="ident" id="8664408">Name</span><span class="op" id="8664412">.</span><span class="ident" id="8664413">Local</span>&nbsp;<span class="op" id="8664419">!=</span>&nbsp;<span class="string" id="8664422">&#34;attr&#34;</span>&nbsp;<span class="op" id="8664429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8664433">t</span><span class="op" id="8664434">.</span><span class="ident" id="8664435">Errorf</span><span class="op" id="8664441">(</span><span class="string" id="8664442">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="8664473">,</span>&nbsp;<span class="ident" id="8664475">attr</span><span class="op" id="8664479">.</span><span class="ident" id="8664480">Name</span><span class="op" id="8664484">.</span><span class="ident" id="8664485">Local</span><span class="op" id="8664490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8664493">}</span><br>
<span class="lineno">515</span><span class="op" id="8664495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8664498">func</span>&nbsp;<span class="ident" id="8664503">TestValuelessAttrs</span><span class="op" id="8664521">(</span><span class="ident" id="8664522">t</span>&nbsp;<span class="op" id="8664524">*</span><span class="ident" id="8664525">testing</span><span class="op" id="8664532">.</span><span class="ident" id="8664533">T</span><span class="op" id="8664534">)</span>&nbsp;<span class="op" id="8664536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8664539">tests</span>&nbsp;<span class="op" id="8664545">:=</span>&nbsp;<span class="op" id="8664548">[</span><span class="op" id="8664549">]</span><span class="op" id="8664550">[</span><span class="num" id="8664551">3</span><span class="op" id="8664552">]</span><span class="builtintype" id="8664553">string</span><span class="op" id="8664559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8664563">{</span><span class="string" id="8664564">&#34;&lt;p&nbsp;nowrap&gt;&#34;</span><span class="op" id="8664576">,</span>&nbsp;<span class="string" id="8664578">&#34;p&#34;</span><span class="op" id="8664581">,</span>&nbsp;<span class="string" id="8664583">&#34;nowrap&#34;</span><span class="op" id="8664591">}</span><span class="op" id="8664592">,</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8664596">{</span><span class="string" id="8664597">&#34;&lt;p&nbsp;nowrap&nbsp;&gt;&#34;</span><span class="op" id="8664610">,</span>&nbsp;<span class="string" id="8664612">&#34;p&#34;</span><span class="op" id="8664615">,</span>&nbsp;<span class="string" id="8664617">&#34;nowrap&#34;</span><span class="op" id="8664625">}</span><span class="op" id="8664626">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8664630">{</span><span class="string" id="8664631">&#34;&lt;input&nbsp;checked/&gt;&#34;</span><span class="op" id="8664649">,</span>&nbsp;<span class="string" id="8664651">&#34;input&#34;</span><span class="op" id="8664658">,</span>&nbsp;<span class="string" id="8664660">&#34;checked&#34;</span><span class="op" id="8664669">}</span><span class="op" id="8664670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8664674">{</span><span class="string" id="8664675">&#34;&lt;input&nbsp;checked&nbsp;/&gt;&#34;</span><span class="op" id="8664694">,</span>&nbsp;<span class="string" id="8664696">&#34;input&#34;</span><span class="op" id="8664703">,</span>&nbsp;<span class="string" id="8664705">&#34;checked&#34;</span><span class="op" id="8664714">}</span><span class="op" id="8664715">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8664718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8664721">for</span>&nbsp;<span class="ident" id="8664725">_</span><span class="op" id="8664726">,</span>&nbsp;<span class="ident" id="8664728">test</span>&nbsp;<span class="op" id="8664733">:=</span>&nbsp;<span class="keyword" id="8664736">range</span>&nbsp;<span class="ident" id="8664742">tests</span>&nbsp;<span class="op" id="8664748">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8664752">d</span>&nbsp;<span class="op" id="8664754">:=</span>&nbsp;<span class="ident" id="8664757">NewDecoder</span><span class="op" id="8664767">(</span><span class="ident" id="8664768">strings</span><span class="op" id="8664775">.</span><span class="ident" id="8664776">NewReader</span><span class="op" id="8664785">(</span><span class="ident" id="8664786">test</span><span class="op" id="8664790">[</span><span class="num" id="8664791">0</span><span class="op" id="8664792">]</span><span class="op" id="8664793">)</span><span class="op" id="8664794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8664798">d</span><span class="op" id="8664799">.</span><span class="ident" id="8664800">Strict</span>&nbsp;<span class="op" id="8664807">=</span>&nbsp;<span class="builtintype" id="8664809">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8664817">token</span><span class="op" id="8664822">,</span>&nbsp;<span class="ident" id="8664824">err</span>&nbsp;<span class="op" id="8664828">:=</span>&nbsp;<span class="ident" id="8664831">d</span><span class="op" id="8664832">.</span><span class="ident" id="8664833">Token</span><span class="op" id="8664838">(</span><span class="op" id="8664839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8664843">if</span>&nbsp;<span class="ident" id="8664846">_</span><span class="op" id="8664847">,</span>&nbsp;<span class="ident" id="8664849">ok</span>&nbsp;<span class="op" id="8664852">:=</span>&nbsp;<span class="ident" id="8664855">err</span><span class="op" id="8664858">.</span><span class="op" id="8664859">(</span><span class="op" id="8664860">*</span><span class="ident" id="8664861">SyntaxError</span><span class="op" id="8664872">)</span><span class="op" id="8664873">;</span>&nbsp;<span class="ident" id="8664875">ok</span>&nbsp;<span class="op" id="8664878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8664883">t</span><span class="op" id="8664884">.</span><span class="ident" id="8664885">Errorf</span><span class="op" id="8664891">(</span><span class="string" id="8664892">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8664914">,</span>&nbsp;<span class="ident" id="8664916">err</span><span class="op" id="8664919">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8664923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8664927">if</span>&nbsp;<span class="ident" id="8664930">token</span><span class="op" id="8664935">.</span><span class="op" id="8664936">(</span><span class="ident" id="8664937">StartElement</span><span class="op" id="8664949">)</span><span class="op" id="8664950">.</span><span class="ident" id="8664951">Name</span><span class="op" id="8664955">.</span><span class="ident" id="8664956">Local</span>&nbsp;<span class="op" id="8664962">!=</span>&nbsp;<span class="ident" id="8664965">test</span><span class="op" id="8664969">[</span><span class="num" id="8664970">1</span><span class="op" id="8664971">]</span>&nbsp;<span class="op" id="8664973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8664978">t</span><span class="op" id="8664979">.</span><span class="ident" id="8664980">Errorf</span><span class="op" id="8664986">(</span><span class="string" id="8664987">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="8665012">,</span>&nbsp;<span class="ident" id="8665014">token</span><span class="op" id="8665019">.</span><span class="op" id="8665020">(</span><span class="ident" id="8665021">StartElement</span><span class="op" id="8665033">)</span><span class="op" id="8665034">.</span><span class="ident" id="8665035">Name</span><span class="op" id="8665039">.</span><span class="ident" id="8665040">Local</span><span class="op" id="8665045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8665049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8665053">attr</span>&nbsp;<span class="op" id="8665058">:=</span>&nbsp;<span class="ident" id="8665061">token</span><span class="op" id="8665066">.</span><span class="op" id="8665067">(</span><span class="ident" id="8665068">StartElement</span><span class="op" id="8665080">)</span><span class="op" id="8665081">.</span><span class="ident" id="8665082">Attr</span><span class="op" id="8665086">[</span><span class="num" id="8665087">0</span><span class="op" id="8665088">]</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8665092">if</span>&nbsp;<span class="ident" id="8665095">attr</span><span class="op" id="8665099">.</span><span class="ident" id="8665100">Value</span>&nbsp;<span class="op" id="8665106">!=</span>&nbsp;<span class="ident" id="8665109">test</span><span class="op" id="8665113">[</span><span class="num" id="8665114">2</span><span class="op" id="8665115">]</span>&nbsp;<span class="op" id="8665117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8665122">t</span><span class="op" id="8665123">.</span><span class="ident" id="8665124">Errorf</span><span class="op" id="8665130">(</span><span class="string" id="8665131">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="8665163">,</span>&nbsp;<span class="ident" id="8665165">attr</span><span class="op" id="8665169">.</span><span class="ident" id="8665170">Value</span><span class="op" id="8665175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8665179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8665183">if</span>&nbsp;<span class="ident" id="8665186">attr</span><span class="op" id="8665190">.</span><span class="ident" id="8665191">Name</span><span class="op" id="8665195">.</span><span class="ident" id="8665196">Local</span>&nbsp;<span class="op" id="8665202">!=</span>&nbsp;<span class="ident" id="8665205">test</span><span class="op" id="8665209">[</span><span class="num" id="8665210">2</span><span class="op" id="8665211">]</span>&nbsp;<span class="op" id="8665213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8665218">t</span><span class="op" id="8665219">.</span><span class="ident" id="8665220">Errorf</span><span class="op" id="8665226">(</span><span class="string" id="8665227">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="8665258">,</span>&nbsp;<span class="ident" id="8665260">attr</span><span class="op" id="8665264">.</span><span class="ident" id="8665265">Name</span><span class="op" id="8665269">.</span><span class="ident" id="8665270">Local</span><span class="op" id="8665275">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8665279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8665282">}</span><br>
<span class="lineno"></span><span class="op" id="8665284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8665287">func</span>&nbsp;<span class="ident" id="8665292">TestCopyTokenCharData</span><span class="op" id="8665313">(</span><span class="ident" id="8665314">t</span>&nbsp;<span class="op" id="8665316">*</span><span class="ident" id="8665317">testing</span><span class="op" id="8665324">.</span><span class="ident" id="8665325">T</span><span class="op" id="8665326">)</span>&nbsp;<span class="op" id="8665328">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8665331">data</span>&nbsp;<span class="op" id="8665336">:=</span>&nbsp;<span class="op" id="8665339">[</span><span class="op" id="8665340">]</span><span class="builtintype" id="8665341">byte</span><span class="op" id="8665345">(</span><span class="string" id="8665346">&#34;same&nbsp;data&#34;</span><span class="op" id="8665357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8665360">var</span>&nbsp;<span class="ident" id="8665364">tok1</span>&nbsp;<span class="ident" id="8665369">Token</span>&nbsp;<span class="op" id="8665375">=</span>&nbsp;<span class="ident" id="8665377">CharData</span><span class="op" id="8665385">(</span><span class="ident" id="8665386">data</span><span class="op" id="8665390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8665393">tok2</span>&nbsp;<span class="op" id="8665398">:=</span>&nbsp;<span class="ident" id="8665401">CopyToken</span><span class="op" id="8665410">(</span><span class="ident" id="8665411">tok1</span><span class="op" id="8665415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8665418">if</span>&nbsp;<span class="op" id="8665421">!</span><span class="ident" id="8665422">reflect</span><span class="op" id="8665429">.</span><span class="ident" id="8665430">DeepEqual</span><span class="op" id="8665439">(</span><span class="ident" id="8665440">tok1</span><span class="op" id="8665444">,</span>&nbsp;<span class="ident" id="8665446">tok2</span><span class="op" id="8665450">)</span>&nbsp;<span class="op" id="8665452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8665456">t</span><span class="op" id="8665457">.</span><span class="ident" id="8665458">Error</span><span class="op" id="8665463">(</span><span class="string" id="8665464">&#34;CopyToken(CharData)&nbsp;!=&nbsp;CharData&#34;</span><span class="op" id="8665497">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8665500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8665503">data</span><span class="op" id="8665507">[</span><span class="num" id="8665508">1</span><span class="op" id="8665509">]</span>&nbsp;<span class="op" id="8665511">=</span>&nbsp;<span class="string" id="8665513">&#39;o&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8665518">if</span>&nbsp;<span class="ident" id="8665521">reflect</span><span class="op" id="8665528">.</span><span class="ident" id="8665529">DeepEqual</span><span class="op" id="8665538">(</span><span class="ident" id="8665539">tok1</span><span class="op" id="8665543">,</span>&nbsp;<span class="ident" id="8665545">tok2</span><span class="op" id="8665549">)</span>&nbsp;<span class="op" id="8665551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8665555">t</span><span class="op" id="8665556">.</span><span class="ident" id="8665557">Error</span><span class="op" id="8665562">(</span><span class="string" id="8665563">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="8665602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8665605">}</span><br>
<span class="lineno">555</span><span class="op" id="8665607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8665610">func</span>&nbsp;<span class="ident" id="8665615">TestCopyTokenStartElement</span><span class="op" id="8665640">(</span><span class="ident" id="8665641">t</span>&nbsp;<span class="op" id="8665643">*</span><span class="ident" id="8665644">testing</span><span class="op" id="8665651">.</span><span class="ident" id="8665652">T</span><span class="op" id="8665653">)</span>&nbsp;<span class="op" id="8665655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8665658">elt</span>&nbsp;<span class="op" id="8665662">:=</span>&nbsp;<span class="ident" id="8665665">StartElement</span><span class="op" id="8665677">{</span><span class="ident" id="8665678">Name</span><span class="op" id="8665682">{</span><span class="string" id="8665683">&#34;&#34;</span><span class="op" id="8665685">,</span>&nbsp;<span class="string" id="8665687">&#34;hello&#34;</span><span class="op" id="8665694">}</span><span class="op" id="8665695">,</span>&nbsp;<span class="op" id="8665697">[</span><span class="op" id="8665698">]</span><span class="ident" id="8665699">Attr</span><span class="op" id="8665703">{</span><span class="op" id="8665704">{</span><span class="ident" id="8665705">Name</span><span class="op" id="8665709">{</span><span class="string" id="8665710">&#34;&#34;</span><span class="op" id="8665712">,</span>&nbsp;<span class="string" id="8665714">&#34;lang&#34;</span><span class="op" id="8665720">}</span><span class="op" id="8665721">,</span>&nbsp;<span class="string" id="8665723">&#34;en&#34;</span><span class="op" id="8665727">}</span><span class="op" id="8665728">}</span><span class="op" id="8665729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8665732">var</span>&nbsp;<span class="ident" id="8665736">tok1</span>&nbsp;<span class="ident" id="8665741">Token</span>&nbsp;<span class="op" id="8665747">=</span>&nbsp;<span class="ident" id="8665749">elt</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8665754">tok2</span>&nbsp;<span class="op" id="8665759">:=</span>&nbsp;<span class="ident" id="8665762">CopyToken</span><span class="op" id="8665771">(</span><span class="ident" id="8665772">tok1</span><span class="op" id="8665776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8665779">if</span>&nbsp;<span class="ident" id="8665782">tok1</span><span class="op" id="8665786">.</span><span class="op" id="8665787">(</span><span class="ident" id="8665788">StartElement</span><span class="op" id="8665800">)</span><span class="op" id="8665801">.</span><span class="ident" id="8665802">Attr</span><span class="op" id="8665806">[</span><span class="num" id="8665807">0</span><span class="op" id="8665808">]</span><span class="op" id="8665809">.</span><span class="ident" id="8665810">Value</span>&nbsp;<span class="op" id="8665816">!=</span>&nbsp;<span class="string" id="8665819">&#34;en&#34;</span>&nbsp;<span class="op" id="8665824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8665828">t</span><span class="op" id="8665829">.</span><span class="ident" id="8665830">Error</span><span class="op" id="8665835">(</span><span class="string" id="8665836">&#34;CopyToken&nbsp;overwrote&nbsp;Attr[0]&#34;</span><span class="op" id="8665865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8665868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8665871">if</span>&nbsp;<span class="op" id="8665874">!</span><span class="ident" id="8665875">reflect</span><span class="op" id="8665882">.</span><span class="ident" id="8665883">DeepEqual</span><span class="op" id="8665892">(</span><span class="ident" id="8665893">tok1</span><span class="op" id="8665897">,</span>&nbsp;<span class="ident" id="8665899">tok2</span><span class="op" id="8665903">)</span>&nbsp;<span class="op" id="8665905">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8665909">t</span><span class="op" id="8665910">.</span><span class="ident" id="8665911">Error</span><span class="op" id="8665916">(</span><span class="string" id="8665917">&#34;CopyToken(StartElement)&nbsp;!=&nbsp;StartElement&#34;</span><span class="op" id="8665958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8665961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8665964">tok1</span><span class="op" id="8665968">.</span><span class="op" id="8665969">(</span><span class="ident" id="8665970">StartElement</span><span class="op" id="8665982">)</span><span class="op" id="8665983">.</span><span class="ident" id="8665984">Attr</span><span class="op" id="8665988">[</span><span class="num" id="8665989">0</span><span class="op" id="8665990">]</span>&nbsp;<span class="op" id="8665992">=</span>&nbsp;<span class="ident" id="8665994">Attr</span><span class="op" id="8665998">{</span><span class="ident" id="8665999">Name</span><span class="op" id="8666003">{</span><span class="string" id="8666004">&#34;&#34;</span><span class="op" id="8666006">,</span>&nbsp;<span class="string" id="8666008">&#34;lang&#34;</span><span class="op" id="8666014">}</span><span class="op" id="8666015">,</span>&nbsp;<span class="string" id="8666017">&#34;de&#34;</span><span class="op" id="8666021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8666024">if</span>&nbsp;<span class="ident" id="8666027">reflect</span><span class="op" id="8666034">.</span><span class="ident" id="8666035">DeepEqual</span><span class="op" id="8666044">(</span><span class="ident" id="8666045">tok1</span><span class="op" id="8666049">,</span>&nbsp;<span class="ident" id="8666051">tok2</span><span class="op" id="8666055">)</span>&nbsp;<span class="op" id="8666057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8666061">t</span><span class="op" id="8666062">.</span><span class="ident" id="8666063">Error</span><span class="op" id="8666068">(</span><span class="string" id="8666069">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="8666108">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8666111">}</span><br>
<span class="lineno"></span><span class="op" id="8666113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8666116">func</span>&nbsp;<span class="ident" id="8666121">TestSyntaxErrorLineNum</span><span class="op" id="8666143">(</span><span class="ident" id="8666144">t</span>&nbsp;<span class="op" id="8666146">*</span><span class="ident" id="8666147">testing</span><span class="op" id="8666154">.</span><span class="ident" id="8666155">T</span><span class="op" id="8666156">)</span>&nbsp;<span class="op" id="8666158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8666161">testInput</span>&nbsp;<span class="op" id="8666171">:=</span>&nbsp;<span class="string" id="8666174">&#34;&lt;P&gt;Foo&lt;P&gt;\n\n&lt;P&gt;Bar&lt;/&gt;\n&#34;</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8666202">d</span>&nbsp;<span class="op" id="8666204">:=</span>&nbsp;<span class="ident" id="8666207">NewDecoder</span><span class="op" id="8666217">(</span><span class="ident" id="8666218">strings</span><span class="op" id="8666225">.</span><span class="ident" id="8666226">NewReader</span><span class="op" id="8666235">(</span><span class="ident" id="8666236">testInput</span><span class="op" id="8666245">)</span><span class="op" id="8666246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8666249">var</span>&nbsp;<span class="ident" id="8666253">err</span>&nbsp;<span class="builtintype" id="8666257">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8666264">for</span>&nbsp;<span class="ident" id="8666268">_</span><span class="op" id="8666269">,</span>&nbsp;<span class="ident" id="8666271">err</span>&nbsp;<span class="op" id="8666275">=</span>&nbsp;<span class="ident" id="8666277">d</span><span class="op" id="8666278">.</span><span class="ident" id="8666279">Token</span><span class="op" id="8666284">(</span><span class="op" id="8666285">)</span><span class="op" id="8666286">;</span>&nbsp;<span class="ident" id="8666288">err</span>&nbsp;<span class="op" id="8666292">==</span>&nbsp;<span class="ident" id="8666295">nil</span><span class="op" id="8666298">;</span>&nbsp;<span class="ident" id="8666300">_</span><span class="op" id="8666301">,</span>&nbsp;<span class="ident" id="8666303">err</span>&nbsp;<span class="op" id="8666307">=</span>&nbsp;<span class="ident" id="8666309">d</span><span class="op" id="8666310">.</span><span class="ident" id="8666311">Token</span><span class="op" id="8666316">(</span><span class="op" id="8666317">)</span>&nbsp;<span class="op" id="8666319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8666322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8666325">synerr</span><span class="op" id="8666331">,</span>&nbsp;<span class="ident" id="8666333">ok</span>&nbsp;<span class="op" id="8666336">:=</span>&nbsp;<span class="ident" id="8666339">err</span><span class="op" id="8666342">.</span><span class="op" id="8666343">(</span><span class="op" id="8666344">*</span><span class="ident" id="8666345">SyntaxError</span><span class="op" id="8666356">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8666359">if</span>&nbsp;<span class="op" id="8666362">!</span><span class="ident" id="8666363">ok</span>&nbsp;<span class="op" id="8666366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8666370">t</span><span class="op" id="8666371">.</span><span class="ident" id="8666372">Error</span><span class="op" id="8666377">(</span><span class="string" id="8666378">&#34;Expected&nbsp;SyntaxError.&#34;</span><span class="op" id="8666401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8666404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8666407">if</span>&nbsp;<span class="ident" id="8666410">synerr</span><span class="op" id="8666416">.</span><span class="ident" id="8666417">Line</span>&nbsp;<span class="op" id="8666422">!=</span>&nbsp;<span class="num" id="8666425">3</span>&nbsp;<span class="op" id="8666427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8666431">t</span><span class="op" id="8666432">.</span><span class="ident" id="8666433">Error</span><span class="op" id="8666438">(</span><span class="string" id="8666439">&#34;SyntaxError&nbsp;didn&#39;t&nbsp;have&nbsp;correct&nbsp;line&nbsp;number.&#34;</span><span class="op" id="8666485">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8666488">}</span><br>
<span class="lineno"></span><span class="op" id="8666490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8666493">func</span>&nbsp;<span class="ident" id="8666498">TestTrailingRawToken</span><span class="op" id="8666518">(</span><span class="ident" id="8666519">t</span>&nbsp;<span class="op" id="8666521">*</span><span class="ident" id="8666522">testing</span><span class="op" id="8666529">.</span><span class="ident" id="8666530">T</span><span class="op" id="8666531">)</span>&nbsp;<span class="op" id="8666533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8666536">input</span>&nbsp;<span class="op" id="8666542">:=</span>&nbsp;<span class="string" id="8666545">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8666562">d</span>&nbsp;<span class="op" id="8666564">:=</span>&nbsp;<span class="ident" id="8666567">NewDecoder</span><span class="op" id="8666577">(</span><span class="ident" id="8666578">strings</span><span class="op" id="8666585">.</span><span class="ident" id="8666586">NewReader</span><span class="op" id="8666595">(</span><span class="ident" id="8666596">input</span><span class="op" id="8666601">)</span><span class="op" id="8666602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8666605">var</span>&nbsp;<span class="ident" id="8666609">err</span>&nbsp;<span class="builtintype" id="8666613">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8666620">for</span>&nbsp;<span class="ident" id="8666624">_</span><span class="op" id="8666625">,</span>&nbsp;<span class="ident" id="8666627">err</span>&nbsp;<span class="op" id="8666631">=</span>&nbsp;<span class="ident" id="8666633">d</span><span class="op" id="8666634">.</span><span class="ident" id="8666635">RawToken</span><span class="op" id="8666643">(</span><span class="op" id="8666644">)</span><span class="op" id="8666645">;</span>&nbsp;<span class="ident" id="8666647">err</span>&nbsp;<span class="op" id="8666651">==</span>&nbsp;<span class="ident" id="8666654">nil</span><span class="op" id="8666657">;</span>&nbsp;<span class="ident" id="8666659">_</span><span class="op" id="8666660">,</span>&nbsp;<span class="ident" id="8666662">err</span>&nbsp;<span class="op" id="8666666">=</span>&nbsp;<span class="ident" id="8666668">d</span><span class="op" id="8666669">.</span><span class="ident" id="8666670">RawToken</span><span class="op" id="8666678">(</span><span class="op" id="8666679">)</span>&nbsp;<span class="op" id="8666681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8666684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8666687">if</span>&nbsp;<span class="ident" id="8666690">err</span>&nbsp;<span class="op" id="8666694">!=</span>&nbsp;<span class="ident" id="8666697">io</span><span class="op" id="8666699">.</span><span class="ident" id="8666700">EOF</span>&nbsp;<span class="op" id="8666704">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8666708">t</span><span class="op" id="8666709">.</span><span class="ident" id="8666710">Fatalf</span><span class="op" id="8666716">(</span><span class="string" id="8666717">&#34;d.RawToken()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="8666755">,</span>&nbsp;<span class="ident" id="8666757">err</span><span class="op" id="8666760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8666763">}</span><br>
<span class="lineno"></span><span class="op" id="8666765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8666768">func</span>&nbsp;<span class="ident" id="8666773">TestTrailingToken</span><span class="op" id="8666790">(</span><span class="ident" id="8666791">t</span>&nbsp;<span class="op" id="8666793">*</span><span class="ident" id="8666794">testing</span><span class="op" id="8666801">.</span><span class="ident" id="8666802">T</span><span class="op" id="8666803">)</span>&nbsp;<span class="op" id="8666805">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8666808">input</span>&nbsp;<span class="op" id="8666814">:=</span>&nbsp;<span class="string" id="8666817">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8666834">d</span>&nbsp;<span class="op" id="8666836">:=</span>&nbsp;<span class="ident" id="8666839">NewDecoder</span><span class="op" id="8666849">(</span><span class="ident" id="8666850">strings</span><span class="op" id="8666857">.</span><span class="ident" id="8666858">NewReader</span><span class="op" id="8666867">(</span><span class="ident" id="8666868">input</span><span class="op" id="8666873">)</span><span class="op" id="8666874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8666877">var</span>&nbsp;<span class="ident" id="8666881">err</span>&nbsp;<span class="builtintype" id="8666885">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8666892">for</span>&nbsp;<span class="ident" id="8666896">_</span><span class="op" id="8666897">,</span>&nbsp;<span class="ident" id="8666899">err</span>&nbsp;<span class="op" id="8666903">=</span>&nbsp;<span class="ident" id="8666905">d</span><span class="op" id="8666906">.</span><span class="ident" id="8666907">Token</span><span class="op" id="8666912">(</span><span class="op" id="8666913">)</span><span class="op" id="8666914">;</span>&nbsp;<span class="ident" id="8666916">err</span>&nbsp;<span class="op" id="8666920">==</span>&nbsp;<span class="ident" id="8666923">nil</span><span class="op" id="8666926">;</span>&nbsp;<span class="ident" id="8666928">_</span><span class="op" id="8666929">,</span>&nbsp;<span class="ident" id="8666931">err</span>&nbsp;<span class="op" id="8666935">=</span>&nbsp;<span class="ident" id="8666937">d</span><span class="op" id="8666938">.</span><span class="ident" id="8666939">Token</span><span class="op" id="8666944">(</span><span class="op" id="8666945">)</span>&nbsp;<span class="op" id="8666947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8666950">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8666953">if</span>&nbsp;<span class="ident" id="8666956">err</span>&nbsp;<span class="op" id="8666960">!=</span>&nbsp;<span class="ident" id="8666963">io</span><span class="op" id="8666965">.</span><span class="ident" id="8666966">EOF</span>&nbsp;<span class="op" id="8666970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8666974">t</span><span class="op" id="8666975">.</span><span class="ident" id="8666976">Fatalf</span><span class="op" id="8666982">(</span><span class="string" id="8666983">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="8667018">,</span>&nbsp;<span class="ident" id="8667020">err</span><span class="op" id="8667023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8667026">}</span><br>
<span class="lineno"></span><span class="op" id="8667028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span><span class="keyword" id="8667031">func</span>&nbsp;<span class="ident" id="8667036">TestEntityInsideCDATA</span><span class="op" id="8667057">(</span><span class="ident" id="8667058">t</span>&nbsp;<span class="op" id="8667060">*</span><span class="ident" id="8667061">testing</span><span class="op" id="8667068">.</span><span class="ident" id="8667069">T</span><span class="op" id="8667070">)</span>&nbsp;<span class="op" id="8667072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8667075">input</span>&nbsp;<span class="op" id="8667081">:=</span>&nbsp;<span class="string" id="8667084">`&lt;test&gt;&lt;![CDATA[&nbsp;&amp;val=foo&nbsp;]]&gt;&lt;/test&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8667123">d</span>&nbsp;<span class="op" id="8667125">:=</span>&nbsp;<span class="ident" id="8667128">NewDecoder</span><span class="op" id="8667138">(</span><span class="ident" id="8667139">strings</span><span class="op" id="8667146">.</span><span class="ident" id="8667147">NewReader</span><span class="op" id="8667156">(</span><span class="ident" id="8667157">input</span><span class="op" id="8667162">)</span><span class="op" id="8667163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8667166">var</span>&nbsp;<span class="ident" id="8667170">err</span>&nbsp;<span class="builtintype" id="8667174">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8667181">for</span>&nbsp;<span class="ident" id="8667185">_</span><span class="op" id="8667186">,</span>&nbsp;<span class="ident" id="8667188">err</span>&nbsp;<span class="op" id="8667192">=</span>&nbsp;<span class="ident" id="8667194">d</span><span class="op" id="8667195">.</span><span class="ident" id="8667196">Token</span><span class="op" id="8667201">(</span><span class="op" id="8667202">)</span><span class="op" id="8667203">;</span>&nbsp;<span class="ident" id="8667205">err</span>&nbsp;<span class="op" id="8667209">==</span>&nbsp;<span class="ident" id="8667212">nil</span><span class="op" id="8667215">;</span>&nbsp;<span class="ident" id="8667217">_</span><span class="op" id="8667218">,</span>&nbsp;<span class="ident" id="8667220">err</span>&nbsp;<span class="op" id="8667224">=</span>&nbsp;<span class="ident" id="8667226">d</span><span class="op" id="8667227">.</span><span class="ident" id="8667228">Token</span><span class="op" id="8667233">(</span><span class="op" id="8667234">)</span>&nbsp;<span class="op" id="8667236">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8667239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8667242">if</span>&nbsp;<span class="ident" id="8667245">err</span>&nbsp;<span class="op" id="8667249">!=</span>&nbsp;<span class="ident" id="8667252">io</span><span class="op" id="8667254">.</span><span class="ident" id="8667255">EOF</span>&nbsp;<span class="op" id="8667259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8667263">t</span><span class="op" id="8667264">.</span><span class="ident" id="8667265">Fatalf</span><span class="op" id="8667271">(</span><span class="string" id="8667272">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="8667307">,</span>&nbsp;<span class="ident" id="8667309">err</span><span class="op" id="8667312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8667315">}</span><br>
<span class="lineno"></span><span class="op" id="8667317">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span><span class="keyword" id="8667320">var</span>&nbsp;<span class="ident" id="8667324">characterTests</span>&nbsp;<span class="op" id="8667339">=</span>&nbsp;<span class="op" id="8667341">[</span><span class="op" id="8667342">]</span><span class="keyword" id="8667343">struct</span>&nbsp;<span class="op" id="8667350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8667353">in</span>&nbsp;&nbsp;<span class="builtintype" id="8667357">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8667365">err</span>&nbsp;<span class="builtintype" id="8667369">string</span><br>
<span class="lineno"></span><span class="op" id="8667376">}</span><span class="op" id="8667377">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8667380">{</span><span class="string" id="8667381">&#34;\x12&lt;doc/&gt;&#34;</span><span class="op" id="8667393">,</span>&nbsp;<span class="string" id="8667395">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0012&#34;</span><span class="op" id="8667426">}</span><span class="op" id="8667427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8667430">{</span><span class="string" id="8667431">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;\x0b&lt;doc/&gt;&#34;</span><span class="op" id="8667466">,</span>&nbsp;<span class="string" id="8667468">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+000B&#34;</span><span class="op" id="8667499">}</span><span class="op" id="8667500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8667503">{</span><span class="string" id="8667504">&#34;\xef\xbf\xbe&lt;doc/&gt;&#34;</span><span class="op" id="8667524">,</span>&nbsp;<span class="string" id="8667526">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+FFFE&#34;</span><span class="op" id="8667557">}</span><span class="op" id="8667558">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8667561">{</span><span class="string" id="8667562">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&gt;\r\n&lt;hiya/&gt;\x07&lt;toots/&gt;&lt;/doc&gt;&#34;</span><span class="op" id="8667621">,</span>&nbsp;<span class="string" id="8667623">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0007&#34;</span><span class="op" id="8667654">}</span><span class="op" id="8667655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8667658">{</span><span class="string" id="8667659">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&nbsp;\x12=&#39;value&#39;&gt;what&#39;s&nbsp;up&lt;/doc&gt;&#34;</span><span class="op" id="8667717">,</span>&nbsp;<span class="string" id="8667719">&#34;expected&nbsp;attribute&nbsp;name&nbsp;in&nbsp;element&#34;</span><span class="op" id="8667755">}</span><span class="op" id="8667756">,</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8667759">{</span><span class="string" id="8667760">&#34;&lt;doc&gt;&amp;abc\x01;&lt;/doc&gt;&#34;</span><span class="op" id="8667782">,</span>&nbsp;<span class="string" id="8667784">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;abc&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="8667830">}</span><span class="op" id="8667831">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8667834">{</span><span class="string" id="8667835">&#34;&lt;doc&gt;&amp;\x01;&lt;/doc&gt;&#34;</span><span class="op" id="8667854">,</span>&nbsp;<span class="string" id="8667856">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="8667899">}</span><span class="op" id="8667900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8667903">{</span><span class="string" id="8667904">&#34;&lt;doc&gt;&amp;\xef\xbf\xbe;&lt;/doc&gt;&#34;</span><span class="op" id="8667931">,</span>&nbsp;<span class="string" id="8667933">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;\uFFFE;&#34;</span><span class="op" id="8667968">}</span><span class="op" id="8667969">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8667972">{</span><span class="string" id="8667973">&#34;&lt;doc&gt;&amp;hello;&lt;/doc&gt;&#34;</span><span class="op" id="8667993">,</span>&nbsp;<span class="string" id="8667995">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;hello;&#34;</span><span class="op" id="8668029">}</span><span class="op" id="8668030">,</span><br>
<span class="lineno"></span><span class="op" id="8668032">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="keyword" id="8668035">func</span>&nbsp;<span class="ident" id="8668040">TestDisallowedCharacters</span><span class="op" id="8668064">(</span><span class="ident" id="8668065">t</span>&nbsp;<span class="op" id="8668067">*</span><span class="ident" id="8668068">testing</span><span class="op" id="8668075">.</span><span class="ident" id="8668076">T</span><span class="op" id="8668077">)</span>&nbsp;<span class="op" id="8668079">{</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8668083">for</span>&nbsp;<span class="ident" id="8668087">i</span><span class="op" id="8668088">,</span>&nbsp;<span class="ident" id="8668090">tt</span>&nbsp;<span class="op" id="8668093">:=</span>&nbsp;<span class="keyword" id="8668096">range</span>&nbsp;<span class="ident" id="8668102">characterTests</span>&nbsp;<span class="op" id="8668117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8668121">d</span>&nbsp;<span class="op" id="8668123">:=</span>&nbsp;<span class="ident" id="8668126">NewDecoder</span><span class="op" id="8668136">(</span><span class="ident" id="8668137">strings</span><span class="op" id="8668144">.</span><span class="ident" id="8668145">NewReader</span><span class="op" id="8668154">(</span><span class="ident" id="8668155">tt</span><span class="op" id="8668157">.</span><span class="ident" id="8668158">in</span><span class="op" id="8668160">)</span><span class="op" id="8668161">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8668165">var</span>&nbsp;<span class="ident" id="8668169">err</span>&nbsp;<span class="builtintype" id="8668173">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8668182">for</span>&nbsp;<span class="ident" id="8668186">err</span>&nbsp;<span class="op" id="8668190">==</span>&nbsp;<span class="ident" id="8668193">nil</span>&nbsp;<span class="op" id="8668197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8668202">_</span><span class="op" id="8668203">,</span>&nbsp;<span class="ident" id="8668205">err</span>&nbsp;<span class="op" id="8668209">=</span>&nbsp;<span class="ident" id="8668211">d</span><span class="op" id="8668212">.</span><span class="ident" id="8668213">Token</span><span class="op" id="8668218">(</span><span class="op" id="8668219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8668223">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8668227">synerr</span><span class="op" id="8668233">,</span>&nbsp;<span class="ident" id="8668235">ok</span>&nbsp;<span class="op" id="8668238">:=</span>&nbsp;<span class="ident" id="8668241">err</span><span class="op" id="8668244">.</span><span class="op" id="8668245">(</span><span class="op" id="8668246">*</span><span class="ident" id="8668247">SyntaxError</span><span class="op" id="8668258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8668262">if</span>&nbsp;<span class="op" id="8668265">!</span><span class="ident" id="8668266">ok</span>&nbsp;<span class="op" id="8668269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8668274">t</span><span class="op" id="8668275">.</span><span class="ident" id="8668276">Fatalf</span><span class="op" id="8668282">(</span><span class="string" id="8668283">&#34;input&nbsp;%d&nbsp;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;*SyntaxError&#34;</span><span class="op" id="8668333">,</span>&nbsp;<span class="ident" id="8668335">i</span><span class="op" id="8668336">,</span>&nbsp;<span class="ident" id="8668338">err</span><span class="op" id="8668341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8668345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8668349">if</span>&nbsp;<span class="ident" id="8668352">synerr</span><span class="op" id="8668358">.</span><span class="ident" id="8668359">Msg</span>&nbsp;<span class="op" id="8668363">!=</span>&nbsp;<span class="ident" id="8668366">tt</span><span class="op" id="8668368">.</span><span class="ident" id="8668369">err</span>&nbsp;<span class="op" id="8668373">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8668378">t</span><span class="op" id="8668379">.</span><span class="ident" id="8668380">Fatalf</span><span class="op" id="8668386">(</span><span class="string" id="8668387">&#34;input&nbsp;%d&nbsp;synerr.Msg&nbsp;wrong:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8668431">,</span>&nbsp;<span class="ident" id="8668433">i</span><span class="op" id="8668434">,</span>&nbsp;<span class="ident" id="8668436">tt</span><span class="op" id="8668438">.</span><span class="ident" id="8668439">err</span><span class="op" id="8668442">,</span>&nbsp;<span class="ident" id="8668444">synerr</span><span class="op" id="8668450">.</span><span class="ident" id="8668451">Msg</span><span class="op" id="8668454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8668458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8668461">}</span><br>
<span class="lineno"></span><span class="op" id="8668463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">655</span><span class="keyword" id="8668466">type</span>&nbsp;<span class="ident" id="8668471">procInstEncodingTest</span>&nbsp;<span class="keyword" id="8668492">struct</span>&nbsp;<span class="op" id="8668499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8668502">expect</span><span class="op" id="8668508">,</span>&nbsp;<span class="ident" id="8668510">got</span>&nbsp;<span class="builtintype" id="8668514">string</span><br>
<span class="lineno"></span><span class="op" id="8668521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8668524">var</span>&nbsp;<span class="ident" id="8668528">procInstTests</span>&nbsp;<span class="op" id="8668542">=</span>&nbsp;<span class="op" id="8668544">[</span><span class="op" id="8668545">]</span><span class="keyword" id="8668546">struct</span>&nbsp;<span class="op" id="8668553">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8668556">input</span><span class="op" id="8668561">,</span>&nbsp;<span class="ident" id="8668563">expect</span>&nbsp;<span class="builtintype" id="8668570">string</span><br>
<span class="lineno"></span><span class="op" id="8668577">}</span><span class="op" id="8668578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8668581">{</span><span class="string" id="8668582">`version=&#34;1.0&#34;&nbsp;encoding=&#34;utf-8&#34;`</span><span class="op" id="8668614">,</span>&nbsp;<span class="string" id="8668616">&#34;utf-8&#34;</span><span class="op" id="8668623">}</span><span class="op" id="8668624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8668627">{</span><span class="string" id="8668628">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;`</span><span class="op" id="8668660">,</span>&nbsp;<span class="string" id="8668662">&#34;utf-8&#34;</span><span class="op" id="8668669">}</span><span class="op" id="8668670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8668673">{</span><span class="string" id="8668674">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;&nbsp;`</span><span class="op" id="8668707">,</span>&nbsp;<span class="string" id="8668709">&#34;utf-8&#34;</span><span class="op" id="8668716">}</span><span class="op" id="8668717">,</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8668720">{</span><span class="string" id="8668721">`version=&#34;1.0&#34;&nbsp;encoding=utf-8`</span><span class="op" id="8668751">,</span>&nbsp;<span class="string" id="8668753">&#34;&#34;</span><span class="op" id="8668755">}</span><span class="op" id="8668756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8668759">{</span><span class="string" id="8668760">`encoding=&#34;FOO&#34;&nbsp;`</span><span class="op" id="8668777">,</span>&nbsp;<span class="string" id="8668779">&#34;FOO&#34;</span><span class="op" id="8668784">}</span><span class="op" id="8668785">,</span><br>
<span class="lineno"></span><span class="op" id="8668787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8668790">func</span>&nbsp;<span class="ident" id="8668795">TestProcInstEncoding</span><span class="op" id="8668815">(</span><span class="ident" id="8668816">t</span>&nbsp;<span class="op" id="8668818">*</span><span class="ident" id="8668819">testing</span><span class="op" id="8668826">.</span><span class="ident" id="8668827">T</span><span class="op" id="8668828">)</span>&nbsp;<span class="op" id="8668830">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8668833">for</span>&nbsp;<span class="ident" id="8668837">_</span><span class="op" id="8668838">,</span>&nbsp;<span class="ident" id="8668840">test</span>&nbsp;<span class="op" id="8668845">:=</span>&nbsp;<span class="keyword" id="8668848">range</span>&nbsp;<span class="ident" id="8668854">procInstTests</span>&nbsp;<span class="op" id="8668868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8668872">got</span>&nbsp;<span class="op" id="8668876">:=</span>&nbsp;<span class="ident" id="8668879">procInstEncoding</span><span class="op" id="8668895">(</span><span class="ident" id="8668896">test</span><span class="op" id="8668900">.</span><span class="ident" id="8668901">input</span><span class="op" id="8668906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8668910">if</span>&nbsp;<span class="ident" id="8668913">got</span>&nbsp;<span class="op" id="8668917">!=</span>&nbsp;<span class="ident" id="8668920">test</span><span class="op" id="8668924">.</span><span class="ident" id="8668925">expect</span>&nbsp;<span class="op" id="8668932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8668937">t</span><span class="op" id="8668938">.</span><span class="ident" id="8668939">Errorf</span><span class="op" id="8668945">(</span><span class="string" id="8668946">&#34;procInstEncoding(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8668982">,</span>&nbsp;<span class="ident" id="8668984">test</span><span class="op" id="8668988">.</span><span class="ident" id="8668989">input</span><span class="op" id="8668994">,</span>&nbsp;<span class="ident" id="8668996">got</span><span class="op" id="8668999">,</span>&nbsp;<span class="ident" id="8669001">test</span><span class="op" id="8669005">.</span><span class="ident" id="8669006">expect</span><span class="op" id="8669012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8669016">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8669019">}</span><br>
<span class="lineno"></span><span class="op" id="8669021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8669024">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;with&nbsp;comments&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno"></span><span class="comment" id="8669085">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives.</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="8669120">var</span>&nbsp;<span class="ident" id="8669124">directivesWithCommentsInput</span>&nbsp;<span class="op" id="8669152">=</span>&nbsp;<span class="string" id="8669154">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!--&nbsp;a&nbsp;comment&nbsp;--&gt;&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&lt;!----&gt;&nbsp;&lt;!--&gt;--&gt;&nbsp;&lt;!---&gt;--&gt;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno">685</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8669390">var</span>&nbsp;<span class="ident" id="8669394">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="8669423">=</span>&nbsp;<span class="op" id="8669425">[</span><span class="op" id="8669426">]</span><span class="ident" id="8669427">Token</span><span class="op" id="8669432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8669435">CharData</span><span class="op" id="8669443">(</span><span class="string" id="8669444">&#34;\n&#34;</span><span class="op" id="8669448">)</span><span class="op" id="8669449">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8669452">Directive</span><span class="op" id="8669461">(</span><span class="string" id="8669462">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="8669533">)</span><span class="op" id="8669534">,</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8669537">CharData</span><span class="op" id="8669545">(</span><span class="string" id="8669546">&#34;\n&#34;</span><span class="op" id="8669550">)</span><span class="op" id="8669551">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8669554">Directive</span><span class="op" id="8669563">(</span><span class="string" id="8669564">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="8669597">)</span><span class="op" id="8669598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8669601">CharData</span><span class="op" id="8669609">(</span><span class="string" id="8669610">&#34;\n&#34;</span><span class="op" id="8669614">)</span><span class="op" id="8669615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8669618">Directive</span><span class="op" id="8669627">(</span><span class="string" id="8669628">`DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&nbsp;&nbsp;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="8669673">)</span><span class="op" id="8669674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8669677">CharData</span><span class="op" id="8669685">(</span><span class="string" id="8669686">&#34;\n&#34;</span><span class="op" id="8669690">)</span><span class="op" id="8669691">,</span><br>
<span class="lineno">695</span><span class="op" id="8669693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8669696">func</span>&nbsp;<span class="ident" id="8669701">TestDirectivesWithComments</span><span class="op" id="8669727">(</span><span class="ident" id="8669728">t</span>&nbsp;<span class="op" id="8669730">*</span><span class="ident" id="8669731">testing</span><span class="op" id="8669738">.</span><span class="ident" id="8669739">T</span><span class="op" id="8669740">)</span>&nbsp;<span class="op" id="8669742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8669745">d</span>&nbsp;<span class="op" id="8669747">:=</span>&nbsp;<span class="ident" id="8669750">NewDecoder</span><span class="op" id="8669760">(</span><span class="ident" id="8669761">strings</span><span class="op" id="8669768">.</span><span class="ident" id="8669769">NewReader</span><span class="op" id="8669778">(</span><span class="ident" id="8669779">directivesWithCommentsInput</span><span class="op" id="8669806">)</span><span class="op" id="8669807">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8669811">for</span>&nbsp;<span class="ident" id="8669815">i</span><span class="op" id="8669816">,</span>&nbsp;<span class="ident" id="8669818">want</span>&nbsp;<span class="op" id="8669823">:=</span>&nbsp;<span class="keyword" id="8669826">range</span>&nbsp;<span class="ident" id="8669832">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="8669861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8669865">have</span><span class="op" id="8669869">,</span>&nbsp;<span class="ident" id="8669871">err</span>&nbsp;<span class="op" id="8669875">:=</span>&nbsp;<span class="ident" id="8669878">d</span><span class="op" id="8669879">.</span><span class="ident" id="8669880">Token</span><span class="op" id="8669885">(</span><span class="op" id="8669886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8669890">if</span>&nbsp;<span class="ident" id="8669893">err</span>&nbsp;<span class="op" id="8669897">!=</span>&nbsp;<span class="ident" id="8669900">nil</span>&nbsp;<span class="op" id="8669904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8669909">t</span><span class="op" id="8669910">.</span><span class="ident" id="8669911">Fatalf</span><span class="op" id="8669917">(</span><span class="string" id="8669918">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8669950">,</span>&nbsp;<span class="ident" id="8669952">i</span><span class="op" id="8669953">,</span>&nbsp;<span class="ident" id="8669955">err</span><span class="op" id="8669958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8669962">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8669966">if</span>&nbsp;<span class="op" id="8669969">!</span><span class="ident" id="8669970">reflect</span><span class="op" id="8669977">.</span><span class="ident" id="8669978">DeepEqual</span><span class="op" id="8669987">(</span><span class="ident" id="8669988">have</span><span class="op" id="8669992">,</span>&nbsp;<span class="ident" id="8669994">want</span><span class="op" id="8669998">)</span>&nbsp;<span class="op" id="8670000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8670005">t</span><span class="op" id="8670006">.</span><span class="ident" id="8670007">Errorf</span><span class="op" id="8670013">(</span><span class="string" id="8670014">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="8670039">,</span>&nbsp;<span class="ident" id="8670041">i</span><span class="op" id="8670042">,</span>&nbsp;<span class="ident" id="8670044">have</span><span class="op" id="8670048">,</span>&nbsp;<span class="ident" id="8670050">want</span><span class="op" id="8670054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8670058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8670061">}</span><br>
<span class="lineno"></span><span class="op" id="8670063">}</span><br>
<span class="lineno">710</span><br>
<span class="lineno"></span><span class="comment" id="8670066">//&nbsp;Writer&nbsp;whose&nbsp;Write&nbsp;method&nbsp;always&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="8670120">type</span>&nbsp;<span class="ident" id="8670125">errWriter</span>&nbsp;<span class="keyword" id="8670135">struct</span><span class="op" id="8670141">{</span><span class="op" id="8670142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8670145">func</span>&nbsp;<span class="op" id="8670150">(</span><span class="ident" id="8670151">errWriter</span><span class="op" id="8670160">)</span>&nbsp;<span class="ident" id="8670162">Write</span><span class="op" id="8670167">(</span><span class="ident" id="8670168">p</span>&nbsp;<span class="op" id="8670170">[</span><span class="op" id="8670171">]</span><span class="builtintype" id="8670172">byte</span><span class="op" id="8670176">)</span>&nbsp;<span class="op" id="8670178">(</span><span class="ident" id="8670179">n</span>&nbsp;<span class="builtintype" id="8670181">int</span><span class="op" id="8670184">,</span>&nbsp;<span class="ident" id="8670186">err</span>&nbsp;<span class="builtintype" id="8670190">error</span><span class="op" id="8670195">)</span>&nbsp;<span class="op" id="8670197">{</span>&nbsp;<span class="keyword" id="8670199">return</span>&nbsp;<span class="num" id="8670206">0</span><span class="op" id="8670207">,</span>&nbsp;<span class="ident" id="8670209">fmt</span><span class="op" id="8670212">.</span><span class="ident" id="8670213">Errorf</span><span class="op" id="8670219">(</span><span class="string" id="8670220">&#34;unwritable&#34;</span><span class="op" id="8670232">)</span>&nbsp;<span class="op" id="8670234">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="8670237">func</span>&nbsp;<span class="ident" id="8670242">TestEscapeTextIOErrors</span><span class="op" id="8670264">(</span><span class="ident" id="8670265">t</span>&nbsp;<span class="op" id="8670267">*</span><span class="ident" id="8670268">testing</span><span class="op" id="8670275">.</span><span class="ident" id="8670276">T</span><span class="op" id="8670277">)</span>&nbsp;<span class="op" id="8670279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8670282">expectErr</span>&nbsp;<span class="op" id="8670292">:=</span>&nbsp;<span class="string" id="8670295">&#34;unwritable&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8670309">err</span>&nbsp;<span class="op" id="8670313">:=</span>&nbsp;<span class="ident" id="8670316">EscapeText</span><span class="op" id="8670326">(</span><span class="ident" id="8670327">errWriter</span><span class="op" id="8670336">{</span><span class="op" id="8670337">}</span><span class="op" id="8670338">,</span>&nbsp;<span class="op" id="8670340">[</span><span class="op" id="8670341">]</span><span class="builtintype" id="8670342">byte</span><span class="op" id="8670346">{</span><span class="string" id="8670347">&#39;A&#39;</span><span class="op" id="8670350">}</span><span class="op" id="8670351">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8670355">if</span>&nbsp;<span class="ident" id="8670358">err</span>&nbsp;<span class="op" id="8670362">==</span>&nbsp;<span class="ident" id="8670365">nil</span>&nbsp;<span class="op" id="8670369">||</span>&nbsp;<span class="ident" id="8670372">err</span><span class="op" id="8670375">.</span><span class="ident" id="8670376">Error</span><span class="op" id="8670381">(</span><span class="op" id="8670382">)</span>&nbsp;<span class="op" id="8670384">!=</span>&nbsp;<span class="ident" id="8670387">expectErr</span>&nbsp;<span class="op" id="8670397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8670401">t</span><span class="op" id="8670402">.</span><span class="ident" id="8670403">Errorf</span><span class="op" id="8670409">(</span><span class="string" id="8670410">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8670428">,</span>&nbsp;<span class="ident" id="8670430">err</span><span class="op" id="8670433">,</span>&nbsp;<span class="ident" id="8670435">expectErr</span><span class="op" id="8670444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8670447">}</span><br>
<span class="lineno"></span><span class="op" id="8670449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="keyword" id="8670452">func</span>&nbsp;<span class="ident" id="8670457">TestEscapeTextInvalidChar</span><span class="op" id="8670482">(</span><span class="ident" id="8670483">t</span>&nbsp;<span class="op" id="8670485">*</span><span class="ident" id="8670486">testing</span><span class="op" id="8670493">.</span><span class="ident" id="8670494">T</span><span class="op" id="8670495">)</span>&nbsp;<span class="op" id="8670497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8670500">input</span>&nbsp;<span class="op" id="8670506">:=</span>&nbsp;<span class="op" id="8670509">[</span><span class="op" id="8670510">]</span><span class="builtintype" id="8670511">byte</span><span class="op" id="8670515">(</span><span class="string" id="8670516">&#34;A&nbsp;\x00&nbsp;terminated&nbsp;string.&#34;</span><span class="op" id="8670543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8670546">expected</span>&nbsp;<span class="op" id="8670555">:=</span>&nbsp;<span class="string" id="8670558">&#34;A&nbsp;\uFFFD&nbsp;terminated&nbsp;string.&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8670590">buff</span>&nbsp;<span class="op" id="8670595">:=</span>&nbsp;<span class="builtinfunc" id="8670598">new</span><span class="op" id="8670601">(</span><span class="ident" id="8670602">bytes</span><span class="op" id="8670607">.</span><span class="ident" id="8670608">Buffer</span><span class="op" id="8670614">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8670617">if</span>&nbsp;<span class="ident" id="8670620">err</span>&nbsp;<span class="op" id="8670624">:=</span>&nbsp;<span class="ident" id="8670627">EscapeText</span><span class="op" id="8670637">(</span><span class="ident" id="8670638">buff</span><span class="op" id="8670642">,</span>&nbsp;<span class="ident" id="8670644">input</span><span class="op" id="8670649">)</span><span class="op" id="8670650">;</span>&nbsp;<span class="ident" id="8670652">err</span>&nbsp;<span class="op" id="8670656">!=</span>&nbsp;<span class="ident" id="8670659">nil</span>&nbsp;<span class="op" id="8670663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8670667">t</span><span class="op" id="8670668">.</span><span class="ident" id="8670669">Fatalf</span><span class="op" id="8670675">(</span><span class="string" id="8670676">&#34;have&nbsp;%v,&nbsp;want&nbsp;nil&#34;</span><span class="op" id="8670695">,</span>&nbsp;<span class="ident" id="8670697">err</span><span class="op" id="8670700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8670703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8670706">text</span>&nbsp;<span class="op" id="8670711">:=</span>&nbsp;<span class="ident" id="8670714">buff</span><span class="op" id="8670718">.</span><span class="ident" id="8670719">String</span><span class="op" id="8670725">(</span><span class="op" id="8670726">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8670730">if</span>&nbsp;<span class="ident" id="8670733">text</span>&nbsp;<span class="op" id="8670738">!=</span>&nbsp;<span class="ident" id="8670741">expected</span>&nbsp;<span class="op" id="8670750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8670754">t</span><span class="op" id="8670755">.</span><span class="ident" id="8670756">Errorf</span><span class="op" id="8670762">(</span><span class="string" id="8670763">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8670781">,</span>&nbsp;<span class="ident" id="8670783">text</span><span class="op" id="8670787">,</span>&nbsp;<span class="ident" id="8670789">expected</span><span class="op" id="8670797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8670800">}</span><br>
<span class="lineno"></span><span class="op" id="8670802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">740</span><span class="keyword" id="8670805">func</span>&nbsp;<span class="ident" id="8670810">TestIssue5880</span><span class="op" id="8670823">(</span><span class="ident" id="8670824">t</span>&nbsp;<span class="op" id="8670826">*</span><span class="ident" id="8670827">testing</span><span class="op" id="8670834">.</span><span class="ident" id="8670835">T</span><span class="op" id="8670836">)</span>&nbsp;<span class="op" id="8670838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8670841">type</span>&nbsp;<span class="ident" id="8670846">T</span>&nbsp;<span class="op" id="8670848">[</span><span class="op" id="8670849">]</span><span class="builtintype" id="8670850">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8670856">data</span><span class="op" id="8670860">,</span>&nbsp;<span class="ident" id="8670862">err</span>&nbsp;<span class="op" id="8670866">:=</span>&nbsp;<span class="ident" id="8670869">Marshal</span><span class="op" id="8670876">(</span><span class="ident" id="8670877">T</span><span class="op" id="8670878">{</span><span class="num" id="8670879">192</span><span class="op" id="8670882">,</span>&nbsp;<span class="num" id="8670884">168</span><span class="op" id="8670887">,</span>&nbsp;<span class="num" id="8670889">0</span><span class="op" id="8670890">,</span>&nbsp;<span class="num" id="8670892">1</span><span class="op" id="8670893">}</span><span class="op" id="8670894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8670897">if</span>&nbsp;<span class="ident" id="8670900">err</span>&nbsp;<span class="op" id="8670904">!=</span>&nbsp;<span class="ident" id="8670907">nil</span>&nbsp;<span class="op" id="8670911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8670915">t</span><span class="op" id="8670916">.</span><span class="ident" id="8670917">Errorf</span><span class="op" id="8670923">(</span><span class="string" id="8670924">&#34;Marshal&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8670943">,</span>&nbsp;<span class="ident" id="8670945">err</span><span class="op" id="8670948">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8670951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8670954">if</span>&nbsp;<span class="op" id="8670957">!</span><span class="ident" id="8670958">utf8</span><span class="op" id="8670962">.</span><span class="ident" id="8670963">Valid</span><span class="op" id="8670968">(</span><span class="ident" id="8670969">data</span><span class="op" id="8670973">)</span>&nbsp;<span class="op" id="8670975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8670979">t</span><span class="op" id="8670980">.</span><span class="ident" id="8670981">Errorf</span><span class="op" id="8670987">(</span><span class="string" id="8670988">&#34;Marshal&nbsp;generated&nbsp;invalid&nbsp;UTF-8:&nbsp;%x&#34;</span><span class="op" id="8671025">,</span>&nbsp;<span class="ident" id="8671027">data</span><span class="op" id="8671031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8671034">}</span><br>
<span class="lineno"></span><span class="op" id="8671036">}</span>
</div>
</body>
</html>
