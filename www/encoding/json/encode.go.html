<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4748105">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4748161">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4748215">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4748266">//&nbsp;Package&nbsp;json&nbsp;implements&nbsp;encoding&nbsp;and&nbsp;decoding&nbsp;of&nbsp;JSON&nbsp;objects&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4748345">//&nbsp;RFC&nbsp;4627.&nbsp;The&nbsp;mapping&nbsp;between&nbsp;JSON&nbsp;objects&nbsp;and&nbsp;Go&nbsp;values&nbsp;is&nbsp;described</span><br>
<span class="lineno"></span><span class="comment" id="4748418">//&nbsp;in&nbsp;the&nbsp;documentation&nbsp;for&nbsp;the&nbsp;Marshal&nbsp;and&nbsp;Unmarshal&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="4748483">//</span><br>
<span class="lineno"></span><span class="comment" id="4748486">//&nbsp;See&nbsp;&#34;JSON&nbsp;and&nbsp;Go&#34;&nbsp;for&nbsp;an&nbsp;introduction&nbsp;to&nbsp;this&nbsp;package:</span><br>
<span class="lineno">10</span><span class="comment" id="4748544">//&nbsp;http://golang.org/doc/articles/json_and_go.html</span><br>
<span class="lineno"></span><span class="keyword" id="4748595">package</span>&nbsp;<span class="ident" id="4748603">json</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4748609">import</span>&nbsp;<span class="op" id="4748616">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4748619">&#34;bytes&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4748628">&#34;encoding&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4748640">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4748659">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4748667">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4748678">&#34;runtime&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4748689">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4748697">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4748708">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4748719">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4748727">&#34;unicode&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4748738">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="4748753">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4748756">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;JSON&nbsp;encoding&nbsp;of&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="4748799">//</span><br>
<span class="lineno">30</span><span class="comment" id="4748802">//&nbsp;Marshal&nbsp;traverses&nbsp;the&nbsp;value&nbsp;v&nbsp;recursively.</span><br>
<span class="lineno"></span><span class="comment" id="4748848">//&nbsp;If&nbsp;an&nbsp;encountered&nbsp;value&nbsp;implements&nbsp;the&nbsp;Marshaler&nbsp;interface</span><br>
<span class="lineno"></span><span class="comment" id="4748910">//&nbsp;and&nbsp;is&nbsp;not&nbsp;a&nbsp;nil&nbsp;pointer,&nbsp;Marshal&nbsp;calls&nbsp;its&nbsp;MarshalJSON&nbsp;method</span><br>
<span class="lineno"></span><span class="comment" id="4748976">//&nbsp;to&nbsp;produce&nbsp;JSON.&nbsp;&nbsp;The&nbsp;nil&nbsp;pointer&nbsp;exception&nbsp;is&nbsp;not&nbsp;strictly&nbsp;necessary</span><br>
<span class="lineno"></span><span class="comment" id="4749049">//&nbsp;but&nbsp;mimics&nbsp;a&nbsp;similar,&nbsp;necessary&nbsp;exception&nbsp;in&nbsp;the&nbsp;behavior&nbsp;of</span><br>
<span class="lineno">35</span><span class="comment" id="4749113">//&nbsp;UnmarshalJSON.</span><br>
<span class="lineno"></span><span class="comment" id="4749131">//</span><br>
<span class="lineno"></span><span class="comment" id="4749134">//&nbsp;Otherwise,&nbsp;Marshal&nbsp;uses&nbsp;the&nbsp;following&nbsp;type-dependent&nbsp;default&nbsp;encodings:</span><br>
<span class="lineno"></span><span class="comment" id="4749209">//</span><br>
<span class="lineno"></span><span class="comment" id="4749212">//&nbsp;Boolean&nbsp;values&nbsp;encode&nbsp;as&nbsp;JSON&nbsp;booleans.</span><br>
<span class="lineno">40</span><span class="comment" id="4749255">//</span><br>
<span class="lineno"></span><span class="comment" id="4749258">//&nbsp;Floating&nbsp;point,&nbsp;integer,&nbsp;and&nbsp;Number&nbsp;values&nbsp;encode&nbsp;as&nbsp;JSON&nbsp;numbers.</span><br>
<span class="lineno"></span><span class="comment" id="4749328">//</span><br>
<span class="lineno"></span><span class="comment" id="4749331">//&nbsp;String&nbsp;values&nbsp;encode&nbsp;as&nbsp;JSON&nbsp;strings&nbsp;coerced&nbsp;to&nbsp;valid&nbsp;UTF-8,</span><br>
<span class="lineno"></span><span class="comment" id="4749395">//&nbsp;replacing&nbsp;invalid&nbsp;bytes&nbsp;with&nbsp;the&nbsp;Unicode&nbsp;replacement&nbsp;rune.</span><br>
<span class="lineno">45</span><span class="comment" id="4749457">//&nbsp;The&nbsp;angle&nbsp;brackets&nbsp;&#34;&lt;&#34;&nbsp;and&nbsp;&#34;&gt;&#34;&nbsp;are&nbsp;escaped&nbsp;to&nbsp;&#34;\u003c&#34;&nbsp;and&nbsp;&#34;\u003e&#34;</span><br>
<span class="lineno"></span><span class="comment" id="4749528">//&nbsp;to&nbsp;keep&nbsp;some&nbsp;browsers&nbsp;from&nbsp;misinterpreting&nbsp;JSON&nbsp;output&nbsp;as&nbsp;HTML.</span><br>
<span class="lineno"></span><span class="comment" id="4749595">//&nbsp;Ampersand&nbsp;&#34;&amp;&#34;&nbsp;is&nbsp;also&nbsp;escaped&nbsp;to&nbsp;&#34;\u0026&#34;&nbsp;for&nbsp;the&nbsp;same&nbsp;reason.</span><br>
<span class="lineno"></span><span class="comment" id="4749661">//</span><br>
<span class="lineno"></span><span class="comment" id="4749664">//&nbsp;Array&nbsp;and&nbsp;slice&nbsp;values&nbsp;encode&nbsp;as&nbsp;JSON&nbsp;arrays,&nbsp;except&nbsp;that</span><br>
<span class="lineno">50</span><span class="comment" id="4749725">//&nbsp;[]byte&nbsp;encodes&nbsp;as&nbsp;a&nbsp;base64-encoded&nbsp;string,&nbsp;and&nbsp;a&nbsp;nil&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="4749787">//&nbsp;encodes&nbsp;as&nbsp;the&nbsp;null&nbsp;JSON&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="4749823">//</span><br>
<span class="lineno"></span><span class="comment" id="4749826">//&nbsp;Struct&nbsp;values&nbsp;encode&nbsp;as&nbsp;JSON&nbsp;objects.&nbsp;Each&nbsp;exported&nbsp;struct&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="4749894">//&nbsp;becomes&nbsp;a&nbsp;member&nbsp;of&nbsp;the&nbsp;object&nbsp;unless</span><br>
<span class="lineno">55</span><span class="comment" id="4749935">//&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;field&#39;s&nbsp;tag&nbsp;is&nbsp;&#34;-&#34;,&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="4749969">//&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;field&nbsp;is&nbsp;empty&nbsp;and&nbsp;its&nbsp;tag&nbsp;specifies&nbsp;the&nbsp;&#34;omitempty&#34;&nbsp;option.</span><br>
<span class="lineno"></span><span class="comment" id="4750041">//&nbsp;The&nbsp;empty&nbsp;values&nbsp;are&nbsp;false,&nbsp;0,&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="4750079">//&nbsp;nil&nbsp;pointer&nbsp;or&nbsp;interface&nbsp;value,&nbsp;and&nbsp;any&nbsp;array,&nbsp;slice,&nbsp;map,&nbsp;or&nbsp;string&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4750154">//&nbsp;length&nbsp;zero.&nbsp;The&nbsp;object&#39;s&nbsp;default&nbsp;key&nbsp;string&nbsp;is&nbsp;the&nbsp;struct&nbsp;field&nbsp;name</span><br>
<span class="lineno">60</span><span class="comment" id="4750227">//&nbsp;but&nbsp;can&nbsp;be&nbsp;specified&nbsp;in&nbsp;the&nbsp;struct&nbsp;field&#39;s&nbsp;tag&nbsp;value.&nbsp;The&nbsp;&#34;json&#34;&nbsp;key&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4750302">//&nbsp;the&nbsp;struct&nbsp;field&#39;s&nbsp;tag&nbsp;value&nbsp;is&nbsp;the&nbsp;key&nbsp;name,&nbsp;followed&nbsp;by&nbsp;an&nbsp;optional&nbsp;comma</span><br>
<span class="lineno"></span><span class="comment" id="4750381">//&nbsp;and&nbsp;options.&nbsp;Examples:</span><br>
<span class="lineno"></span><span class="comment" id="4750407">//</span><br>
<span class="lineno"></span><span class="comment" id="4750410">//&nbsp;&nbsp;&nbsp;//&nbsp;Field&nbsp;is&nbsp;ignored&nbsp;by&nbsp;this&nbsp;package.</span><br>
<span class="lineno">65</span><span class="comment" id="4750452">//&nbsp;&nbsp;&nbsp;Field&nbsp;int&nbsp;`json:&#34;-&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="4750478">//</span><br>
<span class="lineno"></span><span class="comment" id="4750481">//&nbsp;&nbsp;&nbsp;//&nbsp;Field&nbsp;appears&nbsp;in&nbsp;JSON&nbsp;as&nbsp;key&nbsp;&#34;myName&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="4750528">//&nbsp;&nbsp;&nbsp;Field&nbsp;int&nbsp;`json:&#34;myName&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="4750559">//</span><br>
<span class="lineno">70</span><span class="comment" id="4750562">//&nbsp;&nbsp;&nbsp;//&nbsp;Field&nbsp;appears&nbsp;in&nbsp;JSON&nbsp;as&nbsp;key&nbsp;&#34;myName&#34;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4750612">//&nbsp;&nbsp;&nbsp;//&nbsp;the&nbsp;field&nbsp;is&nbsp;omitted&nbsp;from&nbsp;the&nbsp;object&nbsp;if&nbsp;its&nbsp;value&nbsp;is&nbsp;empty,</span><br>
<span class="lineno"></span><span class="comment" id="4750680">//&nbsp;&nbsp;&nbsp;//&nbsp;as&nbsp;defined&nbsp;above.</span><br>
<span class="lineno"></span><span class="comment" id="4750706">//&nbsp;&nbsp;&nbsp;Field&nbsp;int&nbsp;`json:&#34;myName,omitempty&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="4750747">//</span><br>
<span class="lineno">75</span><span class="comment" id="4750750">//&nbsp;&nbsp;&nbsp;//&nbsp;Field&nbsp;appears&nbsp;in&nbsp;JSON&nbsp;as&nbsp;key&nbsp;&#34;Field&#34;&nbsp;(the&nbsp;default),&nbsp;but</span><br>
<span class="lineno"></span><span class="comment" id="4750814">//&nbsp;&nbsp;&nbsp;//&nbsp;the&nbsp;field&nbsp;is&nbsp;skipped&nbsp;if&nbsp;empty.</span><br>
<span class="lineno"></span><span class="comment" id="4750853">//&nbsp;&nbsp;&nbsp;//&nbsp;Note&nbsp;the&nbsp;leading&nbsp;comma.</span><br>
<span class="lineno"></span><span class="comment" id="4750885">//&nbsp;&nbsp;&nbsp;Field&nbsp;int&nbsp;`json:&#34;,omitempty&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="4750920">//</span><br>
<span class="lineno">80</span><span class="comment" id="4750923">//&nbsp;The&nbsp;&#34;string&#34;&nbsp;option&nbsp;signals&nbsp;that&nbsp;a&nbsp;field&nbsp;is&nbsp;stored&nbsp;as&nbsp;JSON&nbsp;inside&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4750994">//&nbsp;JSON-encoded&nbsp;string.&nbsp;It&nbsp;applies&nbsp;only&nbsp;to&nbsp;fields&nbsp;of&nbsp;string,&nbsp;floating&nbsp;point,</span><br>
<span class="lineno"></span><span class="comment" id="4751071">//&nbsp;or&nbsp;integer&nbsp;types.&nbsp;This&nbsp;extra&nbsp;level&nbsp;of&nbsp;encoding&nbsp;is&nbsp;sometimes&nbsp;used&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="4751144">//&nbsp;communicating&nbsp;with&nbsp;JavaScript&nbsp;programs:</span><br>
<span class="lineno"></span><span class="comment" id="4751187">//</span><br>
<span class="lineno">85</span><span class="comment" id="4751190">//&nbsp;&nbsp;&nbsp;&nbsp;Int64String&nbsp;int64&nbsp;`json:&#34;,string&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="4751231">//</span><br>
<span class="lineno"></span><span class="comment" id="4751234">//&nbsp;The&nbsp;key&nbsp;name&nbsp;will&nbsp;be&nbsp;used&nbsp;if&nbsp;it&#39;s&nbsp;a&nbsp;non-empty&nbsp;string&nbsp;consisting&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4751304">//&nbsp;only&nbsp;Unicode&nbsp;letters,&nbsp;digits,&nbsp;dollar&nbsp;signs,&nbsp;percent&nbsp;signs,&nbsp;hyphens,</span><br>
<span class="lineno"></span><span class="comment" id="4751375">//&nbsp;underscores&nbsp;and&nbsp;slashes.</span><br>
<span class="lineno">90</span><span class="comment" id="4751403">//</span><br>
<span class="lineno"></span><span class="comment" id="4751406">//&nbsp;Anonymous&nbsp;struct&nbsp;fields&nbsp;are&nbsp;usually&nbsp;marshaled&nbsp;as&nbsp;if&nbsp;their&nbsp;inner&nbsp;exported&nbsp;fields</span><br>
<span class="lineno"></span><span class="comment" id="4751489">//&nbsp;were&nbsp;fields&nbsp;in&nbsp;the&nbsp;outer&nbsp;struct,&nbsp;subject&nbsp;to&nbsp;the&nbsp;usual&nbsp;Go&nbsp;visibility&nbsp;rules&nbsp;amended</span><br>
<span class="lineno"></span><span class="comment" id="4751574">//&nbsp;as&nbsp;described&nbsp;in&nbsp;the&nbsp;next&nbsp;paragraph.</span><br>
<span class="lineno"></span><span class="comment" id="4751613">//&nbsp;An&nbsp;anonymous&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name&nbsp;given&nbsp;in&nbsp;its&nbsp;JSON&nbsp;tag&nbsp;is&nbsp;treated&nbsp;as</span><br>
<span class="lineno">95</span><span class="comment" id="4751690">//&nbsp;having&nbsp;that&nbsp;name,&nbsp;rather&nbsp;than&nbsp;being&nbsp;anonymous.</span><br>
<span class="lineno"></span><span class="comment" id="4751740">//&nbsp;An&nbsp;anonymous&nbsp;struct&nbsp;field&nbsp;of&nbsp;interface&nbsp;type&nbsp;is&nbsp;treated&nbsp;the&nbsp;same&nbsp;as&nbsp;having</span><br>
<span class="lineno"></span><span class="comment" id="4751817">//&nbsp;that&nbsp;type&nbsp;as&nbsp;its&nbsp;name,&nbsp;rather&nbsp;than&nbsp;being&nbsp;anonymous.</span><br>
<span class="lineno"></span><span class="comment" id="4751872">//</span><br>
<span class="lineno"></span><span class="comment" id="4751875">//&nbsp;The&nbsp;Go&nbsp;visibility&nbsp;rules&nbsp;for&nbsp;struct&nbsp;fields&nbsp;are&nbsp;amended&nbsp;for&nbsp;JSON&nbsp;when</span><br>
<span class="lineno">100</span><span class="comment" id="4751946">//&nbsp;deciding&nbsp;which&nbsp;field&nbsp;to&nbsp;marshal&nbsp;or&nbsp;unmarshal.&nbsp;If&nbsp;there&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4752008">//&nbsp;multiple&nbsp;fields&nbsp;at&nbsp;the&nbsp;same&nbsp;level,&nbsp;and&nbsp;that&nbsp;level&nbsp;is&nbsp;the&nbsp;least</span><br>
<span class="lineno"></span><span class="comment" id="4752074">//&nbsp;nested&nbsp;(and&nbsp;would&nbsp;therefore&nbsp;be&nbsp;the&nbsp;nesting&nbsp;level&nbsp;selected&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4752142">//&nbsp;usual&nbsp;Go&nbsp;rules),&nbsp;the&nbsp;following&nbsp;extra&nbsp;rules&nbsp;apply:</span><br>
<span class="lineno"></span><span class="comment" id="4752195">//</span><br>
<span class="lineno">105</span><span class="comment" id="4752198">//&nbsp;1)&nbsp;Of&nbsp;those&nbsp;fields,&nbsp;if&nbsp;any&nbsp;are&nbsp;JSON-tagged,&nbsp;only&nbsp;tagged&nbsp;fields&nbsp;are&nbsp;considered,</span><br>
<span class="lineno"></span><span class="comment" id="4752280">//&nbsp;even&nbsp;if&nbsp;there&nbsp;are&nbsp;multiple&nbsp;untagged&nbsp;fields&nbsp;that&nbsp;would&nbsp;otherwise&nbsp;conflict.</span><br>
<span class="lineno"></span><span class="comment" id="4752357">//&nbsp;2)&nbsp;If&nbsp;there&nbsp;is&nbsp;exactly&nbsp;one&nbsp;field&nbsp;(tagged&nbsp;or&nbsp;not&nbsp;according&nbsp;to&nbsp;the&nbsp;first&nbsp;rule),&nbsp;that&nbsp;is&nbsp;selected.</span><br>
<span class="lineno"></span><span class="comment" id="4752456">//&nbsp;3)&nbsp;Otherwise&nbsp;there&nbsp;are&nbsp;multiple&nbsp;fields,&nbsp;and&nbsp;all&nbsp;are&nbsp;ignored;&nbsp;no&nbsp;error&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="comment" id="4752537">//</span><br>
<span class="lineno">110</span><span class="comment" id="4752540">//&nbsp;Handling&nbsp;of&nbsp;anonymous&nbsp;struct&nbsp;fields&nbsp;is&nbsp;new&nbsp;in&nbsp;Go&nbsp;1.1.</span><br>
<span class="lineno"></span><span class="comment" id="4752597">//&nbsp;Prior&nbsp;to&nbsp;Go&nbsp;1.1,&nbsp;anonymous&nbsp;struct&nbsp;fields&nbsp;were&nbsp;ignored.&nbsp;To&nbsp;force&nbsp;ignoring&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4752676">//&nbsp;an&nbsp;anonymous&nbsp;struct&nbsp;field&nbsp;in&nbsp;both&nbsp;current&nbsp;and&nbsp;earlier&nbsp;versions,&nbsp;give&nbsp;the&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="4752758">//&nbsp;a&nbsp;JSON&nbsp;tag&nbsp;of&nbsp;&#34;-&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="4752780">//</span><br>
<span class="lineno">115</span><span class="comment" id="4752783">//&nbsp;Map&nbsp;values&nbsp;encode&nbsp;as&nbsp;JSON&nbsp;objects.</span><br>
<span class="lineno"></span><span class="comment" id="4752821">//&nbsp;The&nbsp;map&#39;s&nbsp;key&nbsp;type&nbsp;must&nbsp;be&nbsp;string;&nbsp;the&nbsp;object&nbsp;keys&nbsp;are&nbsp;used&nbsp;directly</span><br>
<span class="lineno"></span><span class="comment" id="4752893">//&nbsp;as&nbsp;map&nbsp;keys.</span><br>
<span class="lineno"></span><span class="comment" id="4752909">//</span><br>
<span class="lineno"></span><span class="comment" id="4752912">//&nbsp;Pointer&nbsp;values&nbsp;encode&nbsp;as&nbsp;the&nbsp;value&nbsp;pointed&nbsp;to.</span><br>
<span class="lineno">120</span><span class="comment" id="4752962">//&nbsp;A&nbsp;nil&nbsp;pointer&nbsp;encodes&nbsp;as&nbsp;the&nbsp;null&nbsp;JSON&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="4753012">//</span><br>
<span class="lineno"></span><span class="comment" id="4753015">//&nbsp;Interface&nbsp;values&nbsp;encode&nbsp;as&nbsp;the&nbsp;value&nbsp;contained&nbsp;in&nbsp;the&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="4753083">//&nbsp;A&nbsp;nil&nbsp;interface&nbsp;value&nbsp;encodes&nbsp;as&nbsp;the&nbsp;null&nbsp;JSON&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="4753141">//</span><br>
<span class="lineno">125</span><span class="comment" id="4753144">//&nbsp;Channel,&nbsp;complex,&nbsp;and&nbsp;function&nbsp;values&nbsp;cannot&nbsp;be&nbsp;encoded&nbsp;in&nbsp;JSON.</span><br>
<span class="lineno"></span><span class="comment" id="4753212">//&nbsp;Attempting&nbsp;to&nbsp;encode&nbsp;such&nbsp;a&nbsp;value&nbsp;causes&nbsp;Marshal&nbsp;to&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="4753274">//&nbsp;an&nbsp;UnsupportedTypeError.</span><br>
<span class="lineno"></span><span class="comment" id="4753302">//</span><br>
<span class="lineno"></span><span class="comment" id="4753305">//&nbsp;JSON&nbsp;cannot&nbsp;represent&nbsp;cyclic&nbsp;data&nbsp;structures&nbsp;and&nbsp;Marshal&nbsp;does&nbsp;not</span><br>
<span class="lineno">130</span><span class="comment" id="4753374">//&nbsp;handle&nbsp;them.&nbsp;&nbsp;Passing&nbsp;cyclic&nbsp;structures&nbsp;to&nbsp;Marshal&nbsp;will&nbsp;result&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4753443">//&nbsp;an&nbsp;infinite&nbsp;recursion.</span><br>
<span class="lineno"></span><span class="comment" id="4753469">//</span><br>
<span class="lineno"></span><span class="keyword" id="4753472">func</span>&nbsp;<span class="ident" id="4753477">Marshal</span><span class="op" id="4753484">(</span><span class="ident" id="4753485">v</span>&nbsp;<span class="keyword" id="4753487">interface</span><span class="op" id="4753496">{</span><span class="op" id="4753497">}</span><span class="op" id="4753498">)</span>&nbsp;<span class="op" id="4753500">(</span><span class="op" id="4753501">[</span><span class="op" id="4753502">]</span><span class="builtintype" id="4753503">byte</span><span class="op" id="4753507">,</span>&nbsp;<span class="builtintype" id="4753509">error</span><span class="op" id="4753514">)</span>&nbsp;<span class="op" id="4753516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753519">e</span>&nbsp;<span class="op" id="4753521">:=</span>&nbsp;<span class="op" id="4753524">&amp;</span><span class="ident" id="4753525"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4753536">{</span><span class="op" id="4753537">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753540">err</span>&nbsp;<span class="op" id="4753544">:=</span>&nbsp;<span class="ident" id="4753547"><a href="/encoding/json/encode.go.html#4753519">e</a></span><span class="op" id="4753548">.</span><span class="ident" id="4753549">marshal</span><span class="op" id="4753556">(</span><span class="ident" id="4753557"><a href="/encoding/json/encode.go.html#4753485">v</a></span><span class="op" id="4753558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753561">if</span>&nbsp;<span class="ident" id="4753564"><a href="/encoding/json/encode.go.html#4753540">err</a></span>&nbsp;<span class="op" id="4753568">!=</span>&nbsp;<span class="ident" id="4753571">nil</span>&nbsp;<span class="op" id="4753575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753579">return</span>&nbsp;<span class="ident" id="4753586">nil</span><span class="op" id="4753589">,</span>&nbsp;<span class="ident" id="4753591"><a href="/encoding/json/encode.go.html#4753540">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4753596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753599">return</span>&nbsp;<span class="ident" id="4753606"><a href="/encoding/json/encode.go.html#4753519">e</a></span><span class="op" id="4753607">.</span><span class="ident" id="4753608">Bytes</span><span class="op" id="4753613">(</span><span class="op" id="4753614">)</span><span class="op" id="4753615">,</span>&nbsp;<span class="ident" id="4753617">nil</span><br>
<span class="lineno">140</span><span class="op" id="4753621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4753624">//&nbsp;MarshalIndent&nbsp;is&nbsp;like&nbsp;Marshal&nbsp;but&nbsp;applies&nbsp;Indent&nbsp;to&nbsp;format&nbsp;the&nbsp;output.</span><br>
<span class="lineno"></span><span class="keyword" id="4753698">func</span>&nbsp;<span class="ident" id="4753703">MarshalIndent</span><span class="op" id="4753716">(</span><span class="ident" id="4753717">v</span>&nbsp;<span class="keyword" id="4753719">interface</span><span class="op" id="4753728">{</span><span class="op" id="4753729">}</span><span class="op" id="4753730">,</span>&nbsp;<span class="ident" id="4753732">prefix</span><span class="op" id="4753738">,</span>&nbsp;<span class="ident" id="4753740">indent</span>&nbsp;<span class="builtintype" id="4753747">string</span><span class="op" id="4753753">)</span>&nbsp;<span class="op" id="4753755">(</span><span class="op" id="4753756">[</span><span class="op" id="4753757">]</span><span class="builtintype" id="4753758">byte</span><span class="op" id="4753762">,</span>&nbsp;<span class="builtintype" id="4753764">error</span><span class="op" id="4753769">)</span>&nbsp;<span class="op" id="4753771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753774">b</span><span class="op" id="4753775">,</span>&nbsp;<span class="ident" id="4753777">err</span>&nbsp;<span class="op" id="4753781">:=</span>&nbsp;<span class="ident" id="4753784"><a href="/encoding/json/encode.go.html#4753477">Marshal</a></span><span class="op" id="4753791">(</span><span class="ident" id="4753792"><a href="/encoding/json/encode.go.html#4753717">v</a></span><span class="op" id="4753793">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753796">if</span>&nbsp;<span class="ident" id="4753799"><a href="/encoding/json/encode.go.html#4753777">err</a></span>&nbsp;<span class="op" id="4753803">!=</span>&nbsp;<span class="ident" id="4753806">nil</span>&nbsp;<span class="op" id="4753810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753814">return</span>&nbsp;<span class="ident" id="4753821">nil</span><span class="op" id="4753824">,</span>&nbsp;<span class="ident" id="4753826"><a href="/encoding/json/encode.go.html#4753777">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4753831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753834">var</span>&nbsp;<span class="ident" id="4753838">buf</span>&nbsp;<span class="ident" id="4753842"><a href="/encoding/json/encode.go.html#4748619">bytes</a></span><span class="op" id="4753847">.</span><span class="ident" id="4753848">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4753856"><a href="/encoding/json/encode.go.html#4753777">err</a></span>&nbsp;<span class="op" id="4753860">=</span>&nbsp;<span class="ident" id="4753862"><a href="/encoding/json/indent.go.html#4784407">Indent</a></span><span class="op" id="4753868">(</span><span class="op" id="4753869">&amp;</span><span class="ident" id="4753870"><a href="/encoding/json/encode.go.html#4753838">buf</a></span><span class="op" id="4753873">,</span>&nbsp;<span class="ident" id="4753875"><a href="/encoding/json/encode.go.html#4753774">b</a></span><span class="op" id="4753876">,</span>&nbsp;<span class="ident" id="4753878"><a href="/encoding/json/encode.go.html#4753732">prefix</a></span><span class="op" id="4753884">,</span>&nbsp;<span class="ident" id="4753886"><a href="/encoding/json/encode.go.html#4753740">indent</a></span><span class="op" id="4753892">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753895">if</span>&nbsp;<span class="ident" id="4753898"><a href="/encoding/json/encode.go.html#4753777">err</a></span>&nbsp;<span class="op" id="4753902">!=</span>&nbsp;<span class="ident" id="4753905">nil</span>&nbsp;<span class="op" id="4753909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753913">return</span>&nbsp;<span class="ident" id="4753920">nil</span><span class="op" id="4753923">,</span>&nbsp;<span class="ident" id="4753925"><a href="/encoding/json/encode.go.html#4753777">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4753930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4753933">return</span>&nbsp;<span class="ident" id="4753940"><a href="/encoding/json/encode.go.html#4753838">buf</a></span><span class="op" id="4753943">.</span><span class="ident" id="4753944">Bytes</span><span class="op" id="4753949">(</span><span class="op" id="4753950">)</span><span class="op" id="4753951">,</span>&nbsp;<span class="ident" id="4753953">nil</span><br>
<span class="lineno"></span><span class="op" id="4753957">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="4753960">//&nbsp;HTMLEscape&nbsp;appends&nbsp;to&nbsp;dst&nbsp;the&nbsp;JSON-encoded&nbsp;src&nbsp;with&nbsp;&lt;,&nbsp;&gt;,&nbsp;&amp;,&nbsp;U+2028&nbsp;and&nbsp;U+2029</span><br>
<span class="lineno"></span><span class="comment" id="4754042">//&nbsp;characters&nbsp;inside&nbsp;string&nbsp;literals&nbsp;changed&nbsp;to&nbsp;\u003c,&nbsp;\u003e,&nbsp;\u0026,&nbsp;\u2028,&nbsp;\u2029</span><br>
<span class="lineno"></span><span class="comment" id="4754129">//&nbsp;so&nbsp;that&nbsp;the&nbsp;JSON&nbsp;will&nbsp;be&nbsp;safe&nbsp;to&nbsp;embed&nbsp;inside&nbsp;HTML&nbsp;&lt;script&gt;&nbsp;tags.</span><br>
<span class="lineno"></span><span class="comment" id="4754198">//&nbsp;For&nbsp;historical&nbsp;reasons,&nbsp;web&nbsp;browsers&nbsp;don&#39;t&nbsp;honor&nbsp;standard&nbsp;HTML</span><br>
<span class="lineno">160</span><span class="comment" id="4754264">//&nbsp;escaping&nbsp;within&nbsp;&lt;script&gt;&nbsp;tags,&nbsp;so&nbsp;an&nbsp;alternative&nbsp;JSON&nbsp;encoding&nbsp;must</span><br>
<span class="lineno"></span><span class="comment" id="4754335">//&nbsp;be&nbsp;used.</span><br>
<span class="lineno"></span><span class="keyword" id="4754347">func</span>&nbsp;<span class="ident" id="4754352">HTMLEscape</span><span class="op" id="4754362">(</span><span class="ident" id="4754363">dst</span>&nbsp;<span class="op" id="4754367">*</span><span class="ident" id="4754368"><a href="/encoding/json/encode.go.html#4748619">bytes</a></span><span class="op" id="4754373">.</span><span class="ident" id="4754374">Buffer</span><span class="op" id="4754380">,</span>&nbsp;<span class="ident" id="4754382">src</span>&nbsp;<span class="op" id="4754386">[</span><span class="op" id="4754387">]</span><span class="builtintype" id="4754388">byte</span><span class="op" id="4754392">)</span>&nbsp;<span class="op" id="4754394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4754397">//&nbsp;The&nbsp;characters&nbsp;can&nbsp;only&nbsp;appear&nbsp;in&nbsp;string&nbsp;literals,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4754452">//&nbsp;so&nbsp;just&nbsp;scan&nbsp;the&nbsp;string&nbsp;one&nbsp;byte&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754500">start</span>&nbsp;<span class="op" id="4754506">:=</span>&nbsp;<span class="num" id="4754509">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754512">for</span>&nbsp;<span class="ident" id="4754516">i</span><span class="op" id="4754517">,</span>&nbsp;<span class="ident" id="4754519">c</span>&nbsp;<span class="op" id="4754521">:=</span>&nbsp;<span class="keyword" id="4754524">range</span>&nbsp;<span class="ident" id="4754530"><a href="/encoding/json/encode.go.html#4754382">src</a></span>&nbsp;<span class="op" id="4754534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754538">if</span>&nbsp;<span class="ident" id="4754541"><a href="/encoding/json/encode.go.html#4754519">c</a></span>&nbsp;<span class="op" id="4754543">==</span>&nbsp;<span class="string" id="4754546">&#39;&lt;&#39;</span>&nbsp;<span class="op" id="4754550">||</span>&nbsp;<span class="ident" id="4754553"><a href="/encoding/json/encode.go.html#4754519">c</a></span>&nbsp;<span class="op" id="4754555">==</span>&nbsp;<span class="string" id="4754558">&#39;&gt;&#39;</span>&nbsp;<span class="op" id="4754562">||</span>&nbsp;<span class="ident" id="4754565"><a href="/encoding/json/encode.go.html#4754519">c</a></span>&nbsp;<span class="op" id="4754567">==</span>&nbsp;<span class="string" id="4754570">&#39;&amp;&#39;</span>&nbsp;<span class="op" id="4754574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754579">if</span>&nbsp;<span class="ident" id="4754582"><a href="/encoding/json/encode.go.html#4754500">start</a></span>&nbsp;<span class="op" id="4754588">&lt;</span>&nbsp;<span class="ident" id="4754590"><a href="/encoding/json/encode.go.html#4754516">i</a></span>&nbsp;<span class="op" id="4754592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754598"><a href="/encoding/json/encode.go.html#4754363">dst</a></span><span class="op" id="4754601">.</span><span class="ident" id="4754602">Write</span><span class="op" id="4754607">(</span><span class="ident" id="4754608"><a href="/encoding/json/encode.go.html#4754382">src</a></span><span class="op" id="4754611">[</span><span class="ident" id="4754612"><a href="/encoding/json/encode.go.html#4754500">start</a></span><span class="op" id="4754617">:</span><span class="ident" id="4754618"><a href="/encoding/json/encode.go.html#4754516">i</a></span><span class="op" id="4754619">]</span><span class="op" id="4754620">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4754625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754630"><a href="/encoding/json/encode.go.html#4754363">dst</a></span><span class="op" id="4754633">.</span><span class="ident" id="4754634">WriteString</span><span class="op" id="4754645">(</span><span class="string" id="4754646">`\u00`</span><span class="op" id="4754652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754657"><a href="/encoding/json/encode.go.html#4754363">dst</a></span><span class="op" id="4754660">.</span><span class="ident" id="4754661">WriteByte</span><span class="op" id="4754670">(</span><span class="ident" id="4754671"><a href="/encoding/json/encode.go.html#4756457">hex</a></span><span class="op" id="4754674">[</span><span class="ident" id="4754675"><a href="/encoding/json/encode.go.html#4754519">c</a></span><span class="op" id="4754676">&gt;&gt;</span><span class="num" id="4754678">4</span><span class="op" id="4754679">]</span><span class="op" id="4754680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754685"><a href="/encoding/json/encode.go.html#4754363">dst</a></span><span class="op" id="4754688">.</span><span class="ident" id="4754689">WriteByte</span><span class="op" id="4754698">(</span><span class="ident" id="4754699"><a href="/encoding/json/encode.go.html#4756457">hex</a></span><span class="op" id="4754702">[</span><span class="ident" id="4754703"><a href="/encoding/json/encode.go.html#4754519">c</a></span><span class="op" id="4754704">&amp;</span><span class="num" id="4754705">0xF</span><span class="op" id="4754708">]</span><span class="op" id="4754709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754714"><a href="/encoding/json/encode.go.html#4754500">start</a></span>&nbsp;<span class="op" id="4754720">=</span>&nbsp;<span class="ident" id="4754722"><a href="/encoding/json/encode.go.html#4754516">i</a></span>&nbsp;<span class="op" id="4754724">+</span>&nbsp;<span class="num" id="4754726">1</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4754730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4754734">//&nbsp;Convert&nbsp;U+2028&nbsp;and&nbsp;U+2029&nbsp;(E2&nbsp;80&nbsp;A8&nbsp;and&nbsp;E2&nbsp;80&nbsp;A9).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754790">if</span>&nbsp;<span class="ident" id="4754793"><a href="/encoding/json/encode.go.html#4754519">c</a></span>&nbsp;<span class="op" id="4754795">==</span>&nbsp;<span class="num" id="4754798">0xE2</span>&nbsp;<span class="op" id="4754803">&amp;&amp;</span>&nbsp;<span class="ident" id="4754806"><a href="/encoding/json/encode.go.html#4754516">i</a></span><span class="op" id="4754807">+</span><span class="num" id="4754808">2</span>&nbsp;<span class="op" id="4754810">&lt;</span>&nbsp;<span class="builtinfunc" id="4754812">len</span><span class="op" id="4754815">(</span><span class="ident" id="4754816"><a href="/encoding/json/encode.go.html#4754382">src</a></span><span class="op" id="4754819">)</span>&nbsp;<span class="op" id="4754821">&amp;&amp;</span>&nbsp;<span class="ident" id="4754824"><a href="/encoding/json/encode.go.html#4754382">src</a></span><span class="op" id="4754827">[</span><span class="ident" id="4754828"><a href="/encoding/json/encode.go.html#4754516">i</a></span><span class="op" id="4754829">+</span><span class="num" id="4754830">1</span><span class="op" id="4754831">]</span>&nbsp;<span class="op" id="4754833">==</span>&nbsp;<span class="num" id="4754836">0x80</span>&nbsp;<span class="op" id="4754841">&amp;&amp;</span>&nbsp;<span class="ident" id="4754844"><a href="/encoding/json/encode.go.html#4754382">src</a></span><span class="op" id="4754847">[</span><span class="ident" id="4754848"><a href="/encoding/json/encode.go.html#4754516">i</a></span><span class="op" id="4754849">+</span><span class="num" id="4754850">2</span><span class="op" id="4754851">]</span><span class="op" id="4754852">&amp;^</span><span class="num" id="4754854">1</span>&nbsp;<span class="op" id="4754856">==</span>&nbsp;<span class="num" id="4754859">0xA8</span>&nbsp;<span class="op" id="4754864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4754869">if</span>&nbsp;<span class="ident" id="4754872"><a href="/encoding/json/encode.go.html#4754500">start</a></span>&nbsp;<span class="op" id="4754878">&lt;</span>&nbsp;<span class="ident" id="4754880"><a href="/encoding/json/encode.go.html#4754516">i</a></span>&nbsp;<span class="op" id="4754882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754888"><a href="/encoding/json/encode.go.html#4754363">dst</a></span><span class="op" id="4754891">.</span><span class="ident" id="4754892">Write</span><span class="op" id="4754897">(</span><span class="ident" id="4754898"><a href="/encoding/json/encode.go.html#4754382">src</a></span><span class="op" id="4754901">[</span><span class="ident" id="4754902"><a href="/encoding/json/encode.go.html#4754500">start</a></span><span class="op" id="4754907">:</span><span class="ident" id="4754908"><a href="/encoding/json/encode.go.html#4754516">i</a></span><span class="op" id="4754909">]</span><span class="op" id="4754910">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4754915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754920"><a href="/encoding/json/encode.go.html#4754363">dst</a></span><span class="op" id="4754923">.</span><span class="ident" id="4754924">WriteString</span><span class="op" id="4754935">(</span><span class="string" id="4754936">`\u202`</span><span class="op" id="4754943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754948"><a href="/encoding/json/encode.go.html#4754363">dst</a></span><span class="op" id="4754951">.</span><span class="ident" id="4754952">WriteByte</span><span class="op" id="4754961">(</span><span class="ident" id="4754962"><a href="/encoding/json/encode.go.html#4756457">hex</a></span><span class="op" id="4754965">[</span><span class="ident" id="4754966"><a href="/encoding/json/encode.go.html#4754382">src</a></span><span class="op" id="4754969">[</span><span class="ident" id="4754970"><a href="/encoding/json/encode.go.html#4754516">i</a></span><span class="op" id="4754971">+</span><span class="num" id="4754972">2</span><span class="op" id="4754973">]</span><span class="op" id="4754974">&amp;</span><span class="num" id="4754975">0xF</span><span class="op" id="4754978">]</span><span class="op" id="4754979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4754984"><a href="/encoding/json/encode.go.html#4754500">start</a></span>&nbsp;<span class="op" id="4754990">=</span>&nbsp;<span class="ident" id="4754992"><a href="/encoding/json/encode.go.html#4754516">i</a></span>&nbsp;<span class="op" id="4754994">+</span>&nbsp;<span class="num" id="4754996">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4755000">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4755003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4755006">if</span>&nbsp;<span class="ident" id="4755009"><a href="/encoding/json/encode.go.html#4754500">start</a></span>&nbsp;<span class="op" id="4755015">&lt;</span>&nbsp;<span class="builtinfunc" id="4755017">len</span><span class="op" id="4755020">(</span><span class="ident" id="4755021"><a href="/encoding/json/encode.go.html#4754382">src</a></span><span class="op" id="4755024">)</span>&nbsp;<span class="op" id="4755026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4755030"><a href="/encoding/json/encode.go.html#4754363">dst</a></span><span class="op" id="4755033">.</span><span class="ident" id="4755034">Write</span><span class="op" id="4755039">(</span><span class="ident" id="4755040"><a href="/encoding/json/encode.go.html#4754382">src</a></span><span class="op" id="4755043">[</span><span class="ident" id="4755044"><a href="/encoding/json/encode.go.html#4754500">start</a></span><span class="op" id="4755049">:</span><span class="op" id="4755050">]</span><span class="op" id="4755051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4755054">}</span><br>
<span class="lineno"></span><span class="op" id="4755056">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="4755059">//&nbsp;Marshaler&nbsp;is&nbsp;the&nbsp;interface&nbsp;implemented&nbsp;by&nbsp;objects&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4755117">//&nbsp;can&nbsp;marshal&nbsp;themselves&nbsp;into&nbsp;valid&nbsp;JSON.</span><br>
<span class="lineno"></span><span class="keyword" id="4755160">type</span>&nbsp;<span class="ident" id="4755165">Marshaler</span>&nbsp;<span class="keyword" id="4755175">interface</span>&nbsp;<span class="op" id="4755185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4755188">MarshalJSON</span><span class="op" id="4755199">(</span><span class="op" id="4755200">)</span>&nbsp;<span class="op" id="4755202">(</span><span class="op" id="4755203">[</span><span class="op" id="4755204">]</span><span class="builtintype" id="4755205">byte</span><span class="op" id="4755209">,</span>&nbsp;<span class="builtintype" id="4755211">error</span><span class="op" id="4755216">)</span><br>
<span class="lineno">195</span><span class="op" id="4755218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4755221">//&nbsp;An&nbsp;UnsupportedTypeError&nbsp;is&nbsp;returned&nbsp;by&nbsp;Marshal&nbsp;when&nbsp;attempting</span><br>
<span class="lineno"></span><span class="comment" id="4755287">//&nbsp;to&nbsp;encode&nbsp;an&nbsp;unsupported&nbsp;value&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4755327">type</span>&nbsp;<span class="ident" id="4755332">UnsupportedTypeError</span>&nbsp;<span class="keyword" id="4755353">struct</span>&nbsp;<span class="op" id="4755360">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4755363">Type</span>&nbsp;<span class="ident" id="4755368"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4755375">.</span><span class="ident" id="4755376">Type</span><br>
<span class="lineno"></span><span class="op" id="4755381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4755384">func</span>&nbsp;<span class="op" id="4755389">(</span><span class="ident" id="4755390">e</span>&nbsp;<span class="op" id="4755392">*</span><span class="ident" id="4755393"><a href="/encoding/json/encode.go.html#4755332">UnsupportedTypeError</a></span><span class="op" id="4755413">)</span>&nbsp;<span class="ident" id="4755415">Error</span><span class="op" id="4755420">(</span><span class="op" id="4755421">)</span>&nbsp;<span class="builtintype" id="4755423">string</span>&nbsp;<span class="op" id="4755430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4755433">return</span>&nbsp;<span class="string" id="4755440">&#34;json:&nbsp;unsupported&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="4755467">+</span>&nbsp;<span class="ident" id="4755469"><a href="/encoding/json/encode.go.html#4755390">e</a></span><span class="op" id="4755470">.</span><span class="ident" id="4755471">Type</span><span class="op" id="4755475">.</span><span class="ident" id="4755476">String</span><span class="op" id="4755482">(</span><span class="op" id="4755483">)</span><br>
<span class="lineno">205</span><span class="op" id="4755485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4755488">type</span>&nbsp;<span class="ident" id="4755493">UnsupportedValueError</span>&nbsp;<span class="keyword" id="4755515">struct</span>&nbsp;<span class="op" id="4755522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4755525">Value</span>&nbsp;<span class="ident" id="4755531"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4755538">.</span><span class="ident" id="4755539">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4755546">Str</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4755552">string</span><br>
<span class="lineno">210</span><span class="op" id="4755559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4755562">func</span>&nbsp;<span class="op" id="4755567">(</span><span class="ident" id="4755568">e</span>&nbsp;<span class="op" id="4755570">*</span><span class="ident" id="4755571"><a href="/encoding/json/encode.go.html#4755493">UnsupportedValueError</a></span><span class="op" id="4755592">)</span>&nbsp;<span class="ident" id="4755594">Error</span><span class="op" id="4755599">(</span><span class="op" id="4755600">)</span>&nbsp;<span class="builtintype" id="4755602">string</span>&nbsp;<span class="op" id="4755609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4755612">return</span>&nbsp;<span class="string" id="4755619">&#34;json:&nbsp;unsupported&nbsp;value:&nbsp;&#34;</span>&nbsp;<span class="op" id="4755647">+</span>&nbsp;<span class="ident" id="4755649"><a href="/encoding/json/encode.go.html#4755568">e</a></span><span class="op" id="4755650">.</span><span class="ident" id="4755651">Str</span><br>
<span class="lineno"></span><span class="op" id="4755655">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="comment" id="4755658">//&nbsp;Before&nbsp;Go&nbsp;1.2,&nbsp;an&nbsp;InvalidUTF8Error&nbsp;was&nbsp;returned&nbsp;by&nbsp;Marshal&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="4755725">//&nbsp;attempting&nbsp;to&nbsp;encode&nbsp;a&nbsp;string&nbsp;value&nbsp;with&nbsp;invalid&nbsp;UTF-8&nbsp;sequences.</span><br>
<span class="lineno"></span><span class="comment" id="4755794">//&nbsp;As&nbsp;of&nbsp;Go&nbsp;1.2,&nbsp;Marshal&nbsp;instead&nbsp;coerces&nbsp;the&nbsp;string&nbsp;to&nbsp;valid&nbsp;UTF-8&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="4755864">//&nbsp;replacing&nbsp;invalid&nbsp;bytes&nbsp;with&nbsp;the&nbsp;Unicode&nbsp;replacement&nbsp;rune&nbsp;U+FFFD.</span><br>
<span class="lineno">220</span><span class="comment" id="4755933">//&nbsp;This&nbsp;error&nbsp;is&nbsp;no&nbsp;longer&nbsp;generated&nbsp;but&nbsp;is&nbsp;kept&nbsp;for&nbsp;backwards&nbsp;compatibility</span><br>
<span class="lineno"></span><span class="comment" id="4756010">//&nbsp;with&nbsp;programs&nbsp;that&nbsp;might&nbsp;mention&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4756050">type</span>&nbsp;<span class="ident" id="4756055">InvalidUTF8Error</span>&nbsp;<span class="keyword" id="4756072">struct</span>&nbsp;<span class="op" id="4756079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756082">S</span>&nbsp;<span class="builtintype" id="4756084">string</span>&nbsp;<span class="comment" id="4756091">//&nbsp;the&nbsp;whole&nbsp;string&nbsp;value&nbsp;that&nbsp;caused&nbsp;the&nbsp;error</span><br>
<span class="lineno"></span><span class="op" id="4756139">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="keyword" id="4756142">func</span>&nbsp;<span class="op" id="4756147">(</span><span class="ident" id="4756148">e</span>&nbsp;<span class="op" id="4756150">*</span><span class="ident" id="4756151"><a href="/encoding/json/encode.go.html#4756055">InvalidUTF8Error</a></span><span class="op" id="4756167">)</span>&nbsp;<span class="ident" id="4756169">Error</span><span class="op" id="4756174">(</span><span class="op" id="4756175">)</span>&nbsp;<span class="builtintype" id="4756177">string</span>&nbsp;<span class="op" id="4756184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756187">return</span>&nbsp;<span class="string" id="4756194">&#34;json:&nbsp;invalid&nbsp;UTF-8&nbsp;in&nbsp;string:&nbsp;&#34;</span>&nbsp;<span class="op" id="4756228">+</span>&nbsp;<span class="ident" id="4756230"><a href="/encoding/json/encode.go.html#4748697">strconv</a></span><span class="op" id="4756237">.</span><span class="ident" id="4756238">Quote</span><span class="op" id="4756243">(</span><span class="ident" id="4756244"><a href="/encoding/json/encode.go.html#4756148">e</a></span><span class="op" id="4756245">.</span><span class="ident" id="4756246">S</span><span class="op" id="4756247">)</span><br>
<span class="lineno"></span><span class="op" id="4756249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="4756252">type</span>&nbsp;<span class="ident" id="4756257">MarshalerError</span>&nbsp;<span class="keyword" id="4756272">struct</span>&nbsp;<span class="op" id="4756279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756282">Type</span>&nbsp;<span class="ident" id="4756287"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4756294">.</span><span class="ident" id="4756295">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756301">Err</span>&nbsp;&nbsp;<span class="builtintype" id="4756306">error</span><br>
<span class="lineno"></span><span class="op" id="4756312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="4756315">func</span>&nbsp;<span class="op" id="4756320">(</span><span class="ident" id="4756321">e</span>&nbsp;<span class="op" id="4756323">*</span><span class="ident" id="4756324"><a href="/encoding/json/encode.go.html#4756257">MarshalerError</a></span><span class="op" id="4756338">)</span>&nbsp;<span class="ident" id="4756340">Error</span><span class="op" id="4756345">(</span><span class="op" id="4756346">)</span>&nbsp;<span class="builtintype" id="4756348">string</span>&nbsp;<span class="op" id="4756355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756358">return</span>&nbsp;<span class="string" id="4756365">&#34;json:&nbsp;error&nbsp;calling&nbsp;MarshalJSON&nbsp;for&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="4756409">+</span>&nbsp;<span class="ident" id="4756411"><a href="/encoding/json/encode.go.html#4756321">e</a></span><span class="op" id="4756412">.</span><span class="ident" id="4756413">Type</span><span class="op" id="4756417">.</span><span class="ident" id="4756418">String</span><span class="op" id="4756424">(</span><span class="op" id="4756425">)</span>&nbsp;<span class="op" id="4756427">+</span>&nbsp;<span class="string" id="4756429">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="4756434">+</span>&nbsp;<span class="ident" id="4756436"><a href="/encoding/json/encode.go.html#4756321">e</a></span><span class="op" id="4756437">.</span><span class="ident" id="4756438">Err</span><span class="op" id="4756441">.</span><span class="ident" id="4756442">Error</span><span class="op" id="4756447">(</span><span class="op" id="4756448">)</span><br>
<span class="lineno"></span><span class="op" id="4756450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4756453">var</span>&nbsp;<span class="ident" id="4756457">hex</span>&nbsp;<span class="op" id="4756461">=</span>&nbsp;<span class="string" id="4756463">&#34;0123456789abcdef&#34;</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="comment" id="4756483">//&nbsp;An&nbsp;encodeState&nbsp;encodes&nbsp;JSON&nbsp;into&nbsp;a&nbsp;bytes.Buffer.</span><br>
<span class="lineno"></span><span class="keyword" id="4756535">type</span>&nbsp;<span class="ident" id="4756540">encodeState</span>&nbsp;<span class="keyword" id="4756552">struct</span>&nbsp;<span class="op" id="4756559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756562"><a href="/encoding/json/encode.go.html#4748619">bytes</a></span><span class="op" id="4756567">.</span><span class="ident" id="4756568">Buffer</span>&nbsp;<span class="comment" id="4756575">//&nbsp;accumulated&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756598">scratch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4756611">[</span><span class="num" id="4756612">64</span><span class="op" id="4756614">]</span><span class="builtintype" id="4756615">byte</span><br>
<span class="lineno">245</span><span class="op" id="4756620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4756623">var</span>&nbsp;<span class="ident" id="4756627">encodeStatePool</span>&nbsp;<span class="ident" id="4756643"><a href="/encoding/json/encode.go.html#4748719">sync</a></span><span class="op" id="4756647">.</span><span class="ident" id="4756648">Pool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4756654">func</span>&nbsp;<span class="ident" id="4756659">newEncodeState</span><span class="op" id="4756673">(</span><span class="op" id="4756674">)</span>&nbsp;<span class="op" id="4756676">*</span><span class="ident" id="4756677"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span>&nbsp;<span class="op" id="4756689">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756692">if</span>&nbsp;<span class="ident" id="4756695">v</span>&nbsp;<span class="op" id="4756697">:=</span>&nbsp;<span class="ident" id="4756700"><a href="/encoding/json/encode.go.html#4756627">encodeStatePool</a></span><span class="op" id="4756715">.</span><span class="ident" id="4756716">Get</span><span class="op" id="4756719">(</span><span class="op" id="4756720">)</span><span class="op" id="4756721">;</span>&nbsp;<span class="ident" id="4756723"><a href="/encoding/json/encode.go.html#4756695">v</a></span>&nbsp;<span class="op" id="4756725">!=</span>&nbsp;<span class="ident" id="4756728">nil</span>&nbsp;<span class="op" id="4756732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756736">e</span>&nbsp;<span class="op" id="4756738">:=</span>&nbsp;<span class="ident" id="4756741"><a href="/encoding/json/encode.go.html#4756695">v</a></span><span class="op" id="4756742">.</span><span class="op" id="4756743">(</span><span class="op" id="4756744">*</span><span class="ident" id="4756745"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4756756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4756760"><a href="/encoding/json/encode.go.html#4756736">e</a></span><span class="op" id="4756761">.</span><span class="ident" id="4756762">Reset</span><span class="op" id="4756767">(</span><span class="op" id="4756768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756772">return</span>&nbsp;<span class="ident" id="4756779"><a href="/encoding/json/encode.go.html#4756736">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4756782">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756785">return</span>&nbsp;<span class="builtinfunc" id="4756792">new</span><span class="op" id="4756795">(</span><span class="ident" id="4756796"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4756807">)</span><br>
<span class="lineno"></span><span class="op" id="4756809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4756812">func</span>&nbsp;<span class="op" id="4756817">(</span><span class="ident" id="4756818">e</span>&nbsp;<span class="op" id="4756820">*</span><span class="ident" id="4756821"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4756832">)</span>&nbsp;<span class="ident" id="4756834">marshal</span><span class="op" id="4756841">(</span><span class="ident" id="4756842">v</span>&nbsp;<span class="keyword" id="4756844">interface</span><span class="op" id="4756853">{</span><span class="op" id="4756854">}</span><span class="op" id="4756855">)</span>&nbsp;<span class="op" id="4756857">(</span><span class="ident" id="4756858">err</span>&nbsp;<span class="builtintype" id="4756862">error</span><span class="op" id="4756867">)</span>&nbsp;<span class="op" id="4756869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756872">defer</span>&nbsp;<span class="keyword" id="4756878">func</span><span class="op" id="4756882">(</span><span class="op" id="4756883">)</span>&nbsp;<span class="op" id="4756885">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756889">if</span>&nbsp;<span class="ident" id="4756892">r</span>&nbsp;<span class="op" id="4756894">:=</span>&nbsp;<span class="builtinfunc" id="4756897">recover</span><span class="op" id="4756904">(</span><span class="op" id="4756905">)</span><span class="op" id="4756906">;</span>&nbsp;<span class="ident" id="4756908"><a href="/encoding/json/encode.go.html#4756892">r</a></span>&nbsp;<span class="op" id="4756910">!=</span>&nbsp;<span class="ident" id="4756913">nil</span>&nbsp;<span class="op" id="4756917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756922">if</span>&nbsp;<span class="ident" id="4756925">_</span><span class="op" id="4756926">,</span>&nbsp;<span class="ident" id="4756928">ok</span>&nbsp;<span class="op" id="4756931">:=</span>&nbsp;<span class="ident" id="4756934"><a href="/encoding/json/encode.go.html#4756892">r</a></span><span class="op" id="4756935">.</span><span class="op" id="4756936">(</span><span class="ident" id="4756937"><a href="/encoding/json/encode.go.html#4748678">runtime</a></span><span class="op" id="4756944">.</span><span class="ident" id="4756945">Error</span><span class="op" id="4756950">)</span><span class="op" id="4756951">;</span>&nbsp;<span class="ident" id="4756953"><a href="/encoding/json/encode.go.html#4756928">ok</a></span>&nbsp;<span class="op" id="4756956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4756962">panic</span><span class="op" id="4756967">(</span><span class="ident" id="4756968"><a href="/encoding/json/encode.go.html#4756892">r</a></span><span class="op" id="4756969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4756974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4756979">if</span>&nbsp;<span class="ident" id="4756982">s</span><span class="op" id="4756983">,</span>&nbsp;<span class="ident" id="4756985">ok</span>&nbsp;<span class="op" id="4756988">:=</span>&nbsp;<span class="ident" id="4756991"><a href="/encoding/json/encode.go.html#4756892">r</a></span><span class="op" id="4756992">.</span><span class="op" id="4756993">(</span><span class="builtintype" id="4756994">string</span><span class="op" id="4757000">)</span><span class="op" id="4757001">;</span>&nbsp;<span class="ident" id="4757003"><a href="/encoding/json/encode.go.html#4756985">ok</a></span>&nbsp;<span class="op" id="4757006">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4757012">panic</span><span class="op" id="4757017">(</span><span class="ident" id="4757018"><a href="/encoding/json/encode.go.html#4756982">s</a></span><span class="op" id="4757019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4757024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4757029"><a href="/encoding/json/encode.go.html#4756858">err</a></span>&nbsp;<span class="op" id="4757033">=</span>&nbsp;<span class="ident" id="4757035"><a href="/encoding/json/encode.go.html#4756892">r</a></span><span class="op" id="4757036">.</span><span class="op" id="4757037">(</span><span class="builtintype" id="4757038">error</span><span class="op" id="4757043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4757047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4757050">}</span><span class="op" id="4757051">(</span><span class="op" id="4757052">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4757055"><a href="/encoding/json/encode.go.html#4756818">e</a></span><span class="op" id="4757056">.</span><span class="ident" id="4757057">reflectValue</span><span class="op" id="4757069">(</span><span class="ident" id="4757070"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757077">.</span><span class="ident" id="4757078">ValueOf</span><span class="op" id="4757085">(</span><span class="ident" id="4757086"><a href="/encoding/json/encode.go.html#4756842">v</a></span><span class="op" id="4757087">)</span><span class="op" id="4757088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757091">return</span>&nbsp;<span class="ident" id="4757098">nil</span><br>
<span class="lineno"></span><span class="op" id="4757102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4757105">func</span>&nbsp;<span class="op" id="4757110">(</span><span class="ident" id="4757111">e</span>&nbsp;<span class="op" id="4757113">*</span><span class="ident" id="4757114"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4757125">)</span>&nbsp;<span class="builtintype" id="4757127">error</span><span class="op" id="4757132">(</span><span class="ident" id="4757133">err</span>&nbsp;<span class="builtintype" id="4757137">error</span><span class="op" id="4757142">)</span>&nbsp;<span class="op" id="4757144">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4757147">panic</span><span class="op" id="4757152">(</span><span class="ident" id="4757153"><a href="/encoding/json/encode.go.html#4757133">err</a></span><span class="op" id="4757156">)</span><br>
<span class="lineno"></span><span class="op" id="4757158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4757161">var</span>&nbsp;<span class="ident" id="4757165">byteSliceType</span>&nbsp;<span class="op" id="4757179">=</span>&nbsp;<span class="ident" id="4757181"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757188">.</span><span class="ident" id="4757189">TypeOf</span><span class="op" id="4757195">(</span><span class="op" id="4757196">[</span><span class="op" id="4757197">]</span><span class="builtintype" id="4757198">byte</span><span class="op" id="4757202">(</span><span class="ident" id="4757203">nil</span><span class="op" id="4757206">)</span><span class="op" id="4757207">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="4757210">func</span>&nbsp;<span class="ident" id="4757215">isEmptyValue</span><span class="op" id="4757227">(</span><span class="ident" id="4757228">v</span>&nbsp;<span class="ident" id="4757230"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757237">.</span><span class="ident" id="4757238">Value</span><span class="op" id="4757243">)</span>&nbsp;<span class="builtintype" id="4757245">bool</span>&nbsp;<span class="op" id="4757250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757253">switch</span>&nbsp;<span class="ident" id="4757260"><a href="/encoding/json/encode.go.html#4757228">v</a></span><span class="op" id="4757261">.</span><span class="ident" id="4757262">Kind</span><span class="op" id="4757266">(</span><span class="op" id="4757267">)</span>&nbsp;<span class="op" id="4757269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757272">case</span>&nbsp;<span class="ident" id="4757277"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757284">.</span><span class="ident" id="4757285">Array</span><span class="op" id="4757290">,</span>&nbsp;<span class="ident" id="4757292"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757299">.</span><span class="ident" id="4757300">Map</span><span class="op" id="4757303">,</span>&nbsp;<span class="ident" id="4757305"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757312">.</span><span class="ident" id="4757313">Slice</span><span class="op" id="4757318">,</span>&nbsp;<span class="ident" id="4757320"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757327">.</span><span class="ident" id="4757328">String</span><span class="op" id="4757334">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757338">return</span>&nbsp;<span class="ident" id="4757345"><a href="/encoding/json/encode.go.html#4757228">v</a></span><span class="op" id="4757346">.</span><span class="ident" id="4757347">Len</span><span class="op" id="4757350">(</span><span class="op" id="4757351">)</span>&nbsp;<span class="op" id="4757353">==</span>&nbsp;<span class="num" id="4757356">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757359">case</span>&nbsp;<span class="ident" id="4757364"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757371">.</span><span class="ident" id="4757372">Bool</span><span class="op" id="4757376">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757380">return</span>&nbsp;<span class="op" id="4757387">!</span><span class="ident" id="4757388"><a href="/encoding/json/encode.go.html#4757228">v</a></span><span class="op" id="4757389">.</span><span class="ident" id="4757390">Bool</span><span class="op" id="4757394">(</span><span class="op" id="4757395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757398">case</span>&nbsp;<span class="ident" id="4757403"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757410">.</span><span class="ident" id="4757411">Int</span><span class="op" id="4757414">,</span>&nbsp;<span class="ident" id="4757416"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757423">.</span><span class="ident" id="4757424">Int8</span><span class="op" id="4757428">,</span>&nbsp;<span class="ident" id="4757430"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757437">.</span><span class="ident" id="4757438">Int16</span><span class="op" id="4757443">,</span>&nbsp;<span class="ident" id="4757445"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757452">.</span><span class="ident" id="4757453">Int32</span><span class="op" id="4757458">,</span>&nbsp;<span class="ident" id="4757460"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757467">.</span><span class="ident" id="4757468">Int64</span><span class="op" id="4757473">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757477">return</span>&nbsp;<span class="ident" id="4757484"><a href="/encoding/json/encode.go.html#4757228">v</a></span><span class="op" id="4757485">.</span><span class="ident" id="4757486">Int</span><span class="op" id="4757489">(</span><span class="op" id="4757490">)</span>&nbsp;<span class="op" id="4757492">==</span>&nbsp;<span class="num" id="4757495">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757498">case</span>&nbsp;<span class="ident" id="4757503"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757510">.</span><span class="ident" id="4757511">Uint</span><span class="op" id="4757515">,</span>&nbsp;<span class="ident" id="4757517"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757524">.</span><span class="ident" id="4757525">Uint8</span><span class="op" id="4757530">,</span>&nbsp;<span class="ident" id="4757532"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757539">.</span><span class="ident" id="4757540">Uint16</span><span class="op" id="4757546">,</span>&nbsp;<span class="ident" id="4757548"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757555">.</span><span class="ident" id="4757556">Uint32</span><span class="op" id="4757562">,</span>&nbsp;<span class="ident" id="4757564"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757571">.</span><span class="ident" id="4757572">Uint64</span><span class="op" id="4757578">,</span>&nbsp;<span class="ident" id="4757580"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757587">.</span><span class="ident" id="4757588">Uintptr</span><span class="op" id="4757595">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757599">return</span>&nbsp;<span class="ident" id="4757606"><a href="/encoding/json/encode.go.html#4757228">v</a></span><span class="op" id="4757607">.</span><span class="ident" id="4757608">Uint</span><span class="op" id="4757612">(</span><span class="op" id="4757613">)</span>&nbsp;<span class="op" id="4757615">==</span>&nbsp;<span class="num" id="4757618">0</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757621">case</span>&nbsp;<span class="ident" id="4757626"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757633">.</span><span class="ident" id="4757634">Float32</span><span class="op" id="4757641">,</span>&nbsp;<span class="ident" id="4757643"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757650">.</span><span class="ident" id="4757651">Float64</span><span class="op" id="4757658">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757662">return</span>&nbsp;<span class="ident" id="4757669"><a href="/encoding/json/encode.go.html#4757228">v</a></span><span class="op" id="4757670">.</span><span class="ident" id="4757671">Float</span><span class="op" id="4757676">(</span><span class="op" id="4757677">)</span>&nbsp;<span class="op" id="4757679">==</span>&nbsp;<span class="num" id="4757682">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757685">case</span>&nbsp;<span class="ident" id="4757690"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757697">.</span><span class="ident" id="4757698">Interface</span><span class="op" id="4757707">,</span>&nbsp;<span class="ident" id="4757709"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757716">.</span><span class="ident" id="4757717">Ptr</span><span class="op" id="4757720">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757724">return</span>&nbsp;<span class="ident" id="4757731"><a href="/encoding/json/encode.go.html#4757228">v</a></span><span class="op" id="4757732">.</span><span class="ident" id="4757733">IsNil</span><span class="op" id="4757738">(</span><span class="op" id="4757739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4757742">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757745">return</span>&nbsp;<span class="builtintype" id="4757752">false</span><br>
<span class="lineno"></span><span class="op" id="4757758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4757761">func</span>&nbsp;<span class="op" id="4757766">(</span><span class="ident" id="4757767">e</span>&nbsp;<span class="op" id="4757769">*</span><span class="ident" id="4757770"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4757781">)</span>&nbsp;<span class="ident" id="4757783">reflectValue</span><span class="op" id="4757795">(</span><span class="ident" id="4757796">v</span>&nbsp;<span class="ident" id="4757798"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757805">.</span><span class="ident" id="4757806">Value</span><span class="op" id="4757811">)</span>&nbsp;<span class="op" id="4757813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4757816"><a href="/encoding/json/encode.go.html#4757997">valueEncoder</a></span><span class="op" id="4757828">(</span><span class="ident" id="4757829"><a href="/encoding/json/encode.go.html#4757796">v</a></span><span class="op" id="4757830">)</span><span class="op" id="4757831">(</span><span class="ident" id="4757832"><a href="/encoding/json/encode.go.html#4757767">e</a></span><span class="op" id="4757833">,</span>&nbsp;<span class="ident" id="4757835"><a href="/encoding/json/encode.go.html#4757796">v</a></span><span class="op" id="4757836">,</span>&nbsp;<span class="builtintype" id="4757838">false</span><span class="op" id="4757843">)</span><br>
<span class="lineno">300</span><span class="op" id="4757845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4757848">type</span>&nbsp;<span class="ident" id="4757853">encoderFunc</span>&nbsp;<span class="keyword" id="4757865">func</span><span class="op" id="4757869">(</span><span class="ident" id="4757870">e</span>&nbsp;<span class="op" id="4757872">*</span><span class="ident" id="4757873"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4757884">,</span>&nbsp;<span class="ident" id="4757886">v</span>&nbsp;<span class="ident" id="4757888"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757895">.</span><span class="ident" id="4757896">Value</span><span class="op" id="4757901">,</span>&nbsp;<span class="ident" id="4757903">quoted</span>&nbsp;<span class="builtintype" id="4757910">bool</span><span class="op" id="4757914">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4757917">var</span>&nbsp;<span class="ident" id="4757921">encoderCache</span>&nbsp;<span class="keyword" id="4757934">struct</span>&nbsp;<span class="op" id="4757941">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4757944"><a href="/encoding/json/encode.go.html#4748719">sync</a></span><span class="op" id="4757948">.</span><span class="ident" id="4757949">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4757958">m</span>&nbsp;<span class="keyword" id="4757960">map</span><span class="op" id="4757963">[</span><span class="ident" id="4757964"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4757971">.</span><span class="ident" id="4757972">Type</span><span class="op" id="4757976">]</span><span class="ident" id="4757977"><a href="/encoding/json/encode.go.html#4757853">encoderFunc</a></span><br>
<span class="lineno"></span><span class="op" id="4757989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4757992">func</span>&nbsp;<span class="ident" id="4757997">valueEncoder</span><span class="op" id="4758009">(</span><span class="ident" id="4758010">v</span>&nbsp;<span class="ident" id="4758012"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4758019">.</span><span class="ident" id="4758020">Value</span><span class="op" id="4758025">)</span>&nbsp;<span class="ident" id="4758027"><a href="/encoding/json/encode.go.html#4757853">encoderFunc</a></span>&nbsp;<span class="op" id="4758039">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758042">if</span>&nbsp;<span class="op" id="4758045">!</span><span class="ident" id="4758046"><a href="/encoding/json/encode.go.html#4758010">v</a></span><span class="op" id="4758047">.</span><span class="ident" id="4758048">IsValid</span><span class="op" id="4758055">(</span><span class="op" id="4758056">)</span>&nbsp;<span class="op" id="4758058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758062">return</span>&nbsp;<span class="ident" id="4758069"><a href="/encoding/json/encode.go.html#4760579">invalidValueEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4758090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758093">return</span>&nbsp;<span class="ident" id="4758100"><a href="/encoding/json/encode.go.html#4758130">typeEncoder</a></span><span class="op" id="4758111">(</span><span class="ident" id="4758112"><a href="/encoding/json/encode.go.html#4758010">v</a></span><span class="op" id="4758113">.</span><span class="ident" id="4758114">Type</span><span class="op" id="4758118">(</span><span class="op" id="4758119">)</span><span class="op" id="4758120">)</span><br>
<span class="lineno"></span><span class="op" id="4758122">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="4758125">func</span>&nbsp;<span class="ident" id="4758130">typeEncoder</span><span class="op" id="4758141">(</span><span class="ident" id="4758142">t</span>&nbsp;<span class="ident" id="4758144"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4758151">.</span><span class="ident" id="4758152">Type</span><span class="op" id="4758156">)</span>&nbsp;<span class="ident" id="4758158"><a href="/encoding/json/encode.go.html#4757853">encoderFunc</a></span>&nbsp;<span class="op" id="4758170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758173"><a href="/encoding/json/encode.go.html#4757921">encoderCache</a></span><span class="op" id="4758185">.</span><span class="ident" id="4758186">RLock</span><span class="op" id="4758191">(</span><span class="op" id="4758192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758195">f</span>&nbsp;<span class="op" id="4758197">:=</span>&nbsp;<span class="ident" id="4758200"><a href="/encoding/json/encode.go.html#4757921">encoderCache</a></span><span class="op" id="4758212">.</span><span class="ident" id="4758213">m</span><span class="op" id="4758214">[</span><span class="ident" id="4758215"><a href="/encoding/json/encode.go.html#4758142">t</a></span><span class="op" id="4758216">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758219"><a href="/encoding/json/encode.go.html#4757921">encoderCache</a></span><span class="op" id="4758231">.</span><span class="ident" id="4758232">RUnlock</span><span class="op" id="4758239">(</span><span class="op" id="4758240">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758243">if</span>&nbsp;<span class="ident" id="4758246"><a href="/encoding/json/encode.go.html#4758195">f</a></span>&nbsp;<span class="op" id="4758248">!=</span>&nbsp;<span class="ident" id="4758251">nil</span>&nbsp;<span class="op" id="4758255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758259">return</span>&nbsp;<span class="ident" id="4758266"><a href="/encoding/json/encode.go.html#4758195">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4758269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4758273">//&nbsp;To&nbsp;deal&nbsp;with&nbsp;recursive&nbsp;types,&nbsp;populate&nbsp;the&nbsp;map&nbsp;with&nbsp;an</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4758332">//&nbsp;indirect&nbsp;func&nbsp;before&nbsp;we&nbsp;build&nbsp;it.&nbsp;This&nbsp;type&nbsp;waits&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4758393">//&nbsp;real&nbsp;func&nbsp;(f)&nbsp;to&nbsp;be&nbsp;ready&nbsp;and&nbsp;then&nbsp;calls&nbsp;it.&nbsp;&nbsp;This&nbsp;indirect</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4758457">//&nbsp;func&nbsp;is&nbsp;only&nbsp;used&nbsp;for&nbsp;recursive&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758500"><a href="/encoding/json/encode.go.html#4757921">encoderCache</a></span><span class="op" id="4758512">.</span><span class="ident" id="4758513">Lock</span><span class="op" id="4758517">(</span><span class="op" id="4758518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758521">if</span>&nbsp;<span class="ident" id="4758524"><a href="/encoding/json/encode.go.html#4757921">encoderCache</a></span><span class="op" id="4758536">.</span><span class="ident" id="4758537">m</span>&nbsp;<span class="op" id="4758539">==</span>&nbsp;<span class="ident" id="4758542">nil</span>&nbsp;<span class="op" id="4758546">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758550"><a href="/encoding/json/encode.go.html#4757921">encoderCache</a></span><span class="op" id="4758562">.</span><span class="ident" id="4758563">m</span>&nbsp;<span class="op" id="4758565">=</span>&nbsp;<span class="builtinfunc" id="4758567">make</span><span class="op" id="4758571">(</span><span class="keyword" id="4758572">map</span><span class="op" id="4758575">[</span><span class="ident" id="4758576"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4758583">.</span><span class="ident" id="4758584">Type</span><span class="op" id="4758588">]</span><span class="ident" id="4758589"><a href="/encoding/json/encode.go.html#4757853">encoderFunc</a></span><span class="op" id="4758600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4758603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758606">var</span>&nbsp;<span class="ident" id="4758610">wg</span>&nbsp;<span class="ident" id="4758613"><a href="/encoding/json/encode.go.html#4748719">sync</a></span><span class="op" id="4758617">.</span><span class="ident" id="4758618">WaitGroup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758629"><a href="/encoding/json/encode.go.html#4758610">wg</a></span><span class="op" id="4758631">.</span><span class="ident" id="4758632">Add</span><span class="op" id="4758635">(</span><span class="num" id="4758636">1</span><span class="op" id="4758637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758640"><a href="/encoding/json/encode.go.html#4757921">encoderCache</a></span><span class="op" id="4758652">.</span><span class="ident" id="4758653">m</span><span class="op" id="4758654">[</span><span class="ident" id="4758655"><a href="/encoding/json/encode.go.html#4758142">t</a></span><span class="op" id="4758656">]</span>&nbsp;<span class="op" id="4758658">=</span>&nbsp;<span class="keyword" id="4758660">func</span><span class="op" id="4758664">(</span><span class="ident" id="4758665">e</span>&nbsp;<span class="op" id="4758667">*</span><span class="ident" id="4758668"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4758679">,</span>&nbsp;<span class="ident" id="4758681">v</span>&nbsp;<span class="ident" id="4758683"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4758690">.</span><span class="ident" id="4758691">Value</span><span class="op" id="4758696">,</span>&nbsp;<span class="ident" id="4758698">quoted</span>&nbsp;<span class="builtintype" id="4758705">bool</span><span class="op" id="4758709">)</span>&nbsp;<span class="op" id="4758711">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758715"><a href="/encoding/json/encode.go.html#4758610">wg</a></span><span class="op" id="4758717">.</span><span class="ident" id="4758718">Wait</span><span class="op" id="4758722">(</span><span class="op" id="4758723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758727"><a href="/encoding/json/encode.go.html#4758195">f</a></span><span class="op" id="4758728">(</span><span class="ident" id="4758729"><a href="/encoding/json/encode.go.html#4758665">e</a></span><span class="op" id="4758730">,</span>&nbsp;<span class="ident" id="4758732"><a href="/encoding/json/encode.go.html#4758681">v</a></span><span class="op" id="4758733">,</span>&nbsp;<span class="ident" id="4758735"><a href="/encoding/json/encode.go.html#4758698">quoted</a></span><span class="op" id="4758741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4758744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758747"><a href="/encoding/json/encode.go.html#4757921">encoderCache</a></span><span class="op" id="4758759">.</span><span class="ident" id="4758760">Unlock</span><span class="op" id="4758766">(</span><span class="op" id="4758767">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4758771">//&nbsp;Compute&nbsp;fields&nbsp;without&nbsp;lock.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4758804">//&nbsp;Might&nbsp;duplicate&nbsp;effort&nbsp;but&nbsp;won&#39;t&nbsp;hold&nbsp;other&nbsp;computations&nbsp;back.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758871"><a href="/encoding/json/encode.go.html#4758195">f</a></span>&nbsp;<span class="op" id="4758873">=</span>&nbsp;<span class="ident" id="4758875"><a href="/encoding/json/encode.go.html#4759259">newTypeEncoder</a></span><span class="op" id="4758889">(</span><span class="ident" id="4758890"><a href="/encoding/json/encode.go.html#4758142">t</a></span><span class="op" id="4758891">,</span>&nbsp;<span class="builtintype" id="4758893">true</span><span class="op" id="4758897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758900"><a href="/encoding/json/encode.go.html#4758610">wg</a></span><span class="op" id="4758902">.</span><span class="ident" id="4758903">Done</span><span class="op" id="4758907">(</span><span class="op" id="4758908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758911"><a href="/encoding/json/encode.go.html#4757921">encoderCache</a></span><span class="op" id="4758923">.</span><span class="ident" id="4758924">Lock</span><span class="op" id="4758928">(</span><span class="op" id="4758929">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758932"><a href="/encoding/json/encode.go.html#4757921">encoderCache</a></span><span class="op" id="4758944">.</span><span class="ident" id="4758945">m</span><span class="op" id="4758946">[</span><span class="ident" id="4758947"><a href="/encoding/json/encode.go.html#4758142">t</a></span><span class="op" id="4758948">]</span>&nbsp;<span class="op" id="4758950">=</span>&nbsp;<span class="ident" id="4758952"><a href="/encoding/json/encode.go.html#4758195">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758955"><a href="/encoding/json/encode.go.html#4757921">encoderCache</a></span><span class="op" id="4758967">.</span><span class="ident" id="4758968">Unlock</span><span class="op" id="4758974">(</span><span class="op" id="4758975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758978">return</span>&nbsp;<span class="ident" id="4758985"><a href="/encoding/json/encode.go.html#4758195">f</a></span><br>
<span class="lineno"></span><span class="op" id="4758987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="4758990">var</span>&nbsp;<span class="op" id="4758994">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758997">marshalerType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4759015">=</span>&nbsp;<span class="ident" id="4759017"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4759024">.</span><span class="ident" id="4759025">TypeOf</span><span class="op" id="4759031">(</span><span class="builtinfunc" id="4759032">new</span><span class="op" id="4759035">(</span><span class="ident" id="4759036"><a href="/encoding/json/encode.go.html#4755165">Marshaler</a></span><span class="op" id="4759045">)</span><span class="op" id="4759046">)</span><span class="op" id="4759047">.</span><span class="ident" id="4759048">Elem</span><span class="op" id="4759052">(</span><span class="op" id="4759053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759056">textMarshalerType</span>&nbsp;<span class="op" id="4759074">=</span>&nbsp;<span class="ident" id="4759076"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4759083">.</span><span class="ident" id="4759084">TypeOf</span><span class="op" id="4759090">(</span><span class="builtinfunc" id="4759091">new</span><span class="op" id="4759094">(</span><span class="ident" id="4759095"><a href="/encoding/json/encode.go.html#4748628">encoding</a></span><span class="op" id="4759103">.</span><span class="ident" id="4759104">TextMarshaler</span><span class="op" id="4759117">)</span><span class="op" id="4759118">)</span><span class="op" id="4759119">.</span><span class="ident" id="4759120">Elem</span><span class="op" id="4759124">(</span><span class="op" id="4759125">)</span><br>
<span class="lineno"></span><span class="op" id="4759127">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="4759130">//&nbsp;newTypeEncoder&nbsp;constructs&nbsp;an&nbsp;encoderFunc&nbsp;for&nbsp;a&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4759186">//&nbsp;The&nbsp;returned&nbsp;encoder&nbsp;only&nbsp;checks&nbsp;CanAddr&nbsp;when&nbsp;allowAddr&nbsp;is&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="4759254">func</span>&nbsp;<span class="ident" id="4759259">newTypeEncoder</span><span class="op" id="4759273">(</span><span class="ident" id="4759274">t</span>&nbsp;<span class="ident" id="4759276"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4759283">.</span><span class="ident" id="4759284">Type</span><span class="op" id="4759288">,</span>&nbsp;<span class="ident" id="4759290">allowAddr</span>&nbsp;<span class="builtintype" id="4759300">bool</span><span class="op" id="4759304">)</span>&nbsp;<span class="ident" id="4759306"><a href="/encoding/json/encode.go.html#4757853">encoderFunc</a></span>&nbsp;<span class="op" id="4759318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759321">if</span>&nbsp;<span class="ident" id="4759324"><a href="/encoding/json/encode.go.html#4759274">t</a></span><span class="op" id="4759325">.</span><span class="ident" id="4759326">Implements</span><span class="op" id="4759336">(</span><span class="ident" id="4759337"><a href="/encoding/json/encode.go.html#4758997">marshalerType</a></span><span class="op" id="4759350">)</span>&nbsp;<span class="op" id="4759352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759356">return</span>&nbsp;<span class="ident" id="4759363"><a href="/encoding/json/encode.go.html#4760678">marshalerEncoder</a></span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4759381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759384">if</span>&nbsp;<span class="ident" id="4759387"><a href="/encoding/json/encode.go.html#4759274">t</a></span><span class="op" id="4759388">.</span><span class="ident" id="4759389">Kind</span><span class="op" id="4759393">(</span><span class="op" id="4759394">)</span>&nbsp;<span class="op" id="4759396">!=</span>&nbsp;<span class="ident" id="4759399"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4759406">.</span><span class="ident" id="4759407">Ptr</span>&nbsp;<span class="op" id="4759411">&amp;&amp;</span>&nbsp;<span class="ident" id="4759414"><a href="/encoding/json/encode.go.html#4759290">allowAddr</a></span>&nbsp;<span class="op" id="4759424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759428">if</span>&nbsp;<span class="ident" id="4759431"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4759438">.</span><span class="ident" id="4759439">PtrTo</span><span class="op" id="4759444">(</span><span class="ident" id="4759445"><a href="/encoding/json/encode.go.html#4759274">t</a></span><span class="op" id="4759446">)</span><span class="op" id="4759447">.</span><span class="ident" id="4759448">Implements</span><span class="op" id="4759458">(</span><span class="ident" id="4759459"><a href="/encoding/json/encode.go.html#4758997">marshalerType</a></span><span class="op" id="4759472">)</span>&nbsp;<span class="op" id="4759474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759479">return</span>&nbsp;<span class="ident" id="4759486"><a href="/encoding/json/encode.go.html#4767382">newCondAddrEncoder</a></span><span class="op" id="4759504">(</span><span class="ident" id="4759505"><a href="/encoding/json/encode.go.html#4761054">addrMarshalerEncoder</a></span><span class="op" id="4759525">,</span>&nbsp;<span class="ident" id="4759527"><a href="/encoding/json/encode.go.html#4759259">newTypeEncoder</a></span><span class="op" id="4759541">(</span><span class="ident" id="4759542"><a href="/encoding/json/encode.go.html#4759274">t</a></span><span class="op" id="4759543">,</span>&nbsp;<span class="builtintype" id="4759545">false</span><span class="op" id="4759550">)</span><span class="op" id="4759551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4759555">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4759558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759562">if</span>&nbsp;<span class="ident" id="4759565"><a href="/encoding/json/encode.go.html#4759274">t</a></span><span class="op" id="4759566">.</span><span class="ident" id="4759567">Implements</span><span class="op" id="4759577">(</span><span class="ident" id="4759578"><a href="/encoding/json/encode.go.html#4759056">textMarshalerType</a></span><span class="op" id="4759595">)</span>&nbsp;<span class="op" id="4759597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759601">return</span>&nbsp;<span class="ident" id="4759608"><a href="/encoding/json/encode.go.html#4761425">textMarshalerEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4759630">}</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759633">if</span>&nbsp;<span class="ident" id="4759636"><a href="/encoding/json/encode.go.html#4759274">t</a></span><span class="op" id="4759637">.</span><span class="ident" id="4759638">Kind</span><span class="op" id="4759642">(</span><span class="op" id="4759643">)</span>&nbsp;<span class="op" id="4759645">!=</span>&nbsp;<span class="ident" id="4759648"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4759655">.</span><span class="ident" id="4759656">Ptr</span>&nbsp;<span class="op" id="4759660">&amp;&amp;</span>&nbsp;<span class="ident" id="4759663"><a href="/encoding/json/encode.go.html#4759290">allowAddr</a></span>&nbsp;<span class="op" id="4759673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759677">if</span>&nbsp;<span class="ident" id="4759680"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4759687">.</span><span class="ident" id="4759688">PtrTo</span><span class="op" id="4759693">(</span><span class="ident" id="4759694"><a href="/encoding/json/encode.go.html#4759274">t</a></span><span class="op" id="4759695">)</span><span class="op" id="4759696">.</span><span class="ident" id="4759697">Implements</span><span class="op" id="4759707">(</span><span class="ident" id="4759708"><a href="/encoding/json/encode.go.html#4759056">textMarshalerType</a></span><span class="op" id="4759725">)</span>&nbsp;<span class="op" id="4759727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759732">return</span>&nbsp;<span class="ident" id="4759739"><a href="/encoding/json/encode.go.html#4767382">newCondAddrEncoder</a></span><span class="op" id="4759757">(</span><span class="ident" id="4759758"><a href="/encoding/json/encode.go.html#4761763">addrTextMarshalerEncoder</a></span><span class="op" id="4759782">,</span>&nbsp;<span class="ident" id="4759784"><a href="/encoding/json/encode.go.html#4759259">newTypeEncoder</a></span><span class="op" id="4759798">(</span><span class="ident" id="4759799"><a href="/encoding/json/encode.go.html#4759274">t</a></span><span class="op" id="4759800">,</span>&nbsp;<span class="builtintype" id="4759802">false</span><span class="op" id="4759807">)</span><span class="op" id="4759808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4759812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4759815">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759819">switch</span>&nbsp;<span class="ident" id="4759826"><a href="/encoding/json/encode.go.html#4759274">t</a></span><span class="op" id="4759827">.</span><span class="ident" id="4759828">Kind</span><span class="op" id="4759832">(</span><span class="op" id="4759833">)</span>&nbsp;<span class="op" id="4759835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759838">case</span>&nbsp;<span class="ident" id="4759843"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4759850">.</span><span class="ident" id="4759851">Bool</span><span class="op" id="4759855">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759859">return</span>&nbsp;<span class="ident" id="4759866"><a href="/encoding/json/encode.go.html#4762096">boolEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759879">case</span>&nbsp;<span class="ident" id="4759884"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4759891">.</span><span class="ident" id="4759892">Int</span><span class="op" id="4759895">,</span>&nbsp;<span class="ident" id="4759897"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4759904">.</span><span class="ident" id="4759905">Int8</span><span class="op" id="4759909">,</span>&nbsp;<span class="ident" id="4759911"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4759918">.</span><span class="ident" id="4759919">Int16</span><span class="op" id="4759924">,</span>&nbsp;<span class="ident" id="4759926"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4759933">.</span><span class="ident" id="4759934">Int32</span><span class="op" id="4759939">,</span>&nbsp;<span class="ident" id="4759941"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4759948">.</span><span class="ident" id="4759949">Int64</span><span class="op" id="4759954">:</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759958">return</span>&nbsp;<span class="ident" id="4759965"><a href="/encoding/json/encode.go.html#4762311">intEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759977">case</span>&nbsp;<span class="ident" id="4759982"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4759989">.</span><span class="ident" id="4759990">Uint</span><span class="op" id="4759994">,</span>&nbsp;<span class="ident" id="4759996"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4760003">.</span><span class="ident" id="4760004">Uint8</span><span class="op" id="4760009">,</span>&nbsp;<span class="ident" id="4760011"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4760018">.</span><span class="ident" id="4760019">Uint16</span><span class="op" id="4760025">,</span>&nbsp;<span class="ident" id="4760027"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4760034">.</span><span class="ident" id="4760035">Uint32</span><span class="op" id="4760041">,</span>&nbsp;<span class="ident" id="4760043"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4760050">.</span><span class="ident" id="4760051">Uint64</span><span class="op" id="4760057">,</span>&nbsp;<span class="ident" id="4760059"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4760066">.</span><span class="ident" id="4760067">Uintptr</span><span class="op" id="4760074">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760078">return</span>&nbsp;<span class="ident" id="4760085"><a href="/encoding/json/encode.go.html#4762512">uintEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760098">case</span>&nbsp;<span class="ident" id="4760103"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4760110">.</span><span class="ident" id="4760111">Float32</span><span class="op" id="4760118">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760122">return</span>&nbsp;<span class="ident" id="4760129"><a href="/encoding/json/encode.go.html#4763128">float32Encoder</a></span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760145">case</span>&nbsp;<span class="ident" id="4760150"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4760157">.</span><span class="ident" id="4760158">Float64</span><span class="op" id="4760165">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760169">return</span>&nbsp;<span class="ident" id="4760176"><a href="/encoding/json/encode.go.html#4763172">float64Encoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760192">case</span>&nbsp;<span class="ident" id="4760197"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4760204">.</span><span class="ident" id="4760205">String</span><span class="op" id="4760211">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760215">return</span>&nbsp;<span class="ident" id="4760222"><a href="/encoding/json/encode.go.html#4763223">stringEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760237">case</span>&nbsp;<span class="ident" id="4760242"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4760249">.</span><span class="ident" id="4760250">Interface</span><span class="op" id="4760259">:</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760263">return</span>&nbsp;<span class="ident" id="4760270"><a href="/encoding/json/encode.go.html#4763585">interfaceEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760288">case</span>&nbsp;<span class="ident" id="4760293"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4760300">.</span><span class="ident" id="4760301">Struct</span><span class="op" id="4760307">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760311">return</span>&nbsp;<span class="ident" id="4760318"><a href="/encoding/json/encode.go.html#4764343">newStructEncoder</a></span><span class="op" id="4760334">(</span><span class="ident" id="4760335"><a href="/encoding/json/encode.go.html#4759274">t</a></span><span class="op" id="4760336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760339">case</span>&nbsp;<span class="ident" id="4760344"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4760351">.</span><span class="ident" id="4760352">Map</span><span class="op" id="4760355">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760359">return</span>&nbsp;<span class="ident" id="4760366"><a href="/encoding/json/encode.go.html#4765035">newMapEncoder</a></span><span class="op" id="4760379">(</span><span class="ident" id="4760380"><a href="/encoding/json/encode.go.html#4759274">t</a></span><span class="op" id="4760381">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760384">case</span>&nbsp;<span class="ident" id="4760389"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4760396">.</span><span class="ident" id="4760397">Slice</span><span class="op" id="4760402">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760406">return</span>&nbsp;<span class="ident" id="4760413"><a href="/encoding/json/encode.go.html#4766049">newSliceEncoder</a></span><span class="op" id="4760428">(</span><span class="ident" id="4760429"><a href="/encoding/json/encode.go.html#4759274">t</a></span><span class="op" id="4760430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760433">case</span>&nbsp;<span class="ident" id="4760438"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4760445">.</span><span class="ident" id="4760446">Array</span><span class="op" id="4760451">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760455">return</span>&nbsp;<span class="ident" id="4760462"><a href="/encoding/json/encode.go.html#4766563">newArrayEncoder</a></span><span class="op" id="4760477">(</span><span class="ident" id="4760478"><a href="/encoding/json/encode.go.html#4759274">t</a></span><span class="op" id="4760479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760482">case</span>&nbsp;<span class="ident" id="4760487"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4760494">.</span><span class="ident" id="4760495">Ptr</span><span class="op" id="4760498">:</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760502">return</span>&nbsp;<span class="ident" id="4760509"><a href="/encoding/json/encode.go.html#4766895">newPtrEncoder</a></span><span class="op" id="4760522">(</span><span class="ident" id="4760523"><a href="/encoding/json/encode.go.html#4759274">t</a></span><span class="op" id="4760524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760527">default</span><span class="op" id="4760534">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760538">return</span>&nbsp;<span class="ident" id="4760545"><a href="/encoding/json/encode.go.html#4763736">unsupportedTypeEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4760569">}</span><br>
<span class="lineno"></span><span class="op" id="4760571">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="keyword" id="4760574">func</span>&nbsp;<span class="ident" id="4760579">invalidValueEncoder</span><span class="op" id="4760598">(</span><span class="ident" id="4760599">e</span>&nbsp;<span class="op" id="4760601">*</span><span class="ident" id="4760602"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4760613">,</span>&nbsp;<span class="ident" id="4760615">v</span>&nbsp;<span class="ident" id="4760617"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4760624">.</span><span class="ident" id="4760625">Value</span><span class="op" id="4760630">,</span>&nbsp;<span class="ident" id="4760632">quoted</span>&nbsp;<span class="builtintype" id="4760639">bool</span><span class="op" id="4760643">)</span>&nbsp;<span class="op" id="4760645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760648"><a href="/encoding/json/encode.go.html#4760599">e</a></span><span class="op" id="4760649">.</span><span class="ident" id="4760650">WriteString</span><span class="op" id="4760661">(</span><span class="string" id="4760662">&#34;null&#34;</span><span class="op" id="4760668">)</span><br>
<span class="lineno"></span><span class="op" id="4760670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="4760673">func</span>&nbsp;<span class="ident" id="4760678">marshalerEncoder</span><span class="op" id="4760694">(</span><span class="ident" id="4760695">e</span>&nbsp;<span class="op" id="4760697">*</span><span class="ident" id="4760698"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4760709">,</span>&nbsp;<span class="ident" id="4760711">v</span>&nbsp;<span class="ident" id="4760713"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4760720">.</span><span class="ident" id="4760721">Value</span><span class="op" id="4760726">,</span>&nbsp;<span class="ident" id="4760728">quoted</span>&nbsp;<span class="builtintype" id="4760735">bool</span><span class="op" id="4760739">)</span>&nbsp;<span class="op" id="4760741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760744">if</span>&nbsp;<span class="ident" id="4760747"><a href="/encoding/json/encode.go.html#4760711">v</a></span><span class="op" id="4760748">.</span><span class="ident" id="4760749">Kind</span><span class="op" id="4760753">(</span><span class="op" id="4760754">)</span>&nbsp;<span class="op" id="4760756">==</span>&nbsp;<span class="ident" id="4760759"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4760766">.</span><span class="ident" id="4760767">Ptr</span>&nbsp;<span class="op" id="4760771">&amp;&amp;</span>&nbsp;<span class="ident" id="4760774"><a href="/encoding/json/encode.go.html#4760711">v</a></span><span class="op" id="4760775">.</span><span class="ident" id="4760776">IsNil</span><span class="op" id="4760781">(</span><span class="op" id="4760782">)</span>&nbsp;<span class="op" id="4760784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760788"><a href="/encoding/json/encode.go.html#4760695">e</a></span><span class="op" id="4760789">.</span><span class="ident" id="4760790">WriteString</span><span class="op" id="4760801">(</span><span class="string" id="4760802">&#34;null&#34;</span><span class="op" id="4760808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760812">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4760820">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760823">m</span>&nbsp;<span class="op" id="4760825">:=</span>&nbsp;<span class="ident" id="4760828"><a href="/encoding/json/encode.go.html#4760711">v</a></span><span class="op" id="4760829">.</span><span class="ident" id="4760830">Interface</span><span class="op" id="4760839">(</span><span class="op" id="4760840">)</span><span class="op" id="4760841">.</span><span class="op" id="4760842">(</span><span class="ident" id="4760843"><a href="/encoding/json/encode.go.html#4755165">Marshaler</a></span><span class="op" id="4760852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760855">b</span><span class="op" id="4760856">,</span>&nbsp;<span class="ident" id="4760858">err</span>&nbsp;<span class="op" id="4760862">:=</span>&nbsp;<span class="ident" id="4760865"><a href="/encoding/json/encode.go.html#4760823">m</a></span><span class="op" id="4760866">.</span><span class="ident" id="4760867">MarshalJSON</span><span class="op" id="4760878">(</span><span class="op" id="4760879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760882">if</span>&nbsp;<span class="ident" id="4760885"><a href="/encoding/json/encode.go.html#4760858">err</a></span>&nbsp;<span class="op" id="4760889">==</span>&nbsp;<span class="ident" id="4760892">nil</span>&nbsp;<span class="op" id="4760896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4760900">//&nbsp;copy&nbsp;JSON&nbsp;into&nbsp;buffer,&nbsp;checking&nbsp;validity.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4760947"><a href="/encoding/json/encode.go.html#4760858">err</a></span>&nbsp;<span class="op" id="4760951">=</span>&nbsp;<span class="ident" id="4760953"><a href="/encoding/json/indent.go.html#4782862">compact</a></span><span class="op" id="4760960">(</span><span class="op" id="4760961">&amp;</span><span class="ident" id="4760962"><a href="/encoding/json/encode.go.html#4760695">e</a></span><span class="op" id="4760963">.</span><span class="ident" id="4760964">Buffer</span><span class="op" id="4760970">,</span>&nbsp;<span class="ident" id="4760972"><a href="/encoding/json/encode.go.html#4760855">b</a></span><span class="op" id="4760973">,</span>&nbsp;<span class="builtintype" id="4760975">true</span><span class="op" id="4760979">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4760982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4760985">if</span>&nbsp;<span class="ident" id="4760988"><a href="/encoding/json/encode.go.html#4760858">err</a></span>&nbsp;<span class="op" id="4760992">!=</span>&nbsp;<span class="ident" id="4760995">nil</span>&nbsp;<span class="op" id="4760999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761003"><a href="/encoding/json/encode.go.html#4760695">e</a></span><span class="op" id="4761004">.</span><span class="builtintype" id="4761005">error</span><span class="op" id="4761010">(</span><span class="op" id="4761011">&amp;</span><span class="ident" id="4761012"><a href="/encoding/json/encode.go.html#4756257">MarshalerError</a></span><span class="op" id="4761026">{</span><span class="ident" id="4761027"><a href="/encoding/json/encode.go.html#4760711">v</a></span><span class="op" id="4761028">.</span><span class="ident" id="4761029">Type</span><span class="op" id="4761033">(</span><span class="op" id="4761034">)</span><span class="op" id="4761035">,</span>&nbsp;<span class="ident" id="4761037"><a href="/encoding/json/encode.go.html#4760858">err</a></span><span class="op" id="4761040">}</span><span class="op" id="4761041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4761044">}</span><br>
<span class="lineno"></span><span class="op" id="4761046">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span><span class="keyword" id="4761049">func</span>&nbsp;<span class="ident" id="4761054">addrMarshalerEncoder</span><span class="op" id="4761074">(</span><span class="ident" id="4761075">e</span>&nbsp;<span class="op" id="4761077">*</span><span class="ident" id="4761078"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4761089">,</span>&nbsp;<span class="ident" id="4761091">v</span>&nbsp;<span class="ident" id="4761093"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4761100">.</span><span class="ident" id="4761101">Value</span><span class="op" id="4761106">,</span>&nbsp;<span class="ident" id="4761108">quoted</span>&nbsp;<span class="builtintype" id="4761115">bool</span><span class="op" id="4761119">)</span>&nbsp;<span class="op" id="4761121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761124">va</span>&nbsp;<span class="op" id="4761127">:=</span>&nbsp;<span class="ident" id="4761130"><a href="/encoding/json/encode.go.html#4761091">v</a></span><span class="op" id="4761131">.</span><span class="ident" id="4761132">Addr</span><span class="op" id="4761136">(</span><span class="op" id="4761137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4761140">if</span>&nbsp;<span class="ident" id="4761143"><a href="/encoding/json/encode.go.html#4761124">va</a></span><span class="op" id="4761145">.</span><span class="ident" id="4761146">IsNil</span><span class="op" id="4761151">(</span><span class="op" id="4761152">)</span>&nbsp;<span class="op" id="4761154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761158"><a href="/encoding/json/encode.go.html#4761075">e</a></span><span class="op" id="4761159">.</span><span class="ident" id="4761160">WriteString</span><span class="op" id="4761171">(</span><span class="string" id="4761172">&#34;null&#34;</span><span class="op" id="4761178">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4761182">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4761190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761193">m</span>&nbsp;<span class="op" id="4761195">:=</span>&nbsp;<span class="ident" id="4761198"><a href="/encoding/json/encode.go.html#4761124">va</a></span><span class="op" id="4761200">.</span><span class="ident" id="4761201">Interface</span><span class="op" id="4761210">(</span><span class="op" id="4761211">)</span><span class="op" id="4761212">.</span><span class="op" id="4761213">(</span><span class="ident" id="4761214"><a href="/encoding/json/encode.go.html#4755165">Marshaler</a></span><span class="op" id="4761223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761226">b</span><span class="op" id="4761227">,</span>&nbsp;<span class="ident" id="4761229">err</span>&nbsp;<span class="op" id="4761233">:=</span>&nbsp;<span class="ident" id="4761236"><a href="/encoding/json/encode.go.html#4761193">m</a></span><span class="op" id="4761237">.</span><span class="ident" id="4761238">MarshalJSON</span><span class="op" id="4761249">(</span><span class="op" id="4761250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4761253">if</span>&nbsp;<span class="ident" id="4761256"><a href="/encoding/json/encode.go.html#4761229">err</a></span>&nbsp;<span class="op" id="4761260">==</span>&nbsp;<span class="ident" id="4761263">nil</span>&nbsp;<span class="op" id="4761267">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4761271">//&nbsp;copy&nbsp;JSON&nbsp;into&nbsp;buffer,&nbsp;checking&nbsp;validity.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761318"><a href="/encoding/json/encode.go.html#4761229">err</a></span>&nbsp;<span class="op" id="4761322">=</span>&nbsp;<span class="ident" id="4761324"><a href="/encoding/json/indent.go.html#4782862">compact</a></span><span class="op" id="4761331">(</span><span class="op" id="4761332">&amp;</span><span class="ident" id="4761333"><a href="/encoding/json/encode.go.html#4761075">e</a></span><span class="op" id="4761334">.</span><span class="ident" id="4761335">Buffer</span><span class="op" id="4761341">,</span>&nbsp;<span class="ident" id="4761343"><a href="/encoding/json/encode.go.html#4761226">b</a></span><span class="op" id="4761344">,</span>&nbsp;<span class="builtintype" id="4761346">true</span><span class="op" id="4761350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4761353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4761356">if</span>&nbsp;<span class="ident" id="4761359"><a href="/encoding/json/encode.go.html#4761229">err</a></span>&nbsp;<span class="op" id="4761363">!=</span>&nbsp;<span class="ident" id="4761366">nil</span>&nbsp;<span class="op" id="4761370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761374"><a href="/encoding/json/encode.go.html#4761075">e</a></span><span class="op" id="4761375">.</span><span class="builtintype" id="4761376">error</span><span class="op" id="4761381">(</span><span class="op" id="4761382">&amp;</span><span class="ident" id="4761383"><a href="/encoding/json/encode.go.html#4756257">MarshalerError</a></span><span class="op" id="4761397">{</span><span class="ident" id="4761398"><a href="/encoding/json/encode.go.html#4761091">v</a></span><span class="op" id="4761399">.</span><span class="ident" id="4761400">Type</span><span class="op" id="4761404">(</span><span class="op" id="4761405">)</span><span class="op" id="4761406">,</span>&nbsp;<span class="ident" id="4761408"><a href="/encoding/json/encode.go.html#4761229">err</a></span><span class="op" id="4761411">}</span><span class="op" id="4761412">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4761415">}</span><br>
<span class="lineno"></span><span class="op" id="4761417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4761420">func</span>&nbsp;<span class="ident" id="4761425">textMarshalerEncoder</span><span class="op" id="4761445">(</span><span class="ident" id="4761446">e</span>&nbsp;<span class="op" id="4761448">*</span><span class="ident" id="4761449"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4761460">,</span>&nbsp;<span class="ident" id="4761462">v</span>&nbsp;<span class="ident" id="4761464"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4761471">.</span><span class="ident" id="4761472">Value</span><span class="op" id="4761477">,</span>&nbsp;<span class="ident" id="4761479">quoted</span>&nbsp;<span class="builtintype" id="4761486">bool</span><span class="op" id="4761490">)</span>&nbsp;<span class="op" id="4761492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4761495">if</span>&nbsp;<span class="ident" id="4761498"><a href="/encoding/json/encode.go.html#4761462">v</a></span><span class="op" id="4761499">.</span><span class="ident" id="4761500">Kind</span><span class="op" id="4761504">(</span><span class="op" id="4761505">)</span>&nbsp;<span class="op" id="4761507">==</span>&nbsp;<span class="ident" id="4761510"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4761517">.</span><span class="ident" id="4761518">Ptr</span>&nbsp;<span class="op" id="4761522">&amp;&amp;</span>&nbsp;<span class="ident" id="4761525"><a href="/encoding/json/encode.go.html#4761462">v</a></span><span class="op" id="4761526">.</span><span class="ident" id="4761527">IsNil</span><span class="op" id="4761532">(</span><span class="op" id="4761533">)</span>&nbsp;<span class="op" id="4761535">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761539"><a href="/encoding/json/encode.go.html#4761446">e</a></span><span class="op" id="4761540">.</span><span class="ident" id="4761541">WriteString</span><span class="op" id="4761552">(</span><span class="string" id="4761553">&#34;null&#34;</span><span class="op" id="4761559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4761563">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4761571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761574">m</span>&nbsp;<span class="op" id="4761576">:=</span>&nbsp;<span class="ident" id="4761579"><a href="/encoding/json/encode.go.html#4761462">v</a></span><span class="op" id="4761580">.</span><span class="ident" id="4761581">Interface</span><span class="op" id="4761590">(</span><span class="op" id="4761591">)</span><span class="op" id="4761592">.</span><span class="op" id="4761593">(</span><span class="ident" id="4761594"><a href="/encoding/json/encode.go.html#4748628">encoding</a></span><span class="op" id="4761602">.</span><span class="ident" id="4761603">TextMarshaler</span><span class="op" id="4761616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761619">b</span><span class="op" id="4761620">,</span>&nbsp;<span class="ident" id="4761622">err</span>&nbsp;<span class="op" id="4761626">:=</span>&nbsp;<span class="ident" id="4761629"><a href="/encoding/json/encode.go.html#4761574">m</a></span><span class="op" id="4761630">.</span><span class="ident" id="4761631">MarshalText</span><span class="op" id="4761642">(</span><span class="op" id="4761643">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4761646">if</span>&nbsp;<span class="ident" id="4761649"><a href="/encoding/json/encode.go.html#4761622">err</a></span>&nbsp;<span class="op" id="4761653">==</span>&nbsp;<span class="ident" id="4761656">nil</span>&nbsp;<span class="op" id="4761660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761664">_</span><span class="op" id="4761665">,</span>&nbsp;<span class="ident" id="4761667"><a href="/encoding/json/encode.go.html#4761622">err</a></span>&nbsp;<span class="op" id="4761671">=</span>&nbsp;<span class="ident" id="4761673"><a href="/encoding/json/encode.go.html#4761446">e</a></span><span class="op" id="4761674">.</span><span class="ident" id="4761675">stringBytes</span><span class="op" id="4761686">(</span><span class="ident" id="4761687"><a href="/encoding/json/encode.go.html#4761619">b</a></span><span class="op" id="4761688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4761691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4761694">if</span>&nbsp;<span class="ident" id="4761697"><a href="/encoding/json/encode.go.html#4761622">err</a></span>&nbsp;<span class="op" id="4761701">!=</span>&nbsp;<span class="ident" id="4761704">nil</span>&nbsp;<span class="op" id="4761708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761712"><a href="/encoding/json/encode.go.html#4761446">e</a></span><span class="op" id="4761713">.</span><span class="builtintype" id="4761714">error</span><span class="op" id="4761719">(</span><span class="op" id="4761720">&amp;</span><span class="ident" id="4761721"><a href="/encoding/json/encode.go.html#4756257">MarshalerError</a></span><span class="op" id="4761735">{</span><span class="ident" id="4761736"><a href="/encoding/json/encode.go.html#4761462">v</a></span><span class="op" id="4761737">.</span><span class="ident" id="4761738">Type</span><span class="op" id="4761742">(</span><span class="op" id="4761743">)</span><span class="op" id="4761744">,</span>&nbsp;<span class="ident" id="4761746"><a href="/encoding/json/encode.go.html#4761622">err</a></span><span class="op" id="4761749">}</span><span class="op" id="4761750">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4761753">}</span><br>
<span class="lineno"></span><span class="op" id="4761755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4761758">func</span>&nbsp;<span class="ident" id="4761763">addrTextMarshalerEncoder</span><span class="op" id="4761787">(</span><span class="ident" id="4761788">e</span>&nbsp;<span class="op" id="4761790">*</span><span class="ident" id="4761791"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4761802">,</span>&nbsp;<span class="ident" id="4761804">v</span>&nbsp;<span class="ident" id="4761806"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4761813">.</span><span class="ident" id="4761814">Value</span><span class="op" id="4761819">,</span>&nbsp;<span class="ident" id="4761821">quoted</span>&nbsp;<span class="builtintype" id="4761828">bool</span><span class="op" id="4761832">)</span>&nbsp;<span class="op" id="4761834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761837">va</span>&nbsp;<span class="op" id="4761840">:=</span>&nbsp;<span class="ident" id="4761843"><a href="/encoding/json/encode.go.html#4761804">v</a></span><span class="op" id="4761844">.</span><span class="ident" id="4761845">Addr</span><span class="op" id="4761849">(</span><span class="op" id="4761850">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4761853">if</span>&nbsp;<span class="ident" id="4761856"><a href="/encoding/json/encode.go.html#4761837">va</a></span><span class="op" id="4761858">.</span><span class="ident" id="4761859">IsNil</span><span class="op" id="4761864">(</span><span class="op" id="4761865">)</span>&nbsp;<span class="op" id="4761867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761871"><a href="/encoding/json/encode.go.html#4761788">e</a></span><span class="op" id="4761872">.</span><span class="ident" id="4761873">WriteString</span><span class="op" id="4761884">(</span><span class="string" id="4761885">&#34;null&#34;</span><span class="op" id="4761891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4761895">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4761903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761906">m</span>&nbsp;<span class="op" id="4761908">:=</span>&nbsp;<span class="ident" id="4761911"><a href="/encoding/json/encode.go.html#4761837">va</a></span><span class="op" id="4761913">.</span><span class="ident" id="4761914">Interface</span><span class="op" id="4761923">(</span><span class="op" id="4761924">)</span><span class="op" id="4761925">.</span><span class="op" id="4761926">(</span><span class="ident" id="4761927"><a href="/encoding/json/encode.go.html#4748628">encoding</a></span><span class="op" id="4761935">.</span><span class="ident" id="4761936">TextMarshaler</span><span class="op" id="4761949">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761952">b</span><span class="op" id="4761953">,</span>&nbsp;<span class="ident" id="4761955">err</span>&nbsp;<span class="op" id="4761959">:=</span>&nbsp;<span class="ident" id="4761962"><a href="/encoding/json/encode.go.html#4761906">m</a></span><span class="op" id="4761963">.</span><span class="ident" id="4761964">MarshalText</span><span class="op" id="4761975">(</span><span class="op" id="4761976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4761979">if</span>&nbsp;<span class="ident" id="4761982"><a href="/encoding/json/encode.go.html#4761955">err</a></span>&nbsp;<span class="op" id="4761986">==</span>&nbsp;<span class="ident" id="4761989">nil</span>&nbsp;<span class="op" id="4761993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4761997">_</span><span class="op" id="4761998">,</span>&nbsp;<span class="ident" id="4762000"><a href="/encoding/json/encode.go.html#4761955">err</a></span>&nbsp;<span class="op" id="4762004">=</span>&nbsp;<span class="ident" id="4762006"><a href="/encoding/json/encode.go.html#4761788">e</a></span><span class="op" id="4762007">.</span><span class="ident" id="4762008">stringBytes</span><span class="op" id="4762019">(</span><span class="ident" id="4762020"><a href="/encoding/json/encode.go.html#4761952">b</a></span><span class="op" id="4762021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4762024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762027">if</span>&nbsp;<span class="ident" id="4762030"><a href="/encoding/json/encode.go.html#4761955">err</a></span>&nbsp;<span class="op" id="4762034">!=</span>&nbsp;<span class="ident" id="4762037">nil</span>&nbsp;<span class="op" id="4762041">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762045"><a href="/encoding/json/encode.go.html#4761788">e</a></span><span class="op" id="4762046">.</span><span class="builtintype" id="4762047">error</span><span class="op" id="4762052">(</span><span class="op" id="4762053">&amp;</span><span class="ident" id="4762054"><a href="/encoding/json/encode.go.html#4756257">MarshalerError</a></span><span class="op" id="4762068">{</span><span class="ident" id="4762069"><a href="/encoding/json/encode.go.html#4761804">v</a></span><span class="op" id="4762070">.</span><span class="ident" id="4762071">Type</span><span class="op" id="4762075">(</span><span class="op" id="4762076">)</span><span class="op" id="4762077">,</span>&nbsp;<span class="ident" id="4762079"><a href="/encoding/json/encode.go.html#4761955">err</a></span><span class="op" id="4762082">}</span><span class="op" id="4762083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4762086">}</span><br>
<span class="lineno"></span><span class="op" id="4762088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4762091">func</span>&nbsp;<span class="ident" id="4762096">boolEncoder</span><span class="op" id="4762107">(</span><span class="ident" id="4762108">e</span>&nbsp;<span class="op" id="4762110">*</span><span class="ident" id="4762111"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4762122">,</span>&nbsp;<span class="ident" id="4762124">v</span>&nbsp;<span class="ident" id="4762126"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4762133">.</span><span class="ident" id="4762134">Value</span><span class="op" id="4762139">,</span>&nbsp;<span class="ident" id="4762141">quoted</span>&nbsp;<span class="builtintype" id="4762148">bool</span><span class="op" id="4762152">)</span>&nbsp;<span class="op" id="4762154">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762157">if</span>&nbsp;<span class="ident" id="4762160"><a href="/encoding/json/encode.go.html#4762141">quoted</a></span>&nbsp;<span class="op" id="4762167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762171"><a href="/encoding/json/encode.go.html#4762108">e</a></span><span class="op" id="4762172">.</span><span class="ident" id="4762173">WriteByte</span><span class="op" id="4762182">(</span><span class="string" id="4762183">&#39;&#34;&#39;</span><span class="op" id="4762186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4762189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762192">if</span>&nbsp;<span class="ident" id="4762195"><a href="/encoding/json/encode.go.html#4762124">v</a></span><span class="op" id="4762196">.</span><span class="ident" id="4762197">Bool</span><span class="op" id="4762201">(</span><span class="op" id="4762202">)</span>&nbsp;<span class="op" id="4762204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762208"><a href="/encoding/json/encode.go.html#4762108">e</a></span><span class="op" id="4762209">.</span><span class="ident" id="4762210">WriteString</span><span class="op" id="4762221">(</span><span class="string" id="4762222">&#34;true&#34;</span><span class="op" id="4762228">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4762231">}</span>&nbsp;<span class="keyword" id="4762233">else</span>&nbsp;<span class="op" id="4762238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762242"><a href="/encoding/json/encode.go.html#4762108">e</a></span><span class="op" id="4762243">.</span><span class="ident" id="4762244">WriteString</span><span class="op" id="4762255">(</span><span class="string" id="4762256">&#34;false&#34;</span><span class="op" id="4762263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4762266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762269">if</span>&nbsp;<span class="ident" id="4762272"><a href="/encoding/json/encode.go.html#4762141">quoted</a></span>&nbsp;<span class="op" id="4762279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762283"><a href="/encoding/json/encode.go.html#4762108">e</a></span><span class="op" id="4762284">.</span><span class="ident" id="4762285">WriteByte</span><span class="op" id="4762294">(</span><span class="string" id="4762295">&#39;&#34;&#39;</span><span class="op" id="4762298">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4762301">}</span><br>
<span class="lineno"></span><span class="op" id="4762303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4762306">func</span>&nbsp;<span class="ident" id="4762311">intEncoder</span><span class="op" id="4762321">(</span><span class="ident" id="4762322">e</span>&nbsp;<span class="op" id="4762324">*</span><span class="ident" id="4762325"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4762336">,</span>&nbsp;<span class="ident" id="4762338">v</span>&nbsp;<span class="ident" id="4762340"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4762347">.</span><span class="ident" id="4762348">Value</span><span class="op" id="4762353">,</span>&nbsp;<span class="ident" id="4762355">quoted</span>&nbsp;<span class="builtintype" id="4762362">bool</span><span class="op" id="4762366">)</span>&nbsp;<span class="op" id="4762368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762371">b</span>&nbsp;<span class="op" id="4762373">:=</span>&nbsp;<span class="ident" id="4762376"><a href="/encoding/json/encode.go.html#4748697">strconv</a></span><span class="op" id="4762383">.</span><span class="ident" id="4762384">AppendInt</span><span class="op" id="4762393">(</span><span class="ident" id="4762394"><a href="/encoding/json/encode.go.html#4762322">e</a></span><span class="op" id="4762395">.</span><span class="ident" id="4762396">scratch</span><span class="op" id="4762403">[</span><span class="op" id="4762404">:</span><span class="num" id="4762405">0</span><span class="op" id="4762406">]</span><span class="op" id="4762407">,</span>&nbsp;<span class="ident" id="4762409"><a href="/encoding/json/encode.go.html#4762338">v</a></span><span class="op" id="4762410">.</span><span class="ident" id="4762411">Int</span><span class="op" id="4762414">(</span><span class="op" id="4762415">)</span><span class="op" id="4762416">,</span>&nbsp;<span class="num" id="4762418">10</span><span class="op" id="4762420">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762423">if</span>&nbsp;<span class="ident" id="4762426"><a href="/encoding/json/encode.go.html#4762355">quoted</a></span>&nbsp;<span class="op" id="4762433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762437"><a href="/encoding/json/encode.go.html#4762322">e</a></span><span class="op" id="4762438">.</span><span class="ident" id="4762439">WriteByte</span><span class="op" id="4762448">(</span><span class="string" id="4762449">&#39;&#34;&#39;</span><span class="op" id="4762452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4762455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762458"><a href="/encoding/json/encode.go.html#4762322">e</a></span><span class="op" id="4762459">.</span><span class="ident" id="4762460">Write</span><span class="op" id="4762465">(</span><span class="ident" id="4762466"><a href="/encoding/json/encode.go.html#4762371">b</a></span><span class="op" id="4762467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762470">if</span>&nbsp;<span class="ident" id="4762473"><a href="/encoding/json/encode.go.html#4762355">quoted</a></span>&nbsp;<span class="op" id="4762480">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762484"><a href="/encoding/json/encode.go.html#4762322">e</a></span><span class="op" id="4762485">.</span><span class="ident" id="4762486">WriteByte</span><span class="op" id="4762495">(</span><span class="string" id="4762496">&#39;&#34;&#39;</span><span class="op" id="4762499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4762502">}</span><br>
<span class="lineno"></span><span class="op" id="4762504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4762507">func</span>&nbsp;<span class="ident" id="4762512">uintEncoder</span><span class="op" id="4762523">(</span><span class="ident" id="4762524">e</span>&nbsp;<span class="op" id="4762526">*</span><span class="ident" id="4762527"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4762538">,</span>&nbsp;<span class="ident" id="4762540">v</span>&nbsp;<span class="ident" id="4762542"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4762549">.</span><span class="ident" id="4762550">Value</span><span class="op" id="4762555">,</span>&nbsp;<span class="ident" id="4762557">quoted</span>&nbsp;<span class="builtintype" id="4762564">bool</span><span class="op" id="4762568">)</span>&nbsp;<span class="op" id="4762570">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762573">b</span>&nbsp;<span class="op" id="4762575">:=</span>&nbsp;<span class="ident" id="4762578"><a href="/encoding/json/encode.go.html#4748697">strconv</a></span><span class="op" id="4762585">.</span><span class="ident" id="4762586">AppendUint</span><span class="op" id="4762596">(</span><span class="ident" id="4762597"><a href="/encoding/json/encode.go.html#4762524">e</a></span><span class="op" id="4762598">.</span><span class="ident" id="4762599">scratch</span><span class="op" id="4762606">[</span><span class="op" id="4762607">:</span><span class="num" id="4762608">0</span><span class="op" id="4762609">]</span><span class="op" id="4762610">,</span>&nbsp;<span class="ident" id="4762612"><a href="/encoding/json/encode.go.html#4762540">v</a></span><span class="op" id="4762613">.</span><span class="ident" id="4762614">Uint</span><span class="op" id="4762618">(</span><span class="op" id="4762619">)</span><span class="op" id="4762620">,</span>&nbsp;<span class="num" id="4762622">10</span><span class="op" id="4762624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762627">if</span>&nbsp;<span class="ident" id="4762630"><a href="/encoding/json/encode.go.html#4762557">quoted</a></span>&nbsp;<span class="op" id="4762637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762641"><a href="/encoding/json/encode.go.html#4762524">e</a></span><span class="op" id="4762642">.</span><span class="ident" id="4762643">WriteByte</span><span class="op" id="4762652">(</span><span class="string" id="4762653">&#39;&#34;&#39;</span><span class="op" id="4762656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4762659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762662"><a href="/encoding/json/encode.go.html#4762524">e</a></span><span class="op" id="4762663">.</span><span class="ident" id="4762664">Write</span><span class="op" id="4762669">(</span><span class="ident" id="4762670"><a href="/encoding/json/encode.go.html#4762573">b</a></span><span class="op" id="4762671">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762674">if</span>&nbsp;<span class="ident" id="4762677"><a href="/encoding/json/encode.go.html#4762557">quoted</a></span>&nbsp;<span class="op" id="4762684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762688"><a href="/encoding/json/encode.go.html#4762524">e</a></span><span class="op" id="4762689">.</span><span class="ident" id="4762690">WriteByte</span><span class="op" id="4762699">(</span><span class="string" id="4762700">&#39;&#34;&#39;</span><span class="op" id="4762703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4762706">}</span><br>
<span class="lineno"></span><span class="op" id="4762708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span><span class="keyword" id="4762711">type</span>&nbsp;<span class="ident" id="4762716">floatEncoder</span>&nbsp;<span class="builtintype" id="4762729">int</span>&nbsp;<span class="comment" id="4762733">//&nbsp;number&nbsp;of&nbsp;bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4762752">func</span>&nbsp;<span class="op" id="4762757">(</span><span class="ident" id="4762758">bits</span>&nbsp;<span class="ident" id="4762763"><a href="/encoding/json/encode.go.html#4762716">floatEncoder</a></span><span class="op" id="4762775">)</span>&nbsp;<span class="ident" id="4762777">encode</span><span class="op" id="4762783">(</span><span class="ident" id="4762784">e</span>&nbsp;<span class="op" id="4762786">*</span><span class="ident" id="4762787"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4762798">,</span>&nbsp;<span class="ident" id="4762800">v</span>&nbsp;<span class="ident" id="4762802"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4762809">.</span><span class="ident" id="4762810">Value</span><span class="op" id="4762815">,</span>&nbsp;<span class="ident" id="4762817">quoted</span>&nbsp;<span class="builtintype" id="4762824">bool</span><span class="op" id="4762828">)</span>&nbsp;<span class="op" id="4762830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762833">f</span>&nbsp;<span class="op" id="4762835">:=</span>&nbsp;<span class="ident" id="4762838"><a href="/encoding/json/encode.go.html#4762800">v</a></span><span class="op" id="4762839">.</span><span class="ident" id="4762840">Float</span><span class="op" id="4762845">(</span><span class="op" id="4762846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4762849">if</span>&nbsp;<span class="ident" id="4762852"><a href="/encoding/json/encode.go.html#4748659">math</a></span><span class="op" id="4762856">.</span><span class="ident" id="4762857">IsInf</span><span class="op" id="4762862">(</span><span class="ident" id="4762863"><a href="/encoding/json/encode.go.html#4762833">f</a></span><span class="op" id="4762864">,</span>&nbsp;<span class="num" id="4762866">0</span><span class="op" id="4762867">)</span>&nbsp;<span class="op" id="4762869">||</span>&nbsp;<span class="ident" id="4762872"><a href="/encoding/json/encode.go.html#4748659">math</a></span><span class="op" id="4762876">.</span><span class="ident" id="4762877">IsNaN</span><span class="op" id="4762882">(</span><span class="ident" id="4762883"><a href="/encoding/json/encode.go.html#4762833">f</a></span><span class="op" id="4762884">)</span>&nbsp;<span class="op" id="4762886">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762890"><a href="/encoding/json/encode.go.html#4762784">e</a></span><span class="op" id="4762891">.</span><span class="builtintype" id="4762892">error</span><span class="op" id="4762897">(</span><span class="op" id="4762898">&amp;</span><span class="ident" id="4762899"><a href="/encoding/json/encode.go.html#4755493">UnsupportedValueError</a></span><span class="op" id="4762920">{</span><span class="ident" id="4762921"><a href="/encoding/json/encode.go.html#4762800">v</a></span><span class="op" id="4762922">,</span>&nbsp;<span class="ident" id="4762924"><a href="/encoding/json/encode.go.html#4748697">strconv</a></span><span class="op" id="4762931">.</span><span class="ident" id="4762932">FormatFloat</span><span class="op" id="4762943">(</span><span class="ident" id="4762944"><a href="/encoding/json/encode.go.html#4762833">f</a></span><span class="op" id="4762945">,</span>&nbsp;<span class="string" id="4762947">&#39;g&#39;</span><span class="op" id="4762950">,</span>&nbsp;<span class="op" id="4762952">-</span><span class="num" id="4762953">1</span><span class="op" id="4762954">,</span>&nbsp;<span class="builtintype" id="4762956">int</span><span class="op" id="4762959">(</span><span class="ident" id="4762960"><a href="/encoding/json/encode.go.html#4762758">bits</a></span><span class="op" id="4762964">)</span><span class="op" id="4762965">)</span><span class="op" id="4762966">}</span><span class="op" id="4762967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4762970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4762973">b</span>&nbsp;<span class="op" id="4762975">:=</span>&nbsp;<span class="ident" id="4762978"><a href="/encoding/json/encode.go.html#4748697">strconv</a></span><span class="op" id="4762985">.</span><span class="ident" id="4762986">AppendFloat</span><span class="op" id="4762997">(</span><span class="ident" id="4762998"><a href="/encoding/json/encode.go.html#4762784">e</a></span><span class="op" id="4762999">.</span><span class="ident" id="4763000">scratch</span><span class="op" id="4763007">[</span><span class="op" id="4763008">:</span><span class="num" id="4763009">0</span><span class="op" id="4763010">]</span><span class="op" id="4763011">,</span>&nbsp;<span class="ident" id="4763013"><a href="/encoding/json/encode.go.html#4762833">f</a></span><span class="op" id="4763014">,</span>&nbsp;<span class="string" id="4763016">&#39;g&#39;</span><span class="op" id="4763019">,</span>&nbsp;<span class="op" id="4763021">-</span><span class="num" id="4763022">1</span><span class="op" id="4763023">,</span>&nbsp;<span class="builtintype" id="4763025">int</span><span class="op" id="4763028">(</span><span class="ident" id="4763029"><a href="/encoding/json/encode.go.html#4762758">bits</a></span><span class="op" id="4763033">)</span><span class="op" id="4763034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763037">if</span>&nbsp;<span class="ident" id="4763040"><a href="/encoding/json/encode.go.html#4762817">quoted</a></span>&nbsp;<span class="op" id="4763047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763051"><a href="/encoding/json/encode.go.html#4762784">e</a></span><span class="op" id="4763052">.</span><span class="ident" id="4763053">WriteByte</span><span class="op" id="4763062">(</span><span class="string" id="4763063">&#39;&#34;&#39;</span><span class="op" id="4763066">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4763069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763072"><a href="/encoding/json/encode.go.html#4762784">e</a></span><span class="op" id="4763073">.</span><span class="ident" id="4763074">Write</span><span class="op" id="4763079">(</span><span class="ident" id="4763080"><a href="/encoding/json/encode.go.html#4762973">b</a></span><span class="op" id="4763081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763084">if</span>&nbsp;<span class="ident" id="4763087"><a href="/encoding/json/encode.go.html#4762817">quoted</a></span>&nbsp;<span class="op" id="4763094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763098"><a href="/encoding/json/encode.go.html#4762784">e</a></span><span class="op" id="4763099">.</span><span class="ident" id="4763100">WriteByte</span><span class="op" id="4763109">(</span><span class="string" id="4763110">&#39;&#34;&#39;</span><span class="op" id="4763113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4763116">}</span><br>
<span class="lineno">525</span><span class="op" id="4763118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4763121">var</span>&nbsp;<span class="op" id="4763125">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763128">float32Encoder</span>&nbsp;<span class="op" id="4763143">=</span>&nbsp;<span class="op" id="4763145">(</span><span class="ident" id="4763146"><a href="/encoding/json/encode.go.html#4762716">floatEncoder</a></span><span class="op" id="4763158">(</span><span class="num" id="4763159">32</span><span class="op" id="4763161">)</span><span class="op" id="4763162">)</span><span class="op" id="4763163">.</span><span class="ident" id="4763164">encode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763172">float64Encoder</span>&nbsp;<span class="op" id="4763187">=</span>&nbsp;<span class="op" id="4763189">(</span><span class="ident" id="4763190"><a href="/encoding/json/encode.go.html#4762716">floatEncoder</a></span><span class="op" id="4763202">(</span><span class="num" id="4763203">64</span><span class="op" id="4763205">)</span><span class="op" id="4763206">)</span><span class="op" id="4763207">.</span><span class="ident" id="4763208">encode</span><br>
<span class="lineno">530</span><span class="op" id="4763215">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4763218">func</span>&nbsp;<span class="ident" id="4763223">stringEncoder</span><span class="op" id="4763236">(</span><span class="ident" id="4763237">e</span>&nbsp;<span class="op" id="4763239">*</span><span class="ident" id="4763240"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4763251">,</span>&nbsp;<span class="ident" id="4763253">v</span>&nbsp;<span class="ident" id="4763255"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4763262">.</span><span class="ident" id="4763263">Value</span><span class="op" id="4763268">,</span>&nbsp;<span class="ident" id="4763270">quoted</span>&nbsp;<span class="builtintype" id="4763277">bool</span><span class="op" id="4763281">)</span>&nbsp;<span class="op" id="4763283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763286">if</span>&nbsp;<span class="ident" id="4763289"><a href="/encoding/json/encode.go.html#4763253">v</a></span><span class="op" id="4763290">.</span><span class="ident" id="4763291">Type</span><span class="op" id="4763295">(</span><span class="op" id="4763296">)</span>&nbsp;<span class="op" id="4763298">==</span>&nbsp;<span class="ident" id="4763301"><a href="/encoding/json/decode.go.html#4738248">numberType</a></span>&nbsp;<span class="op" id="4763312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763316">numStr</span>&nbsp;<span class="op" id="4763323">:=</span>&nbsp;<span class="ident" id="4763326"><a href="/encoding/json/encode.go.html#4763253">v</a></span><span class="op" id="4763327">.</span><span class="ident" id="4763328">String</span><span class="op" id="4763334">(</span><span class="op" id="4763335">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763339">if</span>&nbsp;<span class="ident" id="4763342"><a href="/encoding/json/encode.go.html#4763316">numStr</a></span>&nbsp;<span class="op" id="4763349">==</span>&nbsp;<span class="string" id="4763352">&#34;&#34;</span>&nbsp;<span class="op" id="4763355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763360"><a href="/encoding/json/encode.go.html#4763316">numStr</a></span>&nbsp;<span class="op" id="4763367">=</span>&nbsp;<span class="string" id="4763369">&#34;0&#34;</span>&nbsp;<span class="comment" id="4763373">//&nbsp;Number&#39;s&nbsp;zero-val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4763396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763400"><a href="/encoding/json/encode.go.html#4763237">e</a></span><span class="op" id="4763401">.</span><span class="ident" id="4763402">WriteString</span><span class="op" id="4763413">(</span><span class="ident" id="4763414"><a href="/encoding/json/encode.go.html#4763316">numStr</a></span><span class="op" id="4763420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763424">return</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4763432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763435">if</span>&nbsp;<span class="ident" id="4763438"><a href="/encoding/json/encode.go.html#4763270">quoted</a></span>&nbsp;<span class="op" id="4763445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763449">sb</span><span class="op" id="4763451">,</span>&nbsp;<span class="ident" id="4763453">err</span>&nbsp;<span class="op" id="4763457">:=</span>&nbsp;<span class="ident" id="4763460"><a href="/encoding/json/encode.go.html#4753477">Marshal</a></span><span class="op" id="4763467">(</span><span class="ident" id="4763468"><a href="/encoding/json/encode.go.html#4763253">v</a></span><span class="op" id="4763469">.</span><span class="ident" id="4763470">String</span><span class="op" id="4763476">(</span><span class="op" id="4763477">)</span><span class="op" id="4763478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763482">if</span>&nbsp;<span class="ident" id="4763485"><a href="/encoding/json/encode.go.html#4763453">err</a></span>&nbsp;<span class="op" id="4763489">!=</span>&nbsp;<span class="ident" id="4763492">nil</span>&nbsp;<span class="op" id="4763496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763501"><a href="/encoding/json/encode.go.html#4763237">e</a></span><span class="op" id="4763502">.</span><span class="builtintype" id="4763503">error</span><span class="op" id="4763508">(</span><span class="ident" id="4763509"><a href="/encoding/json/encode.go.html#4763453">err</a></span><span class="op" id="4763512">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4763516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763520"><a href="/encoding/json/encode.go.html#4763237">e</a></span><span class="op" id="4763521">.</span><span class="builtintype" id="4763522">string</span><span class="op" id="4763528">(</span><span class="builtintype" id="4763529">string</span><span class="op" id="4763535">(</span><span class="ident" id="4763536"><a href="/encoding/json/encode.go.html#4763449">sb</a></span><span class="op" id="4763538">)</span><span class="op" id="4763539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4763542">}</span>&nbsp;<span class="keyword" id="4763544">else</span>&nbsp;<span class="op" id="4763549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763553"><a href="/encoding/json/encode.go.html#4763237">e</a></span><span class="op" id="4763554">.</span><span class="builtintype" id="4763555">string</span><span class="op" id="4763561">(</span><span class="ident" id="4763562"><a href="/encoding/json/encode.go.html#4763253">v</a></span><span class="op" id="4763563">.</span><span class="ident" id="4763564">String</span><span class="op" id="4763570">(</span><span class="op" id="4763571">)</span><span class="op" id="4763572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4763575">}</span><br>
<span class="lineno">550</span><span class="op" id="4763577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4763580">func</span>&nbsp;<span class="ident" id="4763585">interfaceEncoder</span><span class="op" id="4763601">(</span><span class="ident" id="4763602">e</span>&nbsp;<span class="op" id="4763604">*</span><span class="ident" id="4763605"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4763616">,</span>&nbsp;<span class="ident" id="4763618">v</span>&nbsp;<span class="ident" id="4763620"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4763627">.</span><span class="ident" id="4763628">Value</span><span class="op" id="4763633">,</span>&nbsp;<span class="ident" id="4763635">quoted</span>&nbsp;<span class="builtintype" id="4763642">bool</span><span class="op" id="4763646">)</span>&nbsp;<span class="op" id="4763648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763651">if</span>&nbsp;<span class="ident" id="4763654"><a href="/encoding/json/encode.go.html#4763618">v</a></span><span class="op" id="4763655">.</span><span class="ident" id="4763656">IsNil</span><span class="op" id="4763661">(</span><span class="op" id="4763662">)</span>&nbsp;<span class="op" id="4763664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763668"><a href="/encoding/json/encode.go.html#4763602">e</a></span><span class="op" id="4763669">.</span><span class="ident" id="4763670">WriteString</span><span class="op" id="4763681">(</span><span class="string" id="4763682">&#34;null&#34;</span><span class="op" id="4763688">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4763692">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4763700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763703"><a href="/encoding/json/encode.go.html#4763602">e</a></span><span class="op" id="4763704">.</span><span class="ident" id="4763705">reflectValue</span><span class="op" id="4763717">(</span><span class="ident" id="4763718"><a href="/encoding/json/encode.go.html#4763618">v</a></span><span class="op" id="4763719">.</span><span class="ident" id="4763720">Elem</span><span class="op" id="4763724">(</span><span class="op" id="4763725">)</span><span class="op" id="4763726">)</span><br>
<span class="lineno"></span><span class="op" id="4763728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="keyword" id="4763731">func</span>&nbsp;<span class="ident" id="4763736">unsupportedTypeEncoder</span><span class="op" id="4763758">(</span><span class="ident" id="4763759">e</span>&nbsp;<span class="op" id="4763761">*</span><span class="ident" id="4763762"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4763773">,</span>&nbsp;<span class="ident" id="4763775">v</span>&nbsp;<span class="ident" id="4763777"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4763784">.</span><span class="ident" id="4763785">Value</span><span class="op" id="4763790">,</span>&nbsp;<span class="ident" id="4763792">quoted</span>&nbsp;<span class="builtintype" id="4763799">bool</span><span class="op" id="4763803">)</span>&nbsp;<span class="op" id="4763805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763808"><a href="/encoding/json/encode.go.html#4763759">e</a></span><span class="op" id="4763809">.</span><span class="builtintype" id="4763810">error</span><span class="op" id="4763815">(</span><span class="op" id="4763816">&amp;</span><span class="ident" id="4763817"><a href="/encoding/json/encode.go.html#4755332">UnsupportedTypeError</a></span><span class="op" id="4763837">{</span><span class="ident" id="4763838"><a href="/encoding/json/encode.go.html#4763775">v</a></span><span class="op" id="4763839">.</span><span class="ident" id="4763840">Type</span><span class="op" id="4763844">(</span><span class="op" id="4763845">)</span><span class="op" id="4763846">}</span><span class="op" id="4763847">)</span><br>
<span class="lineno"></span><span class="op" id="4763849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4763852">type</span>&nbsp;<span class="ident" id="4763857">structEncoder</span>&nbsp;<span class="keyword" id="4763871">struct</span>&nbsp;<span class="op" id="4763878">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763881">fields</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4763891">[</span><span class="op" id="4763892">]</span><span class="ident" id="4763893"><a href="/encoding/json/encode.go.html#4772578">field</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4763900">fieldEncs</span>&nbsp;<span class="op" id="4763910">[</span><span class="op" id="4763911">]</span><span class="ident" id="4763912"><a href="/encoding/json/encode.go.html#4757853">encoderFunc</a></span><br>
<span class="lineno"></span><span class="op" id="4763924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4763927">func</span>&nbsp;<span class="op" id="4763932">(</span><span class="ident" id="4763933">se</span>&nbsp;<span class="op" id="4763936">*</span><span class="ident" id="4763937"><a href="/encoding/json/encode.go.html#4763857">structEncoder</a></span><span class="op" id="4763950">)</span>&nbsp;<span class="ident" id="4763952">encode</span><span class="op" id="4763958">(</span><span class="ident" id="4763959">e</span>&nbsp;<span class="op" id="4763961">*</span><span class="ident" id="4763962"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4763973">,</span>&nbsp;<span class="ident" id="4763975">v</span>&nbsp;<span class="ident" id="4763977"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4763984">.</span><span class="ident" id="4763985">Value</span><span class="op" id="4763990">,</span>&nbsp;<span class="ident" id="4763992">quoted</span>&nbsp;<span class="builtintype" id="4763999">bool</span><span class="op" id="4764003">)</span>&nbsp;<span class="op" id="4764005">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764008"><a href="/encoding/json/encode.go.html#4763959">e</a></span><span class="op" id="4764009">.</span><span class="ident" id="4764010">WriteByte</span><span class="op" id="4764019">(</span><span class="string" id="4764020">&#39;{&#39;</span><span class="op" id="4764023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764026">first</span>&nbsp;<span class="op" id="4764032">:=</span>&nbsp;<span class="builtintype" id="4764035">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764041">for</span>&nbsp;<span class="ident" id="4764045">i</span><span class="op" id="4764046">,</span>&nbsp;<span class="ident" id="4764048">f</span>&nbsp;<span class="op" id="4764050">:=</span>&nbsp;<span class="keyword" id="4764053">range</span>&nbsp;<span class="ident" id="4764059"><a href="/encoding/json/encode.go.html#4763933">se</a></span><span class="op" id="4764061">.</span><span class="ident" id="4764062">fields</span>&nbsp;<span class="op" id="4764069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764073">fv</span>&nbsp;<span class="op" id="4764076">:=</span>&nbsp;<span class="ident" id="4764079"><a href="/encoding/json/encode.go.html#4767933">fieldByIndex</a></span><span class="op" id="4764091">(</span><span class="ident" id="4764092"><a href="/encoding/json/encode.go.html#4763975">v</a></span><span class="op" id="4764093">,</span>&nbsp;<span class="ident" id="4764095"><a href="/encoding/json/encode.go.html#4764048">f</a></span><span class="op" id="4764096">.</span><span class="ident" id="4764097">index</span><span class="op" id="4764102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764106">if</span>&nbsp;<span class="op" id="4764109">!</span><span class="ident" id="4764110"><a href="/encoding/json/encode.go.html#4764073">fv</a></span><span class="op" id="4764112">.</span><span class="ident" id="4764113">IsValid</span><span class="op" id="4764120">(</span><span class="op" id="4764121">)</span>&nbsp;<span class="op" id="4764123">||</span>&nbsp;<span class="ident" id="4764126"><a href="/encoding/json/encode.go.html#4764048">f</a></span><span class="op" id="4764127">.</span><span class="ident" id="4764128">omitEmpty</span>&nbsp;<span class="op" id="4764138">&amp;&amp;</span>&nbsp;<span class="ident" id="4764141"><a href="/encoding/json/encode.go.html#4757215">isEmptyValue</a></span><span class="op" id="4764153">(</span><span class="ident" id="4764154"><a href="/encoding/json/encode.go.html#4764073">fv</a></span><span class="op" id="4764156">)</span>&nbsp;<span class="op" id="4764158">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764163">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4764174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764178">if</span>&nbsp;<span class="ident" id="4764181"><a href="/encoding/json/encode.go.html#4764026">first</a></span>&nbsp;<span class="op" id="4764187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764192"><a href="/encoding/json/encode.go.html#4764026">first</a></span>&nbsp;<span class="op" id="4764198">=</span>&nbsp;<span class="builtintype" id="4764200">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4764208">}</span>&nbsp;<span class="keyword" id="4764210">else</span>&nbsp;<span class="op" id="4764215">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764220"><a href="/encoding/json/encode.go.html#4763959">e</a></span><span class="op" id="4764221">.</span><span class="ident" id="4764222">WriteByte</span><span class="op" id="4764231">(</span><span class="string" id="4764232">&#39;,&#39;</span><span class="op" id="4764235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4764239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764243"><a href="/encoding/json/encode.go.html#4763959">e</a></span><span class="op" id="4764244">.</span><span class="builtintype" id="4764245">string</span><span class="op" id="4764251">(</span><span class="ident" id="4764252"><a href="/encoding/json/encode.go.html#4764048">f</a></span><span class="op" id="4764253">.</span><span class="ident" id="4764254">name</span><span class="op" id="4764258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764262"><a href="/encoding/json/encode.go.html#4763959">e</a></span><span class="op" id="4764263">.</span><span class="ident" id="4764264">WriteByte</span><span class="op" id="4764273">(</span><span class="string" id="4764274">&#39;:&#39;</span><span class="op" id="4764277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764281"><a href="/encoding/json/encode.go.html#4763933">se</a></span><span class="op" id="4764283">.</span><span class="ident" id="4764284">fieldEncs</span><span class="op" id="4764293">[</span><span class="ident" id="4764294"><a href="/encoding/json/encode.go.html#4764045">i</a></span><span class="op" id="4764295">]</span><span class="op" id="4764296">(</span><span class="ident" id="4764297"><a href="/encoding/json/encode.go.html#4763959">e</a></span><span class="op" id="4764298">,</span>&nbsp;<span class="ident" id="4764300"><a href="/encoding/json/encode.go.html#4764073">fv</a></span><span class="op" id="4764302">,</span>&nbsp;<span class="ident" id="4764304"><a href="/encoding/json/encode.go.html#4764048">f</a></span><span class="op" id="4764305">.</span><span class="ident" id="4764306">quoted</span><span class="op" id="4764312">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4764315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764318"><a href="/encoding/json/encode.go.html#4763959">e</a></span><span class="op" id="4764319">.</span><span class="ident" id="4764320">WriteByte</span><span class="op" id="4764329">(</span><span class="string" id="4764330">&#39;}&#39;</span><span class="op" id="4764333">)</span><br>
<span class="lineno"></span><span class="op" id="4764335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4764338">func</span>&nbsp;<span class="ident" id="4764343">newStructEncoder</span><span class="op" id="4764359">(</span><span class="ident" id="4764360">t</span>&nbsp;<span class="ident" id="4764362"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4764369">.</span><span class="ident" id="4764370">Type</span><span class="op" id="4764374">)</span>&nbsp;<span class="ident" id="4764376"><a href="/encoding/json/encode.go.html#4757853">encoderFunc</a></span>&nbsp;<span class="op" id="4764388">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764391">fields</span>&nbsp;<span class="op" id="4764398">:=</span>&nbsp;<span class="ident" id="4764401"><a href="/encoding/json/encode.go.html#4778575">cachedTypeFields</a></span><span class="op" id="4764417">(</span><span class="ident" id="4764418"><a href="/encoding/json/encode.go.html#4764360">t</a></span><span class="op" id="4764419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764422">se</span>&nbsp;<span class="op" id="4764425">:=</span>&nbsp;<span class="op" id="4764428">&amp;</span><span class="ident" id="4764429"><a href="/encoding/json/encode.go.html#4763857">structEncoder</a></span><span class="op" id="4764442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764446">fields</span><span class="op" id="4764452">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764457"><a href="/encoding/json/encode.go.html#4764391">fields</a></span><span class="op" id="4764463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764467">fieldEncs</span><span class="op" id="4764476">:</span>&nbsp;<span class="builtinfunc" id="4764478">make</span><span class="op" id="4764482">(</span><span class="op" id="4764483">[</span><span class="op" id="4764484">]</span><span class="ident" id="4764485"><a href="/encoding/json/encode.go.html#4757853">encoderFunc</a></span><span class="op" id="4764496">,</span>&nbsp;<span class="builtinfunc" id="4764498">len</span><span class="op" id="4764501">(</span><span class="ident" id="4764502"><a href="/encoding/json/encode.go.html#4764391">fields</a></span><span class="op" id="4764508">)</span><span class="op" id="4764509">)</span><span class="op" id="4764510">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4764513">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764516">for</span>&nbsp;<span class="ident" id="4764520">i</span><span class="op" id="4764521">,</span>&nbsp;<span class="ident" id="4764523">f</span>&nbsp;<span class="op" id="4764525">:=</span>&nbsp;<span class="keyword" id="4764528">range</span>&nbsp;<span class="ident" id="4764534"><a href="/encoding/json/encode.go.html#4764391">fields</a></span>&nbsp;<span class="op" id="4764541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764545"><a href="/encoding/json/encode.go.html#4764422">se</a></span><span class="op" id="4764547">.</span><span class="ident" id="4764548">fieldEncs</span><span class="op" id="4764557">[</span><span class="ident" id="4764558"><a href="/encoding/json/encode.go.html#4764520">i</a></span><span class="op" id="4764559">]</span>&nbsp;<span class="op" id="4764561">=</span>&nbsp;<span class="ident" id="4764563"><a href="/encoding/json/encode.go.html#4758130">typeEncoder</a></span><span class="op" id="4764574">(</span><span class="ident" id="4764575"><a href="/encoding/json/encode.go.html#4768158">typeByIndex</a></span><span class="op" id="4764586">(</span><span class="ident" id="4764587"><a href="/encoding/json/encode.go.html#4764360">t</a></span><span class="op" id="4764588">,</span>&nbsp;<span class="ident" id="4764590"><a href="/encoding/json/encode.go.html#4764523">f</a></span><span class="op" id="4764591">.</span><span class="ident" id="4764592">index</span><span class="op" id="4764597">)</span><span class="op" id="4764598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4764601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764604">return</span>&nbsp;<span class="ident" id="4764611"><a href="/encoding/json/encode.go.html#4764422">se</a></span><span class="op" id="4764613">.</span><span class="ident" id="4764614">encode</span><br>
<span class="lineno"></span><span class="op" id="4764621">}</span><br>
<span class="lineno">600</span><br>
<span class="lineno"></span><span class="keyword" id="4764624">type</span>&nbsp;<span class="ident" id="4764629">mapEncoder</span>&nbsp;<span class="keyword" id="4764640">struct</span>&nbsp;<span class="op" id="4764647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764650">elemEnc</span>&nbsp;<span class="ident" id="4764658"><a href="/encoding/json/encode.go.html#4757853">encoderFunc</a></span><br>
<span class="lineno"></span><span class="op" id="4764670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">605</span><span class="keyword" id="4764673">func</span>&nbsp;<span class="op" id="4764678">(</span><span class="ident" id="4764679">me</span>&nbsp;<span class="op" id="4764682">*</span><span class="ident" id="4764683"><a href="/encoding/json/encode.go.html#4764629">mapEncoder</a></span><span class="op" id="4764693">)</span>&nbsp;<span class="ident" id="4764695">encode</span><span class="op" id="4764701">(</span><span class="ident" id="4764702">e</span>&nbsp;<span class="op" id="4764704">*</span><span class="ident" id="4764705"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4764716">,</span>&nbsp;<span class="ident" id="4764718">v</span>&nbsp;<span class="ident" id="4764720"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4764727">.</span><span class="ident" id="4764728">Value</span><span class="op" id="4764733">,</span>&nbsp;<span class="ident" id="4764735">_</span>&nbsp;<span class="builtintype" id="4764737">bool</span><span class="op" id="4764741">)</span>&nbsp;<span class="op" id="4764743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764746">if</span>&nbsp;<span class="ident" id="4764749"><a href="/encoding/json/encode.go.html#4764718">v</a></span><span class="op" id="4764750">.</span><span class="ident" id="4764751">IsNil</span><span class="op" id="4764756">(</span><span class="op" id="4764757">)</span>&nbsp;<span class="op" id="4764759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764763"><a href="/encoding/json/encode.go.html#4764702">e</a></span><span class="op" id="4764764">.</span><span class="ident" id="4764765">WriteString</span><span class="op" id="4764776">(</span><span class="string" id="4764777">&#34;null&#34;</span><span class="op" id="4764783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764787">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4764795">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764798"><a href="/encoding/json/encode.go.html#4764702">e</a></span><span class="op" id="4764799">.</span><span class="ident" id="4764800">WriteByte</span><span class="op" id="4764809">(</span><span class="string" id="4764810">&#39;{&#39;</span><span class="op" id="4764813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764816">var</span>&nbsp;<span class="ident" id="4764820">sv</span>&nbsp;<span class="ident" id="4764823"><a href="/encoding/json/encode.go.html#4768457">stringValues</a></span>&nbsp;<span class="op" id="4764836">=</span>&nbsp;<span class="ident" id="4764838"><a href="/encoding/json/encode.go.html#4764718">v</a></span><span class="op" id="4764839">.</span><span class="ident" id="4764840">MapKeys</span><span class="op" id="4764847">(</span><span class="op" id="4764848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764851"><a href="/encoding/json/encode.go.html#4748689">sort</a></span><span class="op" id="4764855">.</span><span class="ident" id="4764856">Sort</span><span class="op" id="4764860">(</span><span class="ident" id="4764861"><a href="/encoding/json/encode.go.html#4764820">sv</a></span><span class="op" id="4764863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764866">for</span>&nbsp;<span class="ident" id="4764870">i</span><span class="op" id="4764871">,</span>&nbsp;<span class="ident" id="4764873">k</span>&nbsp;<span class="op" id="4764875">:=</span>&nbsp;<span class="keyword" id="4764878">range</span>&nbsp;<span class="ident" id="4764884"><a href="/encoding/json/encode.go.html#4764820">sv</a></span>&nbsp;<span class="op" id="4764887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4764891">if</span>&nbsp;<span class="ident" id="4764894"><a href="/encoding/json/encode.go.html#4764870">i</a></span>&nbsp;<span class="op" id="4764896">&gt;</span>&nbsp;<span class="num" id="4764898">0</span>&nbsp;<span class="op" id="4764900">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764905"><a href="/encoding/json/encode.go.html#4764702">e</a></span><span class="op" id="4764906">.</span><span class="ident" id="4764907">WriteByte</span><span class="op" id="4764916">(</span><span class="string" id="4764917">&#39;,&#39;</span><span class="op" id="4764920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4764924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764928"><a href="/encoding/json/encode.go.html#4764702">e</a></span><span class="op" id="4764929">.</span><span class="builtintype" id="4764930">string</span><span class="op" id="4764936">(</span><span class="ident" id="4764937"><a href="/encoding/json/encode.go.html#4764873">k</a></span><span class="op" id="4764938">.</span><span class="ident" id="4764939">String</span><span class="op" id="4764945">(</span><span class="op" id="4764946">)</span><span class="op" id="4764947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764951"><a href="/encoding/json/encode.go.html#4764702">e</a></span><span class="op" id="4764952">.</span><span class="ident" id="4764953">WriteByte</span><span class="op" id="4764962">(</span><span class="string" id="4764963">&#39;:&#39;</span><span class="op" id="4764966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4764970"><a href="/encoding/json/encode.go.html#4764679">me</a></span><span class="op" id="4764972">.</span><span class="ident" id="4764973">elemEnc</span><span class="op" id="4764980">(</span><span class="ident" id="4764981"><a href="/encoding/json/encode.go.html#4764702">e</a></span><span class="op" id="4764982">,</span>&nbsp;<span class="ident" id="4764984"><a href="/encoding/json/encode.go.html#4764718">v</a></span><span class="op" id="4764985">.</span><span class="ident" id="4764986">MapIndex</span><span class="op" id="4764994">(</span><span class="ident" id="4764995"><a href="/encoding/json/encode.go.html#4764873">k</a></span><span class="op" id="4764996">)</span><span class="op" id="4764997">,</span>&nbsp;<span class="builtintype" id="4764999">false</span><span class="op" id="4765004">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4765007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765010"><a href="/encoding/json/encode.go.html#4764702">e</a></span><span class="op" id="4765011">.</span><span class="ident" id="4765012">WriteByte</span><span class="op" id="4765021">(</span><span class="string" id="4765022">&#39;}&#39;</span><span class="op" id="4765025">)</span><br>
<span class="lineno"></span><span class="op" id="4765027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4765030">func</span>&nbsp;<span class="ident" id="4765035">newMapEncoder</span><span class="op" id="4765048">(</span><span class="ident" id="4765049">t</span>&nbsp;<span class="ident" id="4765051"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4765058">.</span><span class="ident" id="4765059">Type</span><span class="op" id="4765063">)</span>&nbsp;<span class="ident" id="4765065"><a href="/encoding/json/encode.go.html#4757853">encoderFunc</a></span>&nbsp;<span class="op" id="4765077">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765080">if</span>&nbsp;<span class="ident" id="4765083"><a href="/encoding/json/encode.go.html#4765049">t</a></span><span class="op" id="4765084">.</span><span class="ident" id="4765085">Key</span><span class="op" id="4765088">(</span><span class="op" id="4765089">)</span><span class="op" id="4765090">.</span><span class="ident" id="4765091">Kind</span><span class="op" id="4765095">(</span><span class="op" id="4765096">)</span>&nbsp;<span class="op" id="4765098">!=</span>&nbsp;<span class="ident" id="4765101"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4765108">.</span><span class="ident" id="4765109">String</span>&nbsp;<span class="op" id="4765116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765120">return</span>&nbsp;<span class="ident" id="4765127"><a href="/encoding/json/encode.go.html#4763736">unsupportedTypeEncoder</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4765151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765154">me</span>&nbsp;<span class="op" id="4765157">:=</span>&nbsp;<span class="op" id="4765160">&amp;</span><span class="ident" id="4765161"><a href="/encoding/json/encode.go.html#4764629">mapEncoder</a></span><span class="op" id="4765171">{</span><span class="ident" id="4765172"><a href="/encoding/json/encode.go.html#4758130">typeEncoder</a></span><span class="op" id="4765183">(</span><span class="ident" id="4765184"><a href="/encoding/json/encode.go.html#4765049">t</a></span><span class="op" id="4765185">.</span><span class="ident" id="4765186">Elem</span><span class="op" id="4765190">(</span><span class="op" id="4765191">)</span><span class="op" id="4765192">)</span><span class="op" id="4765193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765196">return</span>&nbsp;<span class="ident" id="4765203"><a href="/encoding/json/encode.go.html#4765154">me</a></span><span class="op" id="4765205">.</span><span class="ident" id="4765206">encode</span><br>
<span class="lineno">630</span><span class="op" id="4765213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4765216">func</span>&nbsp;<span class="ident" id="4765221">encodeByteSlice</span><span class="op" id="4765236">(</span><span class="ident" id="4765237">e</span>&nbsp;<span class="op" id="4765239">*</span><span class="ident" id="4765240"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4765251">,</span>&nbsp;<span class="ident" id="4765253">v</span>&nbsp;<span class="ident" id="4765255"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4765262">.</span><span class="ident" id="4765263">Value</span><span class="op" id="4765268">,</span>&nbsp;<span class="ident" id="4765270">_</span>&nbsp;<span class="builtintype" id="4765272">bool</span><span class="op" id="4765276">)</span>&nbsp;<span class="op" id="4765278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765281">if</span>&nbsp;<span class="ident" id="4765284"><a href="/encoding/json/encode.go.html#4765253">v</a></span><span class="op" id="4765285">.</span><span class="ident" id="4765286">IsNil</span><span class="op" id="4765291">(</span><span class="op" id="4765292">)</span>&nbsp;<span class="op" id="4765294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765298"><a href="/encoding/json/encode.go.html#4765237">e</a></span><span class="op" id="4765299">.</span><span class="ident" id="4765300">WriteString</span><span class="op" id="4765311">(</span><span class="string" id="4765312">&#34;null&#34;</span><span class="op" id="4765318">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765322">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4765330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765333">s</span>&nbsp;<span class="op" id="4765335">:=</span>&nbsp;<span class="ident" id="4765338"><a href="/encoding/json/encode.go.html#4765253">v</a></span><span class="op" id="4765339">.</span><span class="ident" id="4765340">Bytes</span><span class="op" id="4765345">(</span><span class="op" id="4765346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765349"><a href="/encoding/json/encode.go.html#4765237">e</a></span><span class="op" id="4765350">.</span><span class="ident" id="4765351">WriteByte</span><span class="op" id="4765360">(</span><span class="string" id="4765361">&#39;&#34;&#39;</span><span class="op" id="4765364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765367">if</span>&nbsp;<span class="builtinfunc" id="4765370">len</span><span class="op" id="4765373">(</span><span class="ident" id="4765374"><a href="/encoding/json/encode.go.html#4765333">s</a></span><span class="op" id="4765375">)</span>&nbsp;<span class="op" id="4765377">&lt;</span>&nbsp;<span class="num" id="4765379">1024</span>&nbsp;<span class="op" id="4765384">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4765388">//&nbsp;for&nbsp;small&nbsp;buffers,&nbsp;using&nbsp;Encode&nbsp;directly&nbsp;is&nbsp;much&nbsp;faster.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765450">dst</span>&nbsp;<span class="op" id="4765454">:=</span>&nbsp;<span class="builtinfunc" id="4765457">make</span><span class="op" id="4765461">(</span><span class="op" id="4765462">[</span><span class="op" id="4765463">]</span><span class="builtintype" id="4765464">byte</span><span class="op" id="4765468">,</span>&nbsp;<span class="ident" id="4765470"><a href="/encoding/json/encode.go.html#4748640">base64</a></span><span class="op" id="4765476">.</span><span class="ident" id="4765477">StdEncoding</span><span class="op" id="4765488">.</span><span class="ident" id="4765489">EncodedLen</span><span class="op" id="4765499">(</span><span class="builtinfunc" id="4765500">len</span><span class="op" id="4765503">(</span><span class="ident" id="4765504"><a href="/encoding/json/encode.go.html#4765333">s</a></span><span class="op" id="4765505">)</span><span class="op" id="4765506">)</span><span class="op" id="4765507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765511"><a href="/encoding/json/encode.go.html#4748640">base64</a></span><span class="op" id="4765517">.</span><span class="ident" id="4765518">StdEncoding</span><span class="op" id="4765529">.</span><span class="ident" id="4765530">Encode</span><span class="op" id="4765536">(</span><span class="ident" id="4765537"><a href="/encoding/json/encode.go.html#4765450">dst</a></span><span class="op" id="4765540">,</span>&nbsp;<span class="ident" id="4765542"><a href="/encoding/json/encode.go.html#4765333">s</a></span><span class="op" id="4765543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765547"><a href="/encoding/json/encode.go.html#4765237">e</a></span><span class="op" id="4765548">.</span><span class="ident" id="4765549">Write</span><span class="op" id="4765554">(</span><span class="ident" id="4765555"><a href="/encoding/json/encode.go.html#4765450">dst</a></span><span class="op" id="4765558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4765561">}</span>&nbsp;<span class="keyword" id="4765563">else</span>&nbsp;<span class="op" id="4765568">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4765572">//&nbsp;for&nbsp;large&nbsp;buffers,&nbsp;avoid&nbsp;unnecessary&nbsp;extra&nbsp;temporary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4765630">//&nbsp;buffer&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765649">enc</span>&nbsp;<span class="op" id="4765653">:=</span>&nbsp;<span class="ident" id="4765656"><a href="/encoding/json/encode.go.html#4748640">base64</a></span><span class="op" id="4765662">.</span><span class="ident" id="4765663">NewEncoder</span><span class="op" id="4765673">(</span><span class="ident" id="4765674"><a href="/encoding/json/encode.go.html#4748640">base64</a></span><span class="op" id="4765680">.</span><span class="ident" id="4765681">StdEncoding</span><span class="op" id="4765692">,</span>&nbsp;<span class="ident" id="4765694"><a href="/encoding/json/encode.go.html#4765237">e</a></span><span class="op" id="4765695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765699"><a href="/encoding/json/encode.go.html#4765649">enc</a></span><span class="op" id="4765702">.</span><span class="ident" id="4765703">Write</span><span class="op" id="4765708">(</span><span class="ident" id="4765709"><a href="/encoding/json/encode.go.html#4765333">s</a></span><span class="op" id="4765710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765714"><a href="/encoding/json/encode.go.html#4765649">enc</a></span><span class="op" id="4765717">.</span><span class="ident" id="4765718">Close</span><span class="op" id="4765723">(</span><span class="op" id="4765724">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4765727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765730"><a href="/encoding/json/encode.go.html#4765237">e</a></span><span class="op" id="4765731">.</span><span class="ident" id="4765732">WriteByte</span><span class="op" id="4765741">(</span><span class="string" id="4765742">&#39;&#34;&#39;</span><span class="op" id="4765745">)</span><br>
<span class="lineno"></span><span class="op" id="4765747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4765750">//&nbsp;sliceEncoder&nbsp;just&nbsp;wraps&nbsp;an&nbsp;arrayEncoder,&nbsp;checking&nbsp;to&nbsp;make&nbsp;sure&nbsp;the&nbsp;value&nbsp;isn&#39;t&nbsp;nil.</span><br>
<span class="lineno">655</span><span class="keyword" id="4765837">type</span>&nbsp;<span class="ident" id="4765842">sliceEncoder</span>&nbsp;<span class="keyword" id="4765855">struct</span>&nbsp;<span class="op" id="4765862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765865">arrayEnc</span>&nbsp;<span class="ident" id="4765874"><a href="/encoding/json/encode.go.html#4757853">encoderFunc</a></span><br>
<span class="lineno"></span><span class="op" id="4765886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4765889">func</span>&nbsp;<span class="op" id="4765894">(</span><span class="ident" id="4765895">se</span>&nbsp;<span class="op" id="4765898">*</span><span class="ident" id="4765899"><a href="/encoding/json/encode.go.html#4765842">sliceEncoder</a></span><span class="op" id="4765911">)</span>&nbsp;<span class="ident" id="4765913">encode</span><span class="op" id="4765919">(</span><span class="ident" id="4765920">e</span>&nbsp;<span class="op" id="4765922">*</span><span class="ident" id="4765923"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4765934">,</span>&nbsp;<span class="ident" id="4765936">v</span>&nbsp;<span class="ident" id="4765938"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4765945">.</span><span class="ident" id="4765946">Value</span><span class="op" id="4765951">,</span>&nbsp;<span class="ident" id="4765953">_</span>&nbsp;<span class="builtintype" id="4765955">bool</span><span class="op" id="4765959">)</span>&nbsp;<span class="op" id="4765961">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4765964">if</span>&nbsp;<span class="ident" id="4765967"><a href="/encoding/json/encode.go.html#4765936">v</a></span><span class="op" id="4765968">.</span><span class="ident" id="4765969">IsNil</span><span class="op" id="4765974">(</span><span class="op" id="4765975">)</span>&nbsp;<span class="op" id="4765977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4765981"><a href="/encoding/json/encode.go.html#4765920">e</a></span><span class="op" id="4765982">.</span><span class="ident" id="4765983">WriteString</span><span class="op" id="4765994">(</span><span class="string" id="4765995">&#34;null&#34;</span><span class="op" id="4766001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766005">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4766013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766016"><a href="/encoding/json/encode.go.html#4765895">se</a></span><span class="op" id="4766018">.</span><span class="ident" id="4766019">arrayEnc</span><span class="op" id="4766027">(</span><span class="ident" id="4766028"><a href="/encoding/json/encode.go.html#4765920">e</a></span><span class="op" id="4766029">,</span>&nbsp;<span class="ident" id="4766031"><a href="/encoding/json/encode.go.html#4765936">v</a></span><span class="op" id="4766032">,</span>&nbsp;<span class="builtintype" id="4766034">false</span><span class="op" id="4766039">)</span><br>
<span class="lineno">665</span><span class="op" id="4766041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4766044">func</span>&nbsp;<span class="ident" id="4766049">newSliceEncoder</span><span class="op" id="4766064">(</span><span class="ident" id="4766065">t</span>&nbsp;<span class="ident" id="4766067"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4766074">.</span><span class="ident" id="4766075">Type</span><span class="op" id="4766079">)</span>&nbsp;<span class="ident" id="4766081"><a href="/encoding/json/encode.go.html#4757853">encoderFunc</a></span>&nbsp;<span class="op" id="4766093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4766096">//&nbsp;Byte&nbsp;slices&nbsp;get&nbsp;special&nbsp;treatment;&nbsp;arrays&nbsp;don&#39;t.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766149">if</span>&nbsp;<span class="ident" id="4766152"><a href="/encoding/json/encode.go.html#4766065">t</a></span><span class="op" id="4766153">.</span><span class="ident" id="4766154">Elem</span><span class="op" id="4766158">(</span><span class="op" id="4766159">)</span><span class="op" id="4766160">.</span><span class="ident" id="4766161">Kind</span><span class="op" id="4766165">(</span><span class="op" id="4766166">)</span>&nbsp;<span class="op" id="4766168">==</span>&nbsp;<span class="ident" id="4766171"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4766178">.</span><span class="ident" id="4766179">Uint8</span>&nbsp;<span class="op" id="4766185">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766189">return</span>&nbsp;<span class="ident" id="4766196"><a href="/encoding/json/encode.go.html#4765221">encodeByteSlice</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4766213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766216">enc</span>&nbsp;<span class="op" id="4766220">:=</span>&nbsp;<span class="op" id="4766223">&amp;</span><span class="ident" id="4766224"><a href="/encoding/json/encode.go.html#4765842">sliceEncoder</a></span><span class="op" id="4766236">{</span><span class="ident" id="4766237"><a href="/encoding/json/encode.go.html#4766563">newArrayEncoder</a></span><span class="op" id="4766252">(</span><span class="ident" id="4766253"><a href="/encoding/json/encode.go.html#4766065">t</a></span><span class="op" id="4766254">)</span><span class="op" id="4766255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766258">return</span>&nbsp;<span class="ident" id="4766265"><a href="/encoding/json/encode.go.html#4766216">enc</a></span><span class="op" id="4766268">.</span><span class="ident" id="4766269">encode</span><br>
<span class="lineno"></span><span class="op" id="4766276">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span><span class="keyword" id="4766279">type</span>&nbsp;<span class="ident" id="4766284">arrayEncoder</span>&nbsp;<span class="keyword" id="4766297">struct</span>&nbsp;<span class="op" id="4766304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766307">elemEnc</span>&nbsp;<span class="ident" id="4766315"><a href="/encoding/json/encode.go.html#4757853">encoderFunc</a></span><br>
<span class="lineno"></span><span class="op" id="4766327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">680</span><span class="keyword" id="4766330">func</span>&nbsp;<span class="op" id="4766335">(</span><span class="ident" id="4766336">ae</span>&nbsp;<span class="op" id="4766339">*</span><span class="ident" id="4766340"><a href="/encoding/json/encode.go.html#4766284">arrayEncoder</a></span><span class="op" id="4766352">)</span>&nbsp;<span class="ident" id="4766354">encode</span><span class="op" id="4766360">(</span><span class="ident" id="4766361">e</span>&nbsp;<span class="op" id="4766363">*</span><span class="ident" id="4766364"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4766375">,</span>&nbsp;<span class="ident" id="4766377">v</span>&nbsp;<span class="ident" id="4766379"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4766386">.</span><span class="ident" id="4766387">Value</span><span class="op" id="4766392">,</span>&nbsp;<span class="ident" id="4766394">_</span>&nbsp;<span class="builtintype" id="4766396">bool</span><span class="op" id="4766400">)</span>&nbsp;<span class="op" id="4766402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766405"><a href="/encoding/json/encode.go.html#4766361">e</a></span><span class="op" id="4766406">.</span><span class="ident" id="4766407">WriteByte</span><span class="op" id="4766416">(</span><span class="string" id="4766417">&#39;[&#39;</span><span class="op" id="4766420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766423">n</span>&nbsp;<span class="op" id="4766425">:=</span>&nbsp;<span class="ident" id="4766428"><a href="/encoding/json/encode.go.html#4766377">v</a></span><span class="op" id="4766429">.</span><span class="ident" id="4766430">Len</span><span class="op" id="4766433">(</span><span class="op" id="4766434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766437">for</span>&nbsp;<span class="ident" id="4766441">i</span>&nbsp;<span class="op" id="4766443">:=</span>&nbsp;<span class="num" id="4766446">0</span><span class="op" id="4766447">;</span>&nbsp;<span class="ident" id="4766449"><a href="/encoding/json/encode.go.html#4766441">i</a></span>&nbsp;<span class="op" id="4766451">&lt;</span>&nbsp;<span class="ident" id="4766453"><a href="/encoding/json/encode.go.html#4766423">n</a></span><span class="op" id="4766454">;</span>&nbsp;<span class="ident" id="4766456"><a href="/encoding/json/encode.go.html#4766441">i</a></span><span class="op" id="4766457">++</span>&nbsp;<span class="op" id="4766460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766464">if</span>&nbsp;<span class="ident" id="4766467"><a href="/encoding/json/encode.go.html#4766441">i</a></span>&nbsp;<span class="op" id="4766469">&gt;</span>&nbsp;<span class="num" id="4766471">0</span>&nbsp;<span class="op" id="4766473">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766478"><a href="/encoding/json/encode.go.html#4766361">e</a></span><span class="op" id="4766479">.</span><span class="ident" id="4766480">WriteByte</span><span class="op" id="4766489">(</span><span class="string" id="4766490">&#39;,&#39;</span><span class="op" id="4766493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4766497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766501"><a href="/encoding/json/encode.go.html#4766336">ae</a></span><span class="op" id="4766503">.</span><span class="ident" id="4766504">elemEnc</span><span class="op" id="4766511">(</span><span class="ident" id="4766512"><a href="/encoding/json/encode.go.html#4766361">e</a></span><span class="op" id="4766513">,</span>&nbsp;<span class="ident" id="4766515"><a href="/encoding/json/encode.go.html#4766377">v</a></span><span class="op" id="4766516">.</span><span class="ident" id="4766517">Index</span><span class="op" id="4766522">(</span><span class="ident" id="4766523"><a href="/encoding/json/encode.go.html#4766441">i</a></span><span class="op" id="4766524">)</span><span class="op" id="4766525">,</span>&nbsp;<span class="builtintype" id="4766527">false</span><span class="op" id="4766532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4766535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766538"><a href="/encoding/json/encode.go.html#4766361">e</a></span><span class="op" id="4766539">.</span><span class="ident" id="4766540">WriteByte</span><span class="op" id="4766549">(</span><span class="string" id="4766550">&#39;]&#39;</span><span class="op" id="4766553">)</span><br>
<span class="lineno">690</span><span class="op" id="4766555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4766558">func</span>&nbsp;<span class="ident" id="4766563">newArrayEncoder</span><span class="op" id="4766578">(</span><span class="ident" id="4766579">t</span>&nbsp;<span class="ident" id="4766581"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4766588">.</span><span class="ident" id="4766589">Type</span><span class="op" id="4766593">)</span>&nbsp;<span class="ident" id="4766595"><a href="/encoding/json/encode.go.html#4757853">encoderFunc</a></span>&nbsp;<span class="op" id="4766607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766610">enc</span>&nbsp;<span class="op" id="4766614">:=</span>&nbsp;<span class="op" id="4766617">&amp;</span><span class="ident" id="4766618"><a href="/encoding/json/encode.go.html#4766284">arrayEncoder</a></span><span class="op" id="4766630">{</span><span class="ident" id="4766631"><a href="/encoding/json/encode.go.html#4758130">typeEncoder</a></span><span class="op" id="4766642">(</span><span class="ident" id="4766643"><a href="/encoding/json/encode.go.html#4766579">t</a></span><span class="op" id="4766644">.</span><span class="ident" id="4766645">Elem</span><span class="op" id="4766649">(</span><span class="op" id="4766650">)</span><span class="op" id="4766651">)</span><span class="op" id="4766652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766655">return</span>&nbsp;<span class="ident" id="4766662"><a href="/encoding/json/encode.go.html#4766610">enc</a></span><span class="op" id="4766665">.</span><span class="ident" id="4766666">encode</span><br>
<span class="lineno">695</span><span class="op" id="4766673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4766676">type</span>&nbsp;<span class="ident" id="4766681">ptrEncoder</span>&nbsp;<span class="keyword" id="4766692">struct</span>&nbsp;<span class="op" id="4766699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766702">elemEnc</span>&nbsp;<span class="ident" id="4766710"><a href="/encoding/json/encode.go.html#4757853">encoderFunc</a></span><br>
<span class="lineno"></span><span class="op" id="4766722">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span><span class="keyword" id="4766725">func</span>&nbsp;<span class="op" id="4766730">(</span><span class="ident" id="4766731">pe</span>&nbsp;<span class="op" id="4766734">*</span><span class="ident" id="4766735"><a href="/encoding/json/encode.go.html#4766681">ptrEncoder</a></span><span class="op" id="4766745">)</span>&nbsp;<span class="ident" id="4766747">encode</span><span class="op" id="4766753">(</span><span class="ident" id="4766754">e</span>&nbsp;<span class="op" id="4766756">*</span><span class="ident" id="4766757"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4766768">,</span>&nbsp;<span class="ident" id="4766770">v</span>&nbsp;<span class="ident" id="4766772"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4766779">.</span><span class="ident" id="4766780">Value</span><span class="op" id="4766785">,</span>&nbsp;<span class="ident" id="4766787">quoted</span>&nbsp;<span class="builtintype" id="4766794">bool</span><span class="op" id="4766798">)</span>&nbsp;<span class="op" id="4766800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766803">if</span>&nbsp;<span class="ident" id="4766806"><a href="/encoding/json/encode.go.html#4766770">v</a></span><span class="op" id="4766807">.</span><span class="ident" id="4766808">IsNil</span><span class="op" id="4766813">(</span><span class="op" id="4766814">)</span>&nbsp;<span class="op" id="4766816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766820"><a href="/encoding/json/encode.go.html#4766754">e</a></span><span class="op" id="4766821">.</span><span class="ident" id="4766822">WriteString</span><span class="op" id="4766833">(</span><span class="string" id="4766834">&#34;null&#34;</span><span class="op" id="4766840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766844">return</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4766852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766855"><a href="/encoding/json/encode.go.html#4766731">pe</a></span><span class="op" id="4766857">.</span><span class="ident" id="4766858">elemEnc</span><span class="op" id="4766865">(</span><span class="ident" id="4766866"><a href="/encoding/json/encode.go.html#4766754">e</a></span><span class="op" id="4766867">,</span>&nbsp;<span class="ident" id="4766869"><a href="/encoding/json/encode.go.html#4766770">v</a></span><span class="op" id="4766870">.</span><span class="ident" id="4766871">Elem</span><span class="op" id="4766875">(</span><span class="op" id="4766876">)</span><span class="op" id="4766877">,</span>&nbsp;<span class="ident" id="4766879"><a href="/encoding/json/encode.go.html#4766787">quoted</a></span><span class="op" id="4766885">)</span><br>
<span class="lineno"></span><span class="op" id="4766887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4766890">func</span>&nbsp;<span class="ident" id="4766895">newPtrEncoder</span><span class="op" id="4766908">(</span><span class="ident" id="4766909">t</span>&nbsp;<span class="ident" id="4766911"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4766918">.</span><span class="ident" id="4766919">Type</span><span class="op" id="4766923">)</span>&nbsp;<span class="ident" id="4766925"><a href="/encoding/json/encode.go.html#4757853">encoderFunc</a></span>&nbsp;<span class="op" id="4766937">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4766940">enc</span>&nbsp;<span class="op" id="4766944">:=</span>&nbsp;<span class="op" id="4766947">&amp;</span><span class="ident" id="4766948"><a href="/encoding/json/encode.go.html#4766681">ptrEncoder</a></span><span class="op" id="4766958">{</span><span class="ident" id="4766959"><a href="/encoding/json/encode.go.html#4758130">typeEncoder</a></span><span class="op" id="4766970">(</span><span class="ident" id="4766971"><a href="/encoding/json/encode.go.html#4766909">t</a></span><span class="op" id="4766972">.</span><span class="ident" id="4766973">Elem</span><span class="op" id="4766977">(</span><span class="op" id="4766978">)</span><span class="op" id="4766979">)</span><span class="op" id="4766980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4766983">return</span>&nbsp;<span class="ident" id="4766990"><a href="/encoding/json/encode.go.html#4766940">enc</a></span><span class="op" id="4766993">.</span><span class="ident" id="4766994">encode</span><br>
<span class="lineno"></span><span class="op" id="4767001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4767004">type</span>&nbsp;<span class="ident" id="4767009">condAddrEncoder</span>&nbsp;<span class="keyword" id="4767025">struct</span>&nbsp;<span class="op" id="4767032">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4767035">canAddrEnc</span><span class="op" id="4767045">,</span>&nbsp;<span class="ident" id="4767047">elseEnc</span>&nbsp;<span class="ident" id="4767055"><a href="/encoding/json/encode.go.html#4757853">encoderFunc</a></span><br>
<span class="lineno"></span><span class="op" id="4767067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4767070">func</span>&nbsp;<span class="op" id="4767075">(</span><span class="ident" id="4767076">ce</span>&nbsp;<span class="op" id="4767079">*</span><span class="ident" id="4767080"><a href="/encoding/json/encode.go.html#4767009">condAddrEncoder</a></span><span class="op" id="4767095">)</span>&nbsp;<span class="ident" id="4767097">encode</span><span class="op" id="4767103">(</span><span class="ident" id="4767104">e</span>&nbsp;<span class="op" id="4767106">*</span><span class="ident" id="4767107"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4767118">,</span>&nbsp;<span class="ident" id="4767120">v</span>&nbsp;<span class="ident" id="4767122"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4767129">.</span><span class="ident" id="4767130">Value</span><span class="op" id="4767135">,</span>&nbsp;<span class="ident" id="4767137">quoted</span>&nbsp;<span class="builtintype" id="4767144">bool</span><span class="op" id="4767148">)</span>&nbsp;<span class="op" id="4767150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767153">if</span>&nbsp;<span class="ident" id="4767156"><a href="/encoding/json/encode.go.html#4767120">v</a></span><span class="op" id="4767157">.</span><span class="ident" id="4767158">CanAddr</span><span class="op" id="4767165">(</span><span class="op" id="4767166">)</span>&nbsp;<span class="op" id="4767168">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4767172"><a href="/encoding/json/encode.go.html#4767076">ce</a></span><span class="op" id="4767174">.</span><span class="ident" id="4767175">canAddrEnc</span><span class="op" id="4767185">(</span><span class="ident" id="4767186"><a href="/encoding/json/encode.go.html#4767104">e</a></span><span class="op" id="4767187">,</span>&nbsp;<span class="ident" id="4767189"><a href="/encoding/json/encode.go.html#4767120">v</a></span><span class="op" id="4767190">,</span>&nbsp;<span class="ident" id="4767192"><a href="/encoding/json/encode.go.html#4767137">quoted</a></span><span class="op" id="4767198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4767201">}</span>&nbsp;<span class="keyword" id="4767203">else</span>&nbsp;<span class="op" id="4767208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4767212"><a href="/encoding/json/encode.go.html#4767076">ce</a></span><span class="op" id="4767214">.</span><span class="ident" id="4767215">elseEnc</span><span class="op" id="4767222">(</span><span class="ident" id="4767223"><a href="/encoding/json/encode.go.html#4767104">e</a></span><span class="op" id="4767224">,</span>&nbsp;<span class="ident" id="4767226"><a href="/encoding/json/encode.go.html#4767120">v</a></span><span class="op" id="4767227">,</span>&nbsp;<span class="ident" id="4767229"><a href="/encoding/json/encode.go.html#4767137">quoted</a></span><span class="op" id="4767235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4767238">}</span><br>
<span class="lineno"></span><span class="op" id="4767240">}</span><br>
<span class="lineno">725</span><br>
<span class="lineno"></span><span class="comment" id="4767243">//&nbsp;newCondAddrEncoder&nbsp;returns&nbsp;an&nbsp;encoder&nbsp;that&nbsp;checks&nbsp;whether&nbsp;its&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="4767314">//&nbsp;CanAddr&nbsp;and&nbsp;delegates&nbsp;to&nbsp;canAddrEnc&nbsp;if&nbsp;so,&nbsp;else&nbsp;to&nbsp;elseEnc.</span><br>
<span class="lineno"></span><span class="keyword" id="4767377">func</span>&nbsp;<span class="ident" id="4767382">newCondAddrEncoder</span><span class="op" id="4767400">(</span><span class="ident" id="4767401">canAddrEnc</span><span class="op" id="4767411">,</span>&nbsp;<span class="ident" id="4767413">elseEnc</span>&nbsp;<span class="ident" id="4767421"><a href="/encoding/json/encode.go.html#4757853">encoderFunc</a></span><span class="op" id="4767432">)</span>&nbsp;<span class="ident" id="4767434"><a href="/encoding/json/encode.go.html#4757853">encoderFunc</a></span>&nbsp;<span class="op" id="4767446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4767449">enc</span>&nbsp;<span class="op" id="4767453">:=</span>&nbsp;<span class="op" id="4767456">&amp;</span><span class="ident" id="4767457"><a href="/encoding/json/encode.go.html#4767009">condAddrEncoder</a></span><span class="op" id="4767472">{</span><span class="ident" id="4767473">canAddrEnc</span><span class="op" id="4767483">:</span>&nbsp;<span class="ident" id="4767485"><a href="/encoding/json/encode.go.html#4767401">canAddrEnc</a></span><span class="op" id="4767495">,</span>&nbsp;<span class="ident" id="4767497">elseEnc</span><span class="op" id="4767504">:</span>&nbsp;<span class="ident" id="4767506"><a href="/encoding/json/encode.go.html#4767413">elseEnc</a></span><span class="op" id="4767513">}</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767516">return</span>&nbsp;<span class="ident" id="4767523"><a href="/encoding/json/encode.go.html#4767449">enc</a></span><span class="op" id="4767526">.</span><span class="ident" id="4767527">encode</span><br>
<span class="lineno"></span><span class="op" id="4767534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4767537">func</span>&nbsp;<span class="ident" id="4767542">isValidTag</span><span class="op" id="4767552">(</span><span class="ident" id="4767553">s</span>&nbsp;<span class="builtintype" id="4767555">string</span><span class="op" id="4767561">)</span>&nbsp;<span class="builtintype" id="4767563">bool</span>&nbsp;<span class="op" id="4767568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767571">if</span>&nbsp;<span class="ident" id="4767574"><a href="/encoding/json/encode.go.html#4767553">s</a></span>&nbsp;<span class="op" id="4767576">==</span>&nbsp;<span class="string" id="4767579">&#34;&#34;</span>&nbsp;<span class="op" id="4767582">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767586">return</span>&nbsp;<span class="builtintype" id="4767593">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4767600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767603">for</span>&nbsp;<span class="ident" id="4767607">_</span><span class="op" id="4767608">,</span>&nbsp;<span class="ident" id="4767610">c</span>&nbsp;<span class="op" id="4767612">:=</span>&nbsp;<span class="keyword" id="4767615">range</span>&nbsp;<span class="ident" id="4767621"><a href="/encoding/json/encode.go.html#4767553">s</a></span>&nbsp;<span class="op" id="4767623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767627">switch</span>&nbsp;<span class="op" id="4767634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767638">case</span>&nbsp;<span class="ident" id="4767643"><a href="/encoding/json/encode.go.html#4748708">strings</a></span><span class="op" id="4767650">.</span><span class="ident" id="4767651">ContainsRune</span><span class="op" id="4767663">(</span><span class="string" id="4767664">&#34;!#$%&amp;()*+-./:&lt;=&gt;?@[]^_{|}~&nbsp;&#34;</span><span class="op" id="4767693">,</span>&nbsp;<span class="ident" id="4767695"><a href="/encoding/json/encode.go.html#4767610">c</a></span><span class="op" id="4767696">)</span><span class="op" id="4767697">:</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4767702">//&nbsp;Backslash&nbsp;and&nbsp;quote&nbsp;chars&nbsp;are&nbsp;reserved,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4767752">//&nbsp;otherwise&nbsp;any&nbsp;punctuation&nbsp;chars&nbsp;are&nbsp;allowed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4767802">//&nbsp;in&nbsp;a&nbsp;tag&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767822">default</span><span class="op" id="4767829">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767834">if</span>&nbsp;<span class="op" id="4767837">!</span><span class="ident" id="4767838"><a href="/encoding/json/encode.go.html#4748727">unicode</a></span><span class="op" id="4767845">.</span><span class="ident" id="4767846">IsLetter</span><span class="op" id="4767854">(</span><span class="ident" id="4767855"><a href="/encoding/json/encode.go.html#4767610">c</a></span><span class="op" id="4767856">)</span>&nbsp;<span class="op" id="4767858">&amp;&amp;</span>&nbsp;<span class="op" id="4767861">!</span><span class="ident" id="4767862"><a href="/encoding/json/encode.go.html#4748727">unicode</a></span><span class="op" id="4767869">.</span><span class="ident" id="4767870">IsDigit</span><span class="op" id="4767877">(</span><span class="ident" id="4767878"><a href="/encoding/json/encode.go.html#4767610">c</a></span><span class="op" id="4767879">)</span>&nbsp;<span class="op" id="4767881">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767887">return</span>&nbsp;<span class="builtintype" id="4767894">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4767903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4767907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4767910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767913">return</span>&nbsp;<span class="builtintype" id="4767920">true</span><br>
<span class="lineno">750</span><span class="op" id="4767925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4767928">func</span>&nbsp;<span class="ident" id="4767933">fieldByIndex</span><span class="op" id="4767945">(</span><span class="ident" id="4767946">v</span>&nbsp;<span class="ident" id="4767948"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4767955">.</span><span class="ident" id="4767956">Value</span><span class="op" id="4767961">,</span>&nbsp;<span class="ident" id="4767963">index</span>&nbsp;<span class="op" id="4767969">[</span><span class="op" id="4767970">]</span><span class="builtintype" id="4767971">int</span><span class="op" id="4767974">)</span>&nbsp;<span class="ident" id="4767976"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4767983">.</span><span class="ident" id="4767984">Value</span>&nbsp;<span class="op" id="4767990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4767993">for</span>&nbsp;<span class="ident" id="4767997">_</span><span class="op" id="4767998">,</span>&nbsp;<span class="ident" id="4768000">i</span>&nbsp;<span class="op" id="4768002">:=</span>&nbsp;<span class="keyword" id="4768005">range</span>&nbsp;<span class="ident" id="4768011"><a href="/encoding/json/encode.go.html#4767963">index</a></span>&nbsp;<span class="op" id="4768017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768021">if</span>&nbsp;<span class="ident" id="4768024"><a href="/encoding/json/encode.go.html#4767946">v</a></span><span class="op" id="4768025">.</span><span class="ident" id="4768026">Kind</span><span class="op" id="4768030">(</span><span class="op" id="4768031">)</span>&nbsp;<span class="op" id="4768033">==</span>&nbsp;<span class="ident" id="4768036"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4768043">.</span><span class="ident" id="4768044">Ptr</span>&nbsp;<span class="op" id="4768048">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768053">if</span>&nbsp;<span class="ident" id="4768056"><a href="/encoding/json/encode.go.html#4767946">v</a></span><span class="op" id="4768057">.</span><span class="ident" id="4768058">IsNil</span><span class="op" id="4768063">(</span><span class="op" id="4768064">)</span>&nbsp;<span class="op" id="4768066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768072">return</span>&nbsp;<span class="ident" id="4768079"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4768086">.</span><span class="ident" id="4768087">Value</span><span class="op" id="4768092">{</span><span class="op" id="4768093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4768098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768103"><a href="/encoding/json/encode.go.html#4767946">v</a></span>&nbsp;<span class="op" id="4768105">=</span>&nbsp;<span class="ident" id="4768107"><a href="/encoding/json/encode.go.html#4767946">v</a></span><span class="op" id="4768108">.</span><span class="ident" id="4768109">Elem</span><span class="op" id="4768113">(</span><span class="op" id="4768114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4768118">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768122"><a href="/encoding/json/encode.go.html#4767946">v</a></span>&nbsp;<span class="op" id="4768124">=</span>&nbsp;<span class="ident" id="4768126"><a href="/encoding/json/encode.go.html#4767946">v</a></span><span class="op" id="4768127">.</span><span class="ident" id="4768128">Field</span><span class="op" id="4768133">(</span><span class="ident" id="4768134"><a href="/encoding/json/encode.go.html#4768000">i</a></span><span class="op" id="4768135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4768138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768141">return</span>&nbsp;<span class="ident" id="4768148"><a href="/encoding/json/encode.go.html#4767946">v</a></span><br>
<span class="lineno"></span><span class="op" id="4768150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span><span class="keyword" id="4768153">func</span>&nbsp;<span class="ident" id="4768158">typeByIndex</span><span class="op" id="4768169">(</span><span class="ident" id="4768170">t</span>&nbsp;<span class="ident" id="4768172"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4768179">.</span><span class="ident" id="4768180">Type</span><span class="op" id="4768184">,</span>&nbsp;<span class="ident" id="4768186">index</span>&nbsp;<span class="op" id="4768192">[</span><span class="op" id="4768193">]</span><span class="builtintype" id="4768194">int</span><span class="op" id="4768197">)</span>&nbsp;<span class="ident" id="4768199"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4768206">.</span><span class="ident" id="4768207">Type</span>&nbsp;<span class="op" id="4768212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768215">for</span>&nbsp;<span class="ident" id="4768219">_</span><span class="op" id="4768220">,</span>&nbsp;<span class="ident" id="4768222">i</span>&nbsp;<span class="op" id="4768224">:=</span>&nbsp;<span class="keyword" id="4768227">range</span>&nbsp;<span class="ident" id="4768233"><a href="/encoding/json/encode.go.html#4768186">index</a></span>&nbsp;<span class="op" id="4768239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768243">if</span>&nbsp;<span class="ident" id="4768246"><a href="/encoding/json/encode.go.html#4768170">t</a></span><span class="op" id="4768247">.</span><span class="ident" id="4768248">Kind</span><span class="op" id="4768252">(</span><span class="op" id="4768253">)</span>&nbsp;<span class="op" id="4768255">==</span>&nbsp;<span class="ident" id="4768258"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4768265">.</span><span class="ident" id="4768266">Ptr</span>&nbsp;<span class="op" id="4768270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768275"><a href="/encoding/json/encode.go.html#4768170">t</a></span>&nbsp;<span class="op" id="4768277">=</span>&nbsp;<span class="ident" id="4768279"><a href="/encoding/json/encode.go.html#4768170">t</a></span><span class="op" id="4768280">.</span><span class="ident" id="4768281">Elem</span><span class="op" id="4768285">(</span><span class="op" id="4768286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4768290">}</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768294"><a href="/encoding/json/encode.go.html#4768170">t</a></span>&nbsp;<span class="op" id="4768296">=</span>&nbsp;<span class="ident" id="4768298"><a href="/encoding/json/encode.go.html#4768170">t</a></span><span class="op" id="4768299">.</span><span class="ident" id="4768300">Field</span><span class="op" id="4768305">(</span><span class="ident" id="4768306"><a href="/encoding/json/encode.go.html#4768222">i</a></span><span class="op" id="4768307">)</span><span class="op" id="4768308">.</span><span class="ident" id="4768309">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4768315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768318">return</span>&nbsp;<span class="ident" id="4768325"><a href="/encoding/json/encode.go.html#4768170">t</a></span><br>
<span class="lineno"></span><span class="op" id="4768327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">775</span><span class="comment" id="4768330">//&nbsp;stringValues&nbsp;is&nbsp;a&nbsp;slice&nbsp;of&nbsp;reflect.Value&nbsp;holding&nbsp;*reflect.StringValue.</span><br>
<span class="lineno"></span><span class="comment" id="4768404">//&nbsp;It&nbsp;implements&nbsp;the&nbsp;methods&nbsp;to&nbsp;sort&nbsp;by&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4768452">type</span>&nbsp;<span class="ident" id="4768457">stringValues</span>&nbsp;<span class="op" id="4768470">[</span><span class="op" id="4768471">]</span><span class="ident" id="4768472"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4768479">.</span><span class="ident" id="4768480">Value</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4768487">func</span>&nbsp;<span class="op" id="4768492">(</span><span class="ident" id="4768493">sv</span>&nbsp;<span class="ident" id="4768496"><a href="/encoding/json/encode.go.html#4768457">stringValues</a></span><span class="op" id="4768508">)</span>&nbsp;<span class="ident" id="4768510">Len</span><span class="op" id="4768513">(</span><span class="op" id="4768514">)</span>&nbsp;<span class="builtintype" id="4768516">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768530">{</span>&nbsp;<span class="keyword" id="4768532">return</span>&nbsp;<span class="builtinfunc" id="4768539">len</span><span class="op" id="4768542">(</span><span class="ident" id="4768543"><a href="/encoding/json/encode.go.html#4768493">sv</a></span><span class="op" id="4768545">)</span>&nbsp;<span class="op" id="4768547">}</span><br>
<span class="lineno">780</span><span class="keyword" id="4768549">func</span>&nbsp;<span class="op" id="4768554">(</span><span class="ident" id="4768555">sv</span>&nbsp;<span class="ident" id="4768558"><a href="/encoding/json/encode.go.html#4768457">stringValues</a></span><span class="op" id="4768570">)</span>&nbsp;<span class="ident" id="4768572">Swap</span><span class="op" id="4768576">(</span><span class="ident" id="4768577">i</span><span class="op" id="4768578">,</span>&nbsp;<span class="ident" id="4768580">j</span>&nbsp;<span class="builtintype" id="4768582">int</span><span class="op" id="4768585">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768592">{</span>&nbsp;<span class="ident" id="4768594"><a href="/encoding/json/encode.go.html#4768555">sv</a></span><span class="op" id="4768596">[</span><span class="ident" id="4768597"><a href="/encoding/json/encode.go.html#4768577">i</a></span><span class="op" id="4768598">]</span><span class="op" id="4768599">,</span>&nbsp;<span class="ident" id="4768601"><a href="/encoding/json/encode.go.html#4768555">sv</a></span><span class="op" id="4768603">[</span><span class="ident" id="4768604"><a href="/encoding/json/encode.go.html#4768580">j</a></span><span class="op" id="4768605">]</span>&nbsp;<span class="op" id="4768607">=</span>&nbsp;<span class="ident" id="4768609"><a href="/encoding/json/encode.go.html#4768555">sv</a></span><span class="op" id="4768611">[</span><span class="ident" id="4768612"><a href="/encoding/json/encode.go.html#4768580">j</a></span><span class="op" id="4768613">]</span><span class="op" id="4768614">,</span>&nbsp;<span class="ident" id="4768616"><a href="/encoding/json/encode.go.html#4768555">sv</a></span><span class="op" id="4768618">[</span><span class="ident" id="4768619"><a href="/encoding/json/encode.go.html#4768577">i</a></span><span class="op" id="4768620">]</span>&nbsp;<span class="op" id="4768622">}</span><br>
<span class="lineno"></span><span class="keyword" id="4768624">func</span>&nbsp;<span class="op" id="4768629">(</span><span class="ident" id="4768630">sv</span>&nbsp;<span class="ident" id="4768633"><a href="/encoding/json/encode.go.html#4768457">stringValues</a></span><span class="op" id="4768645">)</span>&nbsp;<span class="ident" id="4768647">Less</span><span class="op" id="4768651">(</span><span class="ident" id="4768652">i</span><span class="op" id="4768653">,</span>&nbsp;<span class="ident" id="4768655">j</span>&nbsp;<span class="builtintype" id="4768657">int</span><span class="op" id="4768660">)</span>&nbsp;<span class="builtintype" id="4768662">bool</span>&nbsp;<span class="op" id="4768667">{</span>&nbsp;<span class="keyword" id="4768669">return</span>&nbsp;<span class="ident" id="4768676"><a href="/encoding/json/encode.go.html#4768630">sv</a></span><span class="op" id="4768678">.</span><span class="ident" id="4768679">get</span><span class="op" id="4768682">(</span><span class="ident" id="4768683"><a href="/encoding/json/encode.go.html#4768652">i</a></span><span class="op" id="4768684">)</span>&nbsp;<span class="op" id="4768686">&lt;</span>&nbsp;<span class="ident" id="4768688"><a href="/encoding/json/encode.go.html#4768630">sv</a></span><span class="op" id="4768690">.</span><span class="ident" id="4768691">get</span><span class="op" id="4768694">(</span><span class="ident" id="4768695"><a href="/encoding/json/encode.go.html#4768655">j</a></span><span class="op" id="4768696">)</span>&nbsp;<span class="op" id="4768698">}</span><br>
<span class="lineno"></span><span class="keyword" id="4768700">func</span>&nbsp;<span class="op" id="4768705">(</span><span class="ident" id="4768706">sv</span>&nbsp;<span class="ident" id="4768709"><a href="/encoding/json/encode.go.html#4768457">stringValues</a></span><span class="op" id="4768721">)</span>&nbsp;<span class="ident" id="4768723">get</span><span class="op" id="4768726">(</span><span class="ident" id="4768727">i</span>&nbsp;<span class="builtintype" id="4768729">int</span><span class="op" id="4768732">)</span>&nbsp;<span class="builtintype" id="4768734">string</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4768743">{</span>&nbsp;<span class="keyword" id="4768745">return</span>&nbsp;<span class="ident" id="4768752"><a href="/encoding/json/encode.go.html#4768706">sv</a></span><span class="op" id="4768754">[</span><span class="ident" id="4768755"><a href="/encoding/json/encode.go.html#4768727">i</a></span><span class="op" id="4768756">]</span><span class="op" id="4768757">.</span><span class="ident" id="4768758">String</span><span class="op" id="4768764">(</span><span class="op" id="4768765">)</span>&nbsp;<span class="op" id="4768767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4768770">//&nbsp;NOTE:&nbsp;keep&nbsp;in&nbsp;sync&nbsp;with&nbsp;stringBytes&nbsp;below.</span><br>
<span class="lineno">785</span><span class="keyword" id="4768816">func</span>&nbsp;<span class="op" id="4768821">(</span><span class="ident" id="4768822">e</span>&nbsp;<span class="op" id="4768824">*</span><span class="ident" id="4768825"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4768836">)</span>&nbsp;<span class="builtintype" id="4768838">string</span><span class="op" id="4768844">(</span><span class="ident" id="4768845">s</span>&nbsp;<span class="builtintype" id="4768847">string</span><span class="op" id="4768853">)</span>&nbsp;<span class="op" id="4768855">(</span><span class="builtintype" id="4768856">int</span><span class="op" id="4768859">,</span>&nbsp;<span class="builtintype" id="4768861">error</span><span class="op" id="4768866">)</span>&nbsp;<span class="op" id="4768868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768871">len0</span>&nbsp;<span class="op" id="4768876">:=</span>&nbsp;<span class="ident" id="4768879"><a href="/encoding/json/encode.go.html#4768822">e</a></span><span class="op" id="4768880">.</span><span class="ident" id="4768881">Len</span><span class="op" id="4768884">(</span><span class="op" id="4768885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768888"><a href="/encoding/json/encode.go.html#4768822">e</a></span><span class="op" id="4768889">.</span><span class="ident" id="4768890">WriteByte</span><span class="op" id="4768899">(</span><span class="string" id="4768900">&#39;&#34;&#39;</span><span class="op" id="4768903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4768906">start</span>&nbsp;<span class="op" id="4768912">:=</span>&nbsp;<span class="num" id="4768915">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768918">for</span>&nbsp;<span class="ident" id="4768922">i</span>&nbsp;<span class="op" id="4768924">:=</span>&nbsp;<span class="num" id="4768927">0</span><span class="op" id="4768928">;</span>&nbsp;<span class="ident" id="4768930"><a href="/encoding/json/encode.go.html#4768922">i</a></span>&nbsp;<span class="op" id="4768932">&lt;</span>&nbsp;<span class="builtinfunc" id="4768934">len</span><span class="op" id="4768937">(</span><span class="ident" id="4768938"><a href="/encoding/json/encode.go.html#4768845">s</a></span><span class="op" id="4768939">)</span><span class="op" id="4768940">;</span>&nbsp;<span class="op" id="4768942">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768946">if</span>&nbsp;<span class="ident" id="4768949">b</span>&nbsp;<span class="op" id="4768951">:=</span>&nbsp;<span class="ident" id="4768954"><a href="/encoding/json/encode.go.html#4768845">s</a></span><span class="op" id="4768955">[</span><span class="ident" id="4768956"><a href="/encoding/json/encode.go.html#4768922">i</a></span><span class="op" id="4768957">]</span><span class="op" id="4768958">;</span>&nbsp;<span class="ident" id="4768960"><a href="/encoding/json/encode.go.html#4768949">b</a></span>&nbsp;<span class="op" id="4768962">&lt;</span>&nbsp;<span class="ident" id="4768964"><a href="/encoding/json/encode.go.html#4748738">utf8</a></span><span class="op" id="4768968">.</span><span class="ident" id="4768969">RuneSelf</span>&nbsp;<span class="op" id="4768978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4768983">if</span>&nbsp;<span class="num" id="4768986">0x20</span>&nbsp;<span class="op" id="4768991">&lt;=</span>&nbsp;<span class="ident" id="4768994"><a href="/encoding/json/encode.go.html#4768949">b</a></span>&nbsp;<span class="op" id="4768996">&amp;&amp;</span>&nbsp;<span class="ident" id="4768999"><a href="/encoding/json/encode.go.html#4768949">b</a></span>&nbsp;<span class="op" id="4769001">!=</span>&nbsp;<span class="string" id="4769004">&#39;\\&#39;</span>&nbsp;<span class="op" id="4769009">&amp;&amp;</span>&nbsp;<span class="ident" id="4769012"><a href="/encoding/json/encode.go.html#4768949">b</a></span>&nbsp;<span class="op" id="4769014">!=</span>&nbsp;<span class="string" id="4769017">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4769021">&amp;&amp;</span>&nbsp;<span class="ident" id="4769024"><a href="/encoding/json/encode.go.html#4768949">b</a></span>&nbsp;<span class="op" id="4769026">!=</span>&nbsp;<span class="string" id="4769029">&#39;&lt;&#39;</span>&nbsp;<span class="op" id="4769033">&amp;&amp;</span>&nbsp;<span class="ident" id="4769036"><a href="/encoding/json/encode.go.html#4768949">b</a></span>&nbsp;<span class="op" id="4769038">!=</span>&nbsp;<span class="string" id="4769041">&#39;&gt;&#39;</span>&nbsp;<span class="op" id="4769045">&amp;&amp;</span>&nbsp;<span class="ident" id="4769048"><a href="/encoding/json/encode.go.html#4768949">b</a></span>&nbsp;<span class="op" id="4769050">!=</span>&nbsp;<span class="string" id="4769053">&#39;&amp;&#39;</span>&nbsp;<span class="op" id="4769057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769063"><a href="/encoding/json/encode.go.html#4768922">i</a></span><span class="op" id="4769064">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769071">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4769083">}</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769088">if</span>&nbsp;<span class="ident" id="4769091"><a href="/encoding/json/encode.go.html#4768906">start</a></span>&nbsp;<span class="op" id="4769097">&lt;</span>&nbsp;<span class="ident" id="4769099"><a href="/encoding/json/encode.go.html#4768922">i</a></span>&nbsp;<span class="op" id="4769101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769107"><a href="/encoding/json/encode.go.html#4768822">e</a></span><span class="op" id="4769108">.</span><span class="ident" id="4769109">WriteString</span><span class="op" id="4769120">(</span><span class="ident" id="4769121"><a href="/encoding/json/encode.go.html#4768845">s</a></span><span class="op" id="4769122">[</span><span class="ident" id="4769123"><a href="/encoding/json/encode.go.html#4768906">start</a></span><span class="op" id="4769128">:</span><span class="ident" id="4769129"><a href="/encoding/json/encode.go.html#4768922">i</a></span><span class="op" id="4769130">]</span><span class="op" id="4769131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4769136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769141">switch</span>&nbsp;<span class="ident" id="4769148"><a href="/encoding/json/encode.go.html#4768949">b</a></span>&nbsp;<span class="op" id="4769150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769155">case</span>&nbsp;<span class="string" id="4769160">&#39;\\&#39;</span><span class="op" id="4769164">,</span>&nbsp;<span class="string" id="4769166">&#39;&#34;&#39;</span><span class="op" id="4769169">:</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769175"><a href="/encoding/json/encode.go.html#4768822">e</a></span><span class="op" id="4769176">.</span><span class="ident" id="4769177">WriteByte</span><span class="op" id="4769186">(</span><span class="string" id="4769187">&#39;\\&#39;</span><span class="op" id="4769191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769197"><a href="/encoding/json/encode.go.html#4768822">e</a></span><span class="op" id="4769198">.</span><span class="ident" id="4769199">WriteByte</span><span class="op" id="4769208">(</span><span class="ident" id="4769209"><a href="/encoding/json/encode.go.html#4768949">b</a></span><span class="op" id="4769210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769215">case</span>&nbsp;<span class="string" id="4769220">&#39;\n&#39;</span><span class="op" id="4769224">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769230"><a href="/encoding/json/encode.go.html#4768822">e</a></span><span class="op" id="4769231">.</span><span class="ident" id="4769232">WriteByte</span><span class="op" id="4769241">(</span><span class="string" id="4769242">&#39;\\&#39;</span><span class="op" id="4769246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769252"><a href="/encoding/json/encode.go.html#4768822">e</a></span><span class="op" id="4769253">.</span><span class="ident" id="4769254">WriteByte</span><span class="op" id="4769263">(</span><span class="string" id="4769264">&#39;n&#39;</span><span class="op" id="4769267">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769272">case</span>&nbsp;<span class="string" id="4769277">&#39;\r&#39;</span><span class="op" id="4769281">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769287"><a href="/encoding/json/encode.go.html#4768822">e</a></span><span class="op" id="4769288">.</span><span class="ident" id="4769289">WriteByte</span><span class="op" id="4769298">(</span><span class="string" id="4769299">&#39;\\&#39;</span><span class="op" id="4769303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769309"><a href="/encoding/json/encode.go.html#4768822">e</a></span><span class="op" id="4769310">.</span><span class="ident" id="4769311">WriteByte</span><span class="op" id="4769320">(</span><span class="string" id="4769321">&#39;r&#39;</span><span class="op" id="4769324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769329">case</span>&nbsp;<span class="string" id="4769334">&#39;\t&#39;</span><span class="op" id="4769338">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769344"><a href="/encoding/json/encode.go.html#4768822">e</a></span><span class="op" id="4769345">.</span><span class="ident" id="4769346">WriteByte</span><span class="op" id="4769355">(</span><span class="string" id="4769356">&#39;\\&#39;</span><span class="op" id="4769360">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769366"><a href="/encoding/json/encode.go.html#4768822">e</a></span><span class="op" id="4769367">.</span><span class="ident" id="4769368">WriteByte</span><span class="op" id="4769377">(</span><span class="string" id="4769378">&#39;t&#39;</span><span class="op" id="4769381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769386">default</span><span class="op" id="4769393">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4769399">//&nbsp;This&nbsp;encodes&nbsp;bytes&nbsp;&lt;&nbsp;0x20&nbsp;except&nbsp;for&nbsp;\n&nbsp;and&nbsp;\r,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4769454">//&nbsp;as&nbsp;well&nbsp;as&nbsp;&lt;,&nbsp;&gt;&nbsp;and&nbsp;&amp;.&nbsp;The&nbsp;latter&nbsp;are&nbsp;escaped&nbsp;because&nbsp;they</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4769520">//&nbsp;can&nbsp;lead&nbsp;to&nbsp;security&nbsp;holes&nbsp;when&nbsp;user-controlled&nbsp;strings</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4769583">//&nbsp;are&nbsp;rendered&nbsp;into&nbsp;JSON&nbsp;and&nbsp;served&nbsp;to&nbsp;some&nbsp;browsers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769642"><a href="/encoding/json/encode.go.html#4768822">e</a></span><span class="op" id="4769643">.</span><span class="ident" id="4769644">WriteString</span><span class="op" id="4769655">(</span><span class="string" id="4769656">`\u00`</span><span class="op" id="4769662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769668"><a href="/encoding/json/encode.go.html#4768822">e</a></span><span class="op" id="4769669">.</span><span class="ident" id="4769670">WriteByte</span><span class="op" id="4769679">(</span><span class="ident" id="4769680"><a href="/encoding/json/encode.go.html#4756457">hex</a></span><span class="op" id="4769683">[</span><span class="ident" id="4769684"><a href="/encoding/json/encode.go.html#4768949">b</a></span><span class="op" id="4769685">&gt;&gt;</span><span class="num" id="4769687">4</span><span class="op" id="4769688">]</span><span class="op" id="4769689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769695"><a href="/encoding/json/encode.go.html#4768822">e</a></span><span class="op" id="4769696">.</span><span class="ident" id="4769697">WriteByte</span><span class="op" id="4769706">(</span><span class="ident" id="4769707"><a href="/encoding/json/encode.go.html#4756457">hex</a></span><span class="op" id="4769710">[</span><span class="ident" id="4769711"><a href="/encoding/json/encode.go.html#4768949">b</a></span><span class="op" id="4769712">&amp;</span><span class="num" id="4769713">0xF</span><span class="op" id="4769716">]</span><span class="op" id="4769717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4769722">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769727"><a href="/encoding/json/encode.go.html#4768922">i</a></span><span class="op" id="4769728">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769734"><a href="/encoding/json/encode.go.html#4768906">start</a></span>&nbsp;<span class="op" id="4769740">=</span>&nbsp;<span class="ident" id="4769742"><a href="/encoding/json/encode.go.html#4768922">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769747">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4769758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769762">c</span><span class="op" id="4769763">,</span>&nbsp;<span class="ident" id="4769765">size</span>&nbsp;<span class="op" id="4769770">:=</span>&nbsp;<span class="ident" id="4769773"><a href="/encoding/json/encode.go.html#4748738">utf8</a></span><span class="op" id="4769777">.</span><span class="ident" id="4769778">DecodeRuneInString</span><span class="op" id="4769796">(</span><span class="ident" id="4769797"><a href="/encoding/json/encode.go.html#4768845">s</a></span><span class="op" id="4769798">[</span><span class="ident" id="4769799"><a href="/encoding/json/encode.go.html#4768922">i</a></span><span class="op" id="4769800">:</span><span class="op" id="4769801">]</span><span class="op" id="4769802">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769806">if</span>&nbsp;<span class="ident" id="4769809"><a href="/encoding/json/encode.go.html#4769762">c</a></span>&nbsp;<span class="op" id="4769811">==</span>&nbsp;<span class="ident" id="4769814"><a href="/encoding/json/encode.go.html#4748738">utf8</a></span><span class="op" id="4769818">.</span><span class="ident" id="4769819">RuneError</span>&nbsp;<span class="op" id="4769829">&amp;&amp;</span>&nbsp;<span class="ident" id="4769832"><a href="/encoding/json/encode.go.html#4769765">size</a></span>&nbsp;<span class="op" id="4769837">==</span>&nbsp;<span class="num" id="4769840">1</span>&nbsp;<span class="op" id="4769842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769847">if</span>&nbsp;<span class="ident" id="4769850"><a href="/encoding/json/encode.go.html#4768906">start</a></span>&nbsp;<span class="op" id="4769856">&lt;</span>&nbsp;<span class="ident" id="4769858"><a href="/encoding/json/encode.go.html#4768922">i</a></span>&nbsp;<span class="op" id="4769860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769866"><a href="/encoding/json/encode.go.html#4768822">e</a></span><span class="op" id="4769867">.</span><span class="ident" id="4769868">WriteString</span><span class="op" id="4769879">(</span><span class="ident" id="4769880"><a href="/encoding/json/encode.go.html#4768845">s</a></span><span class="op" id="4769881">[</span><span class="ident" id="4769882"><a href="/encoding/json/encode.go.html#4768906">start</a></span><span class="op" id="4769887">:</span><span class="ident" id="4769888"><a href="/encoding/json/encode.go.html#4768922">i</a></span><span class="op" id="4769889">]</span><span class="op" id="4769890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4769895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769900"><a href="/encoding/json/encode.go.html#4768822">e</a></span><span class="op" id="4769901">.</span><span class="ident" id="4769902">WriteString</span><span class="op" id="4769913">(</span><span class="string" id="4769914">`\ufffd`</span><span class="op" id="4769922">)</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769927"><a href="/encoding/json/encode.go.html#4768922">i</a></span>&nbsp;<span class="op" id="4769929">+=</span>&nbsp;<span class="ident" id="4769932"><a href="/encoding/json/encode.go.html#4769765">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4769940"><a href="/encoding/json/encode.go.html#4768906">start</a></span>&nbsp;<span class="op" id="4769946">=</span>&nbsp;<span class="ident" id="4769948"><a href="/encoding/json/encode.go.html#4768922">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4769953">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4769964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4769968">//&nbsp;U+2028&nbsp;is&nbsp;LINE&nbsp;SEPARATOR.</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4769999">//&nbsp;U+2029&nbsp;is&nbsp;PARAGRAPH&nbsp;SEPARATOR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4770035">//&nbsp;They&nbsp;are&nbsp;both&nbsp;technically&nbsp;valid&nbsp;characters&nbsp;in&nbsp;JSON&nbsp;strings,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4770100">//&nbsp;but&nbsp;don&#39;t&nbsp;work&nbsp;in&nbsp;JSONP,&nbsp;which&nbsp;has&nbsp;to&nbsp;be&nbsp;evaluated&nbsp;as&nbsp;JavaScript,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4770171">//&nbsp;and&nbsp;can&nbsp;lead&nbsp;to&nbsp;security&nbsp;holes&nbsp;there.&nbsp;It&nbsp;is&nbsp;valid&nbsp;JSON&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4770234">//&nbsp;escape&nbsp;them,&nbsp;so&nbsp;we&nbsp;do&nbsp;so&nbsp;unconditionally.</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4770281">//&nbsp;See&nbsp;http://timelessrepo.com/json-isnt-a-javascript-subset&nbsp;for&nbsp;discussion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770360">if</span>&nbsp;<span class="ident" id="4770363"><a href="/encoding/json/encode.go.html#4769762">c</a></span>&nbsp;<span class="op" id="4770365">==</span>&nbsp;<span class="string" id="4770368">&#39;\u2028&#39;</span>&nbsp;<span class="op" id="4770377">||</span>&nbsp;<span class="ident" id="4770380"><a href="/encoding/json/encode.go.html#4769762">c</a></span>&nbsp;<span class="op" id="4770382">==</span>&nbsp;<span class="string" id="4770385">&#39;\u2029&#39;</span>&nbsp;<span class="op" id="4770394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770399">if</span>&nbsp;<span class="ident" id="4770402"><a href="/encoding/json/encode.go.html#4768906">start</a></span>&nbsp;<span class="op" id="4770408">&lt;</span>&nbsp;<span class="ident" id="4770410"><a href="/encoding/json/encode.go.html#4768922">i</a></span>&nbsp;<span class="op" id="4770412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4770418"><a href="/encoding/json/encode.go.html#4768822">e</a></span><span class="op" id="4770419">.</span><span class="ident" id="4770420">WriteString</span><span class="op" id="4770431">(</span><span class="ident" id="4770432"><a href="/encoding/json/encode.go.html#4768845">s</a></span><span class="op" id="4770433">[</span><span class="ident" id="4770434"><a href="/encoding/json/encode.go.html#4768906">start</a></span><span class="op" id="4770439">:</span><span class="ident" id="4770440"><a href="/encoding/json/encode.go.html#4768922">i</a></span><span class="op" id="4770441">]</span><span class="op" id="4770442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4770447">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4770452"><a href="/encoding/json/encode.go.html#4768822">e</a></span><span class="op" id="4770453">.</span><span class="ident" id="4770454">WriteString</span><span class="op" id="4770465">(</span><span class="string" id="4770466">`\u202`</span><span class="op" id="4770473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4770478"><a href="/encoding/json/encode.go.html#4768822">e</a></span><span class="op" id="4770479">.</span><span class="ident" id="4770480">WriteByte</span><span class="op" id="4770489">(</span><span class="ident" id="4770490"><a href="/encoding/json/encode.go.html#4756457">hex</a></span><span class="op" id="4770493">[</span><span class="ident" id="4770494"><a href="/encoding/json/encode.go.html#4769762">c</a></span><span class="op" id="4770495">&amp;</span><span class="num" id="4770496">0xF</span><span class="op" id="4770499">]</span><span class="op" id="4770500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4770505"><a href="/encoding/json/encode.go.html#4768922">i</a></span>&nbsp;<span class="op" id="4770507">+=</span>&nbsp;<span class="ident" id="4770510"><a href="/encoding/json/encode.go.html#4769765">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4770518"><a href="/encoding/json/encode.go.html#4768906">start</a></span>&nbsp;<span class="op" id="4770524">=</span>&nbsp;<span class="ident" id="4770526"><a href="/encoding/json/encode.go.html#4768922">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770531">continue</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4770542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4770546"><a href="/encoding/json/encode.go.html#4768922">i</a></span>&nbsp;<span class="op" id="4770548">+=</span>&nbsp;<span class="ident" id="4770551"><a href="/encoding/json/encode.go.html#4769765">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4770557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770560">if</span>&nbsp;<span class="ident" id="4770563"><a href="/encoding/json/encode.go.html#4768906">start</a></span>&nbsp;<span class="op" id="4770569">&lt;</span>&nbsp;<span class="builtinfunc" id="4770571">len</span><span class="op" id="4770574">(</span><span class="ident" id="4770575"><a href="/encoding/json/encode.go.html#4768845">s</a></span><span class="op" id="4770576">)</span>&nbsp;<span class="op" id="4770578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4770582"><a href="/encoding/json/encode.go.html#4768822">e</a></span><span class="op" id="4770583">.</span><span class="ident" id="4770584">WriteString</span><span class="op" id="4770595">(</span><span class="ident" id="4770596"><a href="/encoding/json/encode.go.html#4768845">s</a></span><span class="op" id="4770597">[</span><span class="ident" id="4770598"><a href="/encoding/json/encode.go.html#4768906">start</a></span><span class="op" id="4770603">:</span><span class="op" id="4770604">]</span><span class="op" id="4770605">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4770608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4770611"><a href="/encoding/json/encode.go.html#4768822">e</a></span><span class="op" id="4770612">.</span><span class="ident" id="4770613">WriteByte</span><span class="op" id="4770622">(</span><span class="string" id="4770623">&#39;&#34;&#39;</span><span class="op" id="4770626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770629">return</span>&nbsp;<span class="ident" id="4770636"><a href="/encoding/json/encode.go.html#4768822">e</a></span><span class="op" id="4770637">.</span><span class="ident" id="4770638">Len</span><span class="op" id="4770641">(</span><span class="op" id="4770642">)</span>&nbsp;<span class="op" id="4770644">-</span>&nbsp;<span class="ident" id="4770646"><a href="/encoding/json/encode.go.html#4768871">len0</a></span><span class="op" id="4770650">,</span>&nbsp;<span class="ident" id="4770652">nil</span><br>
<span class="lineno"></span><span class="op" id="4770656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="comment" id="4770659">//&nbsp;NOTE:&nbsp;keep&nbsp;in&nbsp;sync&nbsp;with&nbsp;string&nbsp;above.</span><br>
<span class="lineno"></span><span class="keyword" id="4770700">func</span>&nbsp;<span class="op" id="4770705">(</span><span class="ident" id="4770706">e</span>&nbsp;<span class="op" id="4770708">*</span><span class="ident" id="4770709"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="4770720">)</span>&nbsp;<span class="ident" id="4770722">stringBytes</span><span class="op" id="4770733">(</span><span class="ident" id="4770734">s</span>&nbsp;<span class="op" id="4770736">[</span><span class="op" id="4770737">]</span><span class="builtintype" id="4770738">byte</span><span class="op" id="4770742">)</span>&nbsp;<span class="op" id="4770744">(</span><span class="builtintype" id="4770745">int</span><span class="op" id="4770748">,</span>&nbsp;<span class="builtintype" id="4770750">error</span><span class="op" id="4770755">)</span>&nbsp;<span class="op" id="4770757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4770760">len0</span>&nbsp;<span class="op" id="4770765">:=</span>&nbsp;<span class="ident" id="4770768"><a href="/encoding/json/encode.go.html#4770706">e</a></span><span class="op" id="4770769">.</span><span class="ident" id="4770770">Len</span><span class="op" id="4770773">(</span><span class="op" id="4770774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4770777"><a href="/encoding/json/encode.go.html#4770706">e</a></span><span class="op" id="4770778">.</span><span class="ident" id="4770779">WriteByte</span><span class="op" id="4770788">(</span><span class="string" id="4770789">&#39;&#34;&#39;</span><span class="op" id="4770792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4770795">start</span>&nbsp;<span class="op" id="4770801">:=</span>&nbsp;<span class="num" id="4770804">0</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770807">for</span>&nbsp;<span class="ident" id="4770811">i</span>&nbsp;<span class="op" id="4770813">:=</span>&nbsp;<span class="num" id="4770816">0</span><span class="op" id="4770817">;</span>&nbsp;<span class="ident" id="4770819"><a href="/encoding/json/encode.go.html#4770811">i</a></span>&nbsp;<span class="op" id="4770821">&lt;</span>&nbsp;<span class="builtinfunc" id="4770823">len</span><span class="op" id="4770826">(</span><span class="ident" id="4770827"><a href="/encoding/json/encode.go.html#4770734">s</a></span><span class="op" id="4770828">)</span><span class="op" id="4770829">;</span>&nbsp;<span class="op" id="4770831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770835">if</span>&nbsp;<span class="ident" id="4770838">b</span>&nbsp;<span class="op" id="4770840">:=</span>&nbsp;<span class="ident" id="4770843"><a href="/encoding/json/encode.go.html#4770734">s</a></span><span class="op" id="4770844">[</span><span class="ident" id="4770845"><a href="/encoding/json/encode.go.html#4770811">i</a></span><span class="op" id="4770846">]</span><span class="op" id="4770847">;</span>&nbsp;<span class="ident" id="4770849"><a href="/encoding/json/encode.go.html#4770838">b</a></span>&nbsp;<span class="op" id="4770851">&lt;</span>&nbsp;<span class="ident" id="4770853"><a href="/encoding/json/encode.go.html#4748738">utf8</a></span><span class="op" id="4770857">.</span><span class="ident" id="4770858">RuneSelf</span>&nbsp;<span class="op" id="4770867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770872">if</span>&nbsp;<span class="num" id="4770875">0x20</span>&nbsp;<span class="op" id="4770880">&lt;=</span>&nbsp;<span class="ident" id="4770883"><a href="/encoding/json/encode.go.html#4770838">b</a></span>&nbsp;<span class="op" id="4770885">&amp;&amp;</span>&nbsp;<span class="ident" id="4770888"><a href="/encoding/json/encode.go.html#4770838">b</a></span>&nbsp;<span class="op" id="4770890">!=</span>&nbsp;<span class="string" id="4770893">&#39;\\&#39;</span>&nbsp;<span class="op" id="4770898">&amp;&amp;</span>&nbsp;<span class="ident" id="4770901"><a href="/encoding/json/encode.go.html#4770838">b</a></span>&nbsp;<span class="op" id="4770903">!=</span>&nbsp;<span class="string" id="4770906">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4770910">&amp;&amp;</span>&nbsp;<span class="ident" id="4770913"><a href="/encoding/json/encode.go.html#4770838">b</a></span>&nbsp;<span class="op" id="4770915">!=</span>&nbsp;<span class="string" id="4770918">&#39;&lt;&#39;</span>&nbsp;<span class="op" id="4770922">&amp;&amp;</span>&nbsp;<span class="ident" id="4770925"><a href="/encoding/json/encode.go.html#4770838">b</a></span>&nbsp;<span class="op" id="4770927">!=</span>&nbsp;<span class="string" id="4770930">&#39;&gt;&#39;</span>&nbsp;<span class="op" id="4770934">&amp;&amp;</span>&nbsp;<span class="ident" id="4770937"><a href="/encoding/json/encode.go.html#4770838">b</a></span>&nbsp;<span class="op" id="4770939">!=</span>&nbsp;<span class="string" id="4770942">&#39;&amp;&#39;</span>&nbsp;<span class="op" id="4770946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4770952"><a href="/encoding/json/encode.go.html#4770811">i</a></span><span class="op" id="4770953">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770960">continue</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4770972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4770977">if</span>&nbsp;<span class="ident" id="4770980"><a href="/encoding/json/encode.go.html#4770795">start</a></span>&nbsp;<span class="op" id="4770986">&lt;</span>&nbsp;<span class="ident" id="4770988"><a href="/encoding/json/encode.go.html#4770811">i</a></span>&nbsp;<span class="op" id="4770990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4770996"><a href="/encoding/json/encode.go.html#4770706">e</a></span><span class="op" id="4770997">.</span><span class="ident" id="4770998">Write</span><span class="op" id="4771003">(</span><span class="ident" id="4771004"><a href="/encoding/json/encode.go.html#4770734">s</a></span><span class="op" id="4771005">[</span><span class="ident" id="4771006"><a href="/encoding/json/encode.go.html#4770795">start</a></span><span class="op" id="4771011">:</span><span class="ident" id="4771012"><a href="/encoding/json/encode.go.html#4770811">i</a></span><span class="op" id="4771013">]</span><span class="op" id="4771014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4771019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4771024">switch</span>&nbsp;<span class="ident" id="4771031"><a href="/encoding/json/encode.go.html#4770838">b</a></span>&nbsp;<span class="op" id="4771033">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4771038">case</span>&nbsp;<span class="string" id="4771043">&#39;\\&#39;</span><span class="op" id="4771047">,</span>&nbsp;<span class="string" id="4771049">&#39;&#34;&#39;</span><span class="op" id="4771052">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4771058"><a href="/encoding/json/encode.go.html#4770706">e</a></span><span class="op" id="4771059">.</span><span class="ident" id="4771060">WriteByte</span><span class="op" id="4771069">(</span><span class="string" id="4771070">&#39;\\&#39;</span><span class="op" id="4771074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4771080"><a href="/encoding/json/encode.go.html#4770706">e</a></span><span class="op" id="4771081">.</span><span class="ident" id="4771082">WriteByte</span><span class="op" id="4771091">(</span><span class="ident" id="4771092"><a href="/encoding/json/encode.go.html#4770838">b</a></span><span class="op" id="4771093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4771098">case</span>&nbsp;<span class="string" id="4771103">&#39;\n&#39;</span><span class="op" id="4771107">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4771113"><a href="/encoding/json/encode.go.html#4770706">e</a></span><span class="op" id="4771114">.</span><span class="ident" id="4771115">WriteByte</span><span class="op" id="4771124">(</span><span class="string" id="4771125">&#39;\\&#39;</span><span class="op" id="4771129">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4771135"><a href="/encoding/json/encode.go.html#4770706">e</a></span><span class="op" id="4771136">.</span><span class="ident" id="4771137">WriteByte</span><span class="op" id="4771146">(</span><span class="string" id="4771147">&#39;n&#39;</span><span class="op" id="4771150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4771155">case</span>&nbsp;<span class="string" id="4771160">&#39;\r&#39;</span><span class="op" id="4771164">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4771170"><a href="/encoding/json/encode.go.html#4770706">e</a></span><span class="op" id="4771171">.</span><span class="ident" id="4771172">WriteByte</span><span class="op" id="4771181">(</span><span class="string" id="4771182">&#39;\\&#39;</span><span class="op" id="4771186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4771192"><a href="/encoding/json/encode.go.html#4770706">e</a></span><span class="op" id="4771193">.</span><span class="ident" id="4771194">WriteByte</span><span class="op" id="4771203">(</span><span class="string" id="4771204">&#39;r&#39;</span><span class="op" id="4771207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4771212">case</span>&nbsp;<span class="string" id="4771217">&#39;\t&#39;</span><span class="op" id="4771221">:</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4771227"><a href="/encoding/json/encode.go.html#4770706">e</a></span><span class="op" id="4771228">.</span><span class="ident" id="4771229">WriteByte</span><span class="op" id="4771238">(</span><span class="string" id="4771239">&#39;\\&#39;</span><span class="op" id="4771243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4771249"><a href="/encoding/json/encode.go.html#4770706">e</a></span><span class="op" id="4771250">.</span><span class="ident" id="4771251">WriteByte</span><span class="op" id="4771260">(</span><span class="string" id="4771261">&#39;t&#39;</span><span class="op" id="4771264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4771269">default</span><span class="op" id="4771276">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4771282">//&nbsp;This&nbsp;encodes&nbsp;bytes&nbsp;&lt;&nbsp;0x20&nbsp;except&nbsp;for&nbsp;\n&nbsp;and&nbsp;\r,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4771337">//&nbsp;as&nbsp;well&nbsp;as&nbsp;&lt;,&nbsp;&gt;,&nbsp;and&nbsp;&amp;.&nbsp;The&nbsp;latter&nbsp;are&nbsp;escaped&nbsp;because&nbsp;they</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4771404">//&nbsp;can&nbsp;lead&nbsp;to&nbsp;security&nbsp;holes&nbsp;when&nbsp;user-controlled&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4771467">//&nbsp;are&nbsp;rendered&nbsp;into&nbsp;JSON&nbsp;and&nbsp;served&nbsp;to&nbsp;some&nbsp;browsers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4771526"><a href="/encoding/json/encode.go.html#4770706">e</a></span><span class="op" id="4771527">.</span><span class="ident" id="4771528">WriteString</span><span class="op" id="4771539">(</span><span class="string" id="4771540">`\u00`</span><span class="op" id="4771546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4771552"><a href="/encoding/json/encode.go.html#4770706">e</a></span><span class="op" id="4771553">.</span><span class="ident" id="4771554">WriteByte</span><span class="op" id="4771563">(</span><span class="ident" id="4771564"><a href="/encoding/json/encode.go.html#4756457">hex</a></span><span class="op" id="4771567">[</span><span class="ident" id="4771568"><a href="/encoding/json/encode.go.html#4770838">b</a></span><span class="op" id="4771569">&gt;&gt;</span><span class="num" id="4771571">4</span><span class="op" id="4771572">]</span><span class="op" id="4771573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4771579"><a href="/encoding/json/encode.go.html#4770706">e</a></span><span class="op" id="4771580">.</span><span class="ident" id="4771581">WriteByte</span><span class="op" id="4771590">(</span><span class="ident" id="4771591"><a href="/encoding/json/encode.go.html#4756457">hex</a></span><span class="op" id="4771594">[</span><span class="ident" id="4771595"><a href="/encoding/json/encode.go.html#4770838">b</a></span><span class="op" id="4771596">&amp;</span><span class="num" id="4771597">0xF</span><span class="op" id="4771600">]</span><span class="op" id="4771601">)</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4771606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4771611"><a href="/encoding/json/encode.go.html#4770811">i</a></span><span class="op" id="4771612">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4771618"><a href="/encoding/json/encode.go.html#4770795">start</a></span>&nbsp;<span class="op" id="4771624">=</span>&nbsp;<span class="ident" id="4771626"><a href="/encoding/json/encode.go.html#4770811">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4771631">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4771642">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4771646">c</span><span class="op" id="4771647">,</span>&nbsp;<span class="ident" id="4771649">size</span>&nbsp;<span class="op" id="4771654">:=</span>&nbsp;<span class="ident" id="4771657"><a href="/encoding/json/encode.go.html#4748738">utf8</a></span><span class="op" id="4771661">.</span><span class="ident" id="4771662">DecodeRune</span><span class="op" id="4771672">(</span><span class="ident" id="4771673"><a href="/encoding/json/encode.go.html#4770734">s</a></span><span class="op" id="4771674">[</span><span class="ident" id="4771675"><a href="/encoding/json/encode.go.html#4770811">i</a></span><span class="op" id="4771676">:</span><span class="op" id="4771677">]</span><span class="op" id="4771678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4771682">if</span>&nbsp;<span class="ident" id="4771685"><a href="/encoding/json/encode.go.html#4771646">c</a></span>&nbsp;<span class="op" id="4771687">==</span>&nbsp;<span class="ident" id="4771690"><a href="/encoding/json/encode.go.html#4748738">utf8</a></span><span class="op" id="4771694">.</span><span class="ident" id="4771695">RuneError</span>&nbsp;<span class="op" id="4771705">&amp;&amp;</span>&nbsp;<span class="ident" id="4771708"><a href="/encoding/json/encode.go.html#4771649">size</a></span>&nbsp;<span class="op" id="4771713">==</span>&nbsp;<span class="num" id="4771716">1</span>&nbsp;<span class="op" id="4771718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4771723">if</span>&nbsp;<span class="ident" id="4771726"><a href="/encoding/json/encode.go.html#4770795">start</a></span>&nbsp;<span class="op" id="4771732">&lt;</span>&nbsp;<span class="ident" id="4771734"><a href="/encoding/json/encode.go.html#4770811">i</a></span>&nbsp;<span class="op" id="4771736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4771742"><a href="/encoding/json/encode.go.html#4770706">e</a></span><span class="op" id="4771743">.</span><span class="ident" id="4771744">Write</span><span class="op" id="4771749">(</span><span class="ident" id="4771750"><a href="/encoding/json/encode.go.html#4770734">s</a></span><span class="op" id="4771751">[</span><span class="ident" id="4771752"><a href="/encoding/json/encode.go.html#4770795">start</a></span><span class="op" id="4771757">:</span><span class="ident" id="4771758"><a href="/encoding/json/encode.go.html#4770811">i</a></span><span class="op" id="4771759">]</span><span class="op" id="4771760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4771765">}</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4771770"><a href="/encoding/json/encode.go.html#4770706">e</a></span><span class="op" id="4771771">.</span><span class="ident" id="4771772">WriteString</span><span class="op" id="4771783">(</span><span class="string" id="4771784">`\ufffd`</span><span class="op" id="4771792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4771797"><a href="/encoding/json/encode.go.html#4770811">i</a></span>&nbsp;<span class="op" id="4771799">+=</span>&nbsp;<span class="ident" id="4771802"><a href="/encoding/json/encode.go.html#4771649">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4771810"><a href="/encoding/json/encode.go.html#4770795">start</a></span>&nbsp;<span class="op" id="4771816">=</span>&nbsp;<span class="ident" id="4771818"><a href="/encoding/json/encode.go.html#4770811">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4771823">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4771834">}</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4771838">//&nbsp;U+2028&nbsp;is&nbsp;LINE&nbsp;SEPARATOR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4771869">//&nbsp;U+2029&nbsp;is&nbsp;PARAGRAPH&nbsp;SEPARATOR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4771905">//&nbsp;They&nbsp;are&nbsp;both&nbsp;technically&nbsp;valid&nbsp;characters&nbsp;in&nbsp;JSON&nbsp;strings,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4771970">//&nbsp;but&nbsp;don&#39;t&nbsp;work&nbsp;in&nbsp;JSONP,&nbsp;which&nbsp;has&nbsp;to&nbsp;be&nbsp;evaluated&nbsp;as&nbsp;JavaScript,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4772041">//&nbsp;and&nbsp;can&nbsp;lead&nbsp;to&nbsp;security&nbsp;holes&nbsp;there.&nbsp;It&nbsp;is&nbsp;valid&nbsp;JSON&nbsp;to</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4772104">//&nbsp;escape&nbsp;them,&nbsp;so&nbsp;we&nbsp;do&nbsp;so&nbsp;unconditionally.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4772151">//&nbsp;See&nbsp;http://timelessrepo.com/json-isnt-a-javascript-subset&nbsp;for&nbsp;discussion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4772230">if</span>&nbsp;<span class="ident" id="4772233"><a href="/encoding/json/encode.go.html#4771646">c</a></span>&nbsp;<span class="op" id="4772235">==</span>&nbsp;<span class="string" id="4772238">&#39;\u2028&#39;</span>&nbsp;<span class="op" id="4772247">||</span>&nbsp;<span class="ident" id="4772250"><a href="/encoding/json/encode.go.html#4771646">c</a></span>&nbsp;<span class="op" id="4772252">==</span>&nbsp;<span class="string" id="4772255">&#39;\u2029&#39;</span>&nbsp;<span class="op" id="4772264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4772269">if</span>&nbsp;<span class="ident" id="4772272"><a href="/encoding/json/encode.go.html#4770795">start</a></span>&nbsp;<span class="op" id="4772278">&lt;</span>&nbsp;<span class="ident" id="4772280"><a href="/encoding/json/encode.go.html#4770811">i</a></span>&nbsp;<span class="op" id="4772282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772288"><a href="/encoding/json/encode.go.html#4770706">e</a></span><span class="op" id="4772289">.</span><span class="ident" id="4772290">Write</span><span class="op" id="4772295">(</span><span class="ident" id="4772296"><a href="/encoding/json/encode.go.html#4770734">s</a></span><span class="op" id="4772297">[</span><span class="ident" id="4772298"><a href="/encoding/json/encode.go.html#4770795">start</a></span><span class="op" id="4772303">:</span><span class="ident" id="4772304"><a href="/encoding/json/encode.go.html#4770811">i</a></span><span class="op" id="4772305">]</span><span class="op" id="4772306">)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4772311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772316"><a href="/encoding/json/encode.go.html#4770706">e</a></span><span class="op" id="4772317">.</span><span class="ident" id="4772318">WriteString</span><span class="op" id="4772329">(</span><span class="string" id="4772330">`\u202`</span><span class="op" id="4772337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772342"><a href="/encoding/json/encode.go.html#4770706">e</a></span><span class="op" id="4772343">.</span><span class="ident" id="4772344">WriteByte</span><span class="op" id="4772353">(</span><span class="ident" id="4772354"><a href="/encoding/json/encode.go.html#4756457">hex</a></span><span class="op" id="4772357">[</span><span class="ident" id="4772358"><a href="/encoding/json/encode.go.html#4771646">c</a></span><span class="op" id="4772359">&amp;</span><span class="num" id="4772360">0xF</span><span class="op" id="4772363">]</span><span class="op" id="4772364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772369"><a href="/encoding/json/encode.go.html#4770811">i</a></span>&nbsp;<span class="op" id="4772371">+=</span>&nbsp;<span class="ident" id="4772374"><a href="/encoding/json/encode.go.html#4771649">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772382"><a href="/encoding/json/encode.go.html#4770795">start</a></span>&nbsp;<span class="op" id="4772388">=</span>&nbsp;<span class="ident" id="4772390"><a href="/encoding/json/encode.go.html#4770811">i</a></span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4772395">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4772406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772410"><a href="/encoding/json/encode.go.html#4770811">i</a></span>&nbsp;<span class="op" id="4772412">+=</span>&nbsp;<span class="ident" id="4772415"><a href="/encoding/json/encode.go.html#4771649">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4772421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4772424">if</span>&nbsp;<span class="ident" id="4772427"><a href="/encoding/json/encode.go.html#4770795">start</a></span>&nbsp;<span class="op" id="4772433">&lt;</span>&nbsp;<span class="builtinfunc" id="4772435">len</span><span class="op" id="4772438">(</span><span class="ident" id="4772439"><a href="/encoding/json/encode.go.html#4770734">s</a></span><span class="op" id="4772440">)</span>&nbsp;<span class="op" id="4772442">{</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772446"><a href="/encoding/json/encode.go.html#4770706">e</a></span><span class="op" id="4772447">.</span><span class="ident" id="4772448">Write</span><span class="op" id="4772453">(</span><span class="ident" id="4772454"><a href="/encoding/json/encode.go.html#4770734">s</a></span><span class="op" id="4772455">[</span><span class="ident" id="4772456"><a href="/encoding/json/encode.go.html#4770795">start</a></span><span class="op" id="4772461">:</span><span class="op" id="4772462">]</span><span class="op" id="4772463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4772466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772469"><a href="/encoding/json/encode.go.html#4770706">e</a></span><span class="op" id="4772470">.</span><span class="ident" id="4772471">WriteByte</span><span class="op" id="4772480">(</span><span class="string" id="4772481">&#39;&#34;&#39;</span><span class="op" id="4772484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4772487">return</span>&nbsp;<span class="ident" id="4772494"><a href="/encoding/json/encode.go.html#4770706">e</a></span><span class="op" id="4772495">.</span><span class="ident" id="4772496">Len</span><span class="op" id="4772499">(</span><span class="op" id="4772500">)</span>&nbsp;<span class="op" id="4772502">-</span>&nbsp;<span class="ident" id="4772504"><a href="/encoding/json/encode.go.html#4770760">len0</a></span><span class="op" id="4772508">,</span>&nbsp;<span class="ident" id="4772510">nil</span><br>
<span class="lineno"></span><span class="op" id="4772514">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span><span class="comment" id="4772517">//&nbsp;A&nbsp;field&nbsp;represents&nbsp;a&nbsp;single&nbsp;field&nbsp;found&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span><span class="keyword" id="4772573">type</span>&nbsp;<span class="ident" id="4772578">field</span>&nbsp;<span class="keyword" id="4772584">struct</span>&nbsp;<span class="op" id="4772591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772594">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4772604">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772612">nameBytes</span>&nbsp;<span class="op" id="4772622">[</span><span class="op" id="4772623">]</span><span class="builtintype" id="4772624">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4772645">//&nbsp;[]byte(name)</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772662">equalFold</span>&nbsp;<span class="keyword" id="4772672">func</span><span class="op" id="4772676">(</span><span class="ident" id="4772677">s</span><span class="op" id="4772678">,</span>&nbsp;<span class="ident" id="4772680">t</span>&nbsp;<span class="op" id="4772682">[</span><span class="op" id="4772683">]</span><span class="builtintype" id="4772684">byte</span><span class="op" id="4772688">)</span>&nbsp;<span class="builtintype" id="4772690">bool</span>&nbsp;<span class="comment" id="4772695">//&nbsp;bytes.EqualFold&nbsp;or&nbsp;equivalent</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772730">tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4772740">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772746">index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4772756">[</span><span class="op" id="4772757">]</span><span class="builtintype" id="4772758">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772763">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4772773"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4772780">.</span><span class="ident" id="4772781">Type</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772787">omitEmpty</span>&nbsp;<span class="builtintype" id="4772797">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772803">quoted</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4772813">bool</span><br>
<span class="lineno"></span><span class="op" id="4772818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4772821">func</span>&nbsp;<span class="ident" id="4772826">fillField</span><span class="op" id="4772835">(</span><span class="ident" id="4772836">f</span>&nbsp;<span class="ident" id="4772838"><a href="/encoding/json/encode.go.html#4772578">field</a></span><span class="op" id="4772843">)</span>&nbsp;<span class="ident" id="4772845"><a href="/encoding/json/encode.go.html#4772578">field</a></span>&nbsp;<span class="op" id="4772851">{</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772854"><a href="/encoding/json/encode.go.html#4772836">f</a></span><span class="op" id="4772855">.</span><span class="ident" id="4772856">nameBytes</span>&nbsp;<span class="op" id="4772866">=</span>&nbsp;<span class="op" id="4772868">[</span><span class="op" id="4772869">]</span><span class="builtintype" id="4772870">byte</span><span class="op" id="4772874">(</span><span class="ident" id="4772875"><a href="/encoding/json/encode.go.html#4772836">f</a></span><span class="op" id="4772876">.</span><span class="ident" id="4772877">name</span><span class="op" id="4772881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4772884"><a href="/encoding/json/encode.go.html#4772836">f</a></span><span class="op" id="4772885">.</span><span class="ident" id="4772886">equalFold</span>&nbsp;<span class="op" id="4772896">=</span>&nbsp;<span class="ident" id="4772898"><a href="/encoding/json/fold.go.html#4780125">foldFunc</a></span><span class="op" id="4772906">(</span><span class="ident" id="4772907"><a href="/encoding/json/encode.go.html#4772836">f</a></span><span class="op" id="4772908">.</span><span class="ident" id="4772909">nameBytes</span><span class="op" id="4772918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4772921">return</span>&nbsp;<span class="ident" id="4772928"><a href="/encoding/json/encode.go.html#4772836">f</a></span><br>
<span class="lineno"></span><span class="op" id="4772930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">955</span><span class="comment" id="4772933">//&nbsp;byName&nbsp;sorts&nbsp;field&nbsp;by&nbsp;name,&nbsp;breaking&nbsp;ties&nbsp;with&nbsp;depth,</span><br>
<span class="lineno"></span><span class="comment" id="4772990">//&nbsp;then&nbsp;breaking&nbsp;ties&nbsp;with&nbsp;&#34;name&nbsp;came&nbsp;from&nbsp;json&nbsp;tag&#34;,&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="4773049">//&nbsp;breaking&nbsp;ties&nbsp;with&nbsp;index&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="keyword" id="4773087">type</span>&nbsp;<span class="ident" id="4773092">byName</span>&nbsp;<span class="op" id="4773099">[</span><span class="op" id="4773100">]</span><span class="ident" id="4773101"><a href="/encoding/json/encode.go.html#4772578">field</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">960</span><span class="keyword" id="4773108">func</span>&nbsp;<span class="op" id="4773113">(</span><span class="ident" id="4773114">x</span>&nbsp;<span class="ident" id="4773116"><a href="/encoding/json/encode.go.html#4773092">byName</a></span><span class="op" id="4773122">)</span>&nbsp;<span class="ident" id="4773124">Len</span><span class="op" id="4773127">(</span><span class="op" id="4773128">)</span>&nbsp;<span class="builtintype" id="4773130">int</span>&nbsp;<span class="op" id="4773134">{</span>&nbsp;<span class="keyword" id="4773136">return</span>&nbsp;<span class="builtinfunc" id="4773143">len</span><span class="op" id="4773146">(</span><span class="ident" id="4773147"><a href="/encoding/json/encode.go.html#4773114">x</a></span><span class="op" id="4773148">)</span>&nbsp;<span class="op" id="4773150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4773153">func</span>&nbsp;<span class="op" id="4773158">(</span><span class="ident" id="4773159">x</span>&nbsp;<span class="ident" id="4773161"><a href="/encoding/json/encode.go.html#4773092">byName</a></span><span class="op" id="4773167">)</span>&nbsp;<span class="ident" id="4773169">Swap</span><span class="op" id="4773173">(</span><span class="ident" id="4773174">i</span><span class="op" id="4773175">,</span>&nbsp;<span class="ident" id="4773177">j</span>&nbsp;<span class="builtintype" id="4773179">int</span><span class="op" id="4773182">)</span>&nbsp;<span class="op" id="4773184">{</span>&nbsp;<span class="ident" id="4773186"><a href="/encoding/json/encode.go.html#4773159">x</a></span><span class="op" id="4773187">[</span><span class="ident" id="4773188"><a href="/encoding/json/encode.go.html#4773174">i</a></span><span class="op" id="4773189">]</span><span class="op" id="4773190">,</span>&nbsp;<span class="ident" id="4773192"><a href="/encoding/json/encode.go.html#4773159">x</a></span><span class="op" id="4773193">[</span><span class="ident" id="4773194"><a href="/encoding/json/encode.go.html#4773177">j</a></span><span class="op" id="4773195">]</span>&nbsp;<span class="op" id="4773197">=</span>&nbsp;<span class="ident" id="4773199"><a href="/encoding/json/encode.go.html#4773159">x</a></span><span class="op" id="4773200">[</span><span class="ident" id="4773201"><a href="/encoding/json/encode.go.html#4773177">j</a></span><span class="op" id="4773202">]</span><span class="op" id="4773203">,</span>&nbsp;<span class="ident" id="4773205"><a href="/encoding/json/encode.go.html#4773159">x</a></span><span class="op" id="4773206">[</span><span class="ident" id="4773207"><a href="/encoding/json/encode.go.html#4773174">i</a></span><span class="op" id="4773208">]</span>&nbsp;<span class="op" id="4773210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4773213">func</span>&nbsp;<span class="op" id="4773218">(</span><span class="ident" id="4773219">x</span>&nbsp;<span class="ident" id="4773221"><a href="/encoding/json/encode.go.html#4773092">byName</a></span><span class="op" id="4773227">)</span>&nbsp;<span class="ident" id="4773229">Less</span><span class="op" id="4773233">(</span><span class="ident" id="4773234">i</span><span class="op" id="4773235">,</span>&nbsp;<span class="ident" id="4773237">j</span>&nbsp;<span class="builtintype" id="4773239">int</span><span class="op" id="4773242">)</span>&nbsp;<span class="builtintype" id="4773244">bool</span>&nbsp;<span class="op" id="4773249">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4773252">if</span>&nbsp;<span class="ident" id="4773255"><a href="/encoding/json/encode.go.html#4773219">x</a></span><span class="op" id="4773256">[</span><span class="ident" id="4773257"><a href="/encoding/json/encode.go.html#4773234">i</a></span><span class="op" id="4773258">]</span><span class="op" id="4773259">.</span><span class="ident" id="4773260">name</span>&nbsp;<span class="op" id="4773265">!=</span>&nbsp;<span class="ident" id="4773268"><a href="/encoding/json/encode.go.html#4773219">x</a></span><span class="op" id="4773269">[</span><span class="ident" id="4773270"><a href="/encoding/json/encode.go.html#4773237">j</a></span><span class="op" id="4773271">]</span><span class="op" id="4773272">.</span><span class="ident" id="4773273">name</span>&nbsp;<span class="op" id="4773278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4773282">return</span>&nbsp;<span class="ident" id="4773289"><a href="/encoding/json/encode.go.html#4773219">x</a></span><span class="op" id="4773290">[</span><span class="ident" id="4773291"><a href="/encoding/json/encode.go.html#4773234">i</a></span><span class="op" id="4773292">]</span><span class="op" id="4773293">.</span><span class="ident" id="4773294">name</span>&nbsp;<span class="op" id="4773299">&lt;</span>&nbsp;<span class="ident" id="4773301"><a href="/encoding/json/encode.go.html#4773219">x</a></span><span class="op" id="4773302">[</span><span class="ident" id="4773303"><a href="/encoding/json/encode.go.html#4773237">j</a></span><span class="op" id="4773304">]</span><span class="op" id="4773305">.</span><span class="ident" id="4773306">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4773312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4773315">if</span>&nbsp;<span class="builtinfunc" id="4773318">len</span><span class="op" id="4773321">(</span><span class="ident" id="4773322"><a href="/encoding/json/encode.go.html#4773219">x</a></span><span class="op" id="4773323">[</span><span class="ident" id="4773324"><a href="/encoding/json/encode.go.html#4773234">i</a></span><span class="op" id="4773325">]</span><span class="op" id="4773326">.</span><span class="ident" id="4773327">index</span><span class="op" id="4773332">)</span>&nbsp;<span class="op" id="4773334">!=</span>&nbsp;<span class="builtinfunc" id="4773337">len</span><span class="op" id="4773340">(</span><span class="ident" id="4773341"><a href="/encoding/json/encode.go.html#4773219">x</a></span><span class="op" id="4773342">[</span><span class="ident" id="4773343"><a href="/encoding/json/encode.go.html#4773237">j</a></span><span class="op" id="4773344">]</span><span class="op" id="4773345">.</span><span class="ident" id="4773346">index</span><span class="op" id="4773351">)</span>&nbsp;<span class="op" id="4773353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4773357">return</span>&nbsp;<span class="builtinfunc" id="4773364">len</span><span class="op" id="4773367">(</span><span class="ident" id="4773368"><a href="/encoding/json/encode.go.html#4773219">x</a></span><span class="op" id="4773369">[</span><span class="ident" id="4773370"><a href="/encoding/json/encode.go.html#4773234">i</a></span><span class="op" id="4773371">]</span><span class="op" id="4773372">.</span><span class="ident" id="4773373">index</span><span class="op" id="4773378">)</span>&nbsp;<span class="op" id="4773380">&lt;</span>&nbsp;<span class="builtinfunc" id="4773382">len</span><span class="op" id="4773385">(</span><span class="ident" id="4773386"><a href="/encoding/json/encode.go.html#4773219">x</a></span><span class="op" id="4773387">[</span><span class="ident" id="4773388"><a href="/encoding/json/encode.go.html#4773237">j</a></span><span class="op" id="4773389">]</span><span class="op" id="4773390">.</span><span class="ident" id="4773391">index</span><span class="op" id="4773396">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4773399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4773402">if</span>&nbsp;<span class="ident" id="4773405"><a href="/encoding/json/encode.go.html#4773219">x</a></span><span class="op" id="4773406">[</span><span class="ident" id="4773407"><a href="/encoding/json/encode.go.html#4773234">i</a></span><span class="op" id="4773408">]</span><span class="op" id="4773409">.</span><span class="ident" id="4773410">tag</span>&nbsp;<span class="op" id="4773414">!=</span>&nbsp;<span class="ident" id="4773417"><a href="/encoding/json/encode.go.html#4773219">x</a></span><span class="op" id="4773418">[</span><span class="ident" id="4773419"><a href="/encoding/json/encode.go.html#4773237">j</a></span><span class="op" id="4773420">]</span><span class="op" id="4773421">.</span><span class="ident" id="4773422">tag</span>&nbsp;<span class="op" id="4773426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4773430">return</span>&nbsp;<span class="ident" id="4773437"><a href="/encoding/json/encode.go.html#4773219">x</a></span><span class="op" id="4773438">[</span><span class="ident" id="4773439"><a href="/encoding/json/encode.go.html#4773234">i</a></span><span class="op" id="4773440">]</span><span class="op" id="4773441">.</span><span class="ident" id="4773442">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4773447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4773450">return</span>&nbsp;<span class="ident" id="4773457"><a href="/encoding/json/encode.go.html#4773529">byIndex</a></span><span class="op" id="4773464">(</span><span class="ident" id="4773465"><a href="/encoding/json/encode.go.html#4773219">x</a></span><span class="op" id="4773466">)</span><span class="op" id="4773467">.</span><span class="ident" id="4773468">Less</span><span class="op" id="4773472">(</span><span class="ident" id="4773473"><a href="/encoding/json/encode.go.html#4773234">i</a></span><span class="op" id="4773474">,</span>&nbsp;<span class="ident" id="4773476"><a href="/encoding/json/encode.go.html#4773237">j</a></span><span class="op" id="4773477">)</span><br>
<span class="lineno">975</span><span class="op" id="4773479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4773482">//&nbsp;byIndex&nbsp;sorts&nbsp;field&nbsp;by&nbsp;index&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="keyword" id="4773524">type</span>&nbsp;<span class="ident" id="4773529">byIndex</span>&nbsp;<span class="op" id="4773537">[</span><span class="op" id="4773538">]</span><span class="ident" id="4773539"><a href="/encoding/json/encode.go.html#4772578">field</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">980</span><span class="keyword" id="4773546">func</span>&nbsp;<span class="op" id="4773551">(</span><span class="ident" id="4773552">x</span>&nbsp;<span class="ident" id="4773554"><a href="/encoding/json/encode.go.html#4773529">byIndex</a></span><span class="op" id="4773561">)</span>&nbsp;<span class="ident" id="4773563">Len</span><span class="op" id="4773566">(</span><span class="op" id="4773567">)</span>&nbsp;<span class="builtintype" id="4773569">int</span>&nbsp;<span class="op" id="4773573">{</span>&nbsp;<span class="keyword" id="4773575">return</span>&nbsp;<span class="builtinfunc" id="4773582">len</span><span class="op" id="4773585">(</span><span class="ident" id="4773586"><a href="/encoding/json/encode.go.html#4773552">x</a></span><span class="op" id="4773587">)</span>&nbsp;<span class="op" id="4773589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4773592">func</span>&nbsp;<span class="op" id="4773597">(</span><span class="ident" id="4773598">x</span>&nbsp;<span class="ident" id="4773600"><a href="/encoding/json/encode.go.html#4773529">byIndex</a></span><span class="op" id="4773607">)</span>&nbsp;<span class="ident" id="4773609">Swap</span><span class="op" id="4773613">(</span><span class="ident" id="4773614">i</span><span class="op" id="4773615">,</span>&nbsp;<span class="ident" id="4773617">j</span>&nbsp;<span class="builtintype" id="4773619">int</span><span class="op" id="4773622">)</span>&nbsp;<span class="op" id="4773624">{</span>&nbsp;<span class="ident" id="4773626"><a href="/encoding/json/encode.go.html#4773598">x</a></span><span class="op" id="4773627">[</span><span class="ident" id="4773628"><a href="/encoding/json/encode.go.html#4773614">i</a></span><span class="op" id="4773629">]</span><span class="op" id="4773630">,</span>&nbsp;<span class="ident" id="4773632"><a href="/encoding/json/encode.go.html#4773598">x</a></span><span class="op" id="4773633">[</span><span class="ident" id="4773634"><a href="/encoding/json/encode.go.html#4773617">j</a></span><span class="op" id="4773635">]</span>&nbsp;<span class="op" id="4773637">=</span>&nbsp;<span class="ident" id="4773639"><a href="/encoding/json/encode.go.html#4773598">x</a></span><span class="op" id="4773640">[</span><span class="ident" id="4773641"><a href="/encoding/json/encode.go.html#4773617">j</a></span><span class="op" id="4773642">]</span><span class="op" id="4773643">,</span>&nbsp;<span class="ident" id="4773645"><a href="/encoding/json/encode.go.html#4773598">x</a></span><span class="op" id="4773646">[</span><span class="ident" id="4773647"><a href="/encoding/json/encode.go.html#4773614">i</a></span><span class="op" id="4773648">]</span>&nbsp;<span class="op" id="4773650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4773653">func</span>&nbsp;<span class="op" id="4773658">(</span><span class="ident" id="4773659">x</span>&nbsp;<span class="ident" id="4773661"><a href="/encoding/json/encode.go.html#4773529">byIndex</a></span><span class="op" id="4773668">)</span>&nbsp;<span class="ident" id="4773670">Less</span><span class="op" id="4773674">(</span><span class="ident" id="4773675">i</span><span class="op" id="4773676">,</span>&nbsp;<span class="ident" id="4773678">j</span>&nbsp;<span class="builtintype" id="4773680">int</span><span class="op" id="4773683">)</span>&nbsp;<span class="builtintype" id="4773685">bool</span>&nbsp;<span class="op" id="4773690">{</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4773693">for</span>&nbsp;<span class="ident" id="4773697">k</span><span class="op" id="4773698">,</span>&nbsp;<span class="ident" id="4773700">xik</span>&nbsp;<span class="op" id="4773704">:=</span>&nbsp;<span class="keyword" id="4773707">range</span>&nbsp;<span class="ident" id="4773713"><a href="/encoding/json/encode.go.html#4773659">x</a></span><span class="op" id="4773714">[</span><span class="ident" id="4773715"><a href="/encoding/json/encode.go.html#4773675">i</a></span><span class="op" id="4773716">]</span><span class="op" id="4773717">.</span><span class="ident" id="4773718">index</span>&nbsp;<span class="op" id="4773724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4773728">if</span>&nbsp;<span class="ident" id="4773731"><a href="/encoding/json/encode.go.html#4773697">k</a></span>&nbsp;<span class="op" id="4773733">&gt;=</span>&nbsp;<span class="builtinfunc" id="4773736">len</span><span class="op" id="4773739">(</span><span class="ident" id="4773740"><a href="/encoding/json/encode.go.html#4773659">x</a></span><span class="op" id="4773741">[</span><span class="ident" id="4773742"><a href="/encoding/json/encode.go.html#4773678">j</a></span><span class="op" id="4773743">]</span><span class="op" id="4773744">.</span><span class="ident" id="4773745">index</span><span class="op" id="4773750">)</span>&nbsp;<span class="op" id="4773752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4773757">return</span>&nbsp;<span class="builtintype" id="4773764">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4773772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4773776">if</span>&nbsp;<span class="ident" id="4773779"><a href="/encoding/json/encode.go.html#4773700">xik</a></span>&nbsp;<span class="op" id="4773783">!=</span>&nbsp;<span class="ident" id="4773786"><a href="/encoding/json/encode.go.html#4773659">x</a></span><span class="op" id="4773787">[</span><span class="ident" id="4773788"><a href="/encoding/json/encode.go.html#4773678">j</a></span><span class="op" id="4773789">]</span><span class="op" id="4773790">.</span><span class="ident" id="4773791">index</span><span class="op" id="4773796">[</span><span class="ident" id="4773797"><a href="/encoding/json/encode.go.html#4773697">k</a></span><span class="op" id="4773798">]</span>&nbsp;<span class="op" id="4773800">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4773805">return</span>&nbsp;<span class="ident" id="4773812"><a href="/encoding/json/encode.go.html#4773700">xik</a></span>&nbsp;<span class="op" id="4773816">&lt;</span>&nbsp;<span class="ident" id="4773818"><a href="/encoding/json/encode.go.html#4773659">x</a></span><span class="op" id="4773819">[</span><span class="ident" id="4773820"><a href="/encoding/json/encode.go.html#4773678">j</a></span><span class="op" id="4773821">]</span><span class="op" id="4773822">.</span><span class="ident" id="4773823">index</span><span class="op" id="4773828">[</span><span class="ident" id="4773829"><a href="/encoding/json/encode.go.html#4773697">k</a></span><span class="op" id="4773830">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4773834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4773837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4773840">return</span>&nbsp;<span class="builtinfunc" id="4773847">len</span><span class="op" id="4773850">(</span><span class="ident" id="4773851"><a href="/encoding/json/encode.go.html#4773659">x</a></span><span class="op" id="4773852">[</span><span class="ident" id="4773853"><a href="/encoding/json/encode.go.html#4773675">i</a></span><span class="op" id="4773854">]</span><span class="op" id="4773855">.</span><span class="ident" id="4773856">index</span><span class="op" id="4773861">)</span>&nbsp;<span class="op" id="4773863">&lt;</span>&nbsp;<span class="builtinfunc" id="4773865">len</span><span class="op" id="4773868">(</span><span class="ident" id="4773869"><a href="/encoding/json/encode.go.html#4773659">x</a></span><span class="op" id="4773870">[</span><span class="ident" id="4773871"><a href="/encoding/json/encode.go.html#4773678">j</a></span><span class="op" id="4773872">]</span><span class="op" id="4773873">.</span><span class="ident" id="4773874">index</span><span class="op" id="4773879">)</span><br>
<span class="lineno"></span><span class="op" id="4773881">}</span><br>
<span class="lineno">995</span><br>
<span class="lineno"></span><span class="comment" id="4773884">//&nbsp;typeFields&nbsp;returns&nbsp;a&nbsp;list&nbsp;of&nbsp;fields&nbsp;that&nbsp;JSON&nbsp;should&nbsp;recognize&nbsp;for&nbsp;the&nbsp;given&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4773970">//&nbsp;The&nbsp;algorithm&nbsp;is&nbsp;breadth-first&nbsp;search&nbsp;over&nbsp;the&nbsp;set&nbsp;of&nbsp;structs&nbsp;to&nbsp;include&nbsp;-&nbsp;the&nbsp;top&nbsp;struct</span><br>
<span class="lineno"></span><span class="comment" id="4774063">//&nbsp;and&nbsp;then&nbsp;any&nbsp;reachable&nbsp;anonymous&nbsp;structs.</span><br>
<span class="lineno"></span><span class="keyword" id="4774108">func</span>&nbsp;<span class="ident" id="4774113">typeFields</span><span class="op" id="4774123">(</span><span class="ident" id="4774124">t</span>&nbsp;<span class="ident" id="4774126"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4774133">.</span><span class="ident" id="4774134">Type</span><span class="op" id="4774138">)</span>&nbsp;<span class="op" id="4774140">[</span><span class="op" id="4774141">]</span><span class="ident" id="4774142"><a href="/encoding/json/encode.go.html#4772578">field</a></span>&nbsp;<span class="op" id="4774148">{</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4774151">//&nbsp;Anonymous&nbsp;fields&nbsp;to&nbsp;explore&nbsp;at&nbsp;the&nbsp;current&nbsp;level&nbsp;and&nbsp;the&nbsp;next.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4774218">current</span>&nbsp;<span class="op" id="4774226">:=</span>&nbsp;<span class="op" id="4774229">[</span><span class="op" id="4774230">]</span><span class="ident" id="4774231"><a href="/encoding/json/encode.go.html#4772578">field</a></span><span class="op" id="4774236">{</span><span class="op" id="4774237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4774240">next</span>&nbsp;<span class="op" id="4774245">:=</span>&nbsp;<span class="op" id="4774248">[</span><span class="op" id="4774249">]</span><span class="ident" id="4774250"><a href="/encoding/json/encode.go.html#4772578">field</a></span><span class="op" id="4774255">{</span><span class="op" id="4774256">{</span><span class="ident" id="4774257">typ</span><span class="op" id="4774260">:</span>&nbsp;<span class="ident" id="4774262"><a href="/encoding/json/encode.go.html#4774124">t</a></span><span class="op" id="4774263">}</span><span class="op" id="4774264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4774268">//&nbsp;Count&nbsp;of&nbsp;queued&nbsp;names&nbsp;for&nbsp;current&nbsp;level&nbsp;and&nbsp;the&nbsp;next.</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4774326">count</span>&nbsp;<span class="op" id="4774332">:=</span>&nbsp;<span class="keyword" id="4774335">map</span><span class="op" id="4774338">[</span><span class="ident" id="4774339"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4774346">.</span><span class="ident" id="4774347">Type</span><span class="op" id="4774351">]</span><span class="builtintype" id="4774352">int</span><span class="op" id="4774355">{</span><span class="op" id="4774356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4774359">nextCount</span>&nbsp;<span class="op" id="4774369">:=</span>&nbsp;<span class="keyword" id="4774372">map</span><span class="op" id="4774375">[</span><span class="ident" id="4774376"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4774383">.</span><span class="ident" id="4774384">Type</span><span class="op" id="4774388">]</span><span class="builtintype" id="4774389">int</span><span class="op" id="4774392">{</span><span class="op" id="4774393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4774397">//&nbsp;Types&nbsp;already&nbsp;visited&nbsp;at&nbsp;an&nbsp;earlier&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4774444">visited</span>&nbsp;<span class="op" id="4774452">:=</span>&nbsp;<span class="keyword" id="4774455">map</span><span class="op" id="4774458">[</span><span class="ident" id="4774459"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4774466">.</span><span class="ident" id="4774467">Type</span><span class="op" id="4774471">]</span><span class="builtintype" id="4774472">bool</span><span class="op" id="4774476">{</span><span class="op" id="4774477">}</span><br>
<span class="lineno">1010</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4774481">//&nbsp;Fields&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774499">var</span>&nbsp;<span class="ident" id="4774503">fields</span>&nbsp;<span class="op" id="4774510">[</span><span class="op" id="4774511">]</span><span class="ident" id="4774512"><a href="/encoding/json/encode.go.html#4772578">field</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774520">for</span>&nbsp;<span class="builtinfunc" id="4774524">len</span><span class="op" id="4774527">(</span><span class="ident" id="4774528"><a href="/encoding/json/encode.go.html#4774240">next</a></span><span class="op" id="4774532">)</span>&nbsp;<span class="op" id="4774534">&gt;</span>&nbsp;<span class="num" id="4774536">0</span>&nbsp;<span class="op" id="4774538">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4774542"><a href="/encoding/json/encode.go.html#4774218">current</a></span><span class="op" id="4774549">,</span>&nbsp;<span class="ident" id="4774551"><a href="/encoding/json/encode.go.html#4774240">next</a></span>&nbsp;<span class="op" id="4774556">=</span>&nbsp;<span class="ident" id="4774558"><a href="/encoding/json/encode.go.html#4774240">next</a></span><span class="op" id="4774562">,</span>&nbsp;<span class="ident" id="4774564"><a href="/encoding/json/encode.go.html#4774218">current</a></span><span class="op" id="4774571">[</span><span class="op" id="4774572">:</span><span class="num" id="4774573">0</span><span class="op" id="4774574">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4774578"><a href="/encoding/json/encode.go.html#4774326">count</a></span><span class="op" id="4774583">,</span>&nbsp;<span class="ident" id="4774585"><a href="/encoding/json/encode.go.html#4774359">nextCount</a></span>&nbsp;<span class="op" id="4774595">=</span>&nbsp;<span class="ident" id="4774597"><a href="/encoding/json/encode.go.html#4774359">nextCount</a></span><span class="op" id="4774606">,</span>&nbsp;<span class="keyword" id="4774608">map</span><span class="op" id="4774611">[</span><span class="ident" id="4774612"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4774619">.</span><span class="ident" id="4774620">Type</span><span class="op" id="4774624">]</span><span class="builtintype" id="4774625">int</span><span class="op" id="4774628">{</span><span class="op" id="4774629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774634">for</span>&nbsp;<span class="ident" id="4774638">_</span><span class="op" id="4774639">,</span>&nbsp;<span class="ident" id="4774641">f</span>&nbsp;<span class="op" id="4774643">:=</span>&nbsp;<span class="keyword" id="4774646">range</span>&nbsp;<span class="ident" id="4774652"><a href="/encoding/json/encode.go.html#4774218">current</a></span>&nbsp;<span class="op" id="4774660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774665">if</span>&nbsp;<span class="ident" id="4774668"><a href="/encoding/json/encode.go.html#4774444">visited</a></span><span class="op" id="4774675">[</span><span class="ident" id="4774676"><a href="/encoding/json/encode.go.html#4774641">f</a></span><span class="op" id="4774677">.</span><span class="ident" id="4774678">typ</span><span class="op" id="4774681">]</span>&nbsp;<span class="op" id="4774683">{</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774689">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4774701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4774706"><a href="/encoding/json/encode.go.html#4774444">visited</a></span><span class="op" id="4774713">[</span><span class="ident" id="4774714"><a href="/encoding/json/encode.go.html#4774641">f</a></span><span class="op" id="4774715">.</span><span class="ident" id="4774716">typ</span><span class="op" id="4774719">]</span>&nbsp;<span class="op" id="4774721">=</span>&nbsp;<span class="builtintype" id="4774723">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4774732">//&nbsp;Scan&nbsp;f.typ&nbsp;for&nbsp;fields&nbsp;to&nbsp;include.</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774772">for</span>&nbsp;<span class="ident" id="4774776">i</span>&nbsp;<span class="op" id="4774778">:=</span>&nbsp;<span class="num" id="4774781">0</span><span class="op" id="4774782">;</span>&nbsp;<span class="ident" id="4774784"><a href="/encoding/json/encode.go.html#4774776">i</a></span>&nbsp;<span class="op" id="4774786">&lt;</span>&nbsp;<span class="ident" id="4774788"><a href="/encoding/json/encode.go.html#4774641">f</a></span><span class="op" id="4774789">.</span><span class="ident" id="4774790">typ</span><span class="op" id="4774793">.</span><span class="ident" id="4774794">NumField</span><span class="op" id="4774802">(</span><span class="op" id="4774803">)</span><span class="op" id="4774804">;</span>&nbsp;<span class="ident" id="4774806"><a href="/encoding/json/encode.go.html#4774776">i</a></span><span class="op" id="4774807">++</span>&nbsp;<span class="op" id="4774810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4774816">sf</span>&nbsp;<span class="op" id="4774819">:=</span>&nbsp;<span class="ident" id="4774822"><a href="/encoding/json/encode.go.html#4774641">f</a></span><span class="op" id="4774823">.</span><span class="ident" id="4774824">typ</span><span class="op" id="4774827">.</span><span class="ident" id="4774828">Field</span><span class="op" id="4774833">(</span><span class="ident" id="4774834"><a href="/encoding/json/encode.go.html#4774776">i</a></span><span class="op" id="4774835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774841">if</span>&nbsp;<span class="ident" id="4774844"><a href="/encoding/json/encode.go.html#4774816">sf</a></span><span class="op" id="4774846">.</span><span class="ident" id="4774847">PkgPath</span>&nbsp;<span class="op" id="4774855">!=</span>&nbsp;<span class="string" id="4774858">&#34;&#34;</span>&nbsp;<span class="op" id="4774861">{</span>&nbsp;<span class="comment" id="4774863">//&nbsp;unexported</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774882">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4774895">}</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4774901">tag</span>&nbsp;<span class="op" id="4774905">:=</span>&nbsp;<span class="ident" id="4774908"><a href="/encoding/json/encode.go.html#4774816">sf</a></span><span class="op" id="4774910">.</span><span class="ident" id="4774911">Tag</span><span class="op" id="4774914">.</span><span class="ident" id="4774915">Get</span><span class="op" id="4774918">(</span><span class="string" id="4774919">&#34;json&#34;</span><span class="op" id="4774925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774931">if</span>&nbsp;<span class="ident" id="4774934"><a href="/encoding/json/encode.go.html#4774901">tag</a></span>&nbsp;<span class="op" id="4774938">==</span>&nbsp;<span class="string" id="4774941">&#34;-&#34;</span>&nbsp;<span class="op" id="4774945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4774952">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4774965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4774971">name</span><span class="op" id="4774975">,</span>&nbsp;<span class="ident" id="4774977">opts</span>&nbsp;<span class="op" id="4774982">:=</span>&nbsp;<span class="ident" id="4774985"><a href="/encoding/json/tags.go.html#4807658">parseTag</a></span><span class="op" id="4774993">(</span><span class="ident" id="4774994"><a href="/encoding/json/encode.go.html#4774901">tag</a></span><span class="op" id="4774997">)</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775003">if</span>&nbsp;<span class="op" id="4775006">!</span><span class="ident" id="4775007"><a href="/encoding/json/encode.go.html#4767542">isValidTag</a></span><span class="op" id="4775017">(</span><span class="ident" id="4775018"><a href="/encoding/json/encode.go.html#4774971">name</a></span><span class="op" id="4775022">)</span>&nbsp;<span class="op" id="4775024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4775031"><a href="/encoding/json/encode.go.html#4774971">name</a></span>&nbsp;<span class="op" id="4775036">=</span>&nbsp;<span class="string" id="4775038">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4775045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4775051">index</span>&nbsp;<span class="op" id="4775057">:=</span>&nbsp;<span class="builtinfunc" id="4775060">make</span><span class="op" id="4775064">(</span><span class="op" id="4775065">[</span><span class="op" id="4775066">]</span><span class="builtintype" id="4775067">int</span><span class="op" id="4775070">,</span>&nbsp;<span class="builtinfunc" id="4775072">len</span><span class="op" id="4775075">(</span><span class="ident" id="4775076"><a href="/encoding/json/encode.go.html#4774641">f</a></span><span class="op" id="4775077">.</span><span class="ident" id="4775078">index</span><span class="op" id="4775083">)</span><span class="op" id="4775084">+</span><span class="num" id="4775085">1</span><span class="op" id="4775086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4775092">copy</span><span class="op" id="4775096">(</span><span class="ident" id="4775097"><a href="/encoding/json/encode.go.html#4775051">index</a></span><span class="op" id="4775102">,</span>&nbsp;<span class="ident" id="4775104"><a href="/encoding/json/encode.go.html#4774641">f</a></span><span class="op" id="4775105">.</span><span class="ident" id="4775106">index</span><span class="op" id="4775111">)</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4775117"><a href="/encoding/json/encode.go.html#4775051">index</a></span><span class="op" id="4775122">[</span><span class="builtinfunc" id="4775123">len</span><span class="op" id="4775126">(</span><span class="ident" id="4775127"><a href="/encoding/json/encode.go.html#4774641">f</a></span><span class="op" id="4775128">.</span><span class="ident" id="4775129">index</span><span class="op" id="4775134">)</span><span class="op" id="4775135">]</span>&nbsp;<span class="op" id="4775137">=</span>&nbsp;<span class="ident" id="4775139"><a href="/encoding/json/encode.go.html#4774776">i</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4775146">ft</span>&nbsp;<span class="op" id="4775149">:=</span>&nbsp;<span class="ident" id="4775152"><a href="/encoding/json/encode.go.html#4774816">sf</a></span><span class="op" id="4775154">.</span><span class="ident" id="4775155">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775164">if</span>&nbsp;<span class="ident" id="4775167"><a href="/encoding/json/encode.go.html#4775146">ft</a></span><span class="op" id="4775169">.</span><span class="ident" id="4775170">Name</span><span class="op" id="4775174">(</span><span class="op" id="4775175">)</span>&nbsp;<span class="op" id="4775177">==</span>&nbsp;<span class="string" id="4775180">&#34;&#34;</span>&nbsp;<span class="op" id="4775183">&amp;&amp;</span>&nbsp;<span class="ident" id="4775186"><a href="/encoding/json/encode.go.html#4775146">ft</a></span><span class="op" id="4775188">.</span><span class="ident" id="4775189">Kind</span><span class="op" id="4775193">(</span><span class="op" id="4775194">)</span>&nbsp;<span class="op" id="4775196">==</span>&nbsp;<span class="ident" id="4775199"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4775206">.</span><span class="ident" id="4775207">Ptr</span>&nbsp;<span class="op" id="4775211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4775218">//&nbsp;Follow&nbsp;pointer.</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4775242"><a href="/encoding/json/encode.go.html#4775146">ft</a></span>&nbsp;<span class="op" id="4775245">=</span>&nbsp;<span class="ident" id="4775247"><a href="/encoding/json/encode.go.html#4775146">ft</a></span><span class="op" id="4775249">.</span><span class="ident" id="4775250">Elem</span><span class="op" id="4775254">(</span><span class="op" id="4775255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4775261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4775268">//&nbsp;Record&nbsp;found&nbsp;field&nbsp;and&nbsp;index&nbsp;sequence.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775314">if</span>&nbsp;<span class="ident" id="4775317"><a href="/encoding/json/encode.go.html#4774971">name</a></span>&nbsp;<span class="op" id="4775322">!=</span>&nbsp;<span class="string" id="4775325">&#34;&#34;</span>&nbsp;<span class="op" id="4775328">||</span>&nbsp;<span class="op" id="4775331">!</span><span class="ident" id="4775332"><a href="/encoding/json/encode.go.html#4774816">sf</a></span><span class="op" id="4775334">.</span><span class="ident" id="4775335">Anonymous</span>&nbsp;<span class="op" id="4775345">||</span>&nbsp;<span class="ident" id="4775348"><a href="/encoding/json/encode.go.html#4775146">ft</a></span><span class="op" id="4775350">.</span><span class="ident" id="4775351">Kind</span><span class="op" id="4775355">(</span><span class="op" id="4775356">)</span>&nbsp;<span class="op" id="4775358">!=</span>&nbsp;<span class="ident" id="4775361"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4775368">.</span><span class="ident" id="4775369">Struct</span>&nbsp;<span class="op" id="4775376">{</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4775383">tagged</span>&nbsp;<span class="op" id="4775390">:=</span>&nbsp;<span class="ident" id="4775393"><a href="/encoding/json/encode.go.html#4774971">name</a></span>&nbsp;<span class="op" id="4775398">!=</span>&nbsp;<span class="string" id="4775401">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775409">if</span>&nbsp;<span class="ident" id="4775412"><a href="/encoding/json/encode.go.html#4774971">name</a></span>&nbsp;<span class="op" id="4775417">==</span>&nbsp;<span class="string" id="4775420">&#34;&#34;</span>&nbsp;<span class="op" id="4775423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4775431"><a href="/encoding/json/encode.go.html#4774971">name</a></span>&nbsp;<span class="op" id="4775436">=</span>&nbsp;<span class="ident" id="4775438"><a href="/encoding/json/encode.go.html#4774816">sf</a></span><span class="op" id="4775440">.</span><span class="ident" id="4775441">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4775451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4775458"><a href="/encoding/json/encode.go.html#4774503">fields</a></span>&nbsp;<span class="op" id="4775465">=</span>&nbsp;<span class="builtinfunc" id="4775467">append</span><span class="op" id="4775473">(</span><span class="ident" id="4775474"><a href="/encoding/json/encode.go.html#4774503">fields</a></span><span class="op" id="4775480">,</span>&nbsp;<span class="ident" id="4775482"><a href="/encoding/json/encode.go.html#4772826">fillField</a></span><span class="op" id="4775491">(</span><span class="ident" id="4775492"><a href="/encoding/json/encode.go.html#4772578">field</a></span><span class="op" id="4775497">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4775505">name</span><span class="op" id="4775509">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4775516"><a href="/encoding/json/encode.go.html#4774971">name</a></span><span class="op" id="4775520">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4775528">tag</span><span class="op" id="4775531">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4775539"><a href="/encoding/json/encode.go.html#4775383">tagged</a></span><span class="op" id="4775545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4775553">index</span><span class="op" id="4775558">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4775564"><a href="/encoding/json/encode.go.html#4775051">index</a></span><span class="op" id="4775569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4775577">typ</span><span class="op" id="4775580">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4775588"><a href="/encoding/json/encode.go.html#4775146">ft</a></span><span class="op" id="4775590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4775598">omitEmpty</span><span class="op" id="4775607">:</span>&nbsp;<span class="ident" id="4775609"><a href="/encoding/json/encode.go.html#4774977">opts</a></span><span class="op" id="4775613">.</span><span class="ident" id="4775614">Contains</span><span class="op" id="4775622">(</span><span class="string" id="4775623">&#34;omitempty&#34;</span><span class="op" id="4775634">)</span><span class="op" id="4775635">,</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4775643">quoted</span><span class="op" id="4775649">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4775654"><a href="/encoding/json/encode.go.html#4774977">opts</a></span><span class="op" id="4775658">.</span><span class="ident" id="4775659">Contains</span><span class="op" id="4775667">(</span><span class="string" id="4775668">&#34;string&#34;</span><span class="op" id="4775676">)</span><span class="op" id="4775677">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4775684">}</span><span class="op" id="4775685">)</span><span class="op" id="4775686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4775693">if</span>&nbsp;<span class="ident" id="4775696"><a href="/encoding/json/encode.go.html#4774326">count</a></span><span class="op" id="4775701">[</span><span class="ident" id="4775702"><a href="/encoding/json/encode.go.html#4774641">f</a></span><span class="op" id="4775703">.</span><span class="ident" id="4775704">typ</span><span class="op" id="4775707">]</span>&nbsp;<span class="op" id="4775709">&gt;</span>&nbsp;<span class="num" id="4775711">1</span>&nbsp;<span class="op" id="4775713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4775721">//&nbsp;If&nbsp;there&nbsp;were&nbsp;multiple&nbsp;instances,&nbsp;add&nbsp;a&nbsp;second,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4775778">//&nbsp;so&nbsp;that&nbsp;the&nbsp;annihilation&nbsp;code&nbsp;will&nbsp;see&nbsp;a&nbsp;duplicate.</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4775839">//&nbsp;It&nbsp;only&nbsp;cares&nbsp;about&nbsp;the&nbsp;distinction&nbsp;between&nbsp;1&nbsp;or&nbsp;2,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4775900">//&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;generating&nbsp;any&nbsp;more&nbsp;copies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4775953"><a href="/encoding/json/encode.go.html#4774503">fields</a></span>&nbsp;<span class="op" id="4775960">=</span>&nbsp;<span class="builtinfunc" id="4775962">append</span><span class="op" id="4775968">(</span><span class="ident" id="4775969"><a href="/encoding/json/encode.go.html#4774503">fields</a></span><span class="op" id="4775975">,</span>&nbsp;<span class="ident" id="4775977"><a href="/encoding/json/encode.go.html#4774503">fields</a></span><span class="op" id="4775983">[</span><span class="builtinfunc" id="4775984">len</span><span class="op" id="4775987">(</span><span class="ident" id="4775988"><a href="/encoding/json/encode.go.html#4774503">fields</a></span><span class="op" id="4775994">)</span><span class="op" id="4775995">-</span><span class="num" id="4775996">1</span><span class="op" id="4775997">]</span><span class="op" id="4775998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4776005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4776012">continue</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4776025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4776032">//&nbsp;Record&nbsp;new&nbsp;anonymous&nbsp;struct&nbsp;to&nbsp;explore&nbsp;in&nbsp;next&nbsp;round.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4776093"><a href="/encoding/json/encode.go.html#4774359">nextCount</a></span><span class="op" id="4776102">[</span><span class="ident" id="4776103"><a href="/encoding/json/encode.go.html#4775146">ft</a></span><span class="op" id="4776105">]</span><span class="op" id="4776106">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4776113">if</span>&nbsp;<span class="ident" id="4776116"><a href="/encoding/json/encode.go.html#4774359">nextCount</a></span><span class="op" id="4776125">[</span><span class="ident" id="4776126"><a href="/encoding/json/encode.go.html#4775146">ft</a></span><span class="op" id="4776128">]</span>&nbsp;<span class="op" id="4776130">==</span>&nbsp;<span class="num" id="4776133">1</span>&nbsp;<span class="op" id="4776135">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4776142"><a href="/encoding/json/encode.go.html#4774240">next</a></span>&nbsp;<span class="op" id="4776147">=</span>&nbsp;<span class="builtinfunc" id="4776149">append</span><span class="op" id="4776155">(</span><span class="ident" id="4776156"><a href="/encoding/json/encode.go.html#4774240">next</a></span><span class="op" id="4776160">,</span>&nbsp;<span class="ident" id="4776162"><a href="/encoding/json/encode.go.html#4772826">fillField</a></span><span class="op" id="4776171">(</span><span class="ident" id="4776172"><a href="/encoding/json/encode.go.html#4772578">field</a></span><span class="op" id="4776177">{</span><span class="ident" id="4776178">name</span><span class="op" id="4776182">:</span>&nbsp;<span class="ident" id="4776184"><a href="/encoding/json/encode.go.html#4775146">ft</a></span><span class="op" id="4776186">.</span><span class="ident" id="4776187">Name</span><span class="op" id="4776191">(</span><span class="op" id="4776192">)</span><span class="op" id="4776193">,</span>&nbsp;<span class="ident" id="4776195">index</span><span class="op" id="4776200">:</span>&nbsp;<span class="ident" id="4776202"><a href="/encoding/json/encode.go.html#4775051">index</a></span><span class="op" id="4776207">,</span>&nbsp;<span class="ident" id="4776209">typ</span><span class="op" id="4776212">:</span>&nbsp;<span class="ident" id="4776214"><a href="/encoding/json/encode.go.html#4775146">ft</a></span><span class="op" id="4776216">}</span><span class="op" id="4776217">)</span><span class="op" id="4776218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4776224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4776229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4776233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4776236">}</span><br>
<span class="lineno">1080</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4776240"><a href="/encoding/json/encode.go.html#4748689">sort</a></span><span class="op" id="4776244">.</span><span class="ident" id="4776245">Sort</span><span class="op" id="4776249">(</span><span class="ident" id="4776250"><a href="/encoding/json/encode.go.html#4773092">byName</a></span><span class="op" id="4776256">(</span><span class="ident" id="4776257"><a href="/encoding/json/encode.go.html#4774503">fields</a></span><span class="op" id="4776263">)</span><span class="op" id="4776264">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4776268">//&nbsp;Delete&nbsp;all&nbsp;fields&nbsp;that&nbsp;are&nbsp;hidden&nbsp;by&nbsp;the&nbsp;Go&nbsp;rules&nbsp;for&nbsp;embedded&nbsp;fields,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4776343">//&nbsp;except&nbsp;that&nbsp;fields&nbsp;with&nbsp;JSON&nbsp;tags&nbsp;are&nbsp;promoted.</span><br>
<span class="lineno">1085</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4776396">//&nbsp;The&nbsp;fields&nbsp;are&nbsp;sorted&nbsp;in&nbsp;primary&nbsp;order&nbsp;of&nbsp;name,&nbsp;secondary&nbsp;order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4776464">//&nbsp;of&nbsp;field&nbsp;index&nbsp;length.&nbsp;Loop&nbsp;over&nbsp;names;&nbsp;for&nbsp;each&nbsp;name,&nbsp;delete</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4776530">//&nbsp;hidden&nbsp;fields&nbsp;by&nbsp;choosing&nbsp;the&nbsp;one&nbsp;dominant&nbsp;field&nbsp;that&nbsp;survives.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4776598">out</span>&nbsp;<span class="op" id="4776602">:=</span>&nbsp;<span class="ident" id="4776605"><a href="/encoding/json/encode.go.html#4774503">fields</a></span><span class="op" id="4776611">[</span><span class="op" id="4776612">:</span><span class="num" id="4776613">0</span><span class="op" id="4776614">]</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4776617">for</span>&nbsp;<span class="ident" id="4776621">advance</span><span class="op" id="4776628">,</span>&nbsp;<span class="ident" id="4776630">i</span>&nbsp;<span class="op" id="4776632">:=</span>&nbsp;<span class="num" id="4776635">0</span><span class="op" id="4776636">,</span>&nbsp;<span class="num" id="4776638">0</span><span class="op" id="4776639">;</span>&nbsp;<span class="ident" id="4776641"><a href="/encoding/json/encode.go.html#4776630">i</a></span>&nbsp;<span class="op" id="4776643">&lt;</span>&nbsp;<span class="builtinfunc" id="4776645">len</span><span class="op" id="4776648">(</span><span class="ident" id="4776649"><a href="/encoding/json/encode.go.html#4774503">fields</a></span><span class="op" id="4776655">)</span><span class="op" id="4776656">;</span>&nbsp;<span class="ident" id="4776658"><a href="/encoding/json/encode.go.html#4776630">i</a></span>&nbsp;<span class="op" id="4776660">+=</span>&nbsp;<span class="ident" id="4776663"><a href="/encoding/json/encode.go.html#4776621">advance</a></span>&nbsp;<span class="op" id="4776671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4776675">//&nbsp;One&nbsp;iteration&nbsp;per&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4776704">//&nbsp;Find&nbsp;the&nbsp;sequence&nbsp;of&nbsp;fields&nbsp;with&nbsp;the&nbsp;name&nbsp;of&nbsp;this&nbsp;first&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4776772">fi</span>&nbsp;<span class="op" id="4776775">:=</span>&nbsp;<span class="ident" id="4776778"><a href="/encoding/json/encode.go.html#4774503">fields</a></span><span class="op" id="4776784">[</span><span class="ident" id="4776785"><a href="/encoding/json/encode.go.html#4776630">i</a></span><span class="op" id="4776786">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4776790">name</span>&nbsp;<span class="op" id="4776795">:=</span>&nbsp;<span class="ident" id="4776798"><a href="/encoding/json/encode.go.html#4776772">fi</a></span><span class="op" id="4776800">.</span><span class="ident" id="4776801">name</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4776808">for</span>&nbsp;<span class="ident" id="4776812"><a href="/encoding/json/encode.go.html#4776621">advance</a></span>&nbsp;<span class="op" id="4776820">=</span>&nbsp;<span class="num" id="4776822">1</span><span class="op" id="4776823">;</span>&nbsp;<span class="ident" id="4776825"><a href="/encoding/json/encode.go.html#4776630">i</a></span><span class="op" id="4776826">+</span><span class="ident" id="4776827"><a href="/encoding/json/encode.go.html#4776621">advance</a></span>&nbsp;<span class="op" id="4776835">&lt;</span>&nbsp;<span class="builtinfunc" id="4776837">len</span><span class="op" id="4776840">(</span><span class="ident" id="4776841"><a href="/encoding/json/encode.go.html#4774503">fields</a></span><span class="op" id="4776847">)</span><span class="op" id="4776848">;</span>&nbsp;<span class="ident" id="4776850"><a href="/encoding/json/encode.go.html#4776621">advance</a></span><span class="op" id="4776857">++</span>&nbsp;<span class="op" id="4776860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4776865">fj</span>&nbsp;<span class="op" id="4776868">:=</span>&nbsp;<span class="ident" id="4776871"><a href="/encoding/json/encode.go.html#4774503">fields</a></span><span class="op" id="4776877">[</span><span class="ident" id="4776878"><a href="/encoding/json/encode.go.html#4776630">i</a></span><span class="op" id="4776879">+</span><span class="ident" id="4776880"><a href="/encoding/json/encode.go.html#4776621">advance</a></span><span class="op" id="4776887">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4776892">if</span>&nbsp;<span class="ident" id="4776895"><a href="/encoding/json/encode.go.html#4776865">fj</a></span><span class="op" id="4776897">.</span><span class="ident" id="4776898">name</span>&nbsp;<span class="op" id="4776903">!=</span>&nbsp;<span class="ident" id="4776906"><a href="/encoding/json/encode.go.html#4776790">name</a></span>&nbsp;<span class="op" id="4776911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4776917">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4776926">}</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4776930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4776934">if</span>&nbsp;<span class="ident" id="4776937"><a href="/encoding/json/encode.go.html#4776621">advance</a></span>&nbsp;<span class="op" id="4776945">==</span>&nbsp;<span class="num" id="4776948">1</span>&nbsp;<span class="op" id="4776950">{</span>&nbsp;<span class="comment" id="4776952">//&nbsp;Only&nbsp;one&nbsp;field&nbsp;with&nbsp;this&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4776988"><a href="/encoding/json/encode.go.html#4776598">out</a></span>&nbsp;<span class="op" id="4776992">=</span>&nbsp;<span class="builtinfunc" id="4776994">append</span><span class="op" id="4777000">(</span><span class="ident" id="4777001"><a href="/encoding/json/encode.go.html#4776598">out</a></span><span class="op" id="4777004">,</span>&nbsp;<span class="ident" id="4777006"><a href="/encoding/json/encode.go.html#4776772">fi</a></span><span class="op" id="4777008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4777013">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4777024">}</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4777028">dominant</span><span class="op" id="4777036">,</span>&nbsp;<span class="ident" id="4777038">ok</span>&nbsp;<span class="op" id="4777041">:=</span>&nbsp;<span class="ident" id="4777044"><a href="/encoding/json/encode.go.html#4777546">dominantField</a></span><span class="op" id="4777057">(</span><span class="ident" id="4777058"><a href="/encoding/json/encode.go.html#4774503">fields</a></span><span class="op" id="4777064">[</span><span class="ident" id="4777065"><a href="/encoding/json/encode.go.html#4776630">i</a></span>&nbsp;<span class="op" id="4777067">:</span>&nbsp;<span class="ident" id="4777069"><a href="/encoding/json/encode.go.html#4776630">i</a></span><span class="op" id="4777070">+</span><span class="ident" id="4777071"><a href="/encoding/json/encode.go.html#4776621">advance</a></span><span class="op" id="4777078">]</span><span class="op" id="4777079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4777083">if</span>&nbsp;<span class="ident" id="4777086"><a href="/encoding/json/encode.go.html#4777038">ok</a></span>&nbsp;<span class="op" id="4777089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4777094"><a href="/encoding/json/encode.go.html#4776598">out</a></span>&nbsp;<span class="op" id="4777098">=</span>&nbsp;<span class="builtinfunc" id="4777100">append</span><span class="op" id="4777106">(</span><span class="ident" id="4777107"><a href="/encoding/json/encode.go.html#4776598">out</a></span><span class="op" id="4777110">,</span>&nbsp;<span class="ident" id="4777112"><a href="/encoding/json/encode.go.html#4777028">dominant</a></span><span class="op" id="4777120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4777124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4777127">}</span><br>
<span class="lineno">1110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4777131"><a href="/encoding/json/encode.go.html#4774503">fields</a></span>&nbsp;<span class="op" id="4777138">=</span>&nbsp;<span class="ident" id="4777140"><a href="/encoding/json/encode.go.html#4776598">out</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4777145"><a href="/encoding/json/encode.go.html#4748689">sort</a></span><span class="op" id="4777149">.</span><span class="ident" id="4777150">Sort</span><span class="op" id="4777154">(</span><span class="ident" id="4777155"><a href="/encoding/json/encode.go.html#4773529">byIndex</a></span><span class="op" id="4777162">(</span><span class="ident" id="4777163"><a href="/encoding/json/encode.go.html#4774503">fields</a></span><span class="op" id="4777169">)</span><span class="op" id="4777170">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4777174">return</span>&nbsp;<span class="ident" id="4777181"><a href="/encoding/json/encode.go.html#4774503">fields</a></span><br>
<span class="lineno">1115</span><span class="op" id="4777188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4777191">//&nbsp;dominantField&nbsp;looks&nbsp;through&nbsp;the&nbsp;fields,&nbsp;all&nbsp;of&nbsp;which&nbsp;are&nbsp;known&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4777260">//&nbsp;have&nbsp;the&nbsp;same&nbsp;name,&nbsp;to&nbsp;find&nbsp;the&nbsp;single&nbsp;field&nbsp;that&nbsp;dominates&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4777327">//&nbsp;others&nbsp;using&nbsp;Go&#39;s&nbsp;embedding&nbsp;rules,&nbsp;modified&nbsp;by&nbsp;the&nbsp;presence&nbsp;of</span><br>
<span class="lineno">1120</span><span class="comment" id="4777393">//&nbsp;JSON&nbsp;tags.&nbsp;If&nbsp;there&nbsp;are&nbsp;multiple&nbsp;top-level&nbsp;fields,&nbsp;the&nbsp;boolean</span><br>
<span class="lineno"></span><span class="comment" id="4777459">//&nbsp;will&nbsp;be&nbsp;false:&nbsp;This&nbsp;condition&nbsp;is&nbsp;an&nbsp;error&nbsp;in&nbsp;Go&nbsp;and&nbsp;we&nbsp;skip&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="4777526">//&nbsp;the&nbsp;fields.</span><br>
<span class="lineno"></span><span class="keyword" id="4777541">func</span>&nbsp;<span class="ident" id="4777546">dominantField</span><span class="op" id="4777559">(</span><span class="ident" id="4777560">fields</span>&nbsp;<span class="op" id="4777567">[</span><span class="op" id="4777568">]</span><span class="ident" id="4777569"><a href="/encoding/json/encode.go.html#4772578">field</a></span><span class="op" id="4777574">)</span>&nbsp;<span class="op" id="4777576">(</span><span class="ident" id="4777577"><a href="/encoding/json/encode.go.html#4772578">field</a></span><span class="op" id="4777582">,</span>&nbsp;<span class="builtintype" id="4777584">bool</span><span class="op" id="4777588">)</span>&nbsp;<span class="op" id="4777590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4777593">//&nbsp;The&nbsp;fields&nbsp;are&nbsp;sorted&nbsp;in&nbsp;increasing&nbsp;index-length&nbsp;order.&nbsp;The&nbsp;winner</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4777664">//&nbsp;must&nbsp;therefore&nbsp;be&nbsp;one&nbsp;with&nbsp;the&nbsp;shortest&nbsp;index&nbsp;length.&nbsp;Drop&nbsp;all</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4777731">//&nbsp;longer&nbsp;entries,&nbsp;which&nbsp;is&nbsp;easy:&nbsp;just&nbsp;truncate&nbsp;the&nbsp;slice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4777791">length</span>&nbsp;<span class="op" id="4777798">:=</span>&nbsp;<span class="builtinfunc" id="4777801">len</span><span class="op" id="4777804">(</span><span class="ident" id="4777805"><a href="/encoding/json/encode.go.html#4777560">fields</a></span><span class="op" id="4777811">[</span><span class="num" id="4777812">0</span><span class="op" id="4777813">]</span><span class="op" id="4777814">.</span><span class="ident" id="4777815">index</span><span class="op" id="4777820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4777823">tagged</span>&nbsp;<span class="op" id="4777830">:=</span>&nbsp;<span class="op" id="4777833">-</span><span class="num" id="4777834">1</span>&nbsp;<span class="comment" id="4777836">//&nbsp;Index&nbsp;of&nbsp;first&nbsp;tagged&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4777869">for</span>&nbsp;<span class="ident" id="4777873">i</span><span class="op" id="4777874">,</span>&nbsp;<span class="ident" id="4777876">f</span>&nbsp;<span class="op" id="4777878">:=</span>&nbsp;<span class="keyword" id="4777881">range</span>&nbsp;<span class="ident" id="4777887"><a href="/encoding/json/encode.go.html#4777560">fields</a></span>&nbsp;<span class="op" id="4777894">{</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4777898">if</span>&nbsp;<span class="builtinfunc" id="4777901">len</span><span class="op" id="4777904">(</span><span class="ident" id="4777905"><a href="/encoding/json/encode.go.html#4777876">f</a></span><span class="op" id="4777906">.</span><span class="ident" id="4777907">index</span><span class="op" id="4777912">)</span>&nbsp;<span class="op" id="4777914">&gt;</span>&nbsp;<span class="ident" id="4777916"><a href="/encoding/json/encode.go.html#4777791">length</a></span>&nbsp;<span class="op" id="4777923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4777928"><a href="/encoding/json/encode.go.html#4777560">fields</a></span>&nbsp;<span class="op" id="4777935">=</span>&nbsp;<span class="ident" id="4777937"><a href="/encoding/json/encode.go.html#4777560">fields</a></span><span class="op" id="4777943">[</span><span class="op" id="4777944">:</span><span class="ident" id="4777945"><a href="/encoding/json/encode.go.html#4777873">i</a></span><span class="op" id="4777946">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4777951">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4777959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4777963">if</span>&nbsp;<span class="ident" id="4777966"><a href="/encoding/json/encode.go.html#4777876">f</a></span><span class="op" id="4777967">.</span><span class="ident" id="4777968">tag</span>&nbsp;<span class="op" id="4777972">{</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4777977">if</span>&nbsp;<span class="ident" id="4777980"><a href="/encoding/json/encode.go.html#4777823">tagged</a></span>&nbsp;<span class="op" id="4777987">&gt;=</span>&nbsp;<span class="num" id="4777990">0</span>&nbsp;<span class="op" id="4777992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4777998">//&nbsp;Multiple&nbsp;tagged&nbsp;fields&nbsp;at&nbsp;the&nbsp;same&nbsp;level:&nbsp;conflict.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4778057">//&nbsp;Return&nbsp;no&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4778081">return</span>&nbsp;<span class="ident" id="4778088"><a href="/encoding/json/encode.go.html#4772578">field</a></span><span class="op" id="4778093">{</span><span class="op" id="4778094">}</span><span class="op" id="4778095">,</span>&nbsp;<span class="builtintype" id="4778097">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4778106">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4778111"><a href="/encoding/json/encode.go.html#4777823">tagged</a></span>&nbsp;<span class="op" id="4778118">=</span>&nbsp;<span class="ident" id="4778120"><a href="/encoding/json/encode.go.html#4777873">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4778124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4778127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4778130">if</span>&nbsp;<span class="ident" id="4778133"><a href="/encoding/json/encode.go.html#4777823">tagged</a></span>&nbsp;<span class="op" id="4778140">&gt;=</span>&nbsp;<span class="num" id="4778143">0</span>&nbsp;<span class="op" id="4778145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4778149">return</span>&nbsp;<span class="ident" id="4778156"><a href="/encoding/json/encode.go.html#4777560">fields</a></span><span class="op" id="4778162">[</span><span class="ident" id="4778163"><a href="/encoding/json/encode.go.html#4777823">tagged</a></span><span class="op" id="4778169">]</span><span class="op" id="4778170">,</span>&nbsp;<span class="builtintype" id="4778172">true</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4778178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4778181">//&nbsp;All&nbsp;remaining&nbsp;fields&nbsp;have&nbsp;the&nbsp;same&nbsp;length.&nbsp;If&nbsp;there&#39;s&nbsp;more&nbsp;than&nbsp;one,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4778254">//&nbsp;we&nbsp;have&nbsp;a&nbsp;conflict&nbsp;(two&nbsp;fields&nbsp;named&nbsp;&#34;X&#34;&nbsp;at&nbsp;the&nbsp;same&nbsp;level)&nbsp;and&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4778325">//&nbsp;return&nbsp;no&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4778346">if</span>&nbsp;<span class="builtinfunc" id="4778349">len</span><span class="op" id="4778352">(</span><span class="ident" id="4778353"><a href="/encoding/json/encode.go.html#4777560">fields</a></span><span class="op" id="4778359">)</span>&nbsp;<span class="op" id="4778361">&gt;</span>&nbsp;<span class="num" id="4778363">1</span>&nbsp;<span class="op" id="4778365">{</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4778369">return</span>&nbsp;<span class="ident" id="4778376"><a href="/encoding/json/encode.go.html#4772578">field</a></span><span class="op" id="4778381">{</span><span class="op" id="4778382">}</span><span class="op" id="4778383">,</span>&nbsp;<span class="builtintype" id="4778385">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4778392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4778395">return</span>&nbsp;<span class="ident" id="4778402"><a href="/encoding/json/encode.go.html#4777560">fields</a></span><span class="op" id="4778408">[</span><span class="num" id="4778409">0</span><span class="op" id="4778410">]</span><span class="op" id="4778411">,</span>&nbsp;<span class="builtintype" id="4778413">true</span><br>
<span class="lineno"></span><span class="op" id="4778418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1155</span><span class="keyword" id="4778421">var</span>&nbsp;<span class="ident" id="4778425">fieldCache</span>&nbsp;<span class="keyword" id="4778436">struct</span>&nbsp;<span class="op" id="4778443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4778446"><a href="/encoding/json/encode.go.html#4748719">sync</a></span><span class="op" id="4778450">.</span><span class="ident" id="4778451">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4778460">m</span>&nbsp;<span class="keyword" id="4778462">map</span><span class="op" id="4778465">[</span><span class="ident" id="4778466"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4778473">.</span><span class="ident" id="4778474">Type</span><span class="op" id="4778478">]</span><span class="op" id="4778479">[</span><span class="op" id="4778480">]</span><span class="ident" id="4778481"><a href="/encoding/json/encode.go.html#4772578">field</a></span><br>
<span class="lineno"></span><span class="op" id="4778487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1160</span><span class="comment" id="4778490">//&nbsp;cachedTypeFields&nbsp;is&nbsp;like&nbsp;typeFields&nbsp;but&nbsp;uses&nbsp;a&nbsp;cache&nbsp;to&nbsp;avoid&nbsp;repeated&nbsp;work.</span><br>
<span class="lineno"></span><span class="keyword" id="4778570">func</span>&nbsp;<span class="ident" id="4778575">cachedTypeFields</span><span class="op" id="4778591">(</span><span class="ident" id="4778592">t</span>&nbsp;<span class="ident" id="4778594"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4778601">.</span><span class="ident" id="4778602">Type</span><span class="op" id="4778606">)</span>&nbsp;<span class="op" id="4778608">[</span><span class="op" id="4778609">]</span><span class="ident" id="4778610"><a href="/encoding/json/encode.go.html#4772578">field</a></span>&nbsp;<span class="op" id="4778616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4778619"><a href="/encoding/json/encode.go.html#4778425">fieldCache</a></span><span class="op" id="4778629">.</span><span class="ident" id="4778630">RLock</span><span class="op" id="4778635">(</span><span class="op" id="4778636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4778639">f</span>&nbsp;<span class="op" id="4778641">:=</span>&nbsp;<span class="ident" id="4778644"><a href="/encoding/json/encode.go.html#4778425">fieldCache</a></span><span class="op" id="4778654">.</span><span class="ident" id="4778655">m</span><span class="op" id="4778656">[</span><span class="ident" id="4778657"><a href="/encoding/json/encode.go.html#4778592">t</a></span><span class="op" id="4778658">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4778661"><a href="/encoding/json/encode.go.html#4778425">fieldCache</a></span><span class="op" id="4778671">.</span><span class="ident" id="4778672">RUnlock</span><span class="op" id="4778679">(</span><span class="op" id="4778680">)</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4778683">if</span>&nbsp;<span class="ident" id="4778686"><a href="/encoding/json/encode.go.html#4778639">f</a></span>&nbsp;<span class="op" id="4778688">!=</span>&nbsp;<span class="ident" id="4778691">nil</span>&nbsp;<span class="op" id="4778695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4778699">return</span>&nbsp;<span class="ident" id="4778706"><a href="/encoding/json/encode.go.html#4778639">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4778709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4778713">//&nbsp;Compute&nbsp;fields&nbsp;without&nbsp;lock.</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4778746">//&nbsp;Might&nbsp;duplicate&nbsp;effort&nbsp;but&nbsp;won&#39;t&nbsp;hold&nbsp;other&nbsp;computations&nbsp;back.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4778813"><a href="/encoding/json/encode.go.html#4778639">f</a></span>&nbsp;<span class="op" id="4778815">=</span>&nbsp;<span class="ident" id="4778817"><a href="/encoding/json/encode.go.html#4774113">typeFields</a></span><span class="op" id="4778827">(</span><span class="ident" id="4778828"><a href="/encoding/json/encode.go.html#4778592">t</a></span><span class="op" id="4778829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4778832">if</span>&nbsp;<span class="ident" id="4778835"><a href="/encoding/json/encode.go.html#4778639">f</a></span>&nbsp;<span class="op" id="4778837">==</span>&nbsp;<span class="ident" id="4778840">nil</span>&nbsp;<span class="op" id="4778844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4778848"><a href="/encoding/json/encode.go.html#4778639">f</a></span>&nbsp;<span class="op" id="4778850">=</span>&nbsp;<span class="op" id="4778852">[</span><span class="op" id="4778853">]</span><span class="ident" id="4778854"><a href="/encoding/json/encode.go.html#4772578">field</a></span><span class="op" id="4778859">{</span><span class="op" id="4778860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4778863">}</span><br>
<span class="lineno">1175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4778867"><a href="/encoding/json/encode.go.html#4778425">fieldCache</a></span><span class="op" id="4778877">.</span><span class="ident" id="4778878">Lock</span><span class="op" id="4778882">(</span><span class="op" id="4778883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4778886">if</span>&nbsp;<span class="ident" id="4778889"><a href="/encoding/json/encode.go.html#4778425">fieldCache</a></span><span class="op" id="4778899">.</span><span class="ident" id="4778900">m</span>&nbsp;<span class="op" id="4778902">==</span>&nbsp;<span class="ident" id="4778905">nil</span>&nbsp;<span class="op" id="4778909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4778913"><a href="/encoding/json/encode.go.html#4778425">fieldCache</a></span><span class="op" id="4778923">.</span><span class="ident" id="4778924">m</span>&nbsp;<span class="op" id="4778926">=</span>&nbsp;<span class="keyword" id="4778928">map</span><span class="op" id="4778931">[</span><span class="ident" id="4778932"><a href="/encoding/json/encode.go.html#4748667">reflect</a></span><span class="op" id="4778939">.</span><span class="ident" id="4778940">Type</span><span class="op" id="4778944">]</span><span class="op" id="4778945">[</span><span class="op" id="4778946">]</span><span class="ident" id="4778947"><a href="/encoding/json/encode.go.html#4772578">field</a></span><span class="op" id="4778952">{</span><span class="op" id="4778953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4778956">}</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4778959"><a href="/encoding/json/encode.go.html#4778425">fieldCache</a></span><span class="op" id="4778969">.</span><span class="ident" id="4778970">m</span><span class="op" id="4778971">[</span><span class="ident" id="4778972"><a href="/encoding/json/encode.go.html#4778592">t</a></span><span class="op" id="4778973">]</span>&nbsp;<span class="op" id="4778975">=</span>&nbsp;<span class="ident" id="4778977"><a href="/encoding/json/encode.go.html#4778639">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4778980"><a href="/encoding/json/encode.go.html#4778425">fieldCache</a></span><span class="op" id="4778990">.</span><span class="ident" id="4778991">Unlock</span><span class="op" id="4778997">(</span><span class="op" id="4778998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4779001">return</span>&nbsp;<span class="ident" id="4779008"><a href="/encoding/json/encode.go.html#4778639">f</a></span><br>
<span class="lineno"></span><span class="op" id="4779010">}</span>
</div>
</body>
</html>
